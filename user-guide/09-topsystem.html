
<!DOCTYPE html>


<html lang="en" data-content_root="../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Topsystem: from 2D map to 3D model &#8212; iMOD Python 1.0.0rc4 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=2fc85bd2"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user-guide/09-topsystem';</script>
    <script src="../_static/deltares.js?v=8d5578be"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Data cleanup" href="10-cleanup.html" />
    <link rel="prev" title="Regridding" href="08-regridding.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.0.0rc4.dev" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
    
    <img src="../_static/imod-python-logo-light.svg" class="logo__image only-light" alt="iMOD Python 1.0.0rc4 documentation - Home"/>
    <img src="../_static/imod-python-logo-dark.svg" class="logo__image only-dark pst-js-only" alt="iMOD Python 1.0.0rc4 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation.html">
    Installing
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../faq/index.html">
    FAQ
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../developing/index.html">
    Developing
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.deltares.nl/en/" title="Deltares" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-deltares fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Deltares</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Deltares/imod-python" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation.html">
    Installing
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../faq/index.html">
    FAQ
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../developing/index.html">
    Developing
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.deltares.nl/en/" title="Deltares" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-deltares fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Deltares</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Deltares/imod-python" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="00-index-examples.html">Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="01-raster-data.html">Raster data and xarray</a></li>
<li class="toctree-l1"><a class="reference internal" href="02-vector-data.html">Vector data and Geopandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="03-timeseries-data.html">Time series data and Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="05-unstructured-grids.html">Unstructured Grids</a></li>
<li class="toctree-l1"><a class="reference internal" href="06-lazy-evaluation.html">Lazy evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="07-time-discretization.html">Model time discretization</a></li>
<li class="toctree-l1"><a class="reference internal" href="08-regridding.html">Regridding</a></li>








<li class="toctree-l1 current active"><a class="current reference internal" href="#">Topsystem: from 2D map to 3D model</a></li>
<li class="toctree-l1"><a class="reference internal" href="10-cleanup.html">Data cleanup</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">User Guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Topsystem: from 2D map to 3D model</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-user-guide-09-topsystem-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="topsystem-from-2d-map-to-3d-model">
<span id="sphx-glr-user-guide-09-topsystem-py"></span><h1>Topsystem: from 2D map to 3D model<a class="headerlink" href="#topsystem-from-2d-map-to-3d-model" title="Link to this heading">#</a></h1>
<p>iMOD Python has multiple features to help you define the topsystem of the
groundwater system. With “topsystem” we mean all forcings which act on the top
of the groundwater system. These are usually either meteorological
(precipitation &amp; evapotranspiration) or hydrological (rivers, ditches, lakes,
sea) in nature. In MODFLOW 6 these are usually simulated with the DRN, RIV, GHB,
and RCH package. This data is usually provided as planar grids (x, y) without
any vertical dimension. This user guide will show you how to allocate these
forcings across model layers to grid cells and how to distribute conductances
for Robin-like boundary conditions (RIV, DRN, GHB) over model layers. We will
demonstrate this with the RIV package, as this package supports all options for
allocating cells and distributing conductances. A subset of options are
available for the DRN, GHB, and RCH packages.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<section id="example-data">
<h2>Example data<a class="headerlink" href="#example-data" title="Link to this heading">#</a></h2>
<p>Let’s load the data first. We have a layer model containing a basic
hydrogeological schemitization of our model, so the tops and bottoms of model
layers, the hydraulic conductivity (k), and which cells are active (idomain=1)
or vertical passthrough (idomain=-1).</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">imod</span>

<span class="n">layer_model</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">hondsrug_layermodel_topsystem</span><span class="p">()</span>

<span class="n">layer_model</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 64MB
Dimensions:  (layer: 20, y: 200, x: 500)
Coordinates:
  * layer    (layer) int64 160B 1 2 3 4 5 6 7 8 9 ... 12 13 14 15 16 17 18 19 20
  * x        (x) float64 4kB 2.375e+05 2.375e+05 2.376e+05 ... 2.5e+05 2.5e+05
  * y        (y) float64 2kB 5.64e+05 5.64e+05 5.639e+05 ... 5.59e+05 5.59e+05
    dx       float64 8B 25.0
    dy       float64 8B -25.0
Data variables:
    k        (layer, y, x) float64 16MB nan nan nan nan ... 15.39 15.38 15.44
    idomain  (layer, y, x) float64 16MB -1.0 -1.0 -1.0 -1.0 ... 1.0 1.0 1.0 1.0
    top      (layer, y, x) float64 16MB 6.329 6.329 6.329 ... -16.92 -16.92
    bottom   (layer, y, x) float64 16MB 6.329 6.329 6.329 ... -19.68 -19.68</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-145e70dd-b60b-4d59-a487-37d8e98b0501' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-145e70dd-b60b-4d59-a487-37d8e98b0501' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>layer</span>: 20</li><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>x</span>: 500</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-9541bfee-de82-47b1-b4f7-b537152c3469' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9541bfee-de82-47b1-b4f7-b537152c3469' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 ... 15 16 17 18 19 20</div><input id='attrs-4214dc56-a200-4eeb-9909-23c418834253' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4214dc56-a200-4eeb-9909-23c418834253' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9b2f5eae-8de7-4af0-bcb7-b9173f14df3f' class='xr-var-data-in' type='checkbox'><label for='data-9b2f5eae-8de7-4af0-bcb7-b9173f14df3f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
       19, 20])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-59c4121d-f7f8-4f85-9e99-81b35575a82d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-59c4121d-f7f8-4f85-9e99-81b35575a82d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-91658760-93d0-4813-9d87-585bedc56251' class='xr-var-data-in' type='checkbox'><label for='data-91658760-93d0-4813-9d87-585bedc56251' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5],
      shape=(500,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-b1dc3e5c-88fe-43bb-9d7b-5716871b73e4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b1dc3e5c-88fe-43bb-9d7b-5716871b73e4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-92167397-faf7-43e4-8efb-1aaade801229' class='xr-var-data-in' type='checkbox'><label for='data-92167397-faf7-43e4-8efb-1aaade801229' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
       563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
       563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
       563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
       563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
       563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
       562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
       562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
       562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
       562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
       562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
       562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
       561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
       561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
       561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
       561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
       561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
       561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
       560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
       560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
       560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
       560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
       560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
       559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
       559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
       559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
       559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
       559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
       559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>25.0</div><input id='attrs-abd3bec4-9ea0-48ec-9eb9-ff0b260175ac' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-abd3bec4-9ea0-48ec-9eb9-ff0b260175ac' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e764e000-e0dd-49ca-9591-c6e576a744a0' class='xr-var-data-in' type='checkbox'><label for='data-e764e000-e0dd-49ca-9591-c6e576a744a0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-25.0</div><input id='attrs-42b6aacb-ee54-41df-945a-c7cedb878f8c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-42b6aacb-ee54-41df-945a-c7cedb878f8c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-98c35724-ac47-4092-b4a4-7e89e550c5fb' class='xr-var-data-in' type='checkbox'><label for='data-98c35724-ac47-4092-b4a4-7e89e550c5fb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-25.)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b2b26859-43d0-414e-9780-bca99427bf70' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b2b26859-43d0-414e-9780-bca99427bf70' class='xr-section-summary' >Data variables: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>k</span></div><div class='xr-var-dims'>(layer, y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... 15.39 15.38 15.44</div><input id='attrs-16b2cd59-653b-41de-be43-6fb6831f15e6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-16b2cd59-653b-41de-be43-6fb6831f15e6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-14b0f556-89d3-4dfe-b1ba-cdd64642ceb6' class='xr-var-data-in' type='checkbox'><label for='data-14b0f556-89d3-4dfe-b1ba-cdd64642ceb6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[         nan,          nan,          nan, ...,   2.09063745,
           1.92048049,   1.27883947],
        [         nan,          nan,          nan, ...,   2.26992607,
           2.14511347,   1.35537922],
        [         nan,          nan,          nan, ...,   2.41958737,
           2.35661888,   1.53761673],
        ...,
        [  6.95569086,   6.9874959 ,   7.00762653, ...,          nan,
                  nan,          nan],
        [  6.76307201,   6.81238127,   6.84568357, ...,          nan,
                  nan,          nan],
        [  6.41486168,   6.47761154,   6.52335644, ...,          nan,
                  nan,          nan]],

       [[         nan,          nan,          nan, ...,   2.09063745,
           1.92048049,   1.27883947],
        [         nan,          nan,          nan, ...,   2.26992607,
           2.14511347,   1.35537922],
        [         nan,          nan,          nan, ...,   2.41958737,
           2.35661888,   1.53761673],
...
        [  3.23147655,   3.21656537,   3.20356822, ...,  15.054636  ,
          14.99483585,  15.02609539],
        [  3.25598717,   3.24192309,   3.22996807, ...,  15.28957748,
          15.25116062,  15.30180931],
        [  3.28274798,   3.2713542 ,   3.26131344, ...,  15.3915987 ,
          15.37846184,  15.43572426]],

       [[  3.34453869,   3.36107755,   3.4030385 , ..., 100.        ,
         100.        , 100.        ],
        [  3.33302832,   3.34805989,   3.38137436, ..., 100.        ,
         100.        , 100.        ],
        [  3.29513741,   3.30980277,   3.33594632, ..., 100.        ,
         100.        , 100.        ],
        ...,
        [  3.23147655,   3.21656537,   3.20356822, ...,  15.054636  ,
          14.99483585,  15.02609539],
        [  3.25598717,   3.24192309,   3.22996807, ...,  15.28957748,
          15.25116062,  15.30180931],
        [  3.28274798,   3.2713542 ,   3.26131344, ...,  15.3915987 ,
          15.37846184,  15.43572426]]], shape=(20, 200, 500))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>idomain</span></div><div class='xr-var-dims'>(layer, y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1.0 -1.0 -1.0 -1.0 ... 1.0 1.0 1.0</div><input id='attrs-cccae76e-d664-4e4c-ad49-8a66a7481083' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cccae76e-d664-4e4c-ad49-8a66a7481083' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f3c3ef8e-b987-4084-8882-3ee509b9feb8' class='xr-var-data-in' type='checkbox'><label for='data-f3c3ef8e-b987-4084-8882-3ee509b9feb8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[-1., -1., -1., ...,  1.,  1.,  1.],
        [-1., -1., -1., ...,  1.,  1.,  1.],
        [-1., -1., -1., ...,  1.,  1.,  1.],
        ...,
        [ 1.,  1.,  1., ..., -1., -1., -1.],
        [ 1.,  1.,  1., ..., -1., -1., -1.],
        [ 1.,  1.,  1., ..., -1., -1., -1.]],

       [[-1., -1., -1., ...,  1.,  1.,  1.],
        [-1., -1., -1., ...,  1.,  1.,  1.],
        [-1., -1., -1., ...,  1.,  1.,  1.],
        ...,
        [ 1.,  1.,  1., ..., -1., -1., -1.],
        [ 1.,  1.,  1., ..., -1., -1., -1.],
        [ 1.,  1.,  1., ..., -1., -1., -1.]],

       [[-1., -1., -1., ...,  1.,  1.,  1.],
        [-1., -1., -1., ...,  1.,  1.,  1.],
        [-1., -1., -1., ...,  1.,  1.,  1.],
        ...,
...
        ...,
        [ 1.,  1.,  1., ...,  1.,  1.,  1.],
        [ 1.,  1.,  1., ...,  1.,  1.,  1.],
        [ 1.,  1.,  1., ...,  1.,  1.,  1.]],

       [[ 1.,  1.,  1., ...,  1.,  1.,  1.],
        [ 1.,  1.,  1., ...,  1.,  1.,  1.],
        [ 1.,  1.,  1., ...,  1.,  1.,  1.],
        ...,
        [ 1.,  1.,  1., ...,  1.,  1.,  1.],
        [ 1.,  1.,  1., ...,  1.,  1.,  1.],
        [ 1.,  1.,  1., ...,  1.,  1.,  1.]],

       [[ 1.,  1.,  1., ...,  1.,  1.,  1.],
        [ 1.,  1.,  1., ...,  1.,  1.,  1.],
        [ 1.,  1.,  1., ...,  1.,  1.,  1.],
        ...,
        [ 1.,  1.,  1., ...,  1.,  1.,  1.],
        [ 1.,  1.,  1., ...,  1.,  1.,  1.],
        [ 1.,  1.,  1., ...,  1.,  1.,  1.]]], shape=(20, 200, 500))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>top</span></div><div class='xr-var-dims'>(layer, y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>6.329 6.329 6.329 ... -16.92 -16.92</div><input id='attrs-6641cdf9-b16e-4c3e-86b1-3c2436ed5d49' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6641cdf9-b16e-4c3e-86b1-3c2436ed5d49' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2277828f-a8d5-437c-8ffa-ba6fc0855835' class='xr-var-data-in' type='checkbox'><label for='data-2277828f-a8d5-437c-8ffa-ba6fc0855835' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[  6.3288002 ,   6.3288002 ,   6.3288002 , ...,   2.51160002,
           2.51160002,   2.51160002],
        [  6.3288002 ,   6.3288002 ,   6.3288002 , ...,   2.51160002,
           2.51160002,   2.51160002],
        [  6.3288002 ,   6.3288002 ,   6.3288002 , ...,   2.51160002,
           2.51160002,   2.51160002],
        ...,
        [  9.42520046,   9.42520046,   9.42520046, ...,   3.19840002,
           3.19840002,   3.19840002],
        [  9.42520046,   9.42520046,   9.42520046, ...,   3.19840002,
           3.19840002,   3.19840002],
        [  9.42520046,   9.42520046,   9.42520046, ...,   3.19840002,
           3.19840002,   3.19840002]],

       [[  6.3288002 ,   6.3288002 ,   6.3288002 , ...,   1.53750002,
           1.53750002,   1.53750002],
        [  6.3288002 ,   6.3288002 ,   6.3288002 , ...,   1.53750002,
           1.53750002,   1.53750002],
        [  6.3288002 ,   6.3288002 ,   6.3288002 , ...,   1.53750002,
           1.53750002,   1.53750002],
...
        [ -2.15040016,  -2.15040016,  -2.15040016, ..., -14.15840006,
         -14.15840006, -14.15840006],
        [ -2.15040016,  -2.15040016,  -2.15040016, ..., -14.15840006,
         -14.15840006, -14.15840006],
        [ -2.15040016,  -2.15040016,  -2.15040016, ..., -14.15840006,
         -14.15840006, -14.15840006]],

       [[ -1.20539975,  -1.20539975,  -1.20539975, ..., -24.86359978,
         -24.86359978, -24.86359978],
        [ -1.20539975,  -1.20539975,  -1.20539975, ..., -24.86359978,
         -24.86359978, -24.86359978],
        [ -1.20539975,  -1.20539975,  -1.20539975, ..., -24.86359978,
         -24.86359978, -24.86359978],
        ...,
        [ -7.14000034,  -7.14000034,  -7.14000034, ..., -16.91759992,
         -16.91759992, -16.91759992],
        [ -7.14000034,  -7.14000034,  -7.14000034, ..., -16.91759992,
         -16.91759992, -16.91759992],
        [ -7.14000034,  -7.14000034,  -7.14000034, ..., -16.91759992,
         -16.91759992, -16.91759992]]], shape=(20, 200, 500))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>bottom</span></div><div class='xr-var-dims'>(layer, y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>6.329 6.329 6.329 ... -19.68 -19.68</div><input id='attrs-6a9e2d41-dc5b-4589-81c2-10fcc7d162a7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6a9e2d41-dc5b-4589-81c2-10fcc7d162a7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-47903dbb-c5f0-4e4d-a482-62e26e872298' class='xr-var-data-in' type='checkbox'><label for='data-47903dbb-c5f0-4e4d-a482-62e26e872298' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[  6.3288002 ,   6.3288002 ,   6.3288002 , ...,   1.53750002,
           1.53750002,   1.53750002],
        [  6.3288002 ,   6.3288002 ,   6.3288002 , ...,   1.53750002,
           1.53750002,   1.53750002],
        [  6.3288002 ,   6.3288002 ,   6.3288002 , ...,   1.53750002,
           1.53750002,   1.53750002],
        ...,
        [  9.09970045,   9.09970045,   9.09970045, ...,   3.19840002,
           3.19840002,   3.19840002],
        [  9.09970045,   9.09970045,   9.09970045, ...,   3.19840002,
           3.19840002,   3.19840002],
        [  9.09970045,   9.09970045,   9.09970045, ...,   3.19840002,
           3.19840002,   3.19840002]],

       [[  6.3288002 ,   6.3288002 ,   6.3288002 , ...,   0.56340003,
           0.56340003,   0.56340003],
        [  6.3288002 ,   6.3288002 ,   6.3288002 , ...,   0.56340003,
           0.56340003,   0.56340003],
        [  6.3288002 ,   6.3288002 ,   6.3288002 , ...,   0.56340003,
           0.56340003,   0.56340003],
...
        [ -7.14000034,  -7.14000034,  -7.14000034, ..., -16.91759992,
         -16.91759992, -16.91759992],
        [ -7.14000034,  -7.14000034,  -7.14000034, ..., -16.91759992,
         -16.91759992, -16.91759992],
        [ -7.14000034,  -7.14000034,  -7.14000034, ..., -16.91759992,
         -16.91759992, -16.91759992]],

       [[ -3.52719975,  -3.52719975,  -3.52719975, ..., -24.90279961,
         -24.90279961, -24.90279961],
        [ -3.52719975,  -3.52719975,  -3.52719975, ..., -24.90279961,
         -24.90279961, -24.90279961],
        [ -3.52719975,  -3.52719975,  -3.52719975, ..., -24.90279961,
         -24.90279961, -24.90279961],
        ...,
        [-12.12960052, -12.12960052, -12.12960052, ..., -19.67679977,
         -19.67679977, -19.67679977],
        [-12.12960052, -12.12960052, -12.12960052, ..., -19.67679977,
         -19.67679977, -19.67679977],
        [-12.12960052, -12.12960052, -12.12960052, ..., -19.67679977,
         -19.67679977, -19.67679977]]], shape=(20, 200, 500))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7b843d8f-2025-47c1-b19d-0f5c03eadd6d' class='xr-section-summary-in' type='checkbox'  ><label for='section-7b843d8f-2025-47c1-b19d-0f5c03eadd6d' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>layer</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-6f714b07-5497-4cee-992f-f20a462539f5' class='xr-index-data-in' type='checkbox'/><label for='index-6f714b07-5497-4cee-992f-f20a462539f5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20], dtype=&#x27;int64&#x27;, name=&#x27;layer&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-f191a5b2-a804-41fb-8371-6564c9e25bf3' class='xr-index-data-in' type='checkbox'/><label for='index-f191a5b2-a804-41fb-8371-6564c9e25bf3' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([237512.5, 237537.5, 237562.5, 237587.5, 237612.5, 237637.5, 237662.5,
       237687.5, 237712.5, 237737.5,
       ...
       249762.5, 249787.5, 249812.5, 249837.5, 249862.5, 249887.5, 249912.5,
       249937.5, 249962.5, 249987.5],
      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=500))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-8413d813-08ce-458e-8008-6c5fa3c67095' class='xr-index-data-in' type='checkbox'/><label for='index-8413d813-08ce-458e-8008-6c5fa3c67095' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
       563812.5, 563787.5, 563762.5,
       ...
       559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5, 559087.5,
       559062.5, 559037.5, 559012.5],
      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=200))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-22499aca-ec18-426a-a5f8-c2718c78c15f' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-22499aca-ec18-426a-a5f8-c2718c78c15f' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
<br />
<br /><p>Furthermore we have planar grid of river, containing a river stage, bed
elevation and conductance.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">planar_river</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">hondsrug_planar_river</span><span class="p">()</span>

<span class="n">planar_river</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1MB
Dimensions:      (x: 500, y: 200)
Coordinates:
  * x            (x) float64 4kB 2.375e+05 2.375e+05 ... 2.5e+05 2.5e+05
  * y            (y) float64 2kB 5.64e+05 5.64e+05 ... 5.59e+05 5.59e+05
    dx           float64 8B ...
    dy           float64 8B ...
    layer        int32 4B 1
Data variables:
    stage        (y, x) float32 400kB nan nan nan 5.014 ... nan nan nan nan
    bottom       (y, x) float32 400kB nan nan nan 3.7 3.7 ... nan nan nan nan
    conductance  (y, x) float32 400kB nan nan nan 8.21 6.02 ... nan nan nan nan</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-351b2a56-95a8-4e94-9e72-39ff811d036d' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-351b2a56-95a8-4e94-9e72-39ff811d036d' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>x</span>: 500</li><li><span class='xr-has-index'>y</span>: 200</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-5a012778-f5c1-45ce-a74d-a7d68e41fda6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5a012778-f5c1-45ce-a74d-a7d68e41fda6' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-de3a699d-fb1d-4000-8df6-148eedf46f6e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-de3a699d-fb1d-4000-8df6-148eedf46f6e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cbe9d344-2f4e-4944-b901-e5d8fdeed2d7' class='xr-var-data-in' type='checkbox'><label for='data-cbe9d344-2f4e-4944-b901-e5d8fdeed2d7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5],
      shape=(500,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-8a0f4b3a-f6c9-4a75-975b-9a25823e23a0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8a0f4b3a-f6c9-4a75-975b-9a25823e23a0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-43bae399-5156-470e-b8e4-c75977aaf27a' class='xr-var-data-in' type='checkbox'><label for='data-43bae399-5156-470e-b8e4-c75977aaf27a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
       563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
       563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
       563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
       563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
       563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
       562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
       562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
       562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
       562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
       562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
       562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
       561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
       561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
       561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
       561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
       561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
       561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
       560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
       560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
       560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
       560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
       560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
       559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
       559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
       559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
       559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
       559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
       559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-8a4cceac-94f4-4b87-9e5b-78c480c4104c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8a4cceac-94f4-4b87-9e5b-78c480c4104c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9eb082a0-a44c-40fd-9822-2f2e9354cf3d' class='xr-var-data-in' type='checkbox'><label for='data-9eb082a0-a44c-40fd-9822-2f2e9354cf3d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-a25502bc-c10c-49be-ba3a-2ea6697670ea' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a25502bc-c10c-49be-ba3a-2ea6697670ea' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-95eb0d6e-4f05-4038-aadc-4dfb888b33be' class='xr-var-data-in' type='checkbox'><label for='data-95eb0d6e-4f05-4038-aadc-4dfb888b33be' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>layer</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1</div><input id='attrs-0dcdfd22-9102-4228-8372-5ec6dcf59659' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0dcdfd22-9102-4228-8372-5ec6dcf59659' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9bede003-97ca-4f80-8afb-024702dd8316' class='xr-var-data-in' type='checkbox'><label for='data-9bede003-97ca-4f80-8afb-024702dd8316' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1, dtype=int32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c1df2f19-bf63-4fd5-9ebb-442999720bb9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c1df2f19-bf63-4fd5-9ebb-442999720bb9' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>stage</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan 5.014 ... nan nan nan</div><input id='attrs-645b4d03-2081-49b3-8e79-13de90a81f45' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-645b4d03-2081-49b3-8e79-13de90a81f45' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-af81d340-6ffd-4d49-8ad0-a52e6d2cdf11' class='xr-var-data-in' type='checkbox'><label for='data-af81d340-6ffd-4d49-8ad0-a52e6d2cdf11' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[      nan,       nan,       nan, ..., 1.9508   , 1.9358001,
        1.9258001],
       [      nan, 5.3744   , 5.2444   , ...,       nan, 1.9258001,
        1.9258001],
       [5.5094004, 5.4394   ,       nan, ...,       nan, 1.7708   ,
        1.6558001],
       ...,
       [      nan,       nan,       nan, ...,       nan,       nan,
              nan],
       [      nan,       nan,       nan, ...,       nan,       nan,
              nan],
       [      nan,       nan, 8.3776   , ...,       nan,       nan,
              nan]], shape=(200, 500), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>bottom</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan 3.7 ... nan nan nan nan</div><input id='attrs-c7de25e3-266b-4fd4-a8aa-c7c59973ce3b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c7de25e3-266b-4fd4-a8aa-c7c59973ce3b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-36ce1c1c-938e-4b16-af66-345bc6a6e220' class='xr-var-data-in' type='checkbox'><label for='data-36ce1c1c-938e-4b16-af66-345bc6a6e220' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ nan,  nan,  nan, ..., 1.39, 1.36, 1.34],
       [ nan, 4.42, 4.16, ...,  nan, 1.34, 1.34],
       [4.69, 4.55,  nan, ...,  nan, 1.03, 0.51],
       ...,
       [ nan,  nan,  nan, ...,  nan,  nan,  nan],
       [ nan,  nan,  nan, ...,  nan,  nan,  nan],
       [ nan,  nan, 7.33, ...,  nan,  nan,  nan]],
      shape=(200, 500), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>conductance</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan 8.21 ... nan nan nan</div><input id='attrs-22a32e58-e358-4f50-842d-17a5d8e89db0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-22a32e58-e358-4f50-842d-17a5d8e89db0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-23f178f6-747b-4393-ab05-68076e40e776' class='xr-var-data-in' type='checkbox'><label for='data-23f178f6-747b-4393-ab05-68076e40e776' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[  nan,   nan,   nan, ..., 29.86,  2.71, 29.86],
       [  nan, 21.66, 22.56, ...,   nan,  4.52, 26.24],
       [22.56,  0.9 ,   nan, ...,   nan,  0.9 , 11.67],
       ...,
       [  nan,   nan,   nan, ...,   nan,   nan,   nan],
       [  nan,   nan,   nan, ...,   nan,   nan,   nan],
       [  nan,   nan, 15.46, ...,   nan,   nan,   nan]],
      shape=(200, 500), dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d39c9140-a840-46d8-be64-442bf932324c' class='xr-section-summary-in' type='checkbox'  ><label for='section-d39c9140-a840-46d8-be64-442bf932324c' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-8a5e591d-2b8e-4203-811d-5d4ec5d9aa88' class='xr-index-data-in' type='checkbox'/><label for='index-8a5e591d-2b8e-4203-811d-5d4ec5d9aa88' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([237512.5, 237537.5, 237562.5, 237587.5, 237612.5, 237637.5, 237662.5,
       237687.5, 237712.5, 237737.5,
       ...
       249762.5, 249787.5, 249812.5, 249837.5, 249862.5, 249887.5, 249912.5,
       249937.5, 249962.5, 249987.5],
      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=500))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-95e343c1-0454-4aa8-b1e5-b6115695d304' class='xr-index-data-in' type='checkbox'/><label for='index-95e343c1-0454-4aa8-b1e5-b6115695d304' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
       563812.5, 563787.5, 563762.5,
       ...
       559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5, 559087.5,
       559062.5, 559037.5, 559012.5],
      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=200))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d47b453e-75c6-4da8-8b7e-af26874b6429' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d47b453e-75c6-4da8-8b7e-af26874b6429' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
<br />
<br /><p>Let’s plot the top elevation of the model on a map. You can see we have a
ridge roughly the centre of the model, sided by two low-lying areas.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">imod</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span>
    <span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;viridis&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_09-topsystem_001.png" srcset="../_images/sphx_glr_09-topsystem_001.png" alt="09 topsystem" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 640x480 with 2 Axes&gt;, &lt;Axes: &gt;)
</pre></div>
</div>
<p>Let’s plot the river stages on a map. You can see most rivers are located
in the low-lying areas.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">imod</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span><span class="n">planar_river</span><span class="p">[</span><span class="s2">&quot;stage&quot;</span><span class="p">],</span> <span class="s2">&quot;viridis&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_09-topsystem_002.png" srcset="../_images/sphx_glr_09-topsystem_002.png" alt="09 topsystem" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 640x480 with 2 Axes&gt;, &lt;Axes: &gt;)
</pre></div>
</div>
</section>
<section id="allocate-river-cells">
<h2>Allocate river cells<a class="headerlink" href="#allocate-river-cells" title="Link to this heading">#</a></h2>
<p>Let’s allocate river cells across model layers to cells.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">imod.prepare</span><span class="w"> </span><span class="kn">import</span> <span class="n">ALLOCATION_OPTION</span><span class="p">,</span> <span class="n">allocate_riv_cells</span>

<span class="n">riv_allocated</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">allocate_riv_cells</span><span class="p">(</span>
    <span class="n">allocation_option</span><span class="o">=</span><span class="n">ALLOCATION_OPTION</span><span class="o">.</span><span class="n">at_elevation</span><span class="p">,</span>
    <span class="n">active</span><span class="o">=</span><span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;idomain&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">top</span><span class="o">=</span><span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">],</span>
    <span class="n">bottom</span><span class="o">=</span><span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">],</span>
    <span class="n">stage</span><span class="o">=</span><span class="n">planar_river</span><span class="p">[</span><span class="s2">&quot;stage&quot;</span><span class="p">],</span>
    <span class="n">bottom_elevation</span><span class="o">=</span><span class="n">planar_river</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Let’s take a look at what we just produced. Since we are dealing with
information with depth, it is simplest to make a crosssection plot. For that,
we first have to select a crosssection.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gpd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">LineString</span>

<span class="n">geometry</span> <span class="o">=</span> <span class="n">LineString</span><span class="p">([[</span><span class="mi">238725</span><span class="p">,</span> <span class="mi">561800</span><span class="p">],</span> <span class="p">[</span><span class="mi">241050</span><span class="p">,</span> <span class="mi">560350</span><span class="p">]])</span>

<span class="c1"># Define overlay</span>
<span class="n">overlays</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">&quot;gdf&quot;</span><span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">geometry</span><span class="o">=</span><span class="p">[</span><span class="n">geometry</span><span class="p">]),</span> <span class="s2">&quot;edgecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
<span class="p">]</span>
<span class="c1"># Plot</span>
<span class="n">imod</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span>
    <span class="n">planar_river</span><span class="p">[</span><span class="s2">&quot;stage&quot;</span><span class="p">],</span> <span class="s2">&quot;viridis&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">overlays</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_09-topsystem_003.png" srcset="../_images/sphx_glr_09-topsystem_003.png" alt="09 topsystem" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 640x480 with 2 Axes&gt;, &lt;Axes: &gt;)
</pre></div>
</div>
<p>Select a cross section. The plot also requires top and bottom information
which we will add first as coordinates before selecting.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">riv_allocated</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span>
<span class="n">riv_allocated</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span>

<span class="n">xsection_allocated</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">cross_section_linestring</span><span class="p">(</span><span class="n">riv_allocated</span><span class="p">,</span> <span class="n">geometry</span><span class="p">)</span>

<span class="n">xsection_allocated</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (layer: 20, s: 150)&gt; Size: 24kB
array([[0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       ...,
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.]], shape=(20, 150))
Coordinates:
    x        (s) float64 1kB 2.387e+05 2.388e+05 2.388e+05 ... 2.41e+05 2.41e+05
    y        (s) float64 1kB 5.618e+05 5.618e+05 ... 5.604e+05 5.604e+05
    dx       (s) float64 1kB 25.0 15.09 9.914 25.0 ... 25.0 9.914 15.09 25.0
    dy       (s) float64 1kB -15.59 -9.409 -6.183 ... -6.183 -9.409 -15.59
  * layer    (layer) int64 160B 1 2 3 4 5 6 7 8 9 ... 12 13 14 15 16 17 18 19 20
    top      (layer, s) float64 24kB 5.76 5.76 5.76 5.76 ... 2.875 2.875 2.875
    bottom   (layer, s) float64 24kB 5.76 5.76 5.76 5.76 ... 1.679 1.679 1.679
  * s        (s) float64 1kB 14.73 38.35 53.08 ... 2.687e+03 2.702e+03 2.725e+03
    ds       (s) float64 1kB 29.46 17.78 11.68 29.46 ... 29.46 11.68 17.78 29.46</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>layer</span>: 20</li><li><span class='xr-has-index'>s</span>: 150</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-793028eb-0c2e-42e8-867c-102a98901c32' class='xr-array-in' type='checkbox' checked><label for='section-793028eb-0c2e-42e8-867c-102a98901c32' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0</span></div><div class='xr-array-data'><pre>array([[0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       ...,
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.]], shape=(20, 150))</pre></div></div></li><li class='xr-section-item'><input id='section-cd5c5112-c520-4e4f-a06e-0bd0f40ca23b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-cd5c5112-c520-4e4f-a06e-0bd0f40ca23b' class='xr-section-summary' >Coordinates: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>x</span></div><div class='xr-var-dims'>(s)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.387e+05 2.388e+05 ... 2.41e+05</div><input id='attrs-b180d69c-8250-479d-a8d0-bac053f854af' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b180d69c-8250-479d-a8d0-bac053f854af' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-02c8631b-8443-4558-ae94-951cd0fe9137' class='xr-var-data-in' type='checkbox'><label for='data-02c8631b-8443-4558-ae94-951cd0fe9137' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([238737.5, 238762.5, 238762.5, 238787.5, 238812.5, 238812.5, 238837.5,
       238837.5, 238862.5, 238887.5, 238887.5, 238912.5, 238937.5, 238937.5,
       238962.5, 238962.5, 238987.5, 239012.5, 239012.5, 239037.5, 239037.5,
       239062.5, 239087.5, 239087.5, 239112.5, 239137.5, 239137.5, 239162.5,
       239162.5, 239187.5, 239212.5, 239212.5, 239237.5, 239237.5, 239262.5,
       239287.5, 239287.5, 239312.5, 239337.5, 239337.5, 239362.5, 239362.5,
       239387.5, 239412.5, 239412.5, 239437.5, 239437.5, 239462.5, 239487.5,
       239487.5, 239512.5, 239537.5, 239537.5, 239562.5, 239562.5, 239587.5,
       239612.5, 239612.5, 239637.5, 239637.5, 239662.5, 239687.5, 239687.5,
       239712.5, 239737.5, 239737.5, 239762.5, 239762.5, 239787.5, 239812.5,
       239812.5, 239837.5, 239837.5, 239862.5, 239887.5, 239887.5, 239912.5,
       239937.5, 239937.5, 239962.5, 239962.5, 239987.5, 240012.5, 240012.5,
       240037.5, 240037.5, 240062.5, 240087.5, 240087.5, 240112.5, 240137.5,
       240137.5, 240162.5, 240162.5, 240187.5, 240212.5, 240212.5, 240237.5,
       240237.5, 240262.5, 240287.5, 240287.5, 240312.5, 240337.5, 240337.5,
       240362.5, 240362.5, 240387.5, 240412.5, 240412.5, 240437.5, 240437.5,
       240462.5, 240487.5, 240487.5, 240512.5, 240537.5, 240537.5, 240562.5,
       240562.5, 240587.5, 240612.5, 240612.5, 240637.5, 240637.5, 240662.5,
       240687.5, 240687.5, 240712.5, 240737.5, 240737.5, 240762.5, 240762.5,
       240787.5, 240812.5, 240812.5, 240837.5, 240837.5, 240862.5, 240887.5,
       240887.5, 240912.5, 240937.5, 240937.5, 240962.5, 240962.5, 240987.5,
       241012.5, 241012.5, 241037.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>y</span></div><div class='xr-var-dims'>(s)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.618e+05 5.618e+05 ... 5.604e+05</div><input id='attrs-f8b11529-34b1-41d5-9942-ba82b26221c8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f8b11529-34b1-41d5-9942-ba82b26221c8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bd4d148d-9d79-4f01-bebb-b39377a4b82f' class='xr-var-data-in' type='checkbox'><label for='data-bd4d148d-9d79-4f01-bebb-b39377a4b82f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([561787.5, 561787.5, 561762.5, 561762.5, 561762.5, 561737.5, 561737.5,
       561712.5, 561712.5, 561712.5, 561687.5, 561687.5, 561687.5, 561662.5,
       561662.5, 561637.5, 561637.5, 561637.5, 561612.5, 561612.5, 561587.5,
       561587.5, 561587.5, 561562.5, 561562.5, 561562.5, 561537.5, 561537.5,
       561512.5, 561512.5, 561512.5, 561487.5, 561487.5, 561462.5, 561462.5,
       561462.5, 561437.5, 561437.5, 561437.5, 561412.5, 561412.5, 561387.5,
       561387.5, 561387.5, 561362.5, 561362.5, 561337.5, 561337.5, 561337.5,
       561312.5, 561312.5, 561312.5, 561287.5, 561287.5, 561262.5, 561262.5,
       561262.5, 561237.5, 561237.5, 561212.5, 561212.5, 561212.5, 561187.5,
       561187.5, 561187.5, 561162.5, 561162.5, 561137.5, 561137.5, 561137.5,
       561112.5, 561112.5, 561087.5, 561087.5, 561087.5, 561062.5, 561062.5,
       561062.5, 561037.5, 561037.5, 561012.5, 561012.5, 561012.5, 560987.5,
       560987.5, 560962.5, 560962.5, 560962.5, 560937.5, 560937.5, 560937.5,
       560912.5, 560912.5, 560887.5, 560887.5, 560887.5, 560862.5, 560862.5,
       560837.5, 560837.5, 560837.5, 560812.5, 560812.5, 560812.5, 560787.5,
       560787.5, 560762.5, 560762.5, 560762.5, 560737.5, 560737.5, 560712.5,
       560712.5, 560712.5, 560687.5, 560687.5, 560687.5, 560662.5, 560662.5,
       560637.5, 560637.5, 560637.5, 560612.5, 560612.5, 560587.5, 560587.5,
       560587.5, 560562.5, 560562.5, 560562.5, 560537.5, 560537.5, 560512.5,
       560512.5, 560512.5, 560487.5, 560487.5, 560462.5, 560462.5, 560462.5,
       560437.5, 560437.5, 560437.5, 560412.5, 560412.5, 560387.5, 560387.5,
       560387.5, 560362.5, 560362.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>(s)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>25.0 15.09 9.914 ... 15.09 25.0</div><input id='attrs-67887bc8-0b18-468f-9fca-4e80f4d93969' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-67887bc8-0b18-468f-9fca-4e80f4d93969' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-da02f6bd-40d6-4d42-b1bb-b582040a4e56' class='xr-var-data-in' type='checkbox'><label for='data-da02f6bd-40d6-4d42-b1bb-b582040a4e56' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([25.        , 15.0862069 ,  9.9137931 , 25.        ,  5.17241379,
       19.82758621, 20.25862069,  4.74137931, 25.        , 10.34482759,
       14.65517241, 25.        ,  0.43103448, 24.56896552, 15.51724138,
        9.48275862, 25.        ,  5.60344828, 19.39655172, 20.68965517,
        4.31034483, 25.        , 10.77586207, 14.22413793, 25.        ,
        0.86206897, 24.13793103, 15.94827586,  9.05172414, 25.        ,
        6.03448276, 18.96551724, 21.12068966,  3.87931034, 25.        ,
       11.20689655, 13.79310345, 25.        ,  1.29310345, 23.70689655,
       16.37931034,  8.62068966, 25.        ,  6.46551724, 18.53448276,
       21.55172414,  3.44827586, 25.        , 11.63793103, 13.36206897,
       25.        ,  1.72413793, 23.27586207, 16.81034483,  8.18965517,
       25.        ,  6.89655172, 18.10344828, 21.98275862,  3.01724138,
       25.        , 12.06896552, 12.93103448, 25.        ,  2.15517241,
       22.84482759, 17.24137931,  7.75862069, 25.        ,  7.32758621,
       17.67241379, 22.4137931 ,  2.5862069 , 25.        , 12.5       ,
       12.5       , 25.        ,  2.5862069 , 22.4137931 , 17.67241379,
        7.32758621, 25.        ,  7.75862069, 17.24137931, 22.84482759,
        2.15517241, 25.        , 12.93103448, 12.06896552, 25.        ,
        3.01724138, 21.98275862, 18.10344828,  6.89655172, 25.        ,
        8.18965517, 16.81034483, 23.27586207,  1.72413793, 25.        ,
       13.36206897, 11.63793103, 25.        ,  3.44827586, 21.55172414,
       18.53448276,  6.46551724, 25.        ,  8.62068966, 16.37931034,
       23.70689655,  1.29310345, 25.        , 13.79310345, 11.20689655,
       25.        ,  3.87931034, 21.12068966, 18.96551724,  6.03448276,
       25.        ,  9.05172414, 15.94827586, 24.13793103,  0.86206897,
       25.        , 14.22413793, 10.77586207, 25.        ,  4.31034483,
       20.68965517, 19.39655172,  5.60344828, 25.        ,  9.48275862,
       15.51724138, 24.56896552,  0.43103448, 25.        , 14.65517241,
       10.34482759, 25.        ,  4.74137931, 20.25862069, 19.82758621,
        5.17241379, 25.        ,  9.9137931 , 15.0862069 , 25.        ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>(s)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-15.59 -9.409 ... -9.409 -15.59</div><input id='attrs-ff0a6799-74f9-4235-8cfd-8c8170a3d846' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ff0a6799-74f9-4235-8cfd-8c8170a3d846' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-70a39168-2b51-46e1-9505-3c62037b16bc' class='xr-var-data-in' type='checkbox'><label for='data-70a39168-2b51-46e1-9505-3c62037b16bc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-15.59139785,  -9.40860215,  -6.1827957 , -15.59139785,
        -3.22580645, -12.3655914 , -12.6344086 ,  -2.95698925,
       -15.59139785,  -6.4516129 ,  -9.13978495, -15.59139785,
        -0.2688172 , -15.32258065,  -9.67741935,  -5.91397849,
       -15.59139785,  -3.49462366, -12.09677419, -12.90322581,
        -2.68817204, -15.59139785,  -6.72043011,  -8.87096774,
       -15.59139785,  -0.53763441, -15.05376344,  -9.94623656,
        -5.64516129, -15.59139785,  -3.76344086, -11.82795699,
       -13.17204301,  -2.41935484, -15.59139785,  -6.98924731,
        -8.60215054, -15.59139785,  -0.80645161, -14.78494624,
       -10.21505376,  -5.37634409, -15.59139785,  -4.03225806,
       -11.55913978, -13.44086022,  -2.15053763, -15.59139785,
        -7.25806452,  -8.33333333, -15.59139785,  -1.07526882,
       -14.51612903, -10.48387097,  -5.10752688, -15.59139785,
        -4.30107527, -11.29032258, -13.70967742,  -1.88172043,
       -15.59139785,  -7.52688172,  -8.06451613, -15.59139785,
        -1.34408602, -14.24731183, -10.75268817,  -4.83870968,
       -15.59139785,  -4.56989247, -11.02150538, -13.97849462,
        -1.61290323, -15.59139785,  -7.79569892,  -7.79569892,
       -15.59139785,  -1.61290323, -13.97849462, -11.02150538,
        -4.56989247, -15.59139785,  -4.83870968, -10.75268817,
       -14.24731183,  -1.34408602, -15.59139785,  -8.06451613,
        -7.52688172, -15.59139785,  -1.88172043, -13.70967742,
       -11.29032258,  -4.30107527, -15.59139785,  -5.10752688,
       -10.48387097, -14.51612903,  -1.07526882, -15.59139785,
        -8.33333333,  -7.25806452, -15.59139785,  -2.15053763,
       -13.44086022, -11.55913978,  -4.03225806, -15.59139785,
        -5.37634409, -10.21505376, -14.78494624,  -0.80645161,
       -15.59139785,  -8.60215054,  -6.98924731, -15.59139785,
        -2.41935484, -13.17204301, -11.82795699,  -3.76344086,
       -15.59139785,  -5.64516129,  -9.94623656, -15.05376344,
        -0.53763441, -15.59139785,  -8.87096774,  -6.72043011,
       -15.59139785,  -2.68817204, -12.90322581, -12.09677419,
        -3.49462366, -15.59139785,  -5.91397849,  -9.67741935,
       -15.32258065,  -0.2688172 , -15.59139785,  -9.13978495,
        -6.4516129 , -15.59139785,  -2.95698925, -12.6344086 ,
       -12.3655914 ,  -3.22580645, -15.59139785,  -6.1827957 ,
        -9.40860215, -15.59139785])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 ... 15 16 17 18 19 20</div><input id='attrs-787734d8-2620-4ba2-ac23-fd880ab787bc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-787734d8-2620-4ba2-ac23-fd880ab787bc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f24cd7ac-4d91-4252-930e-9b48ed62b14c' class='xr-var-data-in' type='checkbox'><label for='data-f24cd7ac-4d91-4252-930e-9b48ed62b14c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
       19, 20])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>top</span></div><div class='xr-var-dims'>(layer, s)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.76 5.76 5.76 ... 2.875 2.875</div><input id='attrs-8d327bb9-f4f4-417d-b4a3-e9cd7304b3ba' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8d327bb9-f4f4-417d-b4a3-e9cd7304b3ba' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7e7941e9-59d8-4424-9f62-81b7422ffad7' class='xr-var-data-in' type='checkbox'><label for='data-7e7941e9-59d8-4424-9f62-81b7422ffad7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[5.76000023, 5.76000023, 5.76000023, ..., 8.83600044, 8.83600044,
        8.83600044],
       [5.76000023, 5.76000023, 5.76000023, ..., 8.83600044, 8.83600044,
        8.83600044],
       [5.76000023, 5.76000023, 5.76000023, ..., 8.83600044, 8.83600044,
        8.83600044],
       ...,
       [4.5450002 , 4.5450002 , 4.5450002 , ..., 5.2677002 , 5.2677002 ,
        5.2677002 ],
       [3.33000016, 3.33000016, 3.33000016, ..., 4.07140017, 4.07140017,
        4.07140017],
       [2.11500013, 2.11500013, 2.11500013, ..., 2.87510014, 2.87510014,
        2.87510014]], shape=(20, 150))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>bottom</span></div><div class='xr-var-dims'>(layer, s)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.76 5.76 5.76 ... 1.679 1.679</div><input id='attrs-50e3bed2-61e4-4736-88ca-0cf83df4d3af' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-50e3bed2-61e4-4736-88ca-0cf83df4d3af' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b4a8bdd8-f05e-42ee-b9ff-8511e4e26147' class='xr-var-data-in' type='checkbox'><label for='data-b4a8bdd8-f05e-42ee-b9ff-8511e4e26147' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[5.76000023, 5.76000023, 5.76000023, ..., 8.83600044, 8.83600044,
        8.83600044],
       [5.76000023, 5.76000023, 5.76000023, ..., 8.83600044, 8.83600044,
        8.83600044],
       [5.76000023, 5.76000023, 5.76000023, ..., 8.83600044, 8.83600044,
        8.83600044],
       ...,
       [3.33000016, 3.33000016, 3.33000016, ..., 4.07140017, 4.07140017,
        4.07140017],
       [2.11500013, 2.11500013, 2.11500013, ..., 2.87510014, 2.87510014,
        2.87510014],
       [0.9000001 , 0.9000001 , 0.9000001 , ..., 1.67880011, 1.67880011,
        1.67880011]], shape=(20, 150))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>s</span></div><div class='xr-var-dims'>(s)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>14.73 38.35 ... 2.702e+03 2.725e+03</div><input id='attrs-7e618525-0e55-443a-8352-00725f7446b1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7e618525-0e55-443a-8352-00725f7446b1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f8bc8f93-0dea-4636-bf11-05db3879a5bb' class='xr-var-data-in' type='checkbox'><label for='data-f8bc8f93-0dea-4636-bf11-05db3879a5bb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  14.731698,   38.353213,   53.084911,   73.658489,   91.438125,
        106.169822,  129.791338,  144.523036,  162.048676,  182.876249,
        197.607947,  220.975468,  235.96116 ,  250.692858,  274.314374,
        289.046072,  309.365655,  327.399285,  342.130983,  365.752498,
        380.484196,  397.755842,  418.83741 ,  433.569108,  456.682634,
        471.922321,  486.654019,  510.275534,  525.007232,  545.072821,
        563.360446,  578.092143,  601.713659,  616.445357,  633.463008,
        654.79857 ,  669.530268,  692.389799,  707.883481,  722.615179,
        746.236695,  760.968393,  780.779986,  799.321606,  814.053304,
        837.674819,  852.406517,  869.170174,  890.759731,  905.491429,
        928.096965,  943.844642,  958.57634 ,  982.197855,  996.929553,
       1016.487152, 1035.282767, 1050.014464, 1073.63598 , 1088.367678,
       1104.877339, 1126.720891, 1141.452589, 1163.804131, 1179.805802,
       1194.5375  , 1218.159016, 1232.890714, 1252.194318, 1271.243927,
       1285.975625, 1309.59714 , 1324.328838, 1340.584505, 1362.682052,
       1377.41375 , 1399.511296, 1415.766963, 1430.498661, 1454.120176,
       1468.851874, 1487.901483, 1507.205088, 1521.936785, 1545.558301,
       1560.289999, 1576.291671, 1598.643212, 1613.37491 , 1635.218462,
       1651.728123, 1666.459821, 1690.081337, 1704.813035, 1723.608649,
       1743.166248, 1757.897946, 1781.519461, 1796.251159, 1811.998836,
       1834.604373, 1849.336071, 1870.925628, 1887.689284, 1902.420982,
       1926.042497, 1940.774195, 1959.315815, 1979.127409, 1993.859106,
       2017.480622, 2032.21232 , 2047.706002, 2070.565533, 2085.297231,
       2106.632793, 2123.650444, 2138.382142, 2162.003658, 2176.735356,
       2195.022981, 2215.088569, 2229.820267, 2253.441782, 2268.17348 ,
       2283.413168, 2306.526694, 2321.258392, 2342.339959, 2359.611605,
       2374.343303, 2397.964818, 2412.696516, 2430.730146, 2451.04973 ,
       2465.781427, 2489.402943, 2504.134641, 2519.120333, 2542.487854,
       2557.219552, 2578.047125, 2595.572765, 2610.304463, 2633.925979,
       2648.657677, 2666.437312, 2687.01089 , 2701.742588, 2725.364103])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ds</span></div><div class='xr-var-dims'>(s)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>29.46 17.78 11.68 ... 17.78 29.46</div><input id='attrs-7dfeb671-d1b8-4193-bfb7-e8d74e7a51f5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7dfeb671-d1b8-4193-bfb7-e8d74e7a51f5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eb89d634-c7fa-46e7-9b4b-1c29731d64f2' class='xr-var-data-in' type='checkbox'><label for='data-eb89d634-c7fa-46e7-9b4b-1c29731d64f2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([29.46339571, 17.77963534, 11.68376037, 29.46339571,  6.09587498,
       23.36752074, 23.87551032,  5.58788539, 29.46339571, 12.19174995,
       17.27164576, 29.46339571,  0.50798958, 28.95540613, 18.28762492,
       11.17577079, 29.46339571,  6.60386456, 22.85953116, 24.3834999 ,
        5.07989581, 29.46339571, 12.69973953, 16.76365618, 29.46339571,
        1.01597916, 28.44741655, 18.79561451, 10.66778121, 29.46339571,
        7.11185414, 22.35154157, 24.89148948,  4.57190623, 29.46339571,
       13.20772911, 16.2556666 , 29.46339571,  1.52396874, 27.93942697,
       19.30360409, 10.15979162, 29.46339571,  7.61984372, 21.84355199,
       25.39947906,  4.06391665, 29.46339571, 13.71571869, 15.74767702,
       29.46339571,  2.03195833, 27.43143739, 19.81159367,  9.65180204,
       29.46339571,  8.1278333 , 21.33556241, 25.90746864,  3.55592707,
       29.46339571, 14.22370827, 15.23968744, 29.46339571,  2.53994791,
       26.92344781, 20.31958325,  9.14381246, 29.46339571,  8.63582288,
       20.82757283, 26.41545822,  3.04793749, 29.46339571, 14.73169786,
       14.73169786, 29.46339571,  3.04793749, 26.41545822, 20.82757283,
        8.63582288, 29.46339571,  9.14381246, 20.31958325, 26.92344781,
        2.53994791, 29.46339571, 15.23968744, 14.22370827, 29.46339571,
        3.55592707, 25.90746864, 21.33556241,  8.1278333 , 29.46339571,
        9.65180204, 19.81159367, 27.43143739,  2.03195832, 29.46339571,
       15.74767702, 13.71571869, 29.46339571,  4.06391665, 25.39947906,
       21.84355199,  7.61984372, 29.46339571, 10.15979162, 19.30360409,
       27.93942697,  1.52396874, 29.46339571, 16.2556666 , 13.20772911,
       29.46339571,  4.57190623, 24.89148948, 22.35154157,  7.11185414,
       29.46339571, 10.66778121, 18.79561451, 28.44741655,  1.01597916,
       29.46339571, 16.76365618, 12.69973953, 29.46339571,  5.07989581,
       24.3834999 , 22.85953116,  6.60386456, 29.46339571, 11.17577079,
       18.28762492, 28.95540613,  0.50798958, 29.46339571, 17.27164576,
       12.19174995, 29.46339571,  5.58788539, 23.87551032, 23.36752074,
        6.09587497, 29.46339571, 11.68376037, 17.77963534, 29.46339571])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b7b04a91-7706-42f5-ab35-288d99de585c' class='xr-section-summary-in' type='checkbox'  ><label for='section-b7b04a91-7706-42f5-ab35-288d99de585c' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>layer</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-4ae90f90-ddf8-48fc-bba3-9487ed056e68' class='xr-index-data-in' type='checkbox'/><label for='index-4ae90f90-ddf8-48fc-bba3-9487ed056e68' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20], dtype=&#x27;int64&#x27;, name=&#x27;layer&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>s</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-5d093159-1c10-4932-bef4-488be6dd8f39' class='xr-index-data-in' type='checkbox'/><label for='index-5d093159-1c10-4932-bef4-488be6dd8f39' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([14.731697856155446,  38.35321338409926, 53.084911240260034,
        73.65848928078788,  91.43812462444505, 106.16982248058866,
       129.79133800852065, 144.52303586468673, 162.04867641771818,
        182.8762492488771,
       ...
       2557.2195519960724, 2578.0471248271865, 2595.5727653802364,
       2610.3044632363935, 2633.9259787643396, 2648.6576766205017,
        2666.437311964137, 2687.0108900045784, 2701.7425878607337,
        2725.364103388758],
      dtype=&#x27;float64&#x27;, name=&#x27;s&#x27;, length=150))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0d43aaf3-a5f2-406c-a48d-5d2d16948a58' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-0d43aaf3-a5f2-406c-a48d-5d2d16948a58' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
<br />
<br /><p>Now that we have selected our data we can plot it.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">imod</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">cross_section</span><span class="p">(</span><span class="n">xsection_allocated</span><span class="p">,</span> <span class="s2">&quot;viridis&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_09-topsystem_004.png" srcset="../_images/sphx_glr_09-topsystem_004.png" alt="09 topsystem" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 640x480 with 2 Axes&gt;, &lt;Axes: &gt;)
</pre></div>
</div>
<p>Let’s plot the locations of our river stages and bottom elevations.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">stage_line</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">cross_section_linestring</span><span class="p">(</span><span class="n">planar_river</span><span class="p">[</span><span class="s2">&quot;stage&quot;</span><span class="p">],</span> <span class="n">geometry</span><span class="p">)</span>
<span class="n">stage_bottom</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">cross_section_linestring</span><span class="p">(</span><span class="n">planar_river</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">],</span> <span class="n">geometry</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">imod</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">cross_section</span><span class="p">(</span><span class="n">xsection_allocated</span><span class="p">,</span> <span class="s2">&quot;viridis&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">x_line</span> <span class="o">=</span> <span class="n">stage_line</span><span class="p">[</span><span class="s2">&quot;s&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">stage_line</span><span class="p">[</span><span class="s2">&quot;ds&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_line</span><span class="p">,</span> <span class="n">stage_line</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_line</span><span class="p">,</span> <span class="n">stage_bottom</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_09-topsystem_005.png" srcset="../_images/sphx_glr_09-topsystem_005.png" alt="09 topsystem" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection object at 0x0000016F37D04980&gt;
</pre></div>
</div>
<p>The above plot might look a bit off. Let’s plot the layer numbers, so that we
can identify where model layers are located.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>

<span class="n">layer_grid</span> <span class="o">=</span> <span class="n">layer_model</span><span class="o">.</span><span class="n">layer</span> <span class="o">*</span> <span class="n">xr</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">])</span>
<span class="n">layer_grid</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span>
<span class="n">layer_grid</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span>
<span class="n">xsection_layer_nr</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">cross_section_linestring</span><span class="p">(</span><span class="n">layer_grid</span><span class="p">,</span> <span class="n">geometry</span><span class="p">)</span>

<span class="n">imod</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">cross_section</span><span class="p">(</span><span class="n">xsection_layer_nr</span><span class="p">,</span> <span class="s2">&quot;tab20&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_line</span><span class="p">,</span> <span class="n">stage_line</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_line</span><span class="p">,</span> <span class="n">stage_bottom</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_09-topsystem_006.png" srcset="../_images/sphx_glr_09-topsystem_006.png" alt="09 topsystem" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection object at 0x0000016F40112450&gt;
</pre></div>
</div>
</section>
<section id="overview-allocation-options">
<h2>Overview allocation options<a class="headerlink" href="#overview-allocation-options" title="Link to this heading">#</a></h2>
<p>There are multiple options available to allocate rivers. For a full
description of all options, see the documentation of
<a class="reference internal" href="../api/generated/prepare/imod.prepare.ALLOCATION_OPTION.html#imod.prepare.ALLOCATION_OPTION" title="imod.prepare.ALLOCATION_OPTION"><code class="xref py py-func docutils literal notranslate"><span class="pre">imod.prepare.ALLOCATION_OPTION()</span></code></a>. We can print all possible options as
follows:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">ALLOCATION_OPTION</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>stage_to_riv_bot
first_active_to_elevation
stage_to_riv_bot_drn_above
at_elevation
at_first_active
</pre></div>
</div>
<p>Let’s make plots for each option to visualize the effect of each choice.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create grid for plots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>

<span class="c1"># The top left plot shows the elevation of the river bottom (upward triangle)</span>
<span class="c1"># and river stage (downward triangle).</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">imod</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">cross_section</span><span class="p">(</span>
    <span class="n">xsection_layer_nr</span><span class="p">,</span>
    <span class="s2">&quot;tab20&quot;</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">21</span><span class="p">),</span>
    <span class="n">kwargs_colorbar</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;plot_colorbar&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
    <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_line</span><span class="p">,</span> <span class="n">stage_line</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_line</span><span class="p">,</span> <span class="n">stage_bottom</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;stage and bottom elevation&quot;</span><span class="p">)</span>

<span class="c1"># Loop over allocation options, and plot the allocated cells as a polygon,</span>
<span class="c1"># using the &quot;aquitard&quot; feature of the cross_section plot.</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">option</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ALLOCATION_OPTION</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">riv_allocated</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">allocate_riv_cells</span><span class="p">(</span>
        <span class="n">allocation_option</span><span class="o">=</span><span class="n">option</span><span class="p">,</span>
        <span class="n">active</span><span class="o">=</span><span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;idomain&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">top</span><span class="o">=</span><span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">],</span>
        <span class="n">bottom</span><span class="o">=</span><span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">],</span>
        <span class="n">stage</span><span class="o">=</span><span class="n">planar_river</span><span class="p">[</span><span class="s2">&quot;stage&quot;</span><span class="p">],</span>
        <span class="n">bottom_elevation</span><span class="o">=</span><span class="n">planar_river</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">riv_allocated</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span>
    <span class="n">riv_allocated</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span>

    <span class="n">xsection_allocated</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">cross_section_linestring</span><span class="p">(</span><span class="n">riv_allocated</span><span class="p">,</span> <span class="n">geometry</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">kwargs_colorbar</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;plot_colorbar&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">kwargs_colorbar</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;plot_colorbar&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
    <span class="n">kwargs_aquitards</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;edgecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="s2">&quot;facecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;grey&quot;</span><span class="p">}</span>
    <span class="n">imod</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">cross_section</span><span class="p">(</span>
        <span class="n">xsection_layer_nr</span><span class="p">,</span>
        <span class="s2">&quot;tab20&quot;</span><span class="p">,</span>
        <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">21</span><span class="p">),</span>
        <span class="n">aquitards</span><span class="o">=</span><span class="n">xsection_allocated</span><span class="p">,</span>
        <span class="n">kwargs_aquitards</span><span class="o">=</span><span class="n">kwargs_aquitards</span><span class="p">,</span>
        <span class="n">kwargs_colorbar</span><span class="o">=</span><span class="n">kwargs_colorbar</span><span class="p">,</span>
        <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;option: </span><span class="si">{</span><span class="n">option</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Enforce tight layout to remove whitespace inbetween plots.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_09-topsystem_007.png" srcset="../_images/sphx_glr_09-topsystem_007.png" alt="stage and bottom elevation, option: stage_to_riv_bot, option: first_active_to_elevation, option: stage_to_riv_bot_drn_above, option: at_elevation, option: at_first_active" class = "sphx-glr-single-img"/><p>You can see the chosen option matters quite a lot. <code class="docutils literal notranslate"><span class="pre">at_elevation</span></code> allocates
cells in the model layer containing the river bottom elevation.
<code class="docutils literal notranslate"><span class="pre">at_first_active</span></code> allocates only at the first active model layer.
<code class="docutils literal notranslate"><span class="pre">first_active_to_elevation</span></code> allocates cells from first active model layer to
the model layer containing the river bottom elevation. <code class="docutils literal notranslate"><span class="pre">stage_to_riv_bot</span></code>
allocates cells from the model layer containing river stage up until the model
layer containing bottom elevation. Finally <code class="docutils literal notranslate"><span class="pre">stage_to_riv_bot_drn_above</span></code>
allocates <em>river</em> cells from the model layer containing river stage to the
model layer containing the river bottom elevation and allocates <em>drain</em> cells
from the first active model layer to the model layer containing the river
stage elevation. The allocated <em>drain</em> cells are not shown in the plot.</p>
</section>
<section id="distribute-conductance">
<h2>Distribute conductance<a class="headerlink" href="#distribute-conductance" title="Link to this heading">#</a></h2>
<p>Next, we’ll take a look at distributing conductances, as there are multiple
ways to distribute conductances over layers. For example, it is possible to
distribute conductances equally across layers, weighted by layer thickness, or
by transmissivity.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">imod.prepare</span><span class="w"> </span><span class="kn">import</span> <span class="n">DISTRIBUTING_OPTION</span><span class="p">,</span> <span class="n">distribute_riv_conductance</span>
</pre></div>
</div>
<p>Here’s a map of how the conductances are distributed in our dataset.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">imod</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span>
    <span class="n">planar_river</span><span class="p">[</span><span class="s2">&quot;conductance&quot;</span><span class="p">],</span> <span class="s2">&quot;magma&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">overlays</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_09-topsystem_008.png" srcset="../_images/sphx_glr_09-topsystem_008.png" alt="09 topsystem" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 640x480 with 2 Axes&gt;, &lt;Axes: &gt;)
</pre></div>
</div>
<p>First compute the allocated river cells for stage to river bottom elevation
again. This time we’ll use the <code class="docutils literal notranslate"><span class="pre">stage_to_riv_bot</span></code> option.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">riv_allocated</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">allocate_riv_cells</span><span class="p">(</span>
    <span class="n">allocation_option</span><span class="o">=</span><span class="n">ALLOCATION_OPTION</span><span class="o">.</span><span class="n">stage_to_riv_bot</span><span class="p">,</span>
    <span class="n">active</span><span class="o">=</span><span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;idomain&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">top</span><span class="o">=</span><span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">],</span>
    <span class="n">bottom</span><span class="o">=</span><span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">],</span>
    <span class="n">stage</span><span class="o">=</span><span class="n">planar_river</span><span class="p">[</span><span class="s2">&quot;stage&quot;</span><span class="p">],</span>
    <span class="n">bottom_elevation</span><span class="o">=</span><span class="n">planar_river</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">riv_allocated</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (layer: 20, y: 200, x: 500)&gt; Size: 2MB
array([[[False, False, False, ...,  True,  True,  True],
        [False, False, False, ..., False,  True,  True],
        [False, False, False, ..., False,  True,  True],
        ...,
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False]],

       [[False, False, False, ...,  True,  True,  True],
        [False, False, False, ..., False,  True,  True],
        [False, False, False, ..., False,  True,  True],
        ...,
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False]],

       [[False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False,  True],
        ...,
...
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False]],

       [[False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False],
        ...,
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False]],

       [[False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False],
        ...,
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False]]],
      shape=(20, 200, 500))
Coordinates:
  * x        (x) float64 4kB 2.375e+05 2.375e+05 2.376e+05 ... 2.5e+05 2.5e+05
  * y        (y) float64 2kB 5.64e+05 5.64e+05 5.639e+05 ... 5.59e+05 5.59e+05
    dx       float64 8B 25.0
    dy       float64 8B -25.0
  * layer    (layer) int64 160B 1 2 3 4 5 6 7 8 9 ... 12 13 14 15 16 17 18 19 20</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>layer</span>: 20</li><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>x</span>: 500</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-6e2e5392-75b1-44b0-8b16-d694c33c3c94' class='xr-array-in' type='checkbox' checked><label for='section-6e2e5392-75b1-44b0-8b16-d694c33c3c94' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>False False False False False False ... False False False False False</span></div><div class='xr-array-data'><pre>array([[[False, False, False, ...,  True,  True,  True],
        [False, False, False, ..., False,  True,  True],
        [False, False, False, ..., False,  True,  True],
        ...,
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False]],

       [[False, False, False, ...,  True,  True,  True],
        [False, False, False, ..., False,  True,  True],
        [False, False, False, ..., False,  True,  True],
        ...,
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False]],

       [[False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False,  True],
        ...,
...
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False]],

       [[False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False],
        ...,
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False]],

       [[False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False],
        ...,
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False, False]]],
      shape=(20, 200, 500))</pre></div></div></li><li class='xr-section-item'><input id='section-88df2b8a-3bcd-4fad-a045-fd625c4d7b80' class='xr-section-summary-in' type='checkbox'  checked><label for='section-88df2b8a-3bcd-4fad-a045-fd625c4d7b80' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-c474167e-e329-4623-b359-496abdb8ebb7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c474167e-e329-4623-b359-496abdb8ebb7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f943cc16-7bc7-4dc3-8c81-9bd9c76ecd24' class='xr-var-data-in' type='checkbox'><label for='data-f943cc16-7bc7-4dc3-8c81-9bd9c76ecd24' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5],
      shape=(500,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-1a40e637-8d61-4af3-946f-196cd10b002a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1a40e637-8d61-4af3-946f-196cd10b002a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b285a0ea-a4af-4ea6-b5ff-9e9756c1aaf2' class='xr-var-data-in' type='checkbox'><label for='data-b285a0ea-a4af-4ea6-b5ff-9e9756c1aaf2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
       563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
       563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
       563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
       563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
       563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
       562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
       562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
       562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
       562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
       562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
       562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
       561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
       561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
       561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
       561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
       561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
       561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
       560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
       560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
       560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
       560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
       560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
       559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
       559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
       559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
       559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
       559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
       559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>25.0</div><input id='attrs-776c769e-2906-4123-a74e-8cb343c09d27' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-776c769e-2906-4123-a74e-8cb343c09d27' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0ba056c7-ef32-4654-9e25-39c68f8f8438' class='xr-var-data-in' type='checkbox'><label for='data-0ba056c7-ef32-4654-9e25-39c68f8f8438' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-25.0</div><input id='attrs-17e8f37b-14bb-42e4-b6fd-01ceb4718a7d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-17e8f37b-14bb-42e4-b6fd-01ceb4718a7d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ae9e39cb-7e9a-4077-911e-b096396dd334' class='xr-var-data-in' type='checkbox'><label for='data-ae9e39cb-7e9a-4077-911e-b096396dd334' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 ... 15 16 17 18 19 20</div><input id='attrs-68b68885-af52-4ff0-bece-70b4287ba9c8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-68b68885-af52-4ff0-bece-70b4287ba9c8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7043d121-f8e0-45b6-98c9-d66aae00eb6e' class='xr-var-data-in' type='checkbox'><label for='data-7043d121-f8e0-45b6-98c9-d66aae00eb6e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
       19, 20])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9bbba692-5b44-464c-8818-eed72cddaaab' class='xr-section-summary-in' type='checkbox'  ><label for='section-9bbba692-5b44-464c-8818-eed72cddaaab' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-ba43e93b-6a04-461f-81cd-46003897b8f2' class='xr-index-data-in' type='checkbox'/><label for='index-ba43e93b-6a04-461f-81cd-46003897b8f2' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([237512.5, 237537.5, 237562.5, 237587.5, 237612.5, 237637.5, 237662.5,
       237687.5, 237712.5, 237737.5,
       ...
       249762.5, 249787.5, 249812.5, 249837.5, 249862.5, 249887.5, 249912.5,
       249937.5, 249962.5, 249987.5],
      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=500))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-bc170d53-b279-4596-8252-cc018295fbdb' class='xr-index-data-in' type='checkbox'/><label for='index-bc170d53-b279-4596-8252-cc018295fbdb' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
       563812.5, 563787.5, 563762.5,
       ...
       559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5, 559087.5,
       559062.5, 559037.5, 559012.5],
      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=200))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>layer</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-3b2c7e90-6284-4992-8ea1-c60e58dc765c' class='xr-index-data-in' type='checkbox'/><label for='index-3b2c7e90-6284-4992-8ea1-c60e58dc765c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20], dtype=&#x27;int64&#x27;, name=&#x27;layer&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8e4eacd8-6527-4dac-94b0-2a78904e493e' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-8e4eacd8-6527-4dac-94b0-2a78904e493e' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
<br />
<br /><p>Distribute river conductance over model layers. There are multiple options
available, which are fully described in
<a class="reference internal" href="../api/generated/prepare/imod.prepare.DISTRIBUTING_OPTION.html#imod.prepare.DISTRIBUTING_OPTION" title="imod.prepare.DISTRIBUTING_OPTION"><code class="xref py py-func docutils literal notranslate"><span class="pre">imod.prepare.DISTRIBUTING_OPTION()</span></code></a>. We can print all possible options as
follows:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">DISTRIBUTING_OPTION</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>by_corrected_transmissivity
by_corrected_thickness
equally
by_crosscut_thickness
by_layer_thickness
by_crosscut_transmissivity
by_conductivity
by_layer_transmissivity
</pre></div>
</div>
<p>To reduce duplicate code, we are going to store all input data in this
dictionary which we can provide further as keyword arguments.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">distributing_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;allocated&quot;</span><span class="p">:</span> <span class="n">riv_allocated</span><span class="p">,</span>
    <span class="s2">&quot;conductance&quot;</span><span class="p">:</span> <span class="n">planar_river</span><span class="p">[</span><span class="s2">&quot;conductance&quot;</span><span class="p">],</span>
    <span class="s2">&quot;top&quot;</span><span class="p">:</span> <span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">],</span>
    <span class="s2">&quot;bottom&quot;</span><span class="p">:</span> <span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">],</span>
    <span class="s2">&quot;k&quot;</span><span class="p">:</span> <span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">],</span>
    <span class="s2">&quot;stage&quot;</span><span class="p">:</span> <span class="n">planar_river</span><span class="p">[</span><span class="s2">&quot;stage&quot;</span><span class="p">],</span>
    <span class="s2">&quot;bottom_elevation&quot;</span><span class="p">:</span> <span class="n">planar_river</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Let’s keep things simple first and distribute conductances across layers
equally.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">riv_conductance</span> <span class="o">=</span> <span class="n">distribute_riv_conductance</span><span class="p">(</span>
    <span class="n">distributing_option</span><span class="o">=</span><span class="n">DISTRIBUTING_OPTION</span><span class="o">.</span><span class="n">by_layer_thickness</span><span class="p">,</span> <span class="o">**</span><span class="n">distributing_data</span>
<span class="p">)</span>
<span class="n">riv_conductance</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span>
<span class="n">riv_conductance</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Lets repeat the earlier process to produce a nice cross-section plot.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select the conductance over the cross section again.</span>
<span class="n">xsection_distributed</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">cross_section_linestring</span><span class="p">(</span><span class="n">riv_conductance</span><span class="p">,</span> <span class="n">geometry</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># Plot grey background of active cells</span>
<span class="n">is_active</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">xsection_distributed</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">])</span>
<span class="n">imod</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">cross_section</span><span class="p">(</span>
    <span class="n">is_active</span><span class="p">,</span>
    <span class="s2">&quot;Greys&quot;</span><span class="p">,</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="n">kwargs_colorbar</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;plot_colorbar&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
    <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Plot conductances</span>
<span class="n">imod</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">cross_section</span><span class="p">(</span>
    <span class="n">xsection_distributed</span><span class="p">,</span> <span class="s2">&quot;magma&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_09-topsystem_009.png" srcset="../_images/sphx_glr_09-topsystem_009.png" alt="09 topsystem" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 640x480 with 2 Axes&gt;, &lt;Axes: &gt;)
</pre></div>
</div>
<p>Let’s compare the results of all possible options visually. On the top left
we’ll plot the hydraulic conductivity, as we haven’t looked at that yet. The
other plots show the effects of different settings. Again, distributing
options are described in more detail in <a class="reference internal" href="../api/generated/prepare/imod.prepare.DISTRIBUTING_OPTION.html#imod.prepare.DISTRIBUTING_OPTION" title="imod.prepare.DISTRIBUTING_OPTION"><code class="xref py py-func docutils literal notranslate"><span class="pre">imod.prepare.DISTRIBUTING_OPTION()</span></code></a></p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>

<span class="n">k</span> <span class="o">=</span> <span class="n">distributing_data</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">k</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span>
<span class="n">k</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span>

<span class="n">xsection_k</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">cross_section_linestring</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">geometry</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">imod</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">cross_section</span><span class="p">(</span>
    <span class="n">xsection_k</span><span class="p">,</span>
    <span class="s2">&quot;magma&quot;</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
    <span class="n">kwargs_colorbar</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;plot_colorbar&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
    <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_line</span><span class="p">,</span> <span class="n">stage_line</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_line</span><span class="p">,</span> <span class="n">stage_bottom</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;hydraulic conductivity&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">option</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">DISTRIBUTING_OPTION</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">riv_conductance</span> <span class="o">=</span> <span class="n">distribute_riv_conductance</span><span class="p">(</span>
        <span class="n">distributing_option</span><span class="o">=</span><span class="n">option</span><span class="p">,</span> <span class="o">**</span><span class="n">distributing_data</span>
    <span class="p">)</span>
    <span class="n">riv_conductance</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span>
    <span class="n">riv_conductance</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer_model</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span>

    <span class="n">xsection_distributed</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">cross_section_linestring</span><span class="p">(</span>
        <span class="n">riv_conductance</span><span class="p">,</span> <span class="n">geometry</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">kwargs_colorbar</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;plot_colorbar&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">kwargs_colorbar</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;plot_colorbar&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>

    <span class="c1"># Plot grey background of active cells</span>
    <span class="n">is_active</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">xsection_distributed</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">])</span>
    <span class="n">imod</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">cross_section</span><span class="p">(</span>
        <span class="n">is_active</span><span class="p">,</span>
        <span class="s2">&quot;Greys&quot;</span><span class="p">,</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="n">kwargs_colorbar</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;plot_colorbar&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
        <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># Plot conductances</span>
    <span class="n">imod</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">cross_section</span><span class="p">(</span>
        <span class="n">xsection_distributed</span><span class="p">,</span>
        <span class="s2">&quot;magma&quot;</span><span class="p">,</span>
        <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
        <span class="n">kwargs_colorbar</span><span class="o">=</span><span class="n">kwargs_colorbar</span><span class="p">,</span>
        <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;option: </span><span class="si">{</span><span class="n">option</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_09-topsystem_010.png" srcset="../_images/sphx_glr_09-topsystem_010.png" alt="hydraulic conductivity, option: by_corrected_transmissivity, option: by_corrected_thickness, option: equally, option: by_crosscut_thickness, option: by_layer_thickness, option: by_crosscut_transmissivity, option: by_conductivity, option: by_layer_transmissivity" class = "sphx-glr-single-img"/><p>You can see quite some wildly varying conductances with depth. First, the most
simple algorithm <code class="docutils literal notranslate"><span class="pre">equally</span></code> keeps conductance constant with depth. Second,
correcting <code class="docutils literal notranslate"><span class="pre">by_conductivity</span></code> (hydraulic) decreases the conductance in the
deepest layer where rivers occur in the centre of the plot, as conductivity is
lower over there. Correcting <code class="docutils literal notranslate"><span class="pre">by_layer_thickness</span></code>, however, increases
conductance in this deep layer, as this is a thicker layer. These differences
even out when we correct <code class="docutils literal notranslate"><span class="pre">by_layer_transmissivity</span></code> (k * thickness). The
<code class="docutils literal notranslate"><span class="pre">by_crosscut_thickness</span></code> algorithm accounts for how far the river bottom
penetrates a layer. You can see this reduces conductance in the deep layer
compared to distributing <code class="docutils literal notranslate"><span class="pre">by_layer_thickness</span></code>.
<code class="docutils literal notranslate"><span class="pre">by_crosscut_transmissivity</span></code> uses the crosscut thickness instead of the
layer thickness and therefore shows a lower conductance in the deeper layer
compared to <code class="docutils literal notranslate"><span class="pre">by_layer_transmissivity</span></code>. Finally
<code class="docutils literal notranslate"><span class="pre">by_corrected_transmissivity</span></code> and <code class="docutils literal notranslate"><span class="pre">by_corrected_thickness</span></code> also correct
for the displacement of the midpoint over the length where crosscut
transmissivity is computed over (<code class="docutils literal notranslate"><span class="pre">[layer</span> <span class="pre">top</span> <span class="pre">-</span> <span class="pre">river</span> <span class="pre">bottom]/2</span></code>) compared to
the model cell centre. This further reduces the conductance in the deeper
layer.</p>
</section>
<section id="modflow-6-package">
<h2>MODFLOW 6 package<a class="headerlink" href="#modflow-6-package" title="Link to this heading">#</a></h2>
<p>The data created can now be used to create a MODFLOW 6 package. To construct 3D
grids from planar grids for the stages, we can utilize xarrays broadcasting:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">imod.typing.grid</span><span class="w"> </span><span class="kn">import</span> <span class="n">enforce_dim_order</span>

<span class="n">riv_stage</span> <span class="o">=</span> <span class="n">planar_river</span><span class="p">[</span><span class="s2">&quot;stage&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">riv_allocated</span><span class="p">)</span>
<span class="c1"># Use this function to enforce the right dimension order for iMOD Python.</span>
<span class="n">riv_stage</span> <span class="o">=</span> <span class="n">enforce_dim_order</span><span class="p">(</span><span class="n">riv_stage</span><span class="p">)</span>

<span class="n">riv_stage</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;stage&#x27; (layer: 20, y: 200, x: 500)&gt; Size: 8MB
array([[[      nan,       nan,       nan, ..., 1.9508   , 1.9358001,
         1.9258001],
        [      nan,       nan,       nan, ...,       nan, 1.9258001,
         1.9258001],
        [      nan,       nan,       nan, ...,       nan, 1.7708   ,
         1.6558001],
        ...,
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan]],

       [[      nan,       nan,       nan, ..., 1.9508   , 1.9358001,
         1.9258001],
        [      nan,       nan,       nan, ...,       nan, 1.9258001,
         1.9258001],
        [      nan,       nan,       nan, ...,       nan, 1.7708   ,
         1.6558001],
...
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan]],

       [[      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        ...,
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan]]], shape=(20, 200, 500), dtype=float32)
Coordinates:
  * x        (x) float64 4kB 2.375e+05 2.375e+05 2.376e+05 ... 2.5e+05 2.5e+05
  * y        (y) float64 2kB 5.64e+05 5.64e+05 5.639e+05 ... 5.59e+05 5.59e+05
    dx       float64 8B 25.0
    dy       float64 8B -25.0
  * layer    (layer) int64 160B 1 2 3 4 5 6 7 8 9 ... 12 13 14 15 16 17 18 19 20</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'stage'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>layer</span>: 20</li><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>x</span>: 500</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-29f8c30a-44bd-49cb-b90f-36d2a3e9cfdc' class='xr-array-in' type='checkbox' checked><label for='section-29f8c30a-44bd-49cb-b90f-36d2a3e9cfdc' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>nan nan nan nan nan nan nan nan ... nan nan nan nan nan nan nan nan</span></div><div class='xr-array-data'><pre>array([[[      nan,       nan,       nan, ..., 1.9508   , 1.9358001,
         1.9258001],
        [      nan,       nan,       nan, ...,       nan, 1.9258001,
         1.9258001],
        [      nan,       nan,       nan, ...,       nan, 1.7708   ,
         1.6558001],
        ...,
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan]],

       [[      nan,       nan,       nan, ..., 1.9508   , 1.9358001,
         1.9258001],
        [      nan,       nan,       nan, ...,       nan, 1.9258001,
         1.9258001],
        [      nan,       nan,       nan, ...,       nan, 1.7708   ,
         1.6558001],
...
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan]],

       [[      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        ...,
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan]]], shape=(20, 200, 500), dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-14416825-8429-4e22-94be-68c12be5248c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-14416825-8429-4e22-94be-68c12be5248c' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-e690aab9-8627-40a8-b0a8-4642162dd01c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e690aab9-8627-40a8-b0a8-4642162dd01c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-553e31ed-55e1-449f-9028-823b01edca57' class='xr-var-data-in' type='checkbox'><label for='data-553e31ed-55e1-449f-9028-823b01edca57' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5],
      shape=(500,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-fbdc3bc6-cd0a-4498-9523-7c578840d598' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fbdc3bc6-cd0a-4498-9523-7c578840d598' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-19d1de28-dc1c-4c01-824f-f3bb79b803a0' class='xr-var-data-in' type='checkbox'><label for='data-19d1de28-dc1c-4c01-824f-f3bb79b803a0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
       563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
       563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
       563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
       563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
       563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
       562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
       562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
       562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
       562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
       562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
       562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
       561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
       561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
       561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
       561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
       561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
       561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
       560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
       560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
       560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
       560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
       560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
       559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
       559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
       559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
       559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
       559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
       559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>25.0</div><input id='attrs-37f58e81-dc93-4484-8340-be39d83d4dab' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-37f58e81-dc93-4484-8340-be39d83d4dab' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f00cc56d-158c-4b70-a0a8-909fdfe00d9d' class='xr-var-data-in' type='checkbox'><label for='data-f00cc56d-158c-4b70-a0a8-909fdfe00d9d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-25.0</div><input id='attrs-18ab52af-7a85-4a06-a337-47515593b965' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-18ab52af-7a85-4a06-a337-47515593b965' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-01069624-4ebe-41f5-a683-5c2aeade80b7' class='xr-var-data-in' type='checkbox'><label for='data-01069624-4ebe-41f5-a683-5c2aeade80b7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 ... 15 16 17 18 19 20</div><input id='attrs-6c14bd59-5df7-4dad-b29b-2888af0030eb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6c14bd59-5df7-4dad-b29b-2888af0030eb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e858c934-7f9c-4d51-a014-9595cec090b4' class='xr-var-data-in' type='checkbox'><label for='data-e858c934-7f9c-4d51-a014-9595cec090b4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
       19, 20])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a504105b-6eea-4463-821c-bf96afef4d41' class='xr-section-summary-in' type='checkbox'  ><label for='section-a504105b-6eea-4463-821c-bf96afef4d41' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-9fcc70ed-0b4c-4ac3-ad44-b491812fbac9' class='xr-index-data-in' type='checkbox'/><label for='index-9fcc70ed-0b4c-4ac3-ad44-b491812fbac9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([237512.5, 237537.5, 237562.5, 237587.5, 237612.5, 237637.5, 237662.5,
       237687.5, 237712.5, 237737.5,
       ...
       249762.5, 249787.5, 249812.5, 249837.5, 249862.5, 249887.5, 249912.5,
       249937.5, 249962.5, 249987.5],
      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=500))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-cf0eee9b-b8b8-4199-8fdd-a5389354daf1' class='xr-index-data-in' type='checkbox'/><label for='index-cf0eee9b-b8b8-4199-8fdd-a5389354daf1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
       563812.5, 563787.5, 563762.5,
       ...
       559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5, 559087.5,
       559062.5, 559037.5, 559012.5],
      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=200))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>layer</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-a244cf1f-dea0-4ebd-bfef-b51bb46b64af' class='xr-index-data-in' type='checkbox'/><label for='index-a244cf1f-dea0-4ebd-bfef-b51bb46b64af' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20], dtype=&#x27;int64&#x27;, name=&#x27;layer&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d84940d2-fdda-4400-8e43-9d3378e658ce' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d84940d2-fdda-4400-8e43-9d3378e658ce' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
<br />
<br /><p>We can do the same for the river bottom and construct a river package. Note
that we use the previously distributed conductance which we assigned to the
variable <code class="docutils literal notranslate"><span class="pre">riv_conducance</span></code>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">riv_bottom</span> <span class="o">=</span> <span class="n">planar_river</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">riv_allocated</span><span class="p">)</span>
<span class="n">riv_bottom</span> <span class="o">=</span> <span class="n">enforce_dim_order</span><span class="p">(</span><span class="n">riv_bottom</span><span class="p">)</span>

<span class="c1"># Remove coordinates that were added for cross-section plots previously</span>
<span class="n">riv_conductance</span> <span class="o">=</span> <span class="n">riv_conductance</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">([</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="s2">&quot;top&quot;</span><span class="p">])</span>

<span class="n">riv</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">River</span><span class="p">(</span>
    <span class="n">stage</span><span class="o">=</span><span class="n">riv_stage</span><span class="p">,</span> <span class="n">conductance</span><span class="o">=</span><span class="n">riv_conductance</span><span class="p">,</span> <span class="n">bottom_elevation</span><span class="o">=</span><span class="n">riv_bottom</span>
<span class="p">)</span>

<span class="n">riv</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>River</div><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 32MB
Dimensions:           (x: 500, y: 200, layer: 20)
Coordinates:
  * x                 (x) float64 4kB 2.375e+05 2.375e+05 ... 2.5e+05 2.5e+05
  * y                 (y) float64 2kB 5.64e+05 5.64e+05 ... 5.59e+05 5.59e+05
    dx                float64 8B 25.0
    dy                float64 8B -25.0
  * layer             (layer) int64 160B 1 2 3 4 5 6 7 ... 14 15 16 17 18 19 20
Data variables:
    stage             (layer, y, x) float32 8MB nan nan nan nan ... nan nan nan
    conductance       (layer, y, x) float64 16MB nan nan nan nan ... nan nan nan
    bottom_elevation  (layer, y, x) float32 8MB nan nan nan nan ... nan nan nan
    print_input       bool 1B False
    print_flows       bool 1B False
    save_flows        bool 1B False
    observations      object 8B None
    repeat_stress     object 8B None</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-ffd10556-fa76-4824-ae81-deecf8b86d54' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-ffd10556-fa76-4824-ae81-deecf8b86d54' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>x</span>: 500</li><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>layer</span>: 20</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-a38ad781-877f-45b7-9a26-d61a17c3f3ec' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a38ad781-877f-45b7-9a26-d61a17c3f3ec' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-2f1874d9-4e04-4c94-9cba-9b3a4070ade7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2f1874d9-4e04-4c94-9cba-9b3a4070ade7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e3ab6078-816c-407d-90b8-436b60c4f81e' class='xr-var-data-in' type='checkbox'><label for='data-e3ab6078-816c-407d-90b8-436b60c4f81e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5],
      shape=(500,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-0aa3c4f4-1391-4254-8153-d37d01bb9f28' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0aa3c4f4-1391-4254-8153-d37d01bb9f28' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d047dc9a-292a-404c-8da9-f00e16482ede' class='xr-var-data-in' type='checkbox'><label for='data-d047dc9a-292a-404c-8da9-f00e16482ede' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
       563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
       563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
       563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
       563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
       563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
       562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
       562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
       562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
       562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
       562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
       562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
       561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
       561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
       561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
       561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
       561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
       561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
       560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
       560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
       560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
       560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
       560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
       559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
       559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
       559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
       559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
       559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
       559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>25.0</div><input id='attrs-27a60c2d-db4e-4d13-b3a0-8e5ef6511daa' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-27a60c2d-db4e-4d13-b3a0-8e5ef6511daa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3c48d255-5747-4016-8929-2efd0257a609' class='xr-var-data-in' type='checkbox'><label for='data-3c48d255-5747-4016-8929-2efd0257a609' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-25.0</div><input id='attrs-e6761ab4-a84d-4f2d-998a-83bbd2755fe5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e6761ab4-a84d-4f2d-998a-83bbd2755fe5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9aa414a6-320a-4ad4-8ff2-715db9cff6b6' class='xr-var-data-in' type='checkbox'><label for='data-9aa414a6-320a-4ad4-8ff2-715db9cff6b6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 ... 15 16 17 18 19 20</div><input id='attrs-0865b5a0-ecd2-4eab-9014-bfaad69d4589' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0865b5a0-ecd2-4eab-9014-bfaad69d4589' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a29f5069-8b02-48d5-8bf2-a0b897dddcd1' class='xr-var-data-in' type='checkbox'><label for='data-a29f5069-8b02-48d5-8bf2-a0b897dddcd1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
       19, 20])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1b9fbe41-b4ab-4fe3-b470-764b8173c9f8' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1b9fbe41-b4ab-4fe3-b470-764b8173c9f8' class='xr-section-summary' >Data variables: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>stage</span></div><div class='xr-var-dims'>(layer, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-d8a2fc79-dd2f-472c-a557-18a023916384' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d8a2fc79-dd2f-472c-a557-18a023916384' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1c6f01a7-f07e-4f45-970d-192f2f2a2ff9' class='xr-var-data-in' type='checkbox'><label for='data-1c6f01a7-f07e-4f45-970d-192f2f2a2ff9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[      nan,       nan,       nan, ..., 1.9508   , 1.9358001,
         1.9258001],
        [      nan,       nan,       nan, ...,       nan, 1.9258001,
         1.9258001],
        [      nan,       nan,       nan, ...,       nan, 1.7708   ,
         1.6558001],
        ...,
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan]],

       [[      nan,       nan,       nan, ..., 1.9508   , 1.9358001,
         1.9258001],
        [      nan,       nan,       nan, ...,       nan, 1.9258001,
         1.9258001],
        [      nan,       nan,       nan, ...,       nan, 1.7708   ,
         1.6558001],
...
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan]],

       [[      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        ...,
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan]]], shape=(20, 200, 500), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>conductance</span></div><div class='xr-var-dims'>(layer, y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-16fed8da-2e5f-45af-bc99-f19ec3e28b08' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-16fed8da-2e5f-45af-bc99-f19ec3e28b08' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e3ee89db-f83c-4ced-920c-1ab185da9b93' class='xr-var-data-in' type='checkbox'><label for='data-e3ee89db-f83c-4ced-920c-1ab185da9b93' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[        nan,         nan,         nan, ..., 14.93000031,
          1.35500002, 14.93000031],
        [        nan,         nan,         nan, ...,         nan,
          2.25999999, 13.11999989],
        [        nan,         nan,         nan, ...,         nan,
          0.44999999,  3.89000003],
        ...,
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan]],

       [[        nan,         nan,         nan, ..., 14.93000031,
          1.35500002, 14.93000031],
        [        nan,         nan,         nan, ...,         nan,
          2.25999999, 13.11999989],
        [        nan,         nan,         nan, ...,         nan,
          0.44999999,  3.89000003],
...
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan]],

       [[        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        ...,
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan],
        [        nan,         nan,         nan, ...,         nan,
                 nan,         nan]]], shape=(20, 200, 500))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>bottom_elevation</span></div><div class='xr-var-dims'>(layer, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-f2991750-f331-4156-9de9-75d862ac34b4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f2991750-f331-4156-9de9-75d862ac34b4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-47d01efd-9090-420c-b505-547c4704aa33' class='xr-var-data-in' type='checkbox'><label for='data-47d01efd-9090-420c-b505-547c4704aa33' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[ nan,  nan,  nan, ..., 1.39, 1.36, 1.34],
        [ nan,  nan,  nan, ...,  nan, 1.34, 1.34],
        [ nan,  nan,  nan, ...,  nan, 1.03, 0.51],
        ...,
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan]],

       [[ nan,  nan,  nan, ..., 1.39, 1.36, 1.34],
        [ nan,  nan,  nan, ...,  nan, 1.34, 1.34],
        [ nan,  nan,  nan, ...,  nan, 1.03, 0.51],
        ...,
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan]],

       [[ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan, 0.51],
        ...,
...
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan]],

       [[ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        ...,
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan]],

       [[ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        ...,
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan]]],
      shape=(20, 200, 500), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>print_input</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-5beb7aef-c5b1-459f-8db6-d6b07a826353' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5beb7aef-c5b1-459f-8db6-d6b07a826353' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f8f447c4-5004-4c7e-914d-9038e2798a2e' class='xr-var-data-in' type='checkbox'><label for='data-f8f447c4-5004-4c7e-914d-9038e2798a2e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>print_flows</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-34df8994-34b3-41a0-b16d-75e3a2f7519f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-34df8994-34b3-41a0-b16d-75e3a2f7519f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-46c79b34-3629-45cf-9555-b1e52c2b1dfa' class='xr-var-data-in' type='checkbox'><label for='data-46c79b34-3629-45cf-9555-b1e52c2b1dfa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>save_flows</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-5b37b319-0d1f-4036-97de-5465f315e365' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5b37b319-0d1f-4036-97de-5465f315e365' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-86b314e2-5096-4aee-b860-c5fa5d6d87fc' class='xr-var-data-in' type='checkbox'><label for='data-86b314e2-5096-4aee-b860-c5fa5d6d87fc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>observations</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-516e6bef-e482-4847-8982-7bb8f62a1397' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-516e6bef-e482-4847-8982-7bb8f62a1397' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e7755384-0bf9-4e47-b775-c8335254a2cf' class='xr-var-data-in' type='checkbox'><label for='data-e7755384-0bf9-4e47-b775-c8335254a2cf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>repeat_stress</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-9d118f47-4416-4c79-b41a-c5d2669a6d9e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9d118f47-4416-4c79-b41a-c5d2669a6d9e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0e00ebb5-a404-44f9-9f36-d52fb0513acd' class='xr-var-data-in' type='checkbox'><label for='data-0e00ebb5-a404-44f9-9f36-d52fb0513acd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-99715248-6362-4dd4-96cc-401ee6dee961' class='xr-section-summary-in' type='checkbox'  ><label for='section-99715248-6362-4dd4-96cc-401ee6dee961' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-44776549-f662-4a1d-b050-f745a8de7e1e' class='xr-index-data-in' type='checkbox'/><label for='index-44776549-f662-4a1d-b050-f745a8de7e1e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([237512.5, 237537.5, 237562.5, 237587.5, 237612.5, 237637.5, 237662.5,
       237687.5, 237712.5, 237737.5,
       ...
       249762.5, 249787.5, 249812.5, 249837.5, 249862.5, 249887.5, 249912.5,
       249937.5, 249962.5, 249987.5],
      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=500))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-180eaa6c-2376-4bb0-b0fd-dab17f63d0d6' class='xr-index-data-in' type='checkbox'/><label for='index-180eaa6c-2376-4bb0-b0fd-dab17f63d0d6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
       563812.5, 563787.5, 563762.5,
       ...
       559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5, 559087.5,
       559062.5, 559037.5, 559012.5],
      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=200))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>layer</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-176a49f3-235f-4066-b328-38508000d6c7' class='xr-index-data-in' type='checkbox'/><label for='index-176a49f3-235f-4066-b328-38508000d6c7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20], dtype=&#x27;int64&#x27;, name=&#x27;layer&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9035699b-d53b-4b05-b7d2-6892cb6aeebe' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-9035699b-d53b-4b05-b7d2-6892cb6aeebe' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
<br />
<br /><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 10.566 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-user-guide-09-topsystem-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/9616d9ba8e4265a54ecb70e06f1c18da/09-topsystem.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">09-topsystem.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/25c8a204f3c7926a34bc6ca249292873/09-topsystem.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">09-topsystem.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../_downloads/77585dc9cee464441ed6bf3d73aba000/09-topsystem.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">09-topsystem.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="08-regridding.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Regridding</p>
      </div>
    </a>
    <a class="right-next"
       href="10-cleanup.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Data cleanup</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-data">Example data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#allocate-river-cells">Allocate river cells</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-allocation-options">Overview allocation options</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#distribute-conductance">Distribute conductance</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modflow-6-package">MODFLOW 6 package</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/user-guide/09-topsystem.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright Deltares.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>