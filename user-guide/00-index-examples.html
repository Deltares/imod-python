
<!DOCTYPE html>


<html lang="en" data-content_root="../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Quick start &#8212; iMOD Python 1.0.0rc6 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=bc4855a1"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user-guide/00-index-examples';</script>
    <script src="../_static/deltares.js?v=8d5578be"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Raster data and xarray" href="01-raster-data.html" />
    <link rel="prev" title="User Guide" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.0.0rc6.dev" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
    
    <img src="../_static/imod-python-logo-light.svg" class="logo__image only-light" alt="iMOD Python 1.0.0rc6 documentation - Home"/>
    <img src="../_static/imod-python-logo-dark.svg" class="logo__image only-dark pst-js-only" alt="iMOD Python 1.0.0rc6 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation.html">
    Installing
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../faq/index.html">
    FAQ
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../developing/index.html">
    Developing
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.deltares.nl/en/" title="Deltares" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-deltares fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Deltares</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Deltares/imod-python" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation.html">
    Installing
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../faq/index.html">
    FAQ
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../developing/index.html">
    Developing
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.deltares.nl/en/" title="Deltares" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-deltares fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Deltares</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Deltares/imod-python" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="01-raster-data.html">Raster data and xarray</a></li>
<li class="toctree-l1"><a class="reference internal" href="02-vector-data.html">Vector data and Geopandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="03-timeseries-data.html">Time series data and Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="05-unstructured-grids.html">Unstructured Grids</a></li>
<li class="toctree-l1"><a class="reference internal" href="06-lazy-evaluation.html">Lazy evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="07-time-discretization.html">Model time discretization</a></li>
<li class="toctree-l1"><a class="reference internal" href="08-regridding.html">Regridding</a></li>
<li class="toctree-l1"><a class="reference internal" href="09-topsystem.html">Topsystem: from 2D map to 3D model</a></li>
<li class="toctree-l1"><a class="reference internal" href="10-cleanup.html">Data cleanup</a></li>
<li class="toctree-l1"><a class="reference internal" href="11-imod5-files.html">Reading and writing iMOD5 files in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="12-imod5-model-to-modflow6.html">Working with iMOD5 models in MODFLOW 6</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">User Guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Quick start</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-user-guide-00-index-examples-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="quick-start">
<span id="sphx-glr-user-guide-00-index-examples-py"></span><h1>Quick start<a class="headerlink" href="#quick-start" title="Link to this heading">#</a></h1>
<p>These are the examples in the index page of the iMOD Python user guide. The
examples are used to demonstrate the features of iMOD Python and how to use
them. This file is meant to test if the index page is working correctly and to
provide a quick overview of the examples available in the user guide.</p>
<p>Let’s first create some raster data to work with.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xugrid</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xu</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">imod</span>

<span class="n">elevation_uda</span> <span class="o">=</span> <span class="n">xu</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">elevation_nl</span><span class="p">()</span>
<span class="c1"># Drop unnecessary coords. These coords are also stored in elevation_uda.ugrid.grid</span>
<span class="n">elevation_uda</span> <span class="o">=</span> <span class="n">elevation_uda</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">([</span><span class="s2">&quot;mesh2d_face_x&quot;</span><span class="p">,</span> <span class="s2">&quot;mesh2d_face_y&quot;</span><span class="p">])</span>

<span class="n">part</span> <span class="o">=</span> <span class="n">elevation_uda</span><span class="o">.</span><span class="n">ugrid</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mf">100_000.0</span><span class="p">,</span> <span class="mf">200_000.0</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mf">400_000.0</span><span class="p">,</span> <span class="mf">500_000.0</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Make structured grid</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">resolution</span> <span class="o">=</span> <span class="mf">500.0</span>
<span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">part</span><span class="o">.</span><span class="n">ugrid</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">bounds</span>
<span class="n">structured_grid</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">empty_2d</span><span class="p">(</span><span class="n">resolution</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">resolution</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>

<span class="c1"># Interpolate</span>
<span class="n">regridder</span> <span class="o">=</span> <span class="n">xu</span><span class="o">.</span><span class="n">BarycentricInterpolator</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">structured_grid</span><span class="p">)</span>
<span class="n">interpolated_elevation</span> <span class="o">=</span> <span class="n">regridder</span><span class="o">.</span><span class="n">regrid</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">interpolated_elevation</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_00-index-examples_001.png" srcset="../_images/sphx_glr_00-index-examples_001.png" alt="dy = -500.0, dx = 500.0" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage object at 0x00000251CA7C07A0&gt;
</pre></div>
</div>
<p>Save to GeoTIFF</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a temporary directory to store the data</span>
<span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">temporary_directory</span><span class="p">()</span>
<span class="n">tmp_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">interpolated_elevation</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">to_raster</span><span class="p">(</span><span class="n">tmp_dir</span> <span class="o">/</span> <span class="s2">&quot;elevation.tif&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Seamlessly integrate your GIS rasters or meshes with MODFLOW 6, by using <a class="reference external" href="http://xarray.pydata.org/">xarray</a>
and <a class="reference external" href="https://deltares.github.io/xugrid/">xugrid</a> arrays, for structured and unstructured grids respectively, to
create grid-based model packages.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Open Geotiff with elevation data as xarray DataArray</span>
<span class="n">elevation</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">tmp_dir</span> <span class="o">/</span> <span class="s2">&quot;elevation.tif&quot;</span><span class="p">)</span>
<span class="n">elevation</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

<span class="c1"># Create idomain grid</span>
<span class="n">layer_template</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;layer&quot;</span><span class="p">,),</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;layer&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="n">idomain</span> <span class="o">=</span> <span class="n">layer_template</span> <span class="o">*</span> <span class="n">xr</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">elevation</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="c1"># Deactivate cells with NoData</span>
<span class="n">idomain</span> <span class="o">=</span> <span class="n">idomain</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">elevation</span><span class="o">.</span><span class="n">notnull</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># Compute bottom elevations of model layers</span>
<span class="n">layer_thickness</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
    <span class="p">[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;layer&quot;</span><span class="p">,),</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;layer&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]}</span>
<span class="p">)</span>
<span class="n">bottom</span> <span class="o">=</span> <span class="n">elevation</span> <span class="o">-</span> <span class="n">layer_thickness</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;layer&quot;</span><span class="p">)</span>

<span class="c1"># Create MODFLOW 6 DIS package</span>
<span class="n">dis_pkg</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">StructuredDiscretization</span><span class="p">(</span>
    <span class="n">idomain</span><span class="o">=</span><span class="n">idomain</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">elevation</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">bottom</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="s2">&quot;layer&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Assign wells based on x, y coordinates and filter screen depths, instead of
layer, row and column:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Specify well locations</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">150_200.0</span><span class="p">,</span> <span class="mf">160_800.0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mf">450_300.0</span><span class="p">,</span> <span class="mf">460_200.0</span><span class="p">]</span>

<span class="c1"># Specify well screen depths</span>
<span class="n">screen_top</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="n">screen_bottom</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.0</span><span class="p">]</span>

<span class="c1"># Specify flow rate, which changes over time.</span>
<span class="n">weltimes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2000-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2000-01-03&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span><span class="p">)</span>
<span class="n">well_rates_period1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="n">well_rates_period2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]</span>
<span class="n">rate</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
    <span class="p">[</span><span class="n">well_rates_period1</span><span class="p">,</span> <span class="n">well_rates_period2</span><span class="p">],</span>
    <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">weltimes</span><span class="p">},</span>
    <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Now construct the Well package</span>
<span class="n">wel_pkg</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">Well</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="n">rate</span><span class="p">,</span> <span class="n">screen_top</span><span class="o">=</span><span class="n">screen_top</span><span class="p">,</span> <span class="n">screen_bottom</span><span class="o">=</span><span class="n">screen_bottom</span>
<span class="p">)</span>

<span class="c1"># iMOD Python will take care of the rest and assign the wells to the correct model</span>
<span class="c1"># layers upon writing the model. It will furthermore distribute well rates based</span>
<span class="c1"># on transmissivities. To verify how wells will be assigned to model layers before</span>
<span class="c1"># writing the entire simulation, you can use the following command:</span>
<span class="n">wel_mf6_pkg</span> <span class="o">=</span> <span class="n">wel_pkg</span><span class="o">.</span><span class="n">to_mf6_pkg</span><span class="p">(</span><span class="n">idomain</span><span class="p">,</span> <span class="n">elevation</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

<span class="c1"># Wells have been distributed across two model layers based on screen depths.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wel_mf6_pkg</span><span class="p">[</span><span class="s2">&quot;cellid&quot;</span><span class="p">])</span>

<span class="c1"># Well rates have been distributed based on screen overlap</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wel_mf6_pkg</span><span class="p">[</span><span class="s2">&quot;rate&quot;</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;xarray.DataArray &#39;cellid&#39; (ncellid: 4, dim_cellid: 3)&gt; Size: 96B
array([[  1, 104, 106],
       [  1,  84, 127],
       [  2, 104, 106],
       [  2,  84, 127]])
Coordinates:
  * ncellid     (ncellid) int64 32B 0 1 2 3
  * dim_cellid  (dim_cellid) &lt;U6 72B &#39;layer&#39; &#39;row&#39; &#39;column&#39;
    x           (ncellid) float64 32B 1.502e+05 1.608e+05 1.502e+05 1.608e+05
    y           (ncellid) float64 32B 4.503e+05 4.602e+05 4.503e+05 4.602e+05
&lt;xarray.DataArray &#39;rate&#39; (ncellid: 4, time: 2)&gt; Size: 64B
array([[0.28073287, 1.40366435],
       [0.58867207, 1.7660162 ],
       [0.21926713, 1.09633565],
       [0.41132793, 1.2339838 ]])
Coordinates:
  * ncellid  (ncellid) int64 32B 0 1 2 3
    x        (ncellid) float64 32B 1.502e+05 1.608e+05 1.502e+05 1.608e+05
    y        (ncellid) float64 32B 4.503e+05 4.602e+05 4.503e+05 4.602e+05
  * time     (time) datetime64[ns] 16B 2000-01-01 2000-01-03
</pre></div>
</div>
<p>MODFLOW 6 requires that all stress periods are defined in the time discretization
package. However, usually boundary conditions are defined at insconsistent
times. iMOD Python can help you to create a time discretization package that is
consistent, based on all the unique times assigned to the boundary conditions.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">simulation</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">Modflow6Simulation</span><span class="p">(</span><span class="s2">&quot;example&quot;</span><span class="p">)</span>
<span class="n">simulation</span><span class="p">[</span><span class="s2">&quot;gwf&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">GroundwaterFlowModel</span><span class="p">()</span>
<span class="n">simulation</span><span class="p">[</span><span class="s2">&quot;gwf&quot;</span><span class="p">][</span><span class="s2">&quot;dis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dis_pkg</span>
<span class="n">simulation</span><span class="p">[</span><span class="s2">&quot;gwf&quot;</span><span class="p">][</span><span class="s2">&quot;wel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wel_pkg</span>

<span class="c1"># Create a time discretization based on the times assigned to the packages.</span>
<span class="c1"># Specify the end time of the simulation as one of the additional_times</span>
<span class="n">simulation</span><span class="o">.</span><span class="n">create_time_discretization</span><span class="p">(</span><span class="n">additional_times</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;2000-01-07&quot;</span><span class="p">])</span>

<span class="c1"># Note that timesteps in well package are also inserted in the time</span>
<span class="c1"># discretization</span>
<span class="nb">print</span><span class="p">(</span><span class="n">simulation</span><span class="p">[</span><span class="s2">&quot;time_discretization&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;xarray.Dataset&gt; Size: 48B
Dimensions:              (time: 2)
Coordinates:
  * time                 (time) datetime64[ns] 16B 2000-01-01 2000-01-03
Data variables:
    timestep_duration    (time) float64 16B 2.0 4.0
    n_timesteps          int64 8B 1
    timestep_multiplier  float64 8B 1.0
</pre></div>
</div>
<p>Regrid MODFLOW 6 models to different grids, even from structured to unstructured
grids. iMOD Python takes care of properly scaling the input parameters. You can
also configure scaling methods yourself for each input parameter, for example
when you want to upscale drainage elevations with the minimum instead of the
average.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">new_unstructured_grid</span> <span class="o">=</span> <span class="n">part</span>
<span class="n">sim_regridded</span> <span class="o">=</span> <span class="n">simulation</span><span class="o">.</span><span class="n">regrid_like</span><span class="p">(</span><span class="s2">&quot;regridded&quot;</span><span class="p">,</span> <span class="n">new_unstructured_grid</span><span class="p">)</span>

<span class="c1"># Notice that discretization has converted to VerticesDiscretization (DISV)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sim_regridded</span><span class="p">[</span><span class="s2">&quot;gwf&quot;</span><span class="p">][</span><span class="s2">&quot;dis&quot;</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>VerticesDiscretization
&lt;xarray.Dataset&gt; Size: 79kB
Dimensions:        (layer: 3, mesh2d_nFaces: 1238)
Coordinates:
  * layer          (layer) int64 24B 1 2 3
  * mesh2d_nFaces  (mesh2d_nFaces) int64 10kB 0 1 2 3 4 ... 1234 1235 1236 1237
Data variables:
    idomain        (layer, mesh2d_nFaces) int64 30kB 1 1 1 1 1 1 ... 1 1 1 1 1 1
    top            (mesh2d_nFaces) float64 10kB 7.708 18.72 ... 12.31 11.52
    bottom         (layer, mesh2d_nFaces) float64 30kB -2.292 8.724 ... -28.48
</pre></div>
</div>
<p>To reduce the size of your model, you can clip it to a bounding box. This is
useful for example when you want to create a smaller model for testing purposes.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">sim_clipped</span> <span class="o">=</span> <span class="n">simulation</span><span class="o">.</span><span class="n">clip_box</span><span class="p">(</span>
    <span class="n">x_min</span><span class="o">=</span><span class="mi">125_000</span><span class="p">,</span> <span class="n">x_max</span><span class="o">=</span><span class="mi">175_000</span><span class="p">,</span> <span class="n">y_min</span><span class="o">=</span><span class="mi">425_000</span><span class="p">,</span> <span class="n">y_max</span><span class="o">=</span><span class="mi">475_000</span>
<span class="p">)</span>
</pre></div>
</div>
<p>You can even provide states for the model, which will be set on the model
boundaries of the clipped model. Create a grid of zeros, which will be used to
set as heads at the boundaries of clipped parts.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">head_for_boundary</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">idomain</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">idomain</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">states_for_boundary</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;gwf&quot;</span><span class="p">:</span> <span class="n">head_for_boundary</span><span class="p">}</span>

<span class="n">sim_clipped</span> <span class="o">=</span> <span class="n">simulation</span><span class="o">.</span><span class="n">clip_box</span><span class="p">(</span>
    <span class="n">x_min</span><span class="o">=</span><span class="mi">125_000</span><span class="p">,</span>
    <span class="n">x_max</span><span class="o">=</span><span class="mi">175_000</span><span class="p">,</span>
    <span class="n">y_min</span><span class="o">=</span><span class="mi">425_000</span><span class="p">,</span>
    <span class="n">y_max</span><span class="o">=</span><span class="mi">475_000</span><span class="p">,</span>
    <span class="n">states_for_boundary</span><span class="o">=</span><span class="n">states_for_boundary</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Notice that a Constant Head (CHD) package has been created for the clipped</span>
<span class="c1"># model.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sim_clipped</span><span class="p">[</span><span class="s2">&quot;gwf&quot;</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>GroundwaterFlowModel(
    listing_file=None,
    print_input=False,
    print_flows=False,
    save_flows=False,
    newton=False,
    under_relaxation=False,
){
    &#39;dis&#39;: StructuredDiscretization,
    &#39;wel&#39;: Well,
    &#39;chd_clipped&#39;: ConstantHead,
}
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (1 minutes 0.353 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-user-guide-00-index-examples-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/b8a0440a26de3312e0fb26701c3520e3/00-index-examples.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">00-index-examples.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/0c5f1c8a98491053a3a80c81bffcc8e7/00-index-examples.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">00-index-examples.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../_downloads/a99a21dd1b6d1eff2dc7a70101d2e1b5/00-index-examples.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">00-index-examples.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">User Guide</p>
      </div>
    </a>
    <a class="right-next"
       href="01-raster-data.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Raster data and xarray</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/user-guide/00-index-examples.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright Deltares.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>