
<!DOCTYPE html>


<html lang="en" data-content_root="../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Time series data and Pandas &#8212; iMOD Python 1.0.0rc6 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=bc4855a1"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user-guide/03-timeseries-data';</script>
    <script src="../_static/deltares.js?v=8d5578be"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Unstructured Grids" href="05-unstructured-grids.html" />
    <link rel="prev" title="Vector data and Geopandas" href="02-vector-data.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.0.0rc6.dev" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
    
    <img src="../_static/imod-python-logo-light.svg" class="logo__image only-light" alt="iMOD Python 1.0.0rc6 documentation - Home"/>
    <img src="../_static/imod-python-logo-dark.svg" class="logo__image only-dark pst-js-only" alt="iMOD Python 1.0.0rc6 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation.html">
    Installing
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../faq/index.html">
    FAQ
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../developing/index.html">
    Developing
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.deltares.nl/en/" title="Deltares" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-deltares fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Deltares</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Deltares/imod-python" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation.html">
    Installing
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../faq/index.html">
    FAQ
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../developing/index.html">
    Developing
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.deltares.nl/en/" title="Deltares" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-deltares fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Deltares</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Deltares/imod-python" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="00-index-examples.html">Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="01-raster-data.html">Raster data and xarray</a></li>
<li class="toctree-l1"><a class="reference internal" href="02-vector-data.html">Vector data and Geopandas</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Time series data and Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="05-unstructured-grids.html">Unstructured Grids</a></li>
<li class="toctree-l1"><a class="reference internal" href="06-lazy-evaluation.html">Lazy evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="07-time-discretization.html">Model time discretization</a></li>
<li class="toctree-l1"><a class="reference internal" href="08-regridding.html">Regridding</a></li>
<li class="toctree-l1"><a class="reference internal" href="09-topsystem.html">Topsystem: from 2D map to 3D model</a></li>
<li class="toctree-l1"><a class="reference internal" href="10-cleanup.html">Data cleanup</a></li>
<li class="toctree-l1"><a class="reference internal" href="11-imod5-files.html">Reading and writing iMOD5 files in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="12-imod5-model-to-modflow6.html">Working with iMOD5 models in MODFLOW 6</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">User Guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Time series data and Pandas</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-user-guide-03-timeseries-data-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="time-series-data-and-pandas">
<span id="sphx-glr-user-guide-03-timeseries-data-py"></span><h1>Time series data and Pandas<a class="headerlink" href="#time-series-data-and-pandas" title="Link to this heading">#</a></h1>
<p>Handling time series is major part of geohydrology and groundwater modeling.
Time series data come in more than one form:</p>
<ul class="simple">
<li><p>Time series linked to a point location, for example a measured groundwater
level at a specific location.</p></li>
<li><p>Time series of a spatially continuous nature, for example model output of
calculated head for a specific model layer.</p></li>
</ul>
<p>We typically represent time series data at points as a
<code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>, despite the (apparent) match with GeoDataFrames.
The issue is that a GeoDataFrame has to store the geometry for every row: this
means many duplicated geometries. Fortunately, pandas’ <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/groupby.html">group by</a>
(split-apply-combine) functionality provides a (fairly) convenient way of
working with time series data of many points.</p>
<p>Pandas provides many tools for working with time series data, such as:</p>
<ul class="simple">
<li><p>Input and output to many tabular formats, such as CSV or Excel;</p></li>
<li><p>Data selection;</p></li>
<li><p>Filling or interpolating missing data;</p></li>
<li><p>Resampling to specific frequencies;</p></li>
<li><p>Plotting.</p></li>
</ul>
<section id="timeseries-at-point-locations">
<h2>Timeseries at point locations<a class="headerlink" href="#timeseries-at-point-locations" title="Link to this heading">#</a></h2>
<p>iMOD represents time series at points in an IPF format. This format stores
its data as:</p>
<ul class="simple">
<li><p>A “mother” file containing the x and y coordinates of the point. Each
point can be associated with a timeseries with a label.</p></li>
<li><p>A timeries file for every point.</p></li>
</ul>
<p>These files can be read via <a class="reference internal" href="../api/generated/io/imod.formats.ipf.read.html#imod.formats.ipf.read" title="imod.formats.ipf.read"><code class="xref py py-func docutils literal notranslate"><span class="pre">imod.formats.ipf.read()</span></code></a>. The <code class="docutils literal notranslate"><span class="pre">read</span></code> function
will read the mother file, and follow its labels, reading every associated
timeseries file as well. Finally, these are merged into a single large table;
the properties of the point (e.g. the x,y coordinates) are duplicated for every
row.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This may seem wasteful, but:</p>
<ul class="simple">
<li><p>There are few data structures available for storing point data with
associated time series. For example: xarray can store the point location
as coordinates, but every point will need to share its time axis – the
same time window for every point and the same time resolution.</p></li>
<li><p>There are equally few file formats suitable for this data. A single large
table is supported by many file formats.</p></li>
<li><p>Pandas <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/groupby.html">group by</a> functionality is quite fast.</p></li>
</ul>
</div>
</section>
<section id="example-head-observations">
<h2>Example: Head observations<a class="headerlink" href="#example-head-observations" title="Link to this heading">#</a></h2>
<p>Let’s load some example data. We’ll load some head observations. This is a
large dataset, originally stored in the IPF format. This dataset has a similar
form to what <a class="reference internal" href="../api/generated/io/imod.formats.ipf.read.html#imod.formats.ipf.read" title="imod.formats.ipf.read"><code class="xref py py-func docutils literal notranslate"><span class="pre">imod.formats.ipf.read()</span></code></a> would return.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">imod</span>

<span class="n">heads</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">head_observations</span><span class="p">()</span>
<span class="n">heads</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>id</th>
      <th>Filternummer</th>
      <th>time</th>
      <th>head</th>
      <th>filt_top</th>
      <th>filt_bot</th>
      <th>Meetpunt tov m NAP</th>
      <th>x</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>B12A1745001</td>
      <td>1</td>
      <td>2007-12-28</td>
      <td>NaN</td>
      <td>9.29</td>
      <td>8.29</td>
      <td>9.86</td>
      <td>226410</td>
      <td>563800</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>B12A1745001</td>
      <td>1</td>
      <td>2008-01-28</td>
      <td>9.03</td>
      <td>9.29</td>
      <td>8.29</td>
      <td>9.86</td>
      <td>226410</td>
      <td>563800</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>B12A1745001</td>
      <td>1</td>
      <td>2008-02-14</td>
      <td>8.70</td>
      <td>9.29</td>
      <td>8.29</td>
      <td>9.86</td>
      <td>226410</td>
      <td>563800</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>B12A1745001</td>
      <td>1</td>
      <td>2008-02-28</td>
      <td>8.53</td>
      <td>9.29</td>
      <td>8.29</td>
      <td>9.86</td>
      <td>226410</td>
      <td>563800</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>B12A1745001</td>
      <td>1</td>
      <td>2008-03-17</td>
      <td>8.63</td>
      <td>9.29</td>
      <td>8.29</td>
      <td>9.86</td>
      <td>226410</td>
      <td>563800</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>60374</th>
      <td>92</td>
      <td>B17E2244001</td>
      <td>1</td>
      <td>2019-05-14</td>
      <td>15.44</td>
      <td>8.64</td>
      <td>7.64</td>
      <td>16.08</td>
      <td>240586</td>
      <td>543605</td>
    </tr>
    <tr>
      <th>60375</th>
      <td>93</td>
      <td>B17E2244001</td>
      <td>1</td>
      <td>2019-05-28</td>
      <td>15.28</td>
      <td>8.64</td>
      <td>7.64</td>
      <td>16.08</td>
      <td>240586</td>
      <td>543605</td>
    </tr>
    <tr>
      <th>60376</th>
      <td>94</td>
      <td>B17E2244001</td>
      <td>1</td>
      <td>2019-06-14</td>
      <td>15.13</td>
      <td>8.64</td>
      <td>7.64</td>
      <td>16.08</td>
      <td>240586</td>
      <td>543605</td>
    </tr>
    <tr>
      <th>60377</th>
      <td>95</td>
      <td>B17E2244001</td>
      <td>1</td>
      <td>2019-06-28</td>
      <td>14.88</td>
      <td>8.64</td>
      <td>7.64</td>
      <td>16.08</td>
      <td>240586</td>
      <td>543605</td>
    </tr>
    <tr>
      <th>60378</th>
      <td>98</td>
      <td>B17E2244001</td>
      <td>1</td>
      <td>2019-08-14</td>
      <td>14.53</td>
      <td>8.64</td>
      <td>7.64</td>
      <td>16.08</td>
      <td>240586</td>
      <td>543605</td>
    </tr>
  </tbody>
</table>
<p>60379 rows × 10 columns</p>
</div>
</div>
<br />
<br /><p>We can see that the data is stored in a long format, with duplicate entries
for each time. Let’s do some selections to showcase some functionality of
pandas. Let’s first compute filter depth, which is the difference between the
surface_elevation and the top of the filter. Note: “Meetpunt tov m NAP” =
surface elevation, “filt_top” = top of the filter.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">filter_depth</span> <span class="o">=</span> <span class="n">heads</span><span class="p">[</span><span class="s2">&quot;Meetpunt tov m NAP&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">heads</span><span class="p">[</span><span class="s2">&quot;filt_top&quot;</span><span class="p">]</span>
<span class="n">filter_depth</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>0        0.57
1        0.57
2        0.57
3        0.57
4        0.57
         ...
60374    7.44
60375    7.44
60376    7.44
60377    7.44
60378    7.44
Length: 60379, dtype: float64
</pre></div>
</div>
<p>The original dataset is very large, so let’s limit ourselves to only head
observations close to surface elevation. Let’s say the first 20 cm below surface.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">heads_shallow</span> <span class="o">=</span> <span class="n">heads</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">filter_depth</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">]</span>
<span class="n">heads_shallow</span> <span class="o">=</span> <span class="n">heads_shallow</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s plot the head observations for these shallow observations over time with
a separate line for each filter.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">heads_shallow</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;head&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_03-timeseries-data_001.png" srcset="../_images/sphx_glr_03-timeseries-data_001.png" alt="03 timeseries data" class = "sphx-glr-single-img"/><p>It seems one line disappeared. Let’s count the number of observations per
filter. We can see that one of the filters has only one observation, making it
hard to draw a line.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">heads_shallow</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)[</span><span class="s2">&quot;head&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>id
B12A1792001     72
B12A1898001      1
B12D1846001    113
B17B0271002    124
Name: head, dtype: int64
</pre></div>
</div>
<p>Let’s check whether these head observations were all measured at the same
date. We can groupby time and count the number of observations per time.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">n_obs_per_time</span> <span class="o">=</span> <span class="n">heads_shallow</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">n_obs_per_time</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>time
2001-07-16    1
2001-08-14    1
2001-09-14    1
2001-09-28    1
2001-10-14    1
             ..
2018-11-14    1
2018-12-13    1
2019-05-14    1
2019-08-28    1
2019-08-30    1
Name: id, Length: 297, dtype: int64
</pre></div>
</div>
<p>We can see in the printed summary that most dates have only one observation,
and that the last two dates are only two days apart. This is likely caused by
observations on inconsistent dates.</p>
<p>Let’s see if there are some dates with more than one observation.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">n_obs_per_time</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>array([1, 2])
</pre></div>
</div>
<p>We can see that there are some dates with two observations. Lets’s
see which dates those are:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">n_obs_per_time</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">n_obs_per_time</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>time
2004-08-14    2
2004-10-14    2
2005-04-14    2
2005-04-28    2
2005-05-14    2
2005-10-28    2
2007-10-14    2
2008-12-14    2
2009-01-14    2
2009-01-28    2
2009-08-28    2
2009-09-14    2
2009-09-28    2
2014-09-29    2
2014-10-14    2
Name: id, dtype: int64
</pre></div>
</div>
</section>
<section id="modflow-6">
<h2>MODFLOW 6<a class="headerlink" href="#modflow-6" title="Link to this heading">#</a></h2>
<p>iMOD Python’s <a class="reference internal" href="../api/generated/mf6/imod.mf6.Well.html#imod.mf6.Well" title="imod.mf6.Well"><code class="xref py py-class docutils literal notranslate"><span class="pre">imod.mf6.Well</span></code></a> and <a class="reference internal" href="../api/generated/mf6/imod.mf6.LayeredWell.html#imod.mf6.LayeredWell" title="imod.mf6.LayeredWell"><code class="xref py py-class docutils literal notranslate"><span class="pre">imod.mf6.LayeredWell</span></code></a> classes
require their data to be provided as points. However, these require the rates
to be provided on consistent timesteps amongst all points. This means that the
data has to be resampled to a consistent frequency. This is done for the user
when calling <a class="reference internal" href="../api/generated/mf6/imod.mf6.Well.from_imod5_data.html#imod.mf6.Well.from_imod5_data" title="imod.mf6.Well.from_imod5_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">imod.mf6.Well.from_imod5_data()</span></code></a> or
<a class="reference internal" href="../api/generated/mf6/imod.mf6.LayeredWell.from_imod5_data.html#imod.mf6.LayeredWell.from_imod5_data" title="imod.mf6.LayeredWell.from_imod5_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">imod.mf6.LayeredWell.from_imod5_data()</span></code></a>.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 1.397 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-user-guide-03-timeseries-data-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/2da08518e6a9d571f7aee5c95a773928/03-timeseries-data.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">03-timeseries-data.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/4a163f47f22d92d2f80e45ab7e19bddb/03-timeseries-data.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">03-timeseries-data.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../_downloads/c258c3354078649c3282b46383c2e1f9/03-timeseries-data.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">03-timeseries-data.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="02-vector-data.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Vector data and Geopandas</p>
      </div>
    </a>
    <a class="right-next"
       href="05-unstructured-grids.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Unstructured Grids</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#timeseries-at-point-locations">Timeseries at point locations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-head-observations">Example: Head observations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modflow-6">MODFLOW 6</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/user-guide/03-timeseries-data.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright Deltares.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>