
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples\mf6\hondsrug.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_examples_mf6_hondsrug.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_mf6_hondsrug.py:


Regional model
==============

This example shows a simplified script for building a groundwater model in the
northeast of the Netherlands. A primary feature of this area is an ice-pushed
ridge called the Hondsrug. This examples demonstrates modifying external data
for use in a MODFLOW 6 model.

In overview, the model features:

    * Thirteen layers: seven aquifers and six aquitards;
    * A dense ditch network in the east;
    * Pipe drainage for agriculture;
    * Precipitation and evapotranspiration.

.. GENERATED FROM PYTHON SOURCE LINES 18-20

.. code-block:: Python
   :dedent: 1










.. GENERATED FROM PYTHON SOURCE LINES 22-23

We'll start with the usual imports, and an import from scipy.

.. GENERATED FROM PYTHON SOURCE LINES 23-32

.. code-block:: Python


    import matplotlib.pyplot as plt
    import numpy as np
    import pandas as pd
    import scipy.ndimage
    import xarray as xr

    import imod








.. GENERATED FROM PYTHON SOURCE LINES 33-36

Before starting to create the input data, we will create the groundwater
:doc:`/api/generated/mf6/imod.mf6.GroundwaterFlowModel`.
The data from all the model packages will be added to this variable.

.. GENERATED FROM PYTHON SOURCE LINES 36-39

.. code-block:: Python


    gwf_model = imod.mf6.GroundwaterFlowModel()








.. GENERATED FROM PYTHON SOURCE LINES 40-47

This package allows specifying a regular MODFLOW grid. This grid is assumed
to be rectangular horizontally, but can be distorted vertically.

Load data
---------

We'll load the data from the examples that come with this package.

.. GENERATED FROM PYTHON SOURCE LINES 47-61

.. code-block:: Python


    layermodel = imod.data.hondsrug_layermodel()

    # Make sure that the idomain is provided as integers
    idomain = layermodel["idomain"].astype(int)

    # We only need to provide the data for the top as a 2D array. MODFLOW 6 will
    # compare the top against the uppermost active bottom cell.
    top = layermodel["top"].max(dim="layer")

    bot = layermodel["bottom"]

    top.plot.imshow()




.. image-sg:: /examples/mf6/images/sphx_glr_hondsrug_001.png
   :alt: dx = 25.0, dy = -25.0
   :srcset: /examples/mf6/images/sphx_glr_hondsrug_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.image.AxesImage object at 0x0000019B381E5F40>



.. GENERATED FROM PYTHON SOURCE LINES 62-72

Adding information to the DIS package
-------------------------------------

The following step is to add the previously created discretization data to
the gwf_model variable.  This is done using the function
:doc:`/api/generated/mf6/imod.mf6.StructuredDiscretization`.
The data to include is the top of the model domain, the bottom of the layers,
and the idomain. All this information comes from the previously imported
tifs (now converted to `xarray.DataArray
<http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray>`_.

.. GENERATED FROM PYTHON SOURCE LINES 72-77

.. code-block:: Python


    gwf_model["dis"] = imod.mf6.StructuredDiscretization(
        top=top, bottom=bot, idomain=idomain
    )








.. GENERATED FROM PYTHON SOURCE LINES 78-88

Node property flow package - NPF
=================================

This package contains the information related to the aquifer properties used to calculate
hydraulic conductance. This package replaces the Layer Property Flow (LPF),
Block-Centered Flow (BCF), and Upstream Weighting (UPW) packages from previous MODFLOW versions.

Hydraulic conductivity
----------------------


.. GENERATED FROM PYTHON SOURCE LINES 88-90

.. code-block:: Python

    k = layermodel["k"]








.. GENERATED FROM PYTHON SOURCE LINES 91-115

icelltype
----------

The cell type to be used in the model (confined or convertible) can be
defined under ICELLTYPE, which is an input to the NPF package.  ICELLTYPE ==
0: *Confined cell* - Constant transmissivity ICELLTYPE != 0: *Convertible
cell* - Transmissivity varies depending on the calculated head in the cell
(based on the saturated cell thickness)

In this example, all layers have a ICELLTYPE equal to 0, indicating confined
cells.  This is defined in the following section.

Adding information to the NPF package
--------------------------------------

The information for the NPF package is added to the gwf_model variable using
:doc:`/api/generated/mf6/imod.mf6.NodePropertyFlow`.
The information included is the icelltype value (equal to zero), the array
for  the hydraulic conductivity (considered to be the same for the horizontal
and vertical direction) and, optionally, the
variable_vertical_conductance, dewatered, perched and save_flows options have
been activated.  For more details about the meaning of these variables and
other variables available to be used within this package, please refer to the
:doc:`documentation </api/generated/mf6/imod.mf6.NodePropertyFlow>`.

.. GENERATED FROM PYTHON SOURCE LINES 115-126

.. code-block:: Python


    gwf_model["npf"] = imod.mf6.NodePropertyFlow(
        icelltype=0,
        k=k,
        k33=k,
        variable_vertical_conductance=True,
        dewatered=True,
        perched=True,
        save_flows=True,
    )








.. GENERATED FROM PYTHON SOURCE LINES 127-141

Initial conditions package - IC
================================

This package reads the starting heads for a simulation.

Starting heads interpolation
----------------------------

The starting heads to be used in this model are based on the interpolation of
x-y head measurements, which were interpolated on a larger area.  This
example was created in this example --insert-link-here--

The heads were interpolated on a larger area, therefore these have to be
clipped first

.. GENERATED FROM PYTHON SOURCE LINES 141-158

.. code-block:: Python


    initial = imod.data.hondsrug_initial()
    interpolated_head_larger = initial["head"]

    xmin = 237_500.0
    xmax = 250_000.0
    ymin = 559_000.0
    ymax = 564_000.0

    interpolated_head = interpolated_head_larger.sel(
        x=slice(xmin, xmax), y=slice(ymax, ymin)
    )

    # Plotting the clipped interpolation
    fig, ax = plt.subplots()
    interpolated_head.plot.imshow(ax=ax)




.. image-sg:: /examples/mf6/images/sphx_glr_hondsrug_002.png
   :alt: dx = 25.0, dy = -25.0
   :srcset: /examples/mf6/images/sphx_glr_hondsrug_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.image.AxesImage object at 0x0000019B1C7434A0>



.. GENERATED FROM PYTHON SOURCE LINES 159-168

The final step is to assign the 2D heads interpolation to all the
model layers (as a reference value) by using the xarray tool
`xarray.full_like <http://xarray.pydata.org/en/stable/generated/xarray.full_like.html#xarray.full_like>`_.
The 3d idomain array is used as reference for the geometry and then
its original values are replaced by NaNs.
This array is combined with the interpolated_head array using the xarray
`DataArray.combine_first <http://xarray.pydata.org/en/stable/generated/xarray.DataArray.combine_first.html#xarray.DataArray.combine_first>`_
option.
The final result is an starting_heads xarray where all layers have the 2d interpolated_head information.

.. GENERATED FROM PYTHON SOURCE LINES 168-177

.. code-block:: Python


    # Assign interpolated head values to all the model layers
    like_3d = xr.full_like(idomain, np.nan, dtype=float)
    starting_head = like_3d.combine_first(interpolated_head)
    # Consequently ensure no data is specified in inactive cells:
    starting_head = starting_head.where(idomain == 1)

    starting_head






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "ðŸ“";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "â–º";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "â–¼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;idomain&#x27; (layer: 13, y: 200, x: 500)&gt; Size: 10MB
    array([[[       nan,        nan,        nan, ..., 1.27008811,
             1.27823924, 1.28676046],
            [       nan,        nan,        nan, ..., 1.26336139,
             1.27183901, 1.28070347],
            [       nan,        nan,        nan, ..., 1.25620192,
             1.26504986, 1.27431479],
            ...,
            [7.28608515, 7.26550211, 7.24273429, ...,        nan,
                    nan,        nan],
            [7.2907364 , 7.26985601, 7.24672249, ...,        nan,
                    nan,        nan],
            [7.29728577, 7.27649525, 7.25355321, ...,        nan,
                    nan,        nan]],

           [[       nan,        nan,        nan, ...,        nan,
                    nan,        nan],
            [       nan,        nan,        nan, ...,        nan,
                    nan,        nan],
            [       nan,        nan,        nan, ...,        nan,
                    nan,        nan],
    ...
            [       nan,        nan,        nan, ...,        nan,
                    nan,        nan],
            [       nan,        nan,        nan, ...,        nan,
                    nan,        nan],
            [       nan,        nan,        nan, ...,        nan,
                    nan,        nan]],

           [[5.6706604 , 5.65319374, 5.63573351, ..., 1.27008811,
             1.27823924, 1.28676046],
            [5.67764711, 5.66021213, 5.64275829, ..., 1.26336139,
             1.27183901, 1.28070347],
            [5.68462064, 5.66720984, 5.64976361, ..., 1.25620192,
             1.26504986, 1.27431479],
            ...,
            [7.28608515, 7.26550211, 7.24273429, ..., 4.67051889,
             4.66997651, 4.66944365],
            [7.2907364 , 7.26985601, 7.24672249, ..., 4.70303061,
             4.70234778, 4.70168152],
            [7.29728577, 7.27649525, 7.25355321, ..., 4.73551559,
             4.73469247, 4.73389453]]], shape=(13, 200, 500))
    Coordinates:
      * layer    (layer) int32 52B 1 2 3 4 5 6 7 8 9 10 11 12 13
      * y        (y) float64 2kB 5.64e+05 5.64e+05 5.639e+05 ... 5.59e+05 5.59e+05
      * x        (x) float64 4kB 2.375e+05 2.375e+05 2.376e+05 ... 2.5e+05 2.5e+05
        dx       float64 8B 25.0
        dy       float64 8B -25.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'>&#x27;idomain&#x27;</div><ul class='xr-dim-list'><li><span class='xr-has-index'>layer</span>: 13</li><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>x</span>: 500</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-2170aba1-3d02-4a99-ae24-0bf240b619ac' class='xr-array-in' type='checkbox' checked><label for='section-2170aba1-3d02-4a99-ae24-0bf240b619ac' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>nan nan nan nan nan nan nan ... 4.738 4.737 4.736 4.736 4.735 4.734</span></div><div class='xr-array-data'><pre>array([[[       nan,        nan,        nan, ..., 1.27008811,
             1.27823924, 1.28676046],
            [       nan,        nan,        nan, ..., 1.26336139,
             1.27183901, 1.28070347],
            [       nan,        nan,        nan, ..., 1.25620192,
             1.26504986, 1.27431479],
            ...,
            [7.28608515, 7.26550211, 7.24273429, ...,        nan,
                    nan,        nan],
            [7.2907364 , 7.26985601, 7.24672249, ...,        nan,
                    nan,        nan],
            [7.29728577, 7.27649525, 7.25355321, ...,        nan,
                    nan,        nan]],

           [[       nan,        nan,        nan, ...,        nan,
                    nan,        nan],
            [       nan,        nan,        nan, ...,        nan,
                    nan,        nan],
            [       nan,        nan,        nan, ...,        nan,
                    nan,        nan],
    ...
            [       nan,        nan,        nan, ...,        nan,
                    nan,        nan],
            [       nan,        nan,        nan, ...,        nan,
                    nan,        nan],
            [       nan,        nan,        nan, ...,        nan,
                    nan,        nan]],

           [[5.6706604 , 5.65319374, 5.63573351, ..., 1.27008811,
             1.27823924, 1.28676046],
            [5.67764711, 5.66021213, 5.64275829, ..., 1.26336139,
             1.27183901, 1.28070347],
            [5.68462064, 5.66720984, 5.64976361, ..., 1.25620192,
             1.26504986, 1.27431479],
            ...,
            [7.28608515, 7.26550211, 7.24273429, ..., 4.67051889,
             4.66997651, 4.66944365],
            [7.2907364 , 7.26985601, 7.24672249, ..., 4.70303061,
             4.70234778, 4.70168152],
            [7.29728577, 7.27649525, 7.25355321, ..., 4.73551559,
             4.73469247, 4.73389453]]], shape=(13, 200, 500))</pre></div></div></li><li class='xr-section-item'><input id='section-efbc261b-ae58-4c74-aa84-dfd3065d6ef1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-efbc261b-ae58-4c74-aa84-dfd3065d6ef1' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12 13</div><input id='attrs-12553a36-001d-4428-92b5-84af3e1c38d6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-12553a36-001d-4428-92b5-84af3e1c38d6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0afd6d53-1bc0-4eb7-8cad-307690d71a48' class='xr-var-data-in' type='checkbox'><label for='data-0afd6d53-1bc0-4eb7-8cad-307690d71a48' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-41386250-8f33-4548-9c7f-57299d0909a3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-41386250-8f33-4548-9c7f-57299d0909a3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1f4920ac-21d5-4e53-8101-ad9fd7ac478c' class='xr-var-data-in' type='checkbox'><label for='data-1f4920ac-21d5-4e53-8101-ad9fd7ac478c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
           563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
           563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
           563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
           563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
           563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
           562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
           562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
           562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
           562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
           562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
           562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
           561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
           561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
           561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
           561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
           561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
           561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
           560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
           560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
           560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
           560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
           560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
           559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
           559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
           559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
           559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
           559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
           559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-0ac69fb0-16dc-4a3c-82d1-15e80ce110b7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0ac69fb0-16dc-4a3c-82d1-15e80ce110b7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0f3c335d-e9eb-46e3-96eb-65725f5b68eb' class='xr-var-data-in' type='checkbox'><label for='data-0f3c335d-e9eb-46e3-96eb-65725f5b68eb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5],
          shape=(500,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>25.0</div><input id='attrs-8df0f828-a616-4112-8276-2374924014a6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8df0f828-a616-4112-8276-2374924014a6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-440d5bf6-b07c-4a6a-8e0d-39d9b020f02d' class='xr-var-data-in' type='checkbox'><label for='data-440d5bf6-b07c-4a6a-8e0d-39d9b020f02d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-25.0</div><input id='attrs-131ccdd2-8682-43ad-bdcd-5474b4c1fa11' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-131ccdd2-8682-43ad-bdcd-5474b4c1fa11' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-636e030d-8463-4114-9817-6961896995c2' class='xr-var-data-in' type='checkbox'><label for='data-636e030d-8463-4114-9817-6961896995c2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-25.)</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 178-186

Adding information to the IC package
------------------------------------

The function for indicating the initial conditions is
:doc:`/api/generated/mf6/imod.mf6.InitialConditions`.
It is necessary to indicate the value(s) to be considered as the initial
(starting) head of the simulation.
In this case, this value is equal to the previously created starting_head array.

.. GENERATED FROM PYTHON SOURCE LINES 186-189

.. code-block:: Python


    gwf_model["ic"] = imod.mf6.InitialConditions(starting_head)








.. GENERATED FROM PYTHON SOURCE LINES 190-203

Constant head package - CHD
===========================

This package allows to indicate if the head varies with time,
if it is constant or if it is inactive.

Constant head edge
-------------------

The previously interpolated starting_head array will be used to define
the constant head value which will be used along the model boundaries.
A function is defined to indicate the location of the outer edge
(returning a boolean array).

.. GENERATED FROM PYTHON SOURCE LINES 203-212

.. code-block:: Python



    def outer_edge(da):
        data = da.copy()
        from_edge = scipy.ndimage.binary_erosion(data)
        is_edge = (data == 1) & (from_edge == 0)
        return is_edge.astype(bool)









.. GENERATED FROM PYTHON SOURCE LINES 213-217

For the next calculations, it is necessary to create a template array
which can be used for assigning the corresponding geometry to other arrays.
In this case, a 2d template is created based on the idomain layer information
and filled with ones.

.. GENERATED FROM PYTHON SOURCE LINES 217-221

.. code-block:: Python


    like_2d = xr.full_like(idomain.isel(layer=0), 1)
    like_2d






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "ðŸ“";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "â–º";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "â–¼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;idomain&#x27; (y: 200, x: 500)&gt; Size: 800kB
    array([[1, 1, 1, ..., 1, 1, 1],
           [1, 1, 1, ..., 1, 1, 1],
           [1, 1, 1, ..., 1, 1, 1],
           ...,
           [1, 1, 1, ..., 1, 1, 1],
           [1, 1, 1, ..., 1, 1, 1],
           [1, 1, 1, ..., 1, 1, 1]], shape=(200, 500))
    Coordinates:
      * y        (y) float64 2kB 5.64e+05 5.64e+05 5.639e+05 ... 5.59e+05 5.59e+05
      * x        (x) float64 4kB 2.375e+05 2.375e+05 2.376e+05 ... 2.5e+05 2.5e+05
        dx       float64 8B 25.0
        dy       float64 8B -25.0
        layer    int32 4B 1</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'>&#x27;idomain&#x27;</div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>x</span>: 500</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-448e7a4b-03fe-4d62-9e87-436b2023aa0c' class='xr-array-in' type='checkbox' checked><label for='section-448e7a4b-03fe-4d62-9e87-436b2023aa0c' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 ... 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></div><div class='xr-array-data'><pre>array([[1, 1, 1, ..., 1, 1, 1],
           [1, 1, 1, ..., 1, 1, 1],
           [1, 1, 1, ..., 1, 1, 1],
           ...,
           [1, 1, 1, ..., 1, 1, 1],
           [1, 1, 1, ..., 1, 1, 1],
           [1, 1, 1, ..., 1, 1, 1]], shape=(200, 500))</pre></div></div></li><li class='xr-section-item'><input id='section-4eff9c10-10aa-44a5-ad94-c5b2103d412d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4eff9c10-10aa-44a5-ad94-c5b2103d412d' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-f5d15445-3983-41c3-bd54-00d7da415a94' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f5d15445-3983-41c3-bd54-00d7da415a94' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-52b9b167-bd9b-4aa5-8205-caad670be84d' class='xr-var-data-in' type='checkbox'><label for='data-52b9b167-bd9b-4aa5-8205-caad670be84d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
           563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
           563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
           563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
           563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
           563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
           562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
           562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
           562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
           562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
           562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
           562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
           561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
           561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
           561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
           561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
           561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
           561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
           560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
           560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
           560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
           560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
           560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
           559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
           559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
           559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
           559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
           559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
           559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-22b46b58-4bfc-4dba-80ad-4aacb2953aa0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-22b46b58-4bfc-4dba-80ad-4aacb2953aa0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f2b9546d-8b76-4fa3-91f6-4f06cfb55211' class='xr-var-data-in' type='checkbox'><label for='data-f2b9546d-8b76-4fa3-91f6-4f06cfb55211' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5],
          shape=(500,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>25.0</div><input id='attrs-561b6d2b-77e4-431e-98c8-02f727848b84' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-561b6d2b-77e4-431e-98c8-02f727848b84' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4bac347b-947d-482b-a6da-d8eeed06b7f1' class='xr-var-data-in' type='checkbox'><label for='data-4bac347b-947d-482b-a6da-d8eeed06b7f1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-25.0</div><input id='attrs-e7adbdec-3669-4752-bd8b-0459377874ab' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e7adbdec-3669-4752-bd8b-0459377874ab' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3d55271d-217f-47c5-9505-b86ce46ad02c' class='xr-var-data-in' type='checkbox'><label for='data-3d55271d-217f-47c5-9505-b86ce46ad02c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>layer</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1</div><input id='attrs-1c9a872f-5652-4090-a036-fa1acbd24060' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1c9a872f-5652-4090-a036-fa1acbd24060' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-febc4e85-3c95-491c-919a-d10e5e530dfa' class='xr-var-data-in' type='checkbox'><label for='data-febc4e85-3c95-491c-919a-d10e5e530dfa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1, dtype=int32)</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 222-224

Using the previously created function and the 2d template,
the outer edge is defined for this example.

.. GENERATED FROM PYTHON SOURCE LINES 224-227

.. code-block:: Python


    edge = outer_edge(xr.full_like(like_2d.drop_vars("layer"), 1))








.. GENERATED FROM PYTHON SOURCE LINES 228-245

Adding information to the CHD package
--------------------------------------

To add the information to the CHD package within the gwf_model variable, the
:doc:`/api/generated/mf6/imod.mf6.ConstantHead`.
function is used.
The required information is the head array for this boundary condition.
In this example, the starting_head array is selected where the idomain is > 0 (active)
and it is located in the edge array.

It is also possible (and optional) to indicate if the CHD information will be written
to the listing file after it is read (print_input), if the constant head flow rates will
be printed to the listing file for every stress period time step
in which â€œBUDGET PRINTâ€ is specified in Output Control (print_flows)
and if the constant head flow terms will be written to the file
specified with â€œBUDGET FILEOUTâ€ in Output Control (save_flows).
By default, these three options are set to False.

.. GENERATED FROM PYTHON SOURCE LINES 245-253

.. code-block:: Python


    gwf_model["chd"] = imod.mf6.ConstantHead(
        starting_head.where((idomain > 0) & edge),
        print_input=False,
        print_flows=True,
        save_flows=True,
    )








.. GENERATED FROM PYTHON SOURCE LINES 254-267

Recharge
========

This package is used to represent areally distributed recharge to the groundwater system.
To calculate the recharge, the precipitation and evapotranspiration
information from the KNMI website has been downloaded for the study area.
This information is saved in netCDF files, which have been imported using the
xarray function
`xr.open_dataset <http://xarray.pydata.org/en/stable/generated/xarray.open_dataset.html#xarray.open_dataset>`_,
slicing the area to the model's miminum and maximum dimensions.

Note that the meteorological data has mm/d as unit and
this has to be converted to m/d for MODFLOW 6.

.. GENERATED FROM PYTHON SOURCE LINES 268-281

.. code-block:: Python


    xmin = 230_000.0
    xmax = 257_000.0
    ymin = 550_000.0
    ymax = 567_000.0

    meteorology = imod.data.hondsrug_meteorology()
    pp = meteorology["precipitation"]
    evt = meteorology["evapotranspiration"]

    pp = pp.sel(x=slice(xmin, xmax), y=slice(ymax, ymin)) / 1000.0  # from mm/d to m/d
    evt = evt.sel(x=slice(xmin, xmax), y=slice(ymax, ymin)) / 1000.0  # from mm/d to m/d








.. GENERATED FROM PYTHON SOURCE LINES 282-292

Recharge - Steady state
-----------------------

For the steady state conditions of the model,
the data from the period 2000 to 2009 was considered as reference.
The initial information was sliced to this time period and averaged
to obtain the a mean value grid. This process was done for both
precipitation and evapotranspiration datasets.

**Precipitation**

.. GENERATED FROM PYTHON SOURCE LINES 292-298

.. code-block:: Python

    pp_ss = pp.sel(time=slice("2000-01-01", "2009-12-31"))
    pp_ss_mean = pp_ss.mean(dim="time")

    fig, ax = plt.subplots()
    pp_ss_mean.plot(ax=ax)




.. image-sg:: /examples/mf6/images/sphx_glr_hondsrug_003.png
   :alt: dx = 1e+03, dy = -1e+03
   :srcset: /examples/mf6/images/sphx_glr_hondsrug_003.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.collections.QuadMesh object at 0x0000019B382245F0>



.. GENERATED FROM PYTHON SOURCE LINES 299-300

**Evapotranspiration**

.. GENERATED FROM PYTHON SOURCE LINES 300-306

.. code-block:: Python

    evt_ss = evt.sel(time=slice("2000-01-01", "2009-12-31"))
    evt_ss_mean = evt_ss.mean(dim="time")

    fig, ax = plt.subplots()
    evt_ss_mean.plot(ax=ax)




.. image-sg:: /examples/mf6/images/sphx_glr_hondsrug_004.png
   :alt: dx = 1e+03, dy = -1e+03
   :srcset: /examples/mf6/images/sphx_glr_hondsrug_004.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.collections.QuadMesh object at 0x0000019B242AB050>



.. GENERATED FROM PYTHON SOURCE LINES 307-309

For the recharge calculation, a first estimate
is the difference between the precipitation and evapotranspiration values.

.. GENERATED FROM PYTHON SOURCE LINES 309-315

.. code-block:: Python


    rch_ss = pp_ss_mean - evt_ss_mean

    fig, ax = plt.subplots()
    rch_ss.plot.imshow(ax=ax)




.. image-sg:: /examples/mf6/images/sphx_glr_hondsrug_005.png
   :alt: dx = 1e+03, dy = -1e+03
   :srcset: /examples/mf6/images/sphx_glr_hondsrug_005.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.image.AxesImage object at 0x0000019B39D25220>



.. GENERATED FROM PYTHON SOURCE LINES 316-321

Recharge - Transient
--------------------

The transient model will encompass the period from 2010 to 2015.
The initial pp and evt datasets have been sliced to this time frame.

.. GENERATED FROM PYTHON SOURCE LINES 321-325

.. code-block:: Python


    pp_trans = pp.sel(time=slice("2010-01-01", "2015-12-31"))
    evt_trans = evt.sel(time=slice("2010-01-01", "2015-12-31"))








.. GENERATED FROM PYTHON SOURCE LINES 326-330

As previously done, it is assumed that the recharge is equal
to the difference between precipitation and evapotranspiration as a first estimate.
Furthermore, the negative values found after doing this calculation have been
replaced by zeros, as the recharge should not have a negative value.

.. GENERATED FROM PYTHON SOURCE LINES 330-334

.. code-block:: Python


    rch_trans = pp_trans - evt_trans
    rch_trans = rch_trans.where(rch_trans > 0, 0)  # check negative values








.. GENERATED FROM PYTHON SOURCE LINES 335-338

The original information is on a daily step, so it is going to be
resampled to a yearly step by using the xarray function
`Dataset.resample <http://xarray.pydata.org/en/stable/generated/xarray.Dataset.resample.html#xarray.Dataset.resample>`_.

.. GENERATED FROM PYTHON SOURCE LINES 338-342

.. code-block:: Python


    rch_trans_yr = rch_trans.resample(time="A", label="left").mean()
    rch_trans_yr






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "ðŸ“";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "â–º";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "â–¼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (time: 6, y: 17, x: 27)&gt; Size: 11kB
    array([[[0.00191725, 0.00191589, 0.00191248, ..., 0.00158879,
             0.00160275, 0.00161772],
            [0.00193096, 0.00193016, 0.0019277 , ..., 0.00159777,
             0.00160856, 0.00162071],
            [0.00194592, 0.00194606, 0.00194384, ..., 0.00160863,
             0.00161658, 0.0016263 ],
            ...,
            [0.00205102, 0.0020491 , 0.00204451, ..., 0.00175834,
             0.00175477, 0.00175247],
            [0.0020481 , 0.00204493, 0.00203995, ..., 0.00177083,
             0.0017666 , 0.00176362],
            [0.00204444, 0.002041  , 0.00203658, ..., 0.00178251,
             0.00177807, 0.00177411]],

           [[0.00175232, 0.0017549 , 0.00175632, ..., 0.00160428,
             0.0016166 , 0.00163142],
            [0.00175832, 0.00176321, 0.00176716, ..., 0.00161909,
             0.00162744, 0.00163787],
            [0.00176593, 0.00177297, 0.00177865, ..., 0.00163613,
             0.00164029, 0.00164618],
    ...
            [0.00190413, 0.0019    , 0.00189647, ..., 0.00168478,
             0.00167463, 0.00166721],
            [0.00191761, 0.00191336, 0.00190866, ..., 0.00169624,
             0.00168655, 0.0016792 ],
            [0.0019308 , 0.00192603, 0.0019212 , ..., 0.00170712,
             0.00169771, 0.00169032]],

           [[0.00226806, 0.00225167, 0.00223808, ..., 0.00221006,
             0.00219559, 0.00218172],
            [0.0022924 , 0.00227892, 0.00226807, ..., 0.00220936,
             0.00219364, 0.00217812],
            [0.00231699, 0.00230603, 0.00229702, ..., 0.00221065,
             0.0021932 , 0.00217596],
            ...,
            [0.00249076, 0.00248442, 0.00247622, ..., 0.00224485,
             0.00222806, 0.00221361],
            [0.00249192, 0.00248449, 0.00247561, ..., 0.00224585,
             0.00223096, 0.00221743],
            [0.00249155, 0.00248376, 0.00247603, ..., 0.00224736,
             0.00223372, 0.00222133]]], shape=(6, 17, 27), dtype=float32)
    Coordinates:
      * time     (time) datetime64[ns] 48B 2009-12-31 2010-12-31 ... 2014-12-31
      * y        (y) float64 136B 5.665e+05 5.655e+05 ... 5.515e+05 5.505e+05
      * x        (x) float64 216B 2.305e+05 2.315e+05 ... 2.555e+05 2.565e+05
        dx       float64 8B 1e+03
        dy       float64 8B -1e+03</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 6</li><li><span class='xr-has-index'>y</span>: 17</li><li><span class='xr-has-index'>x</span>: 27</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-562535e5-5a7b-4260-8868-0e204157429c' class='xr-array-in' type='checkbox' checked><label for='section-562535e5-5a7b-4260-8868-0e204157429c' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.001917 0.001916 0.001912 0.001907 ... 0.002247 0.002234 0.002221</span></div><div class='xr-array-data'><pre>array([[[0.00191725, 0.00191589, 0.00191248, ..., 0.00158879,
             0.00160275, 0.00161772],
            [0.00193096, 0.00193016, 0.0019277 , ..., 0.00159777,
             0.00160856, 0.00162071],
            [0.00194592, 0.00194606, 0.00194384, ..., 0.00160863,
             0.00161658, 0.0016263 ],
            ...,
            [0.00205102, 0.0020491 , 0.00204451, ..., 0.00175834,
             0.00175477, 0.00175247],
            [0.0020481 , 0.00204493, 0.00203995, ..., 0.00177083,
             0.0017666 , 0.00176362],
            [0.00204444, 0.002041  , 0.00203658, ..., 0.00178251,
             0.00177807, 0.00177411]],

           [[0.00175232, 0.0017549 , 0.00175632, ..., 0.00160428,
             0.0016166 , 0.00163142],
            [0.00175832, 0.00176321, 0.00176716, ..., 0.00161909,
             0.00162744, 0.00163787],
            [0.00176593, 0.00177297, 0.00177865, ..., 0.00163613,
             0.00164029, 0.00164618],
    ...
            [0.00190413, 0.0019    , 0.00189647, ..., 0.00168478,
             0.00167463, 0.00166721],
            [0.00191761, 0.00191336, 0.00190866, ..., 0.00169624,
             0.00168655, 0.0016792 ],
            [0.0019308 , 0.00192603, 0.0019212 , ..., 0.00170712,
             0.00169771, 0.00169032]],

           [[0.00226806, 0.00225167, 0.00223808, ..., 0.00221006,
             0.00219559, 0.00218172],
            [0.0022924 , 0.00227892, 0.00226807, ..., 0.00220936,
             0.00219364, 0.00217812],
            [0.00231699, 0.00230603, 0.00229702, ..., 0.00221065,
             0.0021932 , 0.00217596],
            ...,
            [0.00249076, 0.00248442, 0.00247622, ..., 0.00224485,
             0.00222806, 0.00221361],
            [0.00249192, 0.00248449, 0.00247561, ..., 0.00224585,
             0.00223096, 0.00221743],
            [0.00249155, 0.00248376, 0.00247603, ..., 0.00224736,
             0.00223372, 0.00222133]]], shape=(6, 17, 27), dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-4b918ea0-7747-42be-94b4-3cd5bb2fbce1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4b918ea0-7747-42be-94b4-3cd5bb2fbce1' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2009-12-31 ... 2014-12-31</div><input id='attrs-14fb2a3b-7b65-4d3f-b4c8-1c661ad6e06d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-14fb2a3b-7b65-4d3f-b4c8-1c661ad6e06d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-38778760-a3da-4aa3-a211-56a85a209595' class='xr-var-data-in' type='checkbox'><label for='data-38778760-a3da-4aa3-a211-56a85a209595' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2009-12-31T00:00:00.000000000&#x27;, &#x27;2010-12-31T00:00:00.000000000&#x27;,
           &#x27;2011-12-31T00:00:00.000000000&#x27;, &#x27;2012-12-31T00:00:00.000000000&#x27;,
           &#x27;2013-12-31T00:00:00.000000000&#x27;, &#x27;2014-12-31T00:00:00.000000000&#x27;],
          dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.665e+05 5.655e+05 ... 5.505e+05</div><input id='attrs-9240a383-73a9-403f-aa9d-543071e30149' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9240a383-73a9-403f-aa9d-543071e30149' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-07740ed3-61de-4900-88ca-cb75f07cac2d' class='xr-var-data-in' type='checkbox'><label for='data-07740ed3-61de-4900-88ca-cb75f07cac2d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([566500., 565500., 564500., 563500., 562500., 561500., 560500., 559500.,
           558500., 557500., 556500., 555500., 554500., 553500., 552500., 551500.,
           550500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.305e+05 2.315e+05 ... 2.565e+05</div><input id='attrs-09c13d50-8fa3-45b0-bba2-ff38511e43de' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-09c13d50-8fa3-45b0-bba2-ff38511e43de' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3b26ec79-c5aa-428f-b831-22c5efba3ebf' class='xr-var-data-in' type='checkbox'><label for='data-3b26ec79-c5aa-428f-b831-22c5efba3ebf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([230500., 231500., 232500., 233500., 234500., 235500., 236500., 237500.,
           238500., 239500., 240500., 241500., 242500., 243500., 244500., 245500.,
           246500., 247500., 248500., 249500., 250500., 251500., 252500., 253500.,
           254500., 255500., 256500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1e+03</div><input id='attrs-517f36ed-844d-41c0-ab30-9b31825435da' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-517f36ed-844d-41c0-ab30-9b31825435da' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-abc63e81-2a8c-4f20-9d15-87f9d4469f96' class='xr-var-data-in' type='checkbox'><label for='data-abc63e81-2a8c-4f20-9d15-87f9d4469f96' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1000.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1e+03</div><input id='attrs-73d7b708-49ac-4954-b7d8-24ed675a4f40' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-73d7b708-49ac-4954-b7d8-24ed675a4f40' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5996aa13-1eaa-4f36-aed4-c1770bb86c47' class='xr-var-data-in' type='checkbox'><label for='data-5996aa13-1eaa-4f36-aed4-c1770bb86c47' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-1000.)</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 343-352

To create the final recharge for the transient simulation,
the steady state information needs to be concatenated to the transient recharge data.
The steady state simulation will be run for one second.
This is achieved by using the numpy
`Timedelta function <https://numpy.org/doc/stable/reference/arrays.datetime.html>`_,
first creating a time delta of 1 second, which is assigned to the steady state recharge information.
This dataset is then concatenated using the xarray function
`xarray.concat <http://xarray.pydata.org/en/stable/generated/xarray.concat.html#xarray.concat>`_
to the transient information and indicating that the dimension to join is "time".

.. GENERATED FROM PYTHON SOURCE LINES 352-363

.. code-block:: Python


    starttime = "2009-12-31"

    # Add first steady-state
    timedelta = np.timedelta64(1, "s")  # 1 second duration for initial steady-state
    starttime_steady = np.datetime64(starttime) - timedelta
    rch_ss = rch_ss.assign_coords(time=starttime_steady)

    rch_ss_trans = xr.concat([rch_ss, rch_trans_yr], dim="time")
    rch_ss_trans






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "ðŸ“";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "â–º";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "â–¼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (y: 17, x: 27, time: 7)&gt; Size: 13kB
    array([[[0.00091255, 0.00191725, 0.00175232, ..., 0.00167949,
             0.00161827, 0.00226806],
            [0.0009093 , 0.00191589, 0.0017549 , ..., 0.001689  ,
             0.00161518, 0.00225167],
            [0.00090591, 0.00191248, 0.00175632, ..., 0.00169961,
             0.00161301, 0.00223808],
            ...,
            [0.00078183, 0.00158879, 0.00160428, ..., 0.00174276,
             0.00162122, 0.00221006],
            [0.00078091, 0.00160275, 0.0016166 , ..., 0.00174685,
             0.0016207 , 0.00219559],
            [0.00078071, 0.00161772, 0.00163142, ..., 0.00175276,
             0.00162407, 0.00218172]],

           [[0.000913  , 0.00193096, 0.00175832, ..., 0.00168658,
             0.00164151, 0.0022924 ],
            [0.0009098 , 0.00193016, 0.00176321, ..., 0.00169678,
             0.00163919, 0.00227892],
            [0.0009065 , 0.0019277 , 0.00176716, ..., 0.00170842,
             0.00163841, 0.00226807],
    ...
            [0.00085378, 0.00177083, 0.00186831, ..., 0.00174713,
             0.00169624, 0.00224585],
            [0.00084055, 0.0017666 , 0.00185661, ..., 0.00173329,
             0.00168655, 0.00223096],
            [0.00082746, 0.00176362, 0.00184691, ..., 0.00172136,
             0.0016792 , 0.00221743]],

           [[0.00098196, 0.00204444, 0.00188612, ..., 0.00182747,
             0.0019308 , 0.00249155],
            [0.00098031, 0.002041  , 0.00189853, ..., 0.00183236,
             0.00192603, 0.00248376],
            [0.00097932, 0.00203658, 0.00191231, ..., 0.00183771,
             0.0019212 , 0.00247603],
            ...,
            [0.00086102, 0.00178251, 0.00188156, ..., 0.00175411,
             0.00170712, 0.00224736],
            [0.00084771, 0.00177807, 0.00187044, ..., 0.0017413 ,
             0.00169771, 0.00223372],
            [0.0008352 , 0.00177411, 0.00186046, ..., 0.00173005,
             0.00169032, 0.00222133]]], shape=(17, 27, 7), dtype=float32)
    Coordinates:
      * y        (y) float64 136B 5.665e+05 5.655e+05 ... 5.515e+05 5.505e+05
      * x        (x) float64 216B 2.305e+05 2.315e+05 ... 2.555e+05 2.565e+05
      * time     (time) datetime64[ns] 56B 2009-12-30T23:59:59 ... 2014-12-31
        dx       float64 8B 1e+03
        dy       float64 8B -1e+03</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 17</li><li><span class='xr-has-index'>x</span>: 27</li><li><span class='xr-has-index'>time</span>: 7</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-fbeeaeb6-50f0-4502-9fb8-bf993e5afcf4' class='xr-array-in' type='checkbox' checked><label for='section-fbeeaeb6-50f0-4502-9fb8-bf993e5afcf4' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0009125 0.001917 0.001752 0.001906 ... 0.00173 0.00169 0.002221</span></div><div class='xr-array-data'><pre>array([[[0.00091255, 0.00191725, 0.00175232, ..., 0.00167949,
             0.00161827, 0.00226806],
            [0.0009093 , 0.00191589, 0.0017549 , ..., 0.001689  ,
             0.00161518, 0.00225167],
            [0.00090591, 0.00191248, 0.00175632, ..., 0.00169961,
             0.00161301, 0.00223808],
            ...,
            [0.00078183, 0.00158879, 0.00160428, ..., 0.00174276,
             0.00162122, 0.00221006],
            [0.00078091, 0.00160275, 0.0016166 , ..., 0.00174685,
             0.0016207 , 0.00219559],
            [0.00078071, 0.00161772, 0.00163142, ..., 0.00175276,
             0.00162407, 0.00218172]],

           [[0.000913  , 0.00193096, 0.00175832, ..., 0.00168658,
             0.00164151, 0.0022924 ],
            [0.0009098 , 0.00193016, 0.00176321, ..., 0.00169678,
             0.00163919, 0.00227892],
            [0.0009065 , 0.0019277 , 0.00176716, ..., 0.00170842,
             0.00163841, 0.00226807],
    ...
            [0.00085378, 0.00177083, 0.00186831, ..., 0.00174713,
             0.00169624, 0.00224585],
            [0.00084055, 0.0017666 , 0.00185661, ..., 0.00173329,
             0.00168655, 0.00223096],
            [0.00082746, 0.00176362, 0.00184691, ..., 0.00172136,
             0.0016792 , 0.00221743]],

           [[0.00098196, 0.00204444, 0.00188612, ..., 0.00182747,
             0.0019308 , 0.00249155],
            [0.00098031, 0.002041  , 0.00189853, ..., 0.00183236,
             0.00192603, 0.00248376],
            [0.00097932, 0.00203658, 0.00191231, ..., 0.00183771,
             0.0019212 , 0.00247603],
            ...,
            [0.00086102, 0.00178251, 0.00188156, ..., 0.00175411,
             0.00170712, 0.00224736],
            [0.00084771, 0.00177807, 0.00187044, ..., 0.0017413 ,
             0.00169771, 0.00223372],
            [0.0008352 , 0.00177411, 0.00186046, ..., 0.00173005,
             0.00169032, 0.00222133]]], shape=(17, 27, 7), dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-4d691bec-6c5a-4e1d-ba09-0f1db72dbb72' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4d691bec-6c5a-4e1d-ba09-0f1db72dbb72' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.665e+05 5.655e+05 ... 5.505e+05</div><input id='attrs-682b8214-918f-4bd8-9e61-1f3c709436f8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-682b8214-918f-4bd8-9e61-1f3c709436f8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-918e26d0-cdca-4638-874c-ed6c485320c0' class='xr-var-data-in' type='checkbox'><label for='data-918e26d0-cdca-4638-874c-ed6c485320c0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([566500., 565500., 564500., 563500., 562500., 561500., 560500., 559500.,
           558500., 557500., 556500., 555500., 554500., 553500., 552500., 551500.,
           550500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.305e+05 2.315e+05 ... 2.565e+05</div><input id='attrs-8351fc26-75bf-496e-978f-e13b602ec1ac' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8351fc26-75bf-496e-978f-e13b602ec1ac' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6d6f0f19-92cf-4f6a-83d6-b931c24af723' class='xr-var-data-in' type='checkbox'><label for='data-6d6f0f19-92cf-4f6a-83d6-b931c24af723' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([230500., 231500., 232500., 233500., 234500., 235500., 236500., 237500.,
           238500., 239500., 240500., 241500., 242500., 243500., 244500., 245500.,
           246500., 247500., 248500., 249500., 250500., 251500., 252500., 253500.,
           254500., 255500., 256500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2009-12-30T23:59:59 ... 2014-12-31</div><input id='attrs-13839bcc-bc0b-4bc7-99a0-1bde30e3e6bd' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-13839bcc-bc0b-4bc7-99a0-1bde30e3e6bd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-14929e2f-3bd4-4350-88c0-4d24374648d7' class='xr-var-data-in' type='checkbox'><label for='data-14929e2f-3bd4-4350-88c0-4d24374648d7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2009-12-30T23:59:59.000000000&#x27;, &#x27;2009-12-31T00:00:00.000000000&#x27;,
           &#x27;2010-12-31T00:00:00.000000000&#x27;, &#x27;2011-12-31T00:00:00.000000000&#x27;,
           &#x27;2012-12-31T00:00:00.000000000&#x27;, &#x27;2013-12-31T00:00:00.000000000&#x27;,
           &#x27;2014-12-31T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1e+03</div><input id='attrs-6500fc23-929e-4b34-94aa-25a739979a2e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6500fc23-929e-4b34-94aa-25a739979a2e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a65fe441-be6b-4855-ba97-0d8fbc5c7237' class='xr-var-data-in' type='checkbox'><label for='data-a65fe441-be6b-4855-ba97-0d8fbc5c7237' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1000.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1e+03</div><input id='attrs-1d5b36b2-b75f-4a92-a199-ad0d99b4514d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1d5b36b2-b75f-4a92-a199-ad0d99b4514d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-26afe668-74c7-4330-9db3-d95bd842b1df' class='xr-var-data-in' type='checkbox'><label for='data-26afe668-74c7-4330-9db3-d95bd842b1df' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-1000.)</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 364-373

The data obtained from KNMI has different grid dimensions than the one
considered in this example. To fix this, we'll have to regrid the data to the
model grid. ``xugrid`` has `Regridder functionality that allows to regrid data
with different methods.
<https://deltares.github.io/xugrid/examples/regridder_overview.html>`_ It is
also possible to define the regridding method such as ``nearest``,
``multilinear``, ``mean``, among others. In this case, ``mean`` was selected
and the 2d template (like_2d) was used as reference, as this is the geometry
to be considered in the model.

.. GENERATED FROM PYTHON SOURCE LINES 373-380

.. code-block:: Python


    import xugrid as xu

    regridder = xu.OverlapRegridder(rch_ss, like_2d, method="mean")
    rch_ss_trans = regridder.regrid(rch_ss_trans)
    rch_ss_trans






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "ðŸ“";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "â–º";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "â–¼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (time: 7, y: 200, x: 500)&gt; Size: 6MB
    array([[[0.00089943, 0.00089943, 0.00089943, ..., 0.00083373,
             0.00083373, 0.00083373],
            [0.00089943, 0.00089943, 0.00089943, ..., 0.00083373,
             0.00083373, 0.00083373],
            [0.00089943, 0.00089943, 0.00089943, ..., 0.00083373,
             0.00083373, 0.00083373],
            ...,
            [0.00091826, 0.00091826, 0.00091826, ..., 0.00088318,
             0.00088318, 0.00088318],
            [0.00091826, 0.00091826, 0.00091826, ..., 0.00088318,
             0.00088318, 0.00088318],
            [0.00091826, 0.00091826, 0.00091826, ..., 0.00088318,
             0.00088318, 0.00088318]],

           [[0.00190719, 0.00190719, 0.00190719, ..., 0.00163785,
             0.00163785, 0.00163785],
            [0.00190719, 0.00190719, 0.00190719, ..., 0.00163785,
             0.00163785, 0.00163785],
            [0.00190719, 0.00190719, 0.00190719, ..., 0.00163785,
             0.00163785, 0.00163785],
    ...
            [0.00179237, 0.00179237, 0.00179237, ..., 0.00171221,
             0.00171221, 0.00171221],
            [0.00179237, 0.00179237, 0.00179237, ..., 0.00171221,
             0.00171221, 0.00171221],
            [0.00179237, 0.00179237, 0.00179237, ..., 0.00171221,
             0.00171221, 0.00171221]],

           [[0.00232221, 0.00232221, 0.00232221, ..., 0.00231468,
             0.00231468, 0.00231468],
            [0.00232221, 0.00232221, 0.00232221, ..., 0.00231468,
             0.00231468, 0.00231468],
            [0.00232221, 0.00232221, 0.00232221, ..., 0.00231468,
             0.00231468, 0.00231468],
            ...,
            [0.00242177, 0.00242177, 0.00242177, ..., 0.0023817 ,
             0.0023817 , 0.0023817 ],
            [0.00242177, 0.00242177, 0.00242177, ..., 0.0023817 ,
             0.0023817 , 0.0023817 ],
            [0.00242177, 0.00242177, 0.00242177, ..., 0.0023817 ,
             0.0023817 , 0.0023817 ]]], shape=(7, 200, 500))
    Coordinates:
      * time     (time) datetime64[ns] 56B 2009-12-30T23:59:59 ... 2014-12-31
      * y        (y) float64 2kB 5.64e+05 5.64e+05 5.639e+05 ... 5.59e+05 5.59e+05
      * x        (x) float64 4kB 2.375e+05 2.375e+05 2.376e+05 ... 2.5e+05 2.5e+05
        dx       float64 8B 25.0
        dy       float64 8B -25.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 7</li><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>x</span>: 500</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-9e257e13-84c0-4341-aabb-0b858a620d6c' class='xr-array-in' type='checkbox' checked><label for='section-9e257e13-84c0-4341-aabb-0b858a620d6c' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0008994 0.0008994 0.0008994 0.0008994 ... 0.002382 0.002382 0.002382</span></div><div class='xr-array-data'><pre>array([[[0.00089943, 0.00089943, 0.00089943, ..., 0.00083373,
             0.00083373, 0.00083373],
            [0.00089943, 0.00089943, 0.00089943, ..., 0.00083373,
             0.00083373, 0.00083373],
            [0.00089943, 0.00089943, 0.00089943, ..., 0.00083373,
             0.00083373, 0.00083373],
            ...,
            [0.00091826, 0.00091826, 0.00091826, ..., 0.00088318,
             0.00088318, 0.00088318],
            [0.00091826, 0.00091826, 0.00091826, ..., 0.00088318,
             0.00088318, 0.00088318],
            [0.00091826, 0.00091826, 0.00091826, ..., 0.00088318,
             0.00088318, 0.00088318]],

           [[0.00190719, 0.00190719, 0.00190719, ..., 0.00163785,
             0.00163785, 0.00163785],
            [0.00190719, 0.00190719, 0.00190719, ..., 0.00163785,
             0.00163785, 0.00163785],
            [0.00190719, 0.00190719, 0.00190719, ..., 0.00163785,
             0.00163785, 0.00163785],
    ...
            [0.00179237, 0.00179237, 0.00179237, ..., 0.00171221,
             0.00171221, 0.00171221],
            [0.00179237, 0.00179237, 0.00179237, ..., 0.00171221,
             0.00171221, 0.00171221],
            [0.00179237, 0.00179237, 0.00179237, ..., 0.00171221,
             0.00171221, 0.00171221]],

           [[0.00232221, 0.00232221, 0.00232221, ..., 0.00231468,
             0.00231468, 0.00231468],
            [0.00232221, 0.00232221, 0.00232221, ..., 0.00231468,
             0.00231468, 0.00231468],
            [0.00232221, 0.00232221, 0.00232221, ..., 0.00231468,
             0.00231468, 0.00231468],
            ...,
            [0.00242177, 0.00242177, 0.00242177, ..., 0.0023817 ,
             0.0023817 , 0.0023817 ],
            [0.00242177, 0.00242177, 0.00242177, ..., 0.0023817 ,
             0.0023817 , 0.0023817 ],
            [0.00242177, 0.00242177, 0.00242177, ..., 0.0023817 ,
             0.0023817 , 0.0023817 ]]], shape=(7, 200, 500))</pre></div></div></li><li class='xr-section-item'><input id='section-3304b780-0926-4cdf-8426-d142d41f6640' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3304b780-0926-4cdf-8426-d142d41f6640' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2009-12-30T23:59:59 ... 2014-12-31</div><input id='attrs-0c3f1967-9995-4571-bd74-bfe94338a9e5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0c3f1967-9995-4571-bd74-bfe94338a9e5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a75dc327-eff2-492b-8a7e-4efd7e9a5175' class='xr-var-data-in' type='checkbox'><label for='data-a75dc327-eff2-492b-8a7e-4efd7e9a5175' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2009-12-30T23:59:59.000000000&#x27;, &#x27;2009-12-31T00:00:00.000000000&#x27;,
           &#x27;2010-12-31T00:00:00.000000000&#x27;, &#x27;2011-12-31T00:00:00.000000000&#x27;,
           &#x27;2012-12-31T00:00:00.000000000&#x27;, &#x27;2013-12-31T00:00:00.000000000&#x27;,
           &#x27;2014-12-31T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-80c24e9f-e85f-440b-9a89-1c6f580f3491' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-80c24e9f-e85f-440b-9a89-1c6f580f3491' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4976abbc-383d-4f34-8407-039140d47d78' class='xr-var-data-in' type='checkbox'><label for='data-4976abbc-383d-4f34-8407-039140d47d78' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
           563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
           563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
           563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
           563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
           563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
           562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
           562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
           562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
           562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
           562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
           562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
           561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
           561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
           561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
           561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
           561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
           561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
           560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
           560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
           560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
           560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
           560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
           559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
           559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
           559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
           559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
           559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
           559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-22f259cf-4cde-4c73-af42-2328bcf80948' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-22f259cf-4cde-4c73-af42-2328bcf80948' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ad9818bb-c7d6-44a7-8b1b-577ba611b4a9' class='xr-var-data-in' type='checkbox'><label for='data-ad9818bb-c7d6-44a7-8b1b-577ba611b4a9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5],
          shape=(500,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>25.0</div><input id='attrs-6ff9b4c7-f9f8-46b5-9e9b-d2ae71e89bcb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6ff9b4c7-f9f8-46b5-9e9b-d2ae71e89bcb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b37541ca-057f-4432-92a9-798520a88ef5' class='xr-var-data-in' type='checkbox'><label for='data-b37541ca-057f-4432-92a9-798520a88ef5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-25.0</div><input id='attrs-db5b7f84-7fd5-4c79-bd06-bc2a34e5b8d5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-db5b7f84-7fd5-4c79-bd06-bc2a34e5b8d5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-56cafc1b-d962-421c-82d2-86bc8cb82a1e' class='xr-var-data-in' type='checkbox'><label for='data-56cafc1b-d962-421c-82d2-86bc8cb82a1e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-25.)</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 381-387

The previously created recharge array is a 2D array
that needs to be assigned to a 3D array. This is done using the xarray
`DataArray.where <http://xarray.pydata.org/en/stable/generated/xarray.DataArray.where.html#xarray.DataArray.where>`_
option, where the recharge values are applied to the cells where the
idomain value is larger than zero (that is, the active cells) and for the uppermost
active cell (indicated by the minimum layer number).

.. GENERATED FROM PYTHON SOURCE LINES 387-393

.. code-block:: Python


    rch_total = rch_ss_trans.where(
        idomain["layer"] == idomain["layer"].where(idomain > 0).min("layer")
    )
    rch_total






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "ðŸ“";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "â–º";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "â–¼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (time: 7, y: 200, x: 500, layer: 13)&gt; Size: 73MB
    array([[[[       nan,        nan, 0.00089943, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00089943, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00089943, ...,        nan,
                     nan,        nan],
             ...,
             [0.00083373,        nan,        nan, ...,        nan,
                     nan,        nan],
             [0.00083373,        nan,        nan, ...,        nan,
                     nan,        nan],
             [0.00083373,        nan,        nan, ...,        nan,
                     nan,        nan]],

            [[       nan,        nan, 0.00089943, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00089943, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00089943, ...,        nan,
                     nan,        nan],
    ...
             [       nan,        nan, 0.0023817 , ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.0023817 , ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.0023817 , ...,        nan,
                     nan,        nan]],

            [[0.00242177,        nan,        nan, ...,        nan,
                     nan,        nan],
             [0.00242177,        nan,        nan, ...,        nan,
                     nan,        nan],
             [0.00242177,        nan,        nan, ...,        nan,
                     nan,        nan],
             ...,
             [       nan,        nan, 0.0023817 , ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.0023817 , ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.0023817 , ...,        nan,
                     nan,        nan]]]], shape=(7, 200, 500, 13))
    Coordinates:
      * time     (time) datetime64[ns] 56B 2009-12-30T23:59:59 ... 2014-12-31
      * y        (y) float64 2kB 5.64e+05 5.64e+05 5.639e+05 ... 5.59e+05 5.59e+05
      * x        (x) float64 4kB 2.375e+05 2.375e+05 2.376e+05 ... 2.5e+05 2.5e+05
      * layer    (layer) int32 52B 1 2 3 4 5 6 7 8 9 10 11 12 13
        dx       float64 8B 25.0
        dy       float64 8B -25.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 7</li><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>x</span>: 500</li><li><span class='xr-has-index'>layer</span>: 13</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-7b2614cb-ab1d-4f9a-baca-a45b02ab67d8' class='xr-array-in' type='checkbox' checked><label for='section-7b2614cb-ab1d-4f9a-baca-a45b02ab67d8' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>nan nan 0.0008994 nan nan nan nan nan ... nan nan nan nan nan nan nan</span></div><div class='xr-array-data'><pre>array([[[[       nan,        nan, 0.00089943, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00089943, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00089943, ...,        nan,
                     nan,        nan],
             ...,
             [0.00083373,        nan,        nan, ...,        nan,
                     nan,        nan],
             [0.00083373,        nan,        nan, ...,        nan,
                     nan,        nan],
             [0.00083373,        nan,        nan, ...,        nan,
                     nan,        nan]],

            [[       nan,        nan, 0.00089943, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00089943, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00089943, ...,        nan,
                     nan,        nan],
    ...
             [       nan,        nan, 0.0023817 , ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.0023817 , ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.0023817 , ...,        nan,
                     nan,        nan]],

            [[0.00242177,        nan,        nan, ...,        nan,
                     nan,        nan],
             [0.00242177,        nan,        nan, ...,        nan,
                     nan,        nan],
             [0.00242177,        nan,        nan, ...,        nan,
                     nan,        nan],
             ...,
             [       nan,        nan, 0.0023817 , ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.0023817 , ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.0023817 , ...,        nan,
                     nan,        nan]]]], shape=(7, 200, 500, 13))</pre></div></div></li><li class='xr-section-item'><input id='section-28f55f6f-a66a-444d-aefd-b4b2fd0ae0a9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-28f55f6f-a66a-444d-aefd-b4b2fd0ae0a9' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2009-12-30T23:59:59 ... 2014-12-31</div><input id='attrs-66ab50ab-3f93-4735-865b-987b7fb46260' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-66ab50ab-3f93-4735-865b-987b7fb46260' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8154f21e-2b6b-4c5e-8321-4c745136901b' class='xr-var-data-in' type='checkbox'><label for='data-8154f21e-2b6b-4c5e-8321-4c745136901b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2009-12-30T23:59:59.000000000&#x27;, &#x27;2009-12-31T00:00:00.000000000&#x27;,
           &#x27;2010-12-31T00:00:00.000000000&#x27;, &#x27;2011-12-31T00:00:00.000000000&#x27;,
           &#x27;2012-12-31T00:00:00.000000000&#x27;, &#x27;2013-12-31T00:00:00.000000000&#x27;,
           &#x27;2014-12-31T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-8417dcaf-0bba-4f1a-b238-f51764daad41' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8417dcaf-0bba-4f1a-b238-f51764daad41' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eaa61ee9-edd5-4c66-b109-550663e5eadc' class='xr-var-data-in' type='checkbox'><label for='data-eaa61ee9-edd5-4c66-b109-550663e5eadc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
           563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
           563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
           563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
           563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
           563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
           562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
           562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
           562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
           562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
           562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
           562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
           561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
           561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
           561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
           561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
           561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
           561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
           560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
           560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
           560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
           560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
           560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
           559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
           559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
           559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
           559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
           559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
           559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-c992fdda-6fd0-48e7-8942-d049ac9a865a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c992fdda-6fd0-48e7-8942-d049ac9a865a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6997fd95-1f1d-4c38-a1b0-3a671be11cb1' class='xr-var-data-in' type='checkbox'><label for='data-6997fd95-1f1d-4c38-a1b0-3a671be11cb1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5],
          shape=(500,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12 13</div><input id='attrs-93c49f75-afee-4560-a26d-f71839ee3e24' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-93c49f75-afee-4560-a26d-f71839ee3e24' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-40c849c9-4f9d-4292-a59d-b755b08a3a2e' class='xr-var-data-in' type='checkbox'><label for='data-40c849c9-4f9d-4292-a59d-b755b08a3a2e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>25.0</div><input id='attrs-8a11d970-7ac6-4d05-b8d8-e3051e52501d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8a11d970-7ac6-4d05-b8d8-e3051e52501d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f2a92511-1652-40f2-8ca0-3e586f40fa71' class='xr-var-data-in' type='checkbox'><label for='data-f2a92511-1652-40f2-8ca0-3e586f40fa71' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-25.0</div><input id='attrs-ad2220fe-a20c-4680-9f77-c870f46d1d08' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ad2220fe-a20c-4680-9f77-c870f46d1d08' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d0229b26-2025-4b4e-a71a-5b7e993cec7b' class='xr-var-data-in' type='checkbox'><label for='data-d0229b26-2025-4b4e-a71a-5b7e993cec7b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-25.)</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 394-397

Finally, transposing the array dimensions using
`DataArray.transpose <http://xarray.pydata.org/en/stable/generated/xarray.DataArray.transpose.html#xarray.DataArray.transpose>`_
so they are in the correct order.

.. GENERATED FROM PYTHON SOURCE LINES 397-404

.. code-block:: Python


    rch_total = rch_total.transpose("time", "layer", "y", "x")
    rch_total

    fig, ax = plt.subplots()
    rch_total.isel(layer=2, time=6).plot.imshow(ax=ax)




.. image-sg:: /examples/mf6/images/sphx_glr_hondsrug_006.png
   :alt: dx = 25.0, dy = -25.0, time = 2014-12-31, layer...
   :srcset: /examples/mf6/images/sphx_glr_hondsrug_006.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.image.AxesImage object at 0x0000019B1F052C60>



.. GENERATED FROM PYTHON SOURCE LINES 405-412

Adding information to the RCH package
--------------------------------------

The information for the RCH package is added with the function
:doc:`/api/generated/mf6/imod.mf6.Recharge`.
It is required to insert the recharge flux rate, and it is optional
to include the print_input, print_flows and save_flows information.

.. GENERATED FROM PYTHON SOURCE LINES 412-415

.. code-block:: Python


    gwf_model["rch"] = imod.mf6.Recharge(rch_total)








.. GENERATED FROM PYTHON SOURCE LINES 416-428

Drainage package - DRN
=======================

The drain package is used to simulate features that remove water from the aquifer,
such as agricultural drains or springs.
This occurs at a rate proportional to the head difference between the head in the
aquifer and the drain elevation
(the head in the aquifer has to be above that elevation).
The conductance is the proportionality constant.

Import drainage information
----------------------------

.. GENERATED FROM PYTHON SOURCE LINES 428-436

.. code-block:: Python


    drainage = imod.data.hondsrug_drainage()

    pipe_cond = drainage["conductance"]
    pipe_elev = drainage["elevation"]

    pipe_cond






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "ðŸ“";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "â–º";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "â–¼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;conductance&#x27; (layer: 4, y: 200, x: 500)&gt; Size: 2MB
    [400000 values with dtype=float32]
    Coordinates:
      * layer    (layer) int32 16B 1 3 5 6
      * y        (y) float64 2kB 5.64e+05 5.64e+05 5.639e+05 ... 5.59e+05 5.59e+05
      * x        (x) float64 4kB 2.375e+05 2.375e+05 2.376e+05 ... 2.5e+05 2.5e+05
        dx       float64 8B ...
        dy       float64 8B ...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'>&#x27;conductance&#x27;</div><ul class='xr-dim-list'><li><span class='xr-has-index'>layer</span>: 4</li><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>x</span>: 500</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-37a2b68f-544e-4db7-a579-ca1cad15d1eb' class='xr-array-in' type='checkbox' checked><label for='section-37a2b68f-544e-4db7-a579-ca1cad15d1eb' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>...</span></div><div class='xr-array-data'><pre>[400000 values with dtype=float32]</pre></div></div></li><li class='xr-section-item'><input id='section-4ba49fad-96c6-44bf-ba1c-987d2f15a888' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4ba49fad-96c6-44bf-ba1c-987d2f15a888' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 3 5 6</div><input id='attrs-1dd8b24d-3150-4e4d-a610-9fdb2532c6df' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1dd8b24d-3150-4e4d-a610-9fdb2532c6df' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0bdcc297-9a64-41d1-8208-1ddf437458b3' class='xr-var-data-in' type='checkbox'><label for='data-0bdcc297-9a64-41d1-8208-1ddf437458b3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1, 3, 5, 6], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-19f429c1-4d16-4510-8080-6975b413c83e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-19f429c1-4d16-4510-8080-6975b413c83e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5b53faa5-9bbd-469c-890e-b9d1b65a8476' class='xr-var-data-in' type='checkbox'><label for='data-5b53faa5-9bbd-469c-890e-b9d1b65a8476' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
           563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
           563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
           563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
           563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
           563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
           562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
           562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
           562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
           562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
           562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
           562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
           561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
           561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
           561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
           561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
           561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
           561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
           560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
           560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
           560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
           560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
           560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
           559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
           559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
           559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
           559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
           559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
           559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-4a54db56-f025-4af6-8b11-44ca0ffb13ef' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4a54db56-f025-4af6-8b11-44ca0ffb13ef' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6333e49a-6d54-486a-8db9-2dee37b2a2c5' class='xr-var-data-in' type='checkbox'><label for='data-6333e49a-6d54-486a-8db9-2dee37b2a2c5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5],
          shape=(500,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-d34aac69-1a18-4111-b11e-cb60692c364b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d34aac69-1a18-4111-b11e-cb60692c364b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c11d8bde-0e88-481e-afc2-64c2f7a732c3' class='xr-var-data-in' type='checkbox'><label for='data-c11d8bde-0e88-481e-afc2-64c2f7a732c3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-e4261bad-0c65-4a20-81e2-d874adb432bb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e4261bad-0c65-4a20-81e2-d874adb432bb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fbc554bd-106b-4752-9286-879e8270bc38' class='xr-var-data-in' type='checkbox'><label for='data-fbc554bd-106b-4752-9286-879e8270bc38' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float64]</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 437-447

Adding information to the DRN package
-------------------------------------

To add the information to the DRN package within the gwf_model variable, the
:doc:`/api/generated/mf6/imod.mf6.Drainage`.
function is used. It is required to add the previously created arrays for
the drain elevation and the drain conductance.
It is optional to insert the information for
``print_input``, ``print_flows`` and ``save_flows``
which are set to False by default.

.. GENERATED FROM PYTHON SOURCE LINES 447-450

.. code-block:: Python


    gwf_model["drn-pipe"] = imod.mf6.Drainage(conductance=pipe_cond, elevation=pipe_elev)








.. GENERATED FROM PYTHON SOURCE LINES 451-459

River package - RIV
===================

This package simulates the effects of flow between
surface-water features and groundwater systems.

Import river information
------------------------

.. GENERATED FROM PYTHON SOURCE LINES 459-465

.. code-block:: Python


    river = imod.data.hondsrug_river()
    riv_cond = river["conductance"]
    riv_stage = river["stage"]
    riv_bot = river["bottom"]








.. GENERATED FROM PYTHON SOURCE LINES 466-472

Adding information to the RIV package
-------------------------------------

The data is assigned to the gwf_model variable by using
:doc:`/api/generated/mf6/imod.mf6.River`,
based on the previously imported conductance, stage and bottom arrays.

.. GENERATED FROM PYTHON SOURCE LINES 472-477

.. code-block:: Python


    gwf_model["riv"] = imod.mf6.River(
        conductance=riv_cond, stage=riv_stage, bottom_elevation=riv_bot
    )








.. GENERATED FROM PYTHON SOURCE LINES 478-483

Storage package - STO
======================

When the STO Package is included in a model, storage changes
will be calculated, and thus, the model will be transient.

.. GENERATED FROM PYTHON SOURCE LINES 483-508

.. code-block:: Python


    ss = 0.0003
    layer = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13])
    sy = xr.DataArray(
        [0.16, 0.16, 0.16, 0.16, 0.15, 0.15, 0.15, 0.15, 0.14, 0.14, 0.14, 0.14, 0.14],
        {"layer": layer},
        ("layer",),
    )
    times_sto = np.array(
        [
            "2009-12-30T23:59:59.00",
            "2009-12-31T00:00:00.00",
            "2010-12-31T00:00:00.00",
            "2011-12-31T00:00:00.00",
            "2012-12-31T00:00:00.00",
            "2013-12-31T00:00:00.00",
            "2014-12-31T00:00:00.00",
        ],
        dtype="datetime64[ns]",
    )

    transient = xr.DataArray(
        [False, True, True, True, True, True, True], {"time": times_sto}, ("time",)
    )








.. GENERATED FROM PYTHON SOURCE LINES 509-516

Adding information to the STO package
-------------------------------------

The data is assigned to the gwf_model variable by using
:doc:`/api/generated/mf6/imod.mf6.SpecificStorage`.
It is necessary to indicate the values of specific storage,
specific yield and if the layers are convertible.

.. GENERATED FROM PYTHON SOURCE LINES 516-525

.. code-block:: Python


    gwf_model["sto"] = imod.mf6.SpecificStorage(
        specific_storage=ss,
        specific_yield=sy,
        transient=transient,
        convertible=0,
        save_flows=True,
    )








.. GENERATED FROM PYTHON SOURCE LINES 526-542

Output Control package - OC
===========================

This package determines how and when heads are printed to the
listing file and/or written to a separate binary output file

Adding information to the OC package
------------------------------------

The function
:doc:`/api/generated/mf6/imod.mf6.OutputControl`
is used to store the information for this package.
It is possible to indicate if the heads and budget information is saved
at the end of each stress period (``last``),
for all timesteps a stress period (``all``),
or at the start of a stress period (``first``)

.. GENERATED FROM PYTHON SOURCE LINES 542-545

.. code-block:: Python


    gwf_model["oc"] = imod.mf6.OutputControl(save_head="last", save_budget="last")








.. GENERATED FROM PYTHON SOURCE LINES 546-558

Model simulation
================

In MODFLOW 6, the concept of "model" is that part of the program
that solves a hydrologic process. MODFLOW 6 documentation supports
one type of model: the GWF Model.
It is possible within the MODFLOW 6 framewotk to solve multiple,
tightly coupled, numerical models in a single system of equation,
which may be multiple models of the same type or of different types.

The previously created gwf_model variable now contains
the information from all the variables.

.. GENERATED FROM PYTHON SOURCE LINES 558-561

.. code-block:: Python


    gwf_model





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    GroundwaterFlowModel(
        listing_file=None,
        print_input=False,
        print_flows=False,
        save_flows=False,
        newton=False,
        under_relaxation=False,
    ){
        'dis': StructuredDiscretization,
        'npf': NodePropertyFlow,
        'ic': InitialConditions,
        'chd': ConstantHead,
        'rch': Recharge,
        'drn-pipe': Drainage,
        'riv': River,
        'sto': SpecificStorage,
        'oc': OutputControl,
    }



.. GENERATED FROM PYTHON SOURCE LINES 562-568

Attach the model information to a simulation
--------------------------------------------

The function
:doc:`/api/generated/mf6/imod.mf6.Modflow6Simulation`
allows to assign models to a simulation (in this case, the gwf_model).

.. GENERATED FROM PYTHON SOURCE LINES 568-572

.. code-block:: Python


    simulation = imod.mf6.Modflow6Simulation("mf6-mipwa2-example")
    simulation["GWF_1"] = gwf_model








.. GENERATED FROM PYTHON SOURCE LINES 573-579

Solver settings
---------------

The solver settings are indicated using
:doc:`/api/generated/mf6/imod.mf6.Solution`.
If the values are not indicated manually, the defaults values will be considered.

.. GENERATED FROM PYTHON SOURCE LINES 579-595

.. code-block:: Python


    simulation["solver"] = imod.mf6.Solution(
        modelnames=["GWF_1"],
        print_option="summary",
        outer_dvclose=1.0e-4,
        outer_maximum=500,
        under_relaxation=None,
        inner_dvclose=1.0e-4,
        inner_rclose=0.001,
        inner_maximum=100,
        linear_acceleration="cg",
        scaling_method=None,
        reordering_method=None,
        relaxation_factor=0.97,
    )








.. GENERATED FROM PYTHON SOURCE LINES 596-600

Assign time discretization
--------------------------

The time discretization of this model is 6 years.

.. GENERATED FROM PYTHON SOURCE LINES 600-605

.. code-block:: Python


    simulation.create_time_discretization(
        additional_times=["2009-12-30T23:59:59.000000000", "2015-12-31T00:00:00.000000000"]
    )








.. GENERATED FROM PYTHON SOURCE LINES 606-614

Run the model
-------------

.. note::

  The following lines assume the ``mf6`` executable is available on your PATH.
  :ref:`The MODFLOW 6 examples introduction <mf6-introduction>` shortly
  describes how to add it to yours.

.. GENERATED FROM PYTHON SOURCE LINES 614-619

.. code-block:: Python


    modeldir = imod.util.temporary_directory()
    simulation.write(modeldir, binary=False)
    simulation.run()








.. GENERATED FROM PYTHON SOURCE LINES 620-631

Results visualization
=====================

The next section indicated how to visualize the model results.

Import heads results
--------------------

The heads results are imported using
:doc:`/api/generated/mf6/imod.mf6.open_hds`.
on the background.

.. GENERATED FROM PYTHON SOURCE LINES 631-634

.. code-block:: Python


    hds = simulation.open_head()








.. GENERATED FROM PYTHON SOURCE LINES 635-636

We can plot the data of an individual layer as follows

.. GENERATED FROM PYTHON SOURCE LINES 636-639

.. code-block:: Python

    fig, ax = plt.subplots()
    hds.sel(layer=3).isel(time=3).plot(ax=ax)




.. image-sg:: /examples/mf6/images/sphx_glr_hondsrug_007.png
   :alt: dx = 25.0, dy = -25.0, layer = 3, time = 1.096e+03
   :srcset: /examples/mf6/images/sphx_glr_hondsrug_007.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.collections.QuadMesh object at 0x0000019B2DCA31D0>



.. GENERATED FROM PYTHON SOURCE LINES 640-643

As you can see layer 3 has some missing cells in the west
Whereas layer 4 only contains active cells in the
eastern peatland area

.. GENERATED FROM PYTHON SOURCE LINES 643-645

.. code-block:: Python

    fig, ax = plt.subplots()
    hds.sel(layer=4).isel(time=3).plot(ax=ax)



.. image-sg:: /examples/mf6/images/sphx_glr_hondsrug_008.png
   :alt: dx = 25.0, dy = -25.0, layer = 4, time = 1.096e+03
   :srcset: /examples/mf6/images/sphx_glr_hondsrug_008.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.collections.QuadMesh object at 0x0000019B2421A600>



.. GENERATED FROM PYTHON SOURCE LINES 646-648

Layer 5 contains more data towards the west,
but has no active cells in the centre.

.. GENERATED FROM PYTHON SOURCE LINES 648-651

.. code-block:: Python

    fig, ax = plt.subplots()
    hds.sel(layer=5).isel(time=3).plot(ax=ax)




.. image-sg:: /examples/mf6/images/sphx_glr_hondsrug_009.png
   :alt: dx = 25.0, dy = -25.0, layer = 5, time = 1.096e+03
   :srcset: /examples/mf6/images/sphx_glr_hondsrug_009.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.collections.QuadMesh object at 0x0000019B35969430>



.. GENERATED FROM PYTHON SOURCE LINES 652-663

As you can see the data is individual layers
have lots of inactive in different places.

It is difficult for this model to get a good idea
what is happening across the area based on 1 layer alone.
Luckily xarray allows us to compute the mean across a selection
of layers and plot this.

By first selecting 3 layers with ``sel```,
and then computing the mean across the layer dimension
with ``mean(dim="layer")``.

.. GENERATED FROM PYTHON SOURCE LINES 663-667

.. code-block:: Python


    fig, ax = plt.subplots()
    hds.sel(layer=slice(3, 5)).mean(dim="layer").isel(time=3).plot(ax=ax)




.. image-sg:: /examples/mf6/images/sphx_glr_hondsrug_010.png
   :alt: dx = 25.0, dy = -25.0, time = 1.096e+03
   :srcset: /examples/mf6/images/sphx_glr_hondsrug_010.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.collections.QuadMesh object at 0x0000019B24218AD0>



.. GENERATED FROM PYTHON SOURCE LINES 668-674

Assign dates to head
--------------------

MODFLOW 6 has no concept of a calendar, so the output is not labelled only
in terms of "time since start" in floating point numbers. For this model
the time unit is days and we can assign a date coordinate as follows:

.. GENERATED FROM PYTHON SOURCE LINES 674-679

.. code-block:: Python


    starttime = pd.to_datetime("2000-01-01")
    timedelta = pd.to_timedelta(hds["time"], "D")
    hds = hds.assign_coords(time=starttime + timedelta)








.. GENERATED FROM PYTHON SOURCE LINES 680-686

Extract head at points
----------------------

A typical operation is to extract simulated heads at point locations to
compare them with measurements. In this example, we select the heads at
two points:

.. GENERATED FROM PYTHON SOURCE LINES 686-691

.. code-block:: Python


    x = [240_000.0, 244_000.0]
    y = [560_000.0, 562_000.0]
    selection = imod.select.points_values(hds, x=x, y=y)








.. GENERATED FROM PYTHON SOURCE LINES 692-694

The result can be converted into a pandas dataframe for timeseries analysis,
or written to a variety of tabular file formats.

.. GENERATED FROM PYTHON SOURCE LINES 694-698

.. code-block:: Python


    dataframe = selection.to_dataframe().reset_index()
    dataframe = dataframe.rename(columns={"index": "id"})
    dataframe





.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>time</th>
          <th>layer</th>
          <th>id</th>
          <th>x</th>
          <th>y</th>
          <th>dx</th>
          <th>dy</th>
          <th>head</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>2000-01-01 00:00:01.000000002</td>
          <td>1</td>
          <td>0</td>
          <td>240012.5</td>
          <td>560012.5</td>
          <td>25.0</td>
          <td>-25.0</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>1</th>
          <td>2000-01-01 00:00:01.000000002</td>
          <td>1</td>
          <td>1</td>
          <td>244012.5</td>
          <td>562012.5</td>
          <td>25.0</td>
          <td>-25.0</td>
          <td>10.534013</td>
        </tr>
        <tr>
          <th>2</th>
          <td>2000-01-01 00:00:01.000000002</td>
          <td>2</td>
          <td>0</td>
          <td>240012.5</td>
          <td>560012.5</td>
          <td>25.0</td>
          <td>-25.0</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>3</th>
          <td>2000-01-01 00:00:01.000000002</td>
          <td>2</td>
          <td>1</td>
          <td>244012.5</td>
          <td>562012.5</td>
          <td>25.0</td>
          <td>-25.0</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>4</th>
          <td>2000-01-01 00:00:01.000000002</td>
          <td>3</td>
          <td>0</td>
          <td>240012.5</td>
          <td>560012.5</td>
          <td>25.0</td>
          <td>-25.0</td>
          <td>7.682111</td>
        </tr>
        <tr>
          <th>...</th>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
        <tr>
          <th>177</th>
          <td>2005-12-31 00:00:01.000000002</td>
          <td>11</td>
          <td>1</td>
          <td>244012.5</td>
          <td>562012.5</td>
          <td>25.0</td>
          <td>-25.0</td>
          <td>4.787419</td>
        </tr>
        <tr>
          <th>178</th>
          <td>2005-12-31 00:00:01.000000002</td>
          <td>12</td>
          <td>0</td>
          <td>240012.5</td>
          <td>560012.5</td>
          <td>25.0</td>
          <td>-25.0</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>179</th>
          <td>2005-12-31 00:00:01.000000002</td>
          <td>12</td>
          <td>1</td>
          <td>244012.5</td>
          <td>562012.5</td>
          <td>25.0</td>
          <td>-25.0</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>180</th>
          <td>2005-12-31 00:00:01.000000002</td>
          <td>13</td>
          <td>0</td>
          <td>240012.5</td>
          <td>560012.5</td>
          <td>25.0</td>
          <td>-25.0</td>
          <td>7.498579</td>
        </tr>
        <tr>
          <th>181</th>
          <td>2005-12-31 00:00:01.000000002</td>
          <td>13</td>
          <td>1</td>
          <td>244012.5</td>
          <td>562012.5</td>
          <td>25.0</td>
          <td>-25.0</td>
          <td>4.787407</td>
        </tr>
      </tbody>
    </table>
    <p>182 rows Ã— 8 columns</p>
    </div>
    </div>
    <br />
    <br />


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (2 minutes 25.441 seconds)


.. _sphx_glr_download_examples_mf6_hondsrug.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: hondsrug.ipynb <hondsrug.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: hondsrug.py <hondsrug.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: hondsrug.zip <hondsrug.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
