
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples\mf6\hondsrug.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_examples_mf6_hondsrug.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_mf6_hondsrug.py:


Regional model
==============

This example shows a simplified script for building a groundwater model in the
northeast of the Netherlands. A primary feature of this area is an ice-pushed
ridge called the Hondsrug. This examples demonstrates modifying external data
for use in a MODFLOW6 model.

In overview, the model features:

    * Thirteen layers: seven aquifers and six aquitards;
    * A dense ditch network in the east;
    * Pipe drainage for agriculture;
    * Precipitation and evapotranspiration.

.. GENERATED FROM PYTHON SOURCE LINES 18-20

.. code-block:: Python
   :dedent: 1










.. GENERATED FROM PYTHON SOURCE LINES 22-23

We'll start with the usual imports, and an import from scipy.

.. GENERATED FROM PYTHON SOURCE LINES 23-32

.. code-block:: Python


    import matplotlib.pyplot as plt
    import numpy as np
    import pandas as pd
    import scipy.ndimage
    import xarray as xr

    import imod








.. GENERATED FROM PYTHON SOURCE LINES 33-37

Before starting to create the input data, we will create the groundwater
model variable (gwf_model) using `imod.mf6.GroundwaterFlowModel
<https://deltares.gitlab.io/imod/imod-python/api/mf6.html?highlight=groundwater%20flow%20model#imod.mf6.GroundwaterFlowModel>`_.
The data from all the model packages will be added to this variable.

.. GENERATED FROM PYTHON SOURCE LINES 37-40

.. code-block:: Python


    gwf_model = imod.mf6.GroundwaterFlowModel()








.. GENERATED FROM PYTHON SOURCE LINES 41-48

This package allows specifying a regular MODFLOW grid. This grid is assumed
to be rectangular horizontally, but can be distorted vertically.

Load data
---------

We'll load the data from the examples that come with this package.

.. GENERATED FROM PYTHON SOURCE LINES 48-62

.. code-block:: Python


    layermodel = imod.data.hondsrug_layermodel()

    # Make sure that the idomain is provided as integers
    idomain = layermodel["idomain"].astype(int)

    # We only need to provide the data for the top as a 2D array. Modflow 6 will
    # compare the top against the uppermost active bottom cell.
    top = layermodel["top"].max(dim="layer")

    bot = layermodel["bottom"]

    top.plot.imshow()




.. image-sg:: /examples/mf6/images/sphx_glr_hondsrug_001.png
   :alt: dx = 25.0, dy = -25.0
   :srcset: /examples/mf6/images/sphx_glr_hondsrug_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.image.AxesImage object at 0x0000014B2F316DD0>



.. GENERATED FROM PYTHON SOURCE LINES 63-74

Adding information to the DIS package
-------------------------------------

The following step is to add the previously created discretization data to
the gwf_model variable.  This is done using the function
`imod.mf6.StructuredDiscretization
<https://deltares.gitlab.io/imod/imod-python/api/mf6.html?highlight=structured%20discretization#imod.mf6.StructuredDiscretization>`_.
The data to include is the top of the model domain, the bottom of the layers,
and the idomain. All this information comes from the previously imported
tifs (now converted to `xarray.DataArray
<http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray>`_.

.. GENERATED FROM PYTHON SOURCE LINES 74-79

.. code-block:: Python


    gwf_model["dis"] = imod.mf6.StructuredDiscretization(
        top=top, bottom=bot, idomain=idomain
    )








.. GENERATED FROM PYTHON SOURCE LINES 80-90

Node property flow package - NPF
=================================

This package contains the information related to the aquifer properties used to calculate
hydraulic conductance. This package replaces the Layer Property Flow (LPF),
Block-Centered Flow (BCF), and Upstream Weighting (UPW) packages from previous MODFLOW versions.

Hydraulic conductivity
----------------------


.. GENERATED FROM PYTHON SOURCE LINES 90-92

.. code-block:: Python

    k = layermodel["k"]








.. GENERATED FROM PYTHON SOURCE LINES 93-119

icelltype
----------

The cell type to be used in the model (confined or convertible) can be
defined under ICELLTYPE, which is an input to the NPF package.  ICELLTYPE ==
0: *Confined cell* - Constant transmissivity ICELLTYPE != 0: *Convertible
cell* - Transmissivity varies depending on the calculated head in the cell
(based on the saturated cell thickness)

In this example, all layers have a ICELLTYPE equal to 0, indicating confined
cells.  This is defined in the following section.

Adding information to the NPF package
--------------------------------------

The information for the NPF package is added to the gwf_model variable using
`imod.mf6.NodePropertyFlow
<https://deltares.gitlab.io/imod/imod-python/api/mf6.html?highlight=structured%20discretization#imod.mf6.NodePropertyFlow>`_.
The information included is the icelltype value (equal to zero), the array
for  the hydraulic conductivity (considered to be the same for the horizontal
and vertical direction) and, optionally, the
variable_vertical_conductance, dewatered, perched and save_flows options have
been activated.  For more details about the meaning of these variables and
other variables available to be used within this package, please refer to the
`documentation
<https://deltares.gitlab.io/imod/imod-python/api/mf6.html?highlight=structured%20discretization#imod.mf6.NodePropertyFlow>`_.

.. GENERATED FROM PYTHON SOURCE LINES 119-130

.. code-block:: Python


    gwf_model["npf"] = imod.mf6.NodePropertyFlow(
        icelltype=0,
        k=k,
        k33=k,
        variable_vertical_conductance=True,
        dewatered=True,
        perched=True,
        save_flows=True,
    )








.. GENERATED FROM PYTHON SOURCE LINES 131-145

Initial conditions package - IC
================================

This package reads the starting heads for a simulation.

Starting heads interpolation
----------------------------

The starting heads to be used in this model are based on the interpolation of
x-y head measurements, which were interpolated on a larger area.  This
example was created in this example --insert-link-here--

The heads were interpolated on a larger area, therefore these have to be
clipped first

.. GENERATED FROM PYTHON SOURCE LINES 145-162

.. code-block:: Python


    initial = imod.data.hondsrug_initial()
    interpolated_head_larger = initial["head"]

    xmin = 237_500.0
    xmax = 250_000.0
    ymin = 559_000.0
    ymax = 564_000.0

    interpolated_head = interpolated_head_larger.sel(
        x=slice(xmin, xmax), y=slice(ymax, ymin)
    )

    # Plotting the clipped interpolation
    fig, ax = plt.subplots()
    interpolated_head.plot.imshow(ax=ax)




.. image-sg:: /examples/mf6/images/sphx_glr_hondsrug_002.png
   :alt: dx = 25.0, dy = -25.0
   :srcset: /examples/mf6/images/sphx_glr_hondsrug_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.image.AxesImage object at 0x0000014B2AD02950>



.. GENERATED FROM PYTHON SOURCE LINES 163-172

The final step is to assign the 2D heads interpolation to all the
model layers (as a reference value) by using the xarray tool
`xarray.full_like <http://xarray.pydata.org/en/stable/generated/xarray.full_like.html#xarray.full_like>`_.
The 3d idomain array is used as reference for the geometry and then
its original values are replaced by NaNs.
This array is combined with the interpolated_head array using the xarray
`DataArray.combine_first <http://xarray.pydata.org/en/stable/generated/xarray.DataArray.combine_first.html#xarray.DataArray.combine_first>`_
option.
The final result is an starting_heads xarray where all layers have the 2d interpolated_head information.

.. GENERATED FROM PYTHON SOURCE LINES 172-181

.. code-block:: Python


    # Assign interpolated head values to all the model layers
    like_3d = xr.full_like(idomain, np.nan, dtype=float)
    starting_head = like_3d.combine_first(interpolated_head)
    # Consequently ensure no data is specified in inactive cells:
    starting_head = starting_head.where(idomain == 1)

    starting_head






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 20px 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: none;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;idomain&#x27; (layer: 13, y: 200, x: 500)&gt;
    array([[[       nan,        nan,        nan, ..., 1.27008811,
             1.27823924, 1.28676046],
            [       nan,        nan,        nan, ..., 1.26336139,
             1.27183901, 1.28070347],
            [       nan,        nan,        nan, ..., 1.25620192,
             1.26504986, 1.27431479],
            ...,
            [7.28608515, 7.26550211, 7.24273429, ...,        nan,
                    nan,        nan],
            [7.2907364 , 7.26985601, 7.24672249, ...,        nan,
                    nan,        nan],
            [7.29728577, 7.27649525, 7.25355321, ...,        nan,
                    nan,        nan]],

           [[       nan,        nan,        nan, ...,        nan,
                    nan,        nan],
            [       nan,        nan,        nan, ...,        nan,
                    nan,        nan],
            [       nan,        nan,        nan, ...,        nan,
                    nan,        nan],
    ...
            [       nan,        nan,        nan, ...,        nan,
                    nan,        nan],
            [       nan,        nan,        nan, ...,        nan,
                    nan,        nan],
            [       nan,        nan,        nan, ...,        nan,
                    nan,        nan]],

           [[5.6706604 , 5.65319374, 5.63573351, ..., 1.27008811,
             1.27823924, 1.28676046],
            [5.67764711, 5.66021213, 5.64275829, ..., 1.26336139,
             1.27183901, 1.28070347],
            [5.68462064, 5.66720984, 5.64976361, ..., 1.25620192,
             1.26504986, 1.27431479],
            ...,
            [7.28608515, 7.26550211, 7.24273429, ..., 4.67051889,
             4.66997651, 4.66944365],
            [7.2907364 , 7.26985601, 7.24672249, ..., 4.70303061,
             4.70234778, 4.70168152],
            [7.29728577, 7.27649525, 7.25355321, ..., 4.73551559,
             4.73469247, 4.73389453]]])
    Coordinates:
      * x        (x) float64 2.375e+05 2.375e+05 2.376e+05 ... 2.5e+05 2.5e+05
      * y        (y) float64 5.64e+05 5.64e+05 5.639e+05 ... 5.59e+05 5.59e+05
        dx       float64 25.0
        dy       float64 -25.0
      * layer    (layer) int32 1 2 3 4 5 6 7 8 9 10 11 12 13</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'idomain'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>layer</span>: 13</li><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>x</span>: 500</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-7d29c750-b0c0-47e9-9455-98ba466d1b88' class='xr-array-in' type='checkbox' checked><label for='section-7d29c750-b0c0-47e9-9455-98ba466d1b88' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>nan nan nan nan nan nan nan ... 4.738 4.737 4.736 4.736 4.735 4.734</span></div><div class='xr-array-data'><pre>array([[[       nan,        nan,        nan, ..., 1.27008811,
             1.27823924, 1.28676046],
            [       nan,        nan,        nan, ..., 1.26336139,
             1.27183901, 1.28070347],
            [       nan,        nan,        nan, ..., 1.25620192,
             1.26504986, 1.27431479],
            ...,
            [7.28608515, 7.26550211, 7.24273429, ...,        nan,
                    nan,        nan],
            [7.2907364 , 7.26985601, 7.24672249, ...,        nan,
                    nan,        nan],
            [7.29728577, 7.27649525, 7.25355321, ...,        nan,
                    nan,        nan]],

           [[       nan,        nan,        nan, ...,        nan,
                    nan,        nan],
            [       nan,        nan,        nan, ...,        nan,
                    nan,        nan],
            [       nan,        nan,        nan, ...,        nan,
                    nan,        nan],
    ...
            [       nan,        nan,        nan, ...,        nan,
                    nan,        nan],
            [       nan,        nan,        nan, ...,        nan,
                    nan,        nan],
            [       nan,        nan,        nan, ...,        nan,
                    nan,        nan]],

           [[5.6706604 , 5.65319374, 5.63573351, ..., 1.27008811,
             1.27823924, 1.28676046],
            [5.67764711, 5.66021213, 5.64275829, ..., 1.26336139,
             1.27183901, 1.28070347],
            [5.68462064, 5.66720984, 5.64976361, ..., 1.25620192,
             1.26504986, 1.27431479],
            ...,
            [7.28608515, 7.26550211, 7.24273429, ..., 4.67051889,
             4.66997651, 4.66944365],
            [7.2907364 , 7.26985601, 7.24672249, ..., 4.70303061,
             4.70234778, 4.70168152],
            [7.29728577, 7.27649525, 7.25355321, ..., 4.73551559,
             4.73469247, 4.73389453]]])</pre></div></div></li><li class='xr-section-item'><input id='section-2166d6dd-20b0-4ff6-9054-41624d907ce7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-2166d6dd-20b0-4ff6-9054-41624d907ce7' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-49af1edf-7290-4792-9ef4-f21a3828abe4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-49af1edf-7290-4792-9ef4-f21a3828abe4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-37a4c758-968e-46c9-ad91-1b2ec2e26f34' class='xr-var-data-in' type='checkbox'><label for='data-37a4c758-968e-46c9-ad91-1b2ec2e26f34' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-3f6839ff-17d9-49f0-afbe-ba96d21978c5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3f6839ff-17d9-49f0-afbe-ba96d21978c5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bf5e2210-bf3f-4041-a9b7-317b4ec7386e' class='xr-var-data-in' type='checkbox'><label for='data-bf5e2210-bf3f-4041-a9b7-317b4ec7386e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
           563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
           563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
           563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
           563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
           563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
           562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
           562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
           562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
           562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
           562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
           562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
           561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
           561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
           561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
           561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
           561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
           561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
           560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
           560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
           560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
           560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
           560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
           559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
           559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
           559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
           559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
           559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
           559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>25.0</div><input id='attrs-7b71ae27-7f62-4140-998c-da0e158f8ac0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7b71ae27-7f62-4140-998c-da0e158f8ac0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f19f2194-a466-4876-829e-83276973ad81' class='xr-var-data-in' type='checkbox'><label for='data-f19f2194-a466-4876-829e-83276973ad81' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-25.0</div><input id='attrs-c8199de3-c209-4e9c-9c17-b9c9f988edc6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c8199de3-c209-4e9c-9c17-b9c9f988edc6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7c1496e2-5dde-4f1c-8228-1b2415d2b52a' class='xr-var-data-in' type='checkbox'><label for='data-7c1496e2-5dde-4f1c-8228-1b2415d2b52a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12 13</div><input id='attrs-cac296c3-1534-4cd3-856c-7b17ed37bda0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cac296c3-1534-4cd3-856c-7b17ed37bda0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4e175305-0ae8-4a8c-8e77-050a354b24fb' class='xr-var-data-in' type='checkbox'><label for='data-4e175305-0ae8-4a8c-8e77-050a354b24fb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d1d4849f-bce9-4ad6-8ace-886ecd7e9684' class='xr-section-summary-in' type='checkbox'  ><label for='section-d1d4849f-bce9-4ad6-8ace-886ecd7e9684' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-b94bd6cd-0ff1-4295-a5d9-9a9e4093cf11' class='xr-index-data-in' type='checkbox'/><label for='index-b94bd6cd-0ff1-4295-a5d9-9a9e4093cf11' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([237512.5, 237537.5, 237562.5, 237587.5, 237612.5, 237637.5,
                  237662.5, 237687.5, 237712.5, 237737.5,
                  ...
                  249762.5, 249787.5, 249812.5, 249837.5, 249862.5, 249887.5,
                  249912.5, 249937.5, 249962.5, 249987.5],
                 dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=500))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d453491e-c109-47bc-8920-85d9d5c751fd' class='xr-index-data-in' type='checkbox'/><label for='index-d453491e-c109-47bc-8920-85d9d5c751fd' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5,
                  563837.5, 563812.5, 563787.5, 563762.5,
                  ...
                  559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
                  559087.5, 559062.5, 559037.5, 559012.5],
                 dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=200))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>layer</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-fb9e880e-b635-46c8-80ad-2456e6cd1435' class='xr-index-data-in' type='checkbox'/><label for='index-fb9e880e-b635-46c8-80ad-2456e6cd1435' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Int64Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], dtype=&#x27;int64&#x27;, name=&#x27;layer&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-fbe0f53a-f0ec-4f5e-9b33-583cc1103f75' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-fbe0f53a-f0ec-4f5e-9b33-583cc1103f75' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 182-190

Adding information to the IC package
------------------------------------

The function for indicating the initial conditions is
`imod.mf6.InitialConditions <https://deltares.gitlab.io/imod/imod-python/api/mf6.html?highlight=structured%20discretization#imod.mf6.InitialConditions>`_.
It is necessary to indicate the value(s) to be considered as the initial
(starting) head of the simulation.
In this case, this value is equal to the previously created starting_head array.

.. GENERATED FROM PYTHON SOURCE LINES 190-193

.. code-block:: Python


    gwf_model["ic"] = imod.mf6.InitialConditions(starting_head)








.. GENERATED FROM PYTHON SOURCE LINES 194-207

Constant head package - CHD
===========================

This package allows to indicate if the head varies with time,
if it is constant or if it is inactive.

Constant head edge
-------------------

The previously interpolated starting_head array will be used to define
the constant head value which will be used along the model boundaries.
A function is defined to indicate the location of the outer edge
(returning a boolean array).

.. GENERATED FROM PYTHON SOURCE LINES 207-216

.. code-block:: Python



    def outer_edge(da):
        data = da.copy()
        from_edge = scipy.ndimage.binary_erosion(data)
        is_edge = (data == 1) & (from_edge == 0)
        return is_edge.astype(bool)









.. GENERATED FROM PYTHON SOURCE LINES 217-221

For the next calculations, it is necessary to create a template array
which can be used for assigning the corresponding geometry to other arrays.
In this case, a 2d template is created based on the idomain layer information
and filled with ones.

.. GENERATED FROM PYTHON SOURCE LINES 221-225

.. code-block:: Python


    like_2d = xr.full_like(idomain.isel(layer=0), 1)
    like_2d






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 20px 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: none;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;idomain&#x27; (y: 200, x: 500)&gt;
    array([[1, 1, 1, ..., 1, 1, 1],
           [1, 1, 1, ..., 1, 1, 1],
           [1, 1, 1, ..., 1, 1, 1],
           ...,
           [1, 1, 1, ..., 1, 1, 1],
           [1, 1, 1, ..., 1, 1, 1],
           [1, 1, 1, ..., 1, 1, 1]])
    Coordinates:
      * x        (x) float64 2.375e+05 2.375e+05 2.376e+05 ... 2.5e+05 2.5e+05
      * y        (y) float64 5.64e+05 5.64e+05 5.639e+05 ... 5.59e+05 5.59e+05
        dx       float64 ...
        dy       float64 ...
        layer    int32 1</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'idomain'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>x</span>: 500</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-d3f9aa75-04e7-4415-b1be-7e274c53740e' class='xr-array-in' type='checkbox' checked><label for='section-d3f9aa75-04e7-4415-b1be-7e274c53740e' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 ... 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></div><div class='xr-array-data'><pre>array([[1, 1, 1, ..., 1, 1, 1],
           [1, 1, 1, ..., 1, 1, 1],
           [1, 1, 1, ..., 1, 1, 1],
           ...,
           [1, 1, 1, ..., 1, 1, 1],
           [1, 1, 1, ..., 1, 1, 1],
           [1, 1, 1, ..., 1, 1, 1]])</pre></div></div></li><li class='xr-section-item'><input id='section-a03e91b3-b5b5-4ad8-947a-cf9c4d3c233e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a03e91b3-b5b5-4ad8-947a-cf9c4d3c233e' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-7ef75807-3ed1-46e8-83f4-1de796905627' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7ef75807-3ed1-46e8-83f4-1de796905627' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-53f1ac4b-433c-4730-a6c5-1bf07a6553f2' class='xr-var-data-in' type='checkbox'><label for='data-53f1ac4b-433c-4730-a6c5-1bf07a6553f2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-c4ff1a30-1a00-4953-aa67-2d75fa7dba2e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c4ff1a30-1a00-4953-aa67-2d75fa7dba2e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4cf3885c-d2ef-4dde-bbb3-f8278c8507c2' class='xr-var-data-in' type='checkbox'><label for='data-4cf3885c-d2ef-4dde-bbb3-f8278c8507c2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
           563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
           563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
           563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
           563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
           563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
           562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
           562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
           562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
           562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
           562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
           562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
           561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
           561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
           561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
           561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
           561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
           561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
           560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
           560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
           560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
           560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
           560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
           559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
           559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
           559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
           559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
           559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
           559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-01cc490c-630e-4e77-a437-6b44f8118177' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-01cc490c-630e-4e77-a437-6b44f8118177' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-58040026-7794-4a96-a294-f854add78c34' class='xr-var-data-in' type='checkbox'><label for='data-58040026-7794-4a96-a294-f854add78c34' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-dd02d284-0344-40c3-ab0e-bc57eae10da1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-dd02d284-0344-40c3-ab0e-bc57eae10da1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-803d3683-94e5-427d-ac8b-05b1d75f27ae' class='xr-var-data-in' type='checkbox'><label for='data-803d3683-94e5-427d-ac8b-05b1d75f27ae' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>layer</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1</div><input id='attrs-96264af7-7a16-4b26-aa46-f0bcde64492b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-96264af7-7a16-4b26-aa46-f0bcde64492b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-14902e99-53e2-4dab-b339-cdb5deff44a8' class='xr-var-data-in' type='checkbox'><label for='data-14902e99-53e2-4dab-b339-cdb5deff44a8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-eb2134fe-be23-4ce2-bfe5-4874fbaf2663' class='xr-section-summary-in' type='checkbox'  ><label for='section-eb2134fe-be23-4ce2-bfe5-4874fbaf2663' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-cf354ff9-d27a-4c32-8357-6b6154b96ab4' class='xr-index-data-in' type='checkbox'/><label for='index-cf354ff9-d27a-4c32-8357-6b6154b96ab4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([237512.5, 237537.5, 237562.5, 237587.5, 237612.5, 237637.5,
                  237662.5, 237687.5, 237712.5, 237737.5,
                  ...
                  249762.5, 249787.5, 249812.5, 249837.5, 249862.5, 249887.5,
                  249912.5, 249937.5, 249962.5, 249987.5],
                 dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=500))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-f191d50c-79c7-43a2-a424-d324e4e3cd2c' class='xr-index-data-in' type='checkbox'/><label for='index-f191d50c-79c7-43a2-a424-d324e4e3cd2c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5,
                  563837.5, 563812.5, 563787.5, 563762.5,
                  ...
                  559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
                  559087.5, 559062.5, 559037.5, 559012.5],
                 dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=200))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d4740c6c-638b-40c8-9c80-f05d6874aa50' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d4740c6c-638b-40c8-9c80-f05d6874aa50' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 226-228

Using the previously created function and the 2d template,
the outer edge is defined for this example.

.. GENERATED FROM PYTHON SOURCE LINES 228-231

.. code-block:: Python


    edge = outer_edge(xr.full_like(like_2d.drop_vars("layer"), 1))








.. GENERATED FROM PYTHON SOURCE LINES 232-249

Adding information to the CHD package
--------------------------------------

To add the information to the CHD package within the gwf_model variable, the
`imod.mf6.ConstantHead <https://deltares.gitlab.io/imod/imod-python/api/mf6.html?highlight=structured%20discretization#imod.mf6.ConstantHead>`_
function is used.
The required information is the head array for this boundary condition.
In this example, the starting_head array is selected where the idomain is > 0 (active)
and it is located in the edge array.

It is also possible (and optional) to indicate if the CHD information will be written
to the listing file after it is read (print_input), if the constant head flow rates will
be printed to the listing file for every stress period time step
in which “BUDGET PRINT” is specified in Output Control (print_flows)
and if the constant head flow terms will be written to the file
specified with “BUDGET FILEOUT” in Output Control (save_flows).
By default, these three options are set to False.

.. GENERATED FROM PYTHON SOURCE LINES 249-257

.. code-block:: Python


    gwf_model["chd"] = imod.mf6.ConstantHead(
        starting_head.where((idomain > 0) & edge),
        print_input=False,
        print_flows=True,
        save_flows=True,
    )








.. GENERATED FROM PYTHON SOURCE LINES 258-271

Recharge
========

This package is used to represent areally distributed recharge to the groundwater system.
To calculate the recharge, the precipitation and evapotranspiration
information from the KNMI website has been downloaded for the study area.
This information is saved in netCDF files, which have been imported using the
xarray function
`xr.open_dataset <http://xarray.pydata.org/en/stable/generated/xarray.open_dataset.html#xarray.open_dataset>`_,
slicing the area to the model's miminum and maximum dimensions.

Note that the meteorological data has mm/d as unit and
this has to be converted to m/d for Modflow 6.

.. GENERATED FROM PYTHON SOURCE LINES 272-285

.. code-block:: Python


    xmin = 230_000.0
    xmax = 257_000.0
    ymin = 550_000.0
    ymax = 567_000.0

    meteorology = imod.data.hondsrug_meteorology()
    pp = meteorology["precipitation"]
    evt = meteorology["evapotranspiration"]

    pp = pp.sel(x=slice(xmin, xmax), y=slice(ymax, ymin)) / 1000.0  # from mm/d to m/d
    evt = evt.sel(x=slice(xmin, xmax), y=slice(ymax, ymin)) / 1000.0  # from mm/d to m/d








.. GENERATED FROM PYTHON SOURCE LINES 286-296

Recharge - Steady state
-----------------------

For the steady state conditions of the model,
the data from the period 2000 to 2009 was considered as reference.
The initial information was sliced to this time period and averaged
to obtain the a mean value grid. This process was done for both
precipitation and evapotranspiration datasets.

**Precipitation**

.. GENERATED FROM PYTHON SOURCE LINES 296-302

.. code-block:: Python

    pp_ss = pp.sel(time=slice("2000-01-01", "2009-12-31"))
    pp_ss_mean = pp_ss.mean(dim="time")

    fig, ax = plt.subplots()
    pp_ss_mean.plot(ax=ax)




.. image-sg:: /examples/mf6/images/sphx_glr_hondsrug_003.png
   :alt: dx = 1e+03, dy = -1e+03
   :srcset: /examples/mf6/images/sphx_glr_hondsrug_003.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.collections.QuadMesh object at 0x0000014B26EEB430>



.. GENERATED FROM PYTHON SOURCE LINES 303-304

**Evapotranspiration**

.. GENERATED FROM PYTHON SOURCE LINES 304-310

.. code-block:: Python

    evt_ss = evt.sel(time=slice("2000-01-01", "2009-12-31"))
    evt_ss_mean = evt_ss.mean(dim="time")

    fig, ax = plt.subplots()
    evt_ss_mean.plot(ax=ax)




.. image-sg:: /examples/mf6/images/sphx_glr_hondsrug_004.png
   :alt: dx = 1e+03, dy = -1e+03
   :srcset: /examples/mf6/images/sphx_glr_hondsrug_004.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.collections.QuadMesh object at 0x0000014B2C52DE40>



.. GENERATED FROM PYTHON SOURCE LINES 311-313

For the recharge calculation, a first estimate
is the difference between the precipitation and evapotranspiration values.

.. GENERATED FROM PYTHON SOURCE LINES 313-319

.. code-block:: Python


    rch_ss = pp_ss_mean - evt_ss_mean

    fig, ax = plt.subplots()
    rch_ss.plot.imshow(ax=ax)




.. image-sg:: /examples/mf6/images/sphx_glr_hondsrug_005.png
   :alt: dx = 1e+03, dy = -1e+03
   :srcset: /examples/mf6/images/sphx_glr_hondsrug_005.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.image.AxesImage object at 0x0000014B2F8188B0>



.. GENERATED FROM PYTHON SOURCE LINES 320-325

Recharge - Transient
--------------------

The transient model will encompass the period from 2010 to 2015.
The initial pp and evt datasets have been sliced to this time frame.

.. GENERATED FROM PYTHON SOURCE LINES 325-329

.. code-block:: Python


    pp_trans = pp.sel(time=slice("2010-01-01", "2015-12-31"))
    evt_trans = evt.sel(time=slice("2010-01-01", "2015-12-31"))








.. GENERATED FROM PYTHON SOURCE LINES 330-334

As previously done, it is assumed that the recharge is equal
to the difference between precipitation and evapotranspiration as a first estimate.
Furthermore, the negative values found after doing this calculation have been
replaced by zeros, as the recharge should not have a negative value.

.. GENERATED FROM PYTHON SOURCE LINES 334-338

.. code-block:: Python


    rch_trans = pp_trans - evt_trans
    rch_trans = rch_trans.where(rch_trans > 0, 0)  # check negative values








.. GENERATED FROM PYTHON SOURCE LINES 339-342

The original information is on a daily step, so it is going to be
resampled to a yearly step by using the xarray function
`Dataset.resample <http://xarray.pydata.org/en/stable/generated/xarray.Dataset.resample.html#xarray.Dataset.resample>`_.

.. GENERATED FROM PYTHON SOURCE LINES 342-346

.. code-block:: Python


    rch_trans_yr = rch_trans.resample(time="A", label="left").mean()
    rch_trans_yr






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 20px 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: none;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (time: 6, y: 17, x: 27)&gt;
    array([[[0.00191725, 0.00191589, 0.00191248, ..., 0.00158879,
             0.00160275, 0.00161772],
            [0.00193096, 0.00193016, 0.0019277 , ..., 0.00159777,
             0.00160856, 0.00162071],
            [0.00194592, 0.00194606, 0.00194384, ..., 0.00160863,
             0.00161658, 0.0016263 ],
            ...,
            [0.00205102, 0.0020491 , 0.00204451, ..., 0.00175834,
             0.00175477, 0.00175247],
            [0.0020481 , 0.00204493, 0.00203995, ..., 0.00177083,
             0.0017666 , 0.00176362],
            [0.00204444, 0.002041  , 0.00203658, ..., 0.00178251,
             0.00177807, 0.00177411]],

           [[0.00175232, 0.0017549 , 0.00175632, ..., 0.00160428,
             0.0016166 , 0.00163142],
            [0.00175832, 0.00176321, 0.00176716, ..., 0.00161909,
             0.00162744, 0.00163787],
            [0.00176593, 0.00177297, 0.00177865, ..., 0.00163613,
             0.00164029, 0.00164618],
    ...
            [0.00190413, 0.0019    , 0.00189647, ..., 0.00168478,
             0.00167463, 0.00166721],
            [0.00191761, 0.00191336, 0.00190866, ..., 0.00169624,
             0.00168655, 0.0016792 ],
            [0.0019308 , 0.00192603, 0.0019212 , ..., 0.00170712,
             0.00169771, 0.00169032]],

           [[0.00226806, 0.00225167, 0.00223808, ..., 0.00221006,
             0.00219559, 0.00218172],
            [0.0022924 , 0.00227892, 0.00226807, ..., 0.00220936,
             0.00219364, 0.00217812],
            [0.00231699, 0.00230603, 0.00229702, ..., 0.00221065,
             0.0021932 , 0.00217596],
            ...,
            [0.00249076, 0.00248442, 0.00247622, ..., 0.00224485,
             0.00222806, 0.00221361],
            [0.00249192, 0.00248449, 0.00247561, ..., 0.00224585,
             0.00223096, 0.00221743],
            [0.00249155, 0.00248376, 0.00247603, ..., 0.00224736,
             0.00223372, 0.00222133]]], dtype=float32)
    Coordinates:
      * x        (x) float64 2.305e+05 2.315e+05 2.325e+05 ... 2.555e+05 2.565e+05
      * y        (y) float64 5.665e+05 5.655e+05 5.645e+05 ... 5.515e+05 5.505e+05
        dx       float64 1e+03
        dy       float64 -1e+03
      * time     (time) datetime64[ns] 2009-12-31 2010-12-31 ... 2014-12-31</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 6</li><li><span class='xr-has-index'>y</span>: 17</li><li><span class='xr-has-index'>x</span>: 27</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-5375295b-e679-450f-be80-642cd9a908d9' class='xr-array-in' type='checkbox' checked><label for='section-5375295b-e679-450f-be80-642cd9a908d9' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.001917 0.001916 0.001912 0.001907 ... 0.002247 0.002234 0.002221</span></div><div class='xr-array-data'><pre>array([[[0.00191725, 0.00191589, 0.00191248, ..., 0.00158879,
             0.00160275, 0.00161772],
            [0.00193096, 0.00193016, 0.0019277 , ..., 0.00159777,
             0.00160856, 0.00162071],
            [0.00194592, 0.00194606, 0.00194384, ..., 0.00160863,
             0.00161658, 0.0016263 ],
            ...,
            [0.00205102, 0.0020491 , 0.00204451, ..., 0.00175834,
             0.00175477, 0.00175247],
            [0.0020481 , 0.00204493, 0.00203995, ..., 0.00177083,
             0.0017666 , 0.00176362],
            [0.00204444, 0.002041  , 0.00203658, ..., 0.00178251,
             0.00177807, 0.00177411]],

           [[0.00175232, 0.0017549 , 0.00175632, ..., 0.00160428,
             0.0016166 , 0.00163142],
            [0.00175832, 0.00176321, 0.00176716, ..., 0.00161909,
             0.00162744, 0.00163787],
            [0.00176593, 0.00177297, 0.00177865, ..., 0.00163613,
             0.00164029, 0.00164618],
    ...
            [0.00190413, 0.0019    , 0.00189647, ..., 0.00168478,
             0.00167463, 0.00166721],
            [0.00191761, 0.00191336, 0.00190866, ..., 0.00169624,
             0.00168655, 0.0016792 ],
            [0.0019308 , 0.00192603, 0.0019212 , ..., 0.00170712,
             0.00169771, 0.00169032]],

           [[0.00226806, 0.00225167, 0.00223808, ..., 0.00221006,
             0.00219559, 0.00218172],
            [0.0022924 , 0.00227892, 0.00226807, ..., 0.00220936,
             0.00219364, 0.00217812],
            [0.00231699, 0.00230603, 0.00229702, ..., 0.00221065,
             0.0021932 , 0.00217596],
            ...,
            [0.00249076, 0.00248442, 0.00247622, ..., 0.00224485,
             0.00222806, 0.00221361],
            [0.00249192, 0.00248449, 0.00247561, ..., 0.00224585,
             0.00223096, 0.00221743],
            [0.00249155, 0.00248376, 0.00247603, ..., 0.00224736,
             0.00223372, 0.00222133]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-ae2dcde0-e0cb-4e02-81dc-3f1e3ccd1b92' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ae2dcde0-e0cb-4e02-81dc-3f1e3ccd1b92' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.305e+05 2.315e+05 ... 2.565e+05</div><input id='attrs-4f0452c9-4120-483c-af69-fe00fb011456' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4f0452c9-4120-483c-af69-fe00fb011456' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f351a39e-c31b-471e-990a-9e829a66d70c' class='xr-var-data-in' type='checkbox'><label for='data-f351a39e-c31b-471e-990a-9e829a66d70c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([230500., 231500., 232500., 233500., 234500., 235500., 236500., 237500.,
           238500., 239500., 240500., 241500., 242500., 243500., 244500., 245500.,
           246500., 247500., 248500., 249500., 250500., 251500., 252500., 253500.,
           254500., 255500., 256500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.665e+05 5.655e+05 ... 5.505e+05</div><input id='attrs-ad8ad5d7-da5f-4d76-8d6c-2df329ec7a1f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ad8ad5d7-da5f-4d76-8d6c-2df329ec7a1f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-68003243-04e4-4a92-9b15-477dee6fedcf' class='xr-var-data-in' type='checkbox'><label for='data-68003243-04e4-4a92-9b15-477dee6fedcf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([566500., 565500., 564500., 563500., 562500., 561500., 560500., 559500.,
           558500., 557500., 556500., 555500., 554500., 553500., 552500., 551500.,
           550500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1e+03</div><input id='attrs-ac27e2a8-0830-45b4-99ed-5d2a06e3da8e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ac27e2a8-0830-45b4-99ed-5d2a06e3da8e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3c2b1aec-4634-45d0-bae3-6c5aa3e95911' class='xr-var-data-in' type='checkbox'><label for='data-3c2b1aec-4634-45d0-bae3-6c5aa3e95911' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1000.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1e+03</div><input id='attrs-a6b35f36-ad89-4731-add1-f28c0d2e91f4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a6b35f36-ad89-4731-add1-f28c0d2e91f4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-897664c9-5ba7-46d6-b72f-5a6e77a4f2f3' class='xr-var-data-in' type='checkbox'><label for='data-897664c9-5ba7-46d6-b72f-5a6e77a4f2f3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-1000.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2009-12-31 ... 2014-12-31</div><input id='attrs-509ff339-4d6f-44bf-b871-41aa8c7ff6a1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-509ff339-4d6f-44bf-b871-41aa8c7ff6a1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-63912113-3ed2-4ecb-a06e-7f8a54680903' class='xr-var-data-in' type='checkbox'><label for='data-63912113-3ed2-4ecb-a06e-7f8a54680903' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2009-12-31T00:00:00.000000000&#x27;, &#x27;2010-12-31T00:00:00.000000000&#x27;,
           &#x27;2011-12-31T00:00:00.000000000&#x27;, &#x27;2012-12-31T00:00:00.000000000&#x27;,
           &#x27;2013-12-31T00:00:00.000000000&#x27;, &#x27;2014-12-31T00:00:00.000000000&#x27;],
          dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-bc0ee4f9-2b39-48ff-8985-a288ccd37ca8' class='xr-section-summary-in' type='checkbox'  ><label for='section-bc0ee4f9-2b39-48ff-8985-a288ccd37ca8' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-0d6d0f6a-2d5d-49e7-b90e-b61c72973b5b' class='xr-index-data-in' type='checkbox'/><label for='index-0d6d0f6a-2d5d-49e7-b90e-b61c72973b5b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([230500.0, 231500.0, 232500.0, 233500.0, 234500.0, 235500.0,
                  236500.0, 237500.0, 238500.0, 239500.0, 240500.0, 241500.0,
                  242500.0, 243500.0, 244500.0, 245500.0, 246500.0, 247500.0,
                  248500.0, 249500.0, 250500.0, 251500.0, 252500.0, 253500.0,
                  254500.0, 255500.0, 256500.0],
                 dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-405ba312-e831-44fb-b271-262f79c21f76' class='xr-index-data-in' type='checkbox'/><label for='index-405ba312-e831-44fb-b271-262f79c21f76' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([566500.0, 565500.0, 564500.0, 563500.0, 562500.0, 561500.0,
                  560500.0, 559500.0, 558500.0, 557500.0, 556500.0, 555500.0,
                  554500.0, 553500.0, 552500.0, 551500.0, 550500.0],
                 dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-84d27cd8-dda7-4064-8897-3d682ec1aaee' class='xr-index-data-in' type='checkbox'/><label for='index-84d27cd8-dda7-4064-8897-3d682ec1aaee' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2009-12-31&#x27;, &#x27;2010-12-31&#x27;, &#x27;2011-12-31&#x27;, &#x27;2012-12-31&#x27;,
                   &#x27;2013-12-31&#x27;, &#x27;2014-12-31&#x27;],
                  dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=&#x27;A-DEC&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-90edc19b-73cd-45e9-a5ac-1add5637f5aa' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-90edc19b-73cd-45e9-a5ac-1add5637f5aa' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 347-356

To create the final recharge for the transient simulation,
the steady state information needs to be concatenated to the transient recharge data.
The steady state simulation will be run for one second.
This is achieved by using the numpy
`Timedelta function <https://numpy.org/doc/stable/reference/arrays.datetime.html>`_,
first creating a time delta of 1 second, which is assigned to the steady state recharge information.
This dataset is then concatenated using the xarray function
`xarray.concat <http://xarray.pydata.org/en/stable/generated/xarray.concat.html#xarray.concat>`_
to the transient information and indicating that the dimension to join is "time".

.. GENERATED FROM PYTHON SOURCE LINES 356-367

.. code-block:: Python


    starttime = "2009-12-31"

    # Add first steady-state
    timedelta = np.timedelta64(1, "s")  # 1 second duration for initial steady-state
    starttime_steady = np.datetime64(starttime) - timedelta
    rch_ss = rch_ss.assign_coords(time=starttime_steady)

    rch_ss_trans = xr.concat([rch_ss, rch_trans_yr], dim="time")
    rch_ss_trans






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 20px 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: none;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (y: 17, x: 27, time: 7)&gt;
    array([[[0.00091255, 0.00191725, 0.00175232, ..., 0.00167949,
             0.00161827, 0.00226806],
            [0.0009093 , 0.00191589, 0.0017549 , ..., 0.001689  ,
             0.00161518, 0.00225167],
            [0.00090591, 0.00191248, 0.00175632, ..., 0.00169961,
             0.00161301, 0.00223808],
            ...,
            [0.00078183, 0.00158879, 0.00160428, ..., 0.00174276,
             0.00162122, 0.00221006],
            [0.00078091, 0.00160275, 0.0016166 , ..., 0.00174685,
             0.0016207 , 0.00219559],
            [0.00078071, 0.00161772, 0.00163142, ..., 0.00175276,
             0.00162407, 0.00218172]],

           [[0.000913  , 0.00193096, 0.00175832, ..., 0.00168658,
             0.00164151, 0.0022924 ],
            [0.0009098 , 0.00193016, 0.00176321, ..., 0.00169678,
             0.00163919, 0.00227892],
            [0.0009065 , 0.0019277 , 0.00176716, ..., 0.00170842,
             0.00163841, 0.00226807],
    ...
            [0.00085378, 0.00177083, 0.00186831, ..., 0.00174713,
             0.00169624, 0.00224585],
            [0.00084055, 0.0017666 , 0.00185661, ..., 0.00173329,
             0.00168655, 0.00223096],
            [0.00082746, 0.00176362, 0.00184691, ..., 0.00172136,
             0.0016792 , 0.00221743]],

           [[0.00098196, 0.00204444, 0.00188612, ..., 0.00182747,
             0.0019308 , 0.00249155],
            [0.00098031, 0.002041  , 0.00189853, ..., 0.00183236,
             0.00192603, 0.00248376],
            [0.00097932, 0.00203658, 0.00191231, ..., 0.00183771,
             0.0019212 , 0.00247603],
            ...,
            [0.00086102, 0.00178251, 0.00188156, ..., 0.00175411,
             0.00170712, 0.00224736],
            [0.00084771, 0.00177807, 0.00187044, ..., 0.0017413 ,
             0.00169771, 0.00223372],
            [0.0008352 , 0.00177411, 0.00186046, ..., 0.00173005,
             0.00169032, 0.00222133]]], dtype=float32)
    Coordinates:
      * x        (x) float64 2.305e+05 2.315e+05 2.325e+05 ... 2.555e+05 2.565e+05
      * y        (y) float64 5.665e+05 5.655e+05 5.645e+05 ... 5.515e+05 5.505e+05
        dx       float64 1e+03
        dy       float64 -1e+03
      * time     (time) datetime64[ns] 2009-12-30T23:59:59 2009-12-31 ... 2014-12-31</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 17</li><li><span class='xr-has-index'>x</span>: 27</li><li><span class='xr-has-index'>time</span>: 7</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-05e43ec2-9741-4e1f-b00c-e2d19b228f7c' class='xr-array-in' type='checkbox' checked><label for='section-05e43ec2-9741-4e1f-b00c-e2d19b228f7c' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0009125 0.001917 0.001752 0.001906 ... 0.00173 0.00169 0.002221</span></div><div class='xr-array-data'><pre>array([[[0.00091255, 0.00191725, 0.00175232, ..., 0.00167949,
             0.00161827, 0.00226806],
            [0.0009093 , 0.00191589, 0.0017549 , ..., 0.001689  ,
             0.00161518, 0.00225167],
            [0.00090591, 0.00191248, 0.00175632, ..., 0.00169961,
             0.00161301, 0.00223808],
            ...,
            [0.00078183, 0.00158879, 0.00160428, ..., 0.00174276,
             0.00162122, 0.00221006],
            [0.00078091, 0.00160275, 0.0016166 , ..., 0.00174685,
             0.0016207 , 0.00219559],
            [0.00078071, 0.00161772, 0.00163142, ..., 0.00175276,
             0.00162407, 0.00218172]],

           [[0.000913  , 0.00193096, 0.00175832, ..., 0.00168658,
             0.00164151, 0.0022924 ],
            [0.0009098 , 0.00193016, 0.00176321, ..., 0.00169678,
             0.00163919, 0.00227892],
            [0.0009065 , 0.0019277 , 0.00176716, ..., 0.00170842,
             0.00163841, 0.00226807],
    ...
            [0.00085378, 0.00177083, 0.00186831, ..., 0.00174713,
             0.00169624, 0.00224585],
            [0.00084055, 0.0017666 , 0.00185661, ..., 0.00173329,
             0.00168655, 0.00223096],
            [0.00082746, 0.00176362, 0.00184691, ..., 0.00172136,
             0.0016792 , 0.00221743]],

           [[0.00098196, 0.00204444, 0.00188612, ..., 0.00182747,
             0.0019308 , 0.00249155],
            [0.00098031, 0.002041  , 0.00189853, ..., 0.00183236,
             0.00192603, 0.00248376],
            [0.00097932, 0.00203658, 0.00191231, ..., 0.00183771,
             0.0019212 , 0.00247603],
            ...,
            [0.00086102, 0.00178251, 0.00188156, ..., 0.00175411,
             0.00170712, 0.00224736],
            [0.00084771, 0.00177807, 0.00187044, ..., 0.0017413 ,
             0.00169771, 0.00223372],
            [0.0008352 , 0.00177411, 0.00186046, ..., 0.00173005,
             0.00169032, 0.00222133]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-3c862d88-e896-4d7d-9042-3337a0aaac02' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3c862d88-e896-4d7d-9042-3337a0aaac02' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.305e+05 2.315e+05 ... 2.565e+05</div><input id='attrs-0ec0d23f-5d1b-4380-8932-833a6353b02c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0ec0d23f-5d1b-4380-8932-833a6353b02c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-592f1d7c-2927-4798-94fa-027f309dbc50' class='xr-var-data-in' type='checkbox'><label for='data-592f1d7c-2927-4798-94fa-027f309dbc50' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([230500., 231500., 232500., 233500., 234500., 235500., 236500., 237500.,
           238500., 239500., 240500., 241500., 242500., 243500., 244500., 245500.,
           246500., 247500., 248500., 249500., 250500., 251500., 252500., 253500.,
           254500., 255500., 256500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.665e+05 5.655e+05 ... 5.505e+05</div><input id='attrs-0f6d6e5b-b630-466c-8eb3-ebefbe495628' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0f6d6e5b-b630-466c-8eb3-ebefbe495628' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a2941fac-4dbf-4423-abe9-d001c63125d1' class='xr-var-data-in' type='checkbox'><label for='data-a2941fac-4dbf-4423-abe9-d001c63125d1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([566500., 565500., 564500., 563500., 562500., 561500., 560500., 559500.,
           558500., 557500., 556500., 555500., 554500., 553500., 552500., 551500.,
           550500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1e+03</div><input id='attrs-e42bcc7b-9cee-4f34-b571-0dacf50b7b4b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e42bcc7b-9cee-4f34-b571-0dacf50b7b4b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dedd8f09-8085-4a31-b5ec-303ec4a33c78' class='xr-var-data-in' type='checkbox'><label for='data-dedd8f09-8085-4a31-b5ec-303ec4a33c78' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1000.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1e+03</div><input id='attrs-b342ac3e-edb3-4b38-b5b7-5a54568f22ca' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b342ac3e-edb3-4b38-b5b7-5a54568f22ca' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eb536ff1-c4ab-4cd1-b310-3508c239983b' class='xr-var-data-in' type='checkbox'><label for='data-eb536ff1-c4ab-4cd1-b310-3508c239983b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-1000.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2009-12-30T23:59:59 ... 2014-12-31</div><input id='attrs-7f8ceb06-b9a5-4c02-9644-699bf2b858f9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7f8ceb06-b9a5-4c02-9644-699bf2b858f9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-62e3f3b1-ba98-4e49-be27-ea3cdbaced02' class='xr-var-data-in' type='checkbox'><label for='data-62e3f3b1-ba98-4e49-be27-ea3cdbaced02' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2009-12-30T23:59:59.000000000&#x27;, &#x27;2009-12-31T00:00:00.000000000&#x27;,
           &#x27;2010-12-31T00:00:00.000000000&#x27;, &#x27;2011-12-31T00:00:00.000000000&#x27;,
           &#x27;2012-12-31T00:00:00.000000000&#x27;, &#x27;2013-12-31T00:00:00.000000000&#x27;,
           &#x27;2014-12-31T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-341b72b1-d64a-417a-9df9-b92e314da731' class='xr-section-summary-in' type='checkbox'  ><label for='section-341b72b1-d64a-417a-9df9-b92e314da731' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-7dacf672-870b-40dd-8ab6-a577c5ea8491' class='xr-index-data-in' type='checkbox'/><label for='index-7dacf672-870b-40dd-8ab6-a577c5ea8491' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([230500.0, 231500.0, 232500.0, 233500.0, 234500.0, 235500.0,
                  236500.0, 237500.0, 238500.0, 239500.0, 240500.0, 241500.0,
                  242500.0, 243500.0, 244500.0, 245500.0, 246500.0, 247500.0,
                  248500.0, 249500.0, 250500.0, 251500.0, 252500.0, 253500.0,
                  254500.0, 255500.0, 256500.0],
                 dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-804b2ccf-9941-4112-ba62-4b61c87adb1a' class='xr-index-data-in' type='checkbox'/><label for='index-804b2ccf-9941-4112-ba62-4b61c87adb1a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([566500.0, 565500.0, 564500.0, 563500.0, 562500.0, 561500.0,
                  560500.0, 559500.0, 558500.0, 557500.0, 556500.0, 555500.0,
                  554500.0, 553500.0, 552500.0, 551500.0, 550500.0],
                 dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-826d3bab-2ffd-4612-96ff-305fdbe2c827' class='xr-index-data-in' type='checkbox'/><label for='index-826d3bab-2ffd-4612-96ff-305fdbe2c827' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2009-12-30 23:59:59&#x27;, &#x27;2009-12-31 00:00:00&#x27;,
                   &#x27;2010-12-31 00:00:00&#x27;, &#x27;2011-12-31 00:00:00&#x27;,
                   &#x27;2012-12-31 00:00:00&#x27;, &#x27;2013-12-31 00:00:00&#x27;,
                   &#x27;2014-12-31 00:00:00&#x27;],
                  dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-67be5c5a-a374-4d61-a96e-bd5b8a8ee472' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-67be5c5a-a374-4d61-a96e-bd5b8a8ee472' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 368-377

The data obtained from KNMI has different grid dimensions
than the one considered in this example. To fix this,
imod-python includes the option
`imod.prepare.Regridder <https://deltares.gitlab.io/imod/imod-python/api/prepare.html#imod.prepare.Regridder>`_,
which modifies the original grid dimensions to a different one.
It is also possible to define the regridding method such as
``nearest``, ``multilinear``, ``mean``, among others.
In this case, ``mean`` was selected and the 2d template (like_2d)
was used as reference, as this is the geometry to be considered in the model.

.. GENERATED FROM PYTHON SOURCE LINES 377-381

.. code-block:: Python


    rch_ss_trans = imod.prepare.Regridder(method="mean").regrid(rch_ss_trans, like_2d)
    rch_ss_trans






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 20px 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: none;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (y: 200, x: 500, time: 7)&gt;
    array([[[0.00089943, 0.00190719, 0.00182535, ..., 0.00179266,
             0.00169166, 0.00232221],
            [0.00089943, 0.00190719, 0.00182535, ..., 0.00179266,
             0.00169166, 0.00232221],
            [0.00089943, 0.00190719, 0.00182535, ..., 0.00179266,
             0.00169166, 0.00232221],
            ...,
            [0.00083373, 0.00163785, 0.00171206, ..., 0.00176909,
             0.00164895, 0.00231468],
            [0.00083373, 0.00163785, 0.00171206, ..., 0.00176909,
             0.00164895, 0.00231468],
            [0.00083373, 0.00163785, 0.00171206, ..., 0.00176909,
             0.00164895, 0.00231468]],

           [[0.00089943, 0.00190719, 0.00182535, ..., 0.00179266,
             0.00169166, 0.00232221],
            [0.00089943, 0.00190719, 0.00182535, ..., 0.00179266,
             0.00169166, 0.00232221],
            [0.00089943, 0.00190719, 0.00182535, ..., 0.00179266,
             0.00169166, 0.00232221],
    ...
            [0.00088318, 0.00169605, 0.00183059, ..., 0.00180298,
             0.00171221, 0.0023817 ],
            [0.00088318, 0.00169605, 0.00183059, ..., 0.00180298,
             0.00171221, 0.0023817 ],
            [0.00088318, 0.00169605, 0.00183059, ..., 0.00180298,
             0.00171221, 0.0023817 ]],

           [[0.00091826, 0.00198224, 0.00191962, ..., 0.00183427,
             0.00179237, 0.00242177],
            [0.00091826, 0.00198224, 0.00191962, ..., 0.00183427,
             0.00179237, 0.00242177],
            [0.00091826, 0.00198224, 0.00191962, ..., 0.00183427,
             0.00179237, 0.00242177],
            ...,
            [0.00088318, 0.00169605, 0.00183059, ..., 0.00180298,
             0.00171221, 0.0023817 ],
            [0.00088318, 0.00169605, 0.00183059, ..., 0.00180298,
             0.00171221, 0.0023817 ],
            [0.00088318, 0.00169605, 0.00183059, ..., 0.00180298,
             0.00171221, 0.0023817 ]]])
    Coordinates:
      * time     (time) datetime64[ns] 2009-12-30T23:59:59 2009-12-31 ... 2014-12-31
      * y        (y) float64 5.64e+05 5.64e+05 5.639e+05 ... 5.59e+05 5.59e+05
      * x        (x) float64 2.375e+05 2.375e+05 2.376e+05 ... 2.5e+05 2.5e+05
        dx       float64 25.0
        dy       float64 -25.0
        layer    int32 1</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>x</span>: 500</li><li><span class='xr-has-index'>time</span>: 7</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-c831a1b9-a2ca-4b34-af48-f61e614fb4ca' class='xr-array-in' type='checkbox' checked><label for='section-c831a1b9-a2ca-4b34-af48-f61e614fb4ca' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0008994 0.001907 0.001825 0.001961 ... 0.001803 0.001712 0.002382</span></div><div class='xr-array-data'><pre>array([[[0.00089943, 0.00190719, 0.00182535, ..., 0.00179266,
             0.00169166, 0.00232221],
            [0.00089943, 0.00190719, 0.00182535, ..., 0.00179266,
             0.00169166, 0.00232221],
            [0.00089943, 0.00190719, 0.00182535, ..., 0.00179266,
             0.00169166, 0.00232221],
            ...,
            [0.00083373, 0.00163785, 0.00171206, ..., 0.00176909,
             0.00164895, 0.00231468],
            [0.00083373, 0.00163785, 0.00171206, ..., 0.00176909,
             0.00164895, 0.00231468],
            [0.00083373, 0.00163785, 0.00171206, ..., 0.00176909,
             0.00164895, 0.00231468]],

           [[0.00089943, 0.00190719, 0.00182535, ..., 0.00179266,
             0.00169166, 0.00232221],
            [0.00089943, 0.00190719, 0.00182535, ..., 0.00179266,
             0.00169166, 0.00232221],
            [0.00089943, 0.00190719, 0.00182535, ..., 0.00179266,
             0.00169166, 0.00232221],
    ...
            [0.00088318, 0.00169605, 0.00183059, ..., 0.00180298,
             0.00171221, 0.0023817 ],
            [0.00088318, 0.00169605, 0.00183059, ..., 0.00180298,
             0.00171221, 0.0023817 ],
            [0.00088318, 0.00169605, 0.00183059, ..., 0.00180298,
             0.00171221, 0.0023817 ]],

           [[0.00091826, 0.00198224, 0.00191962, ..., 0.00183427,
             0.00179237, 0.00242177],
            [0.00091826, 0.00198224, 0.00191962, ..., 0.00183427,
             0.00179237, 0.00242177],
            [0.00091826, 0.00198224, 0.00191962, ..., 0.00183427,
             0.00179237, 0.00242177],
            ...,
            [0.00088318, 0.00169605, 0.00183059, ..., 0.00180298,
             0.00171221, 0.0023817 ],
            [0.00088318, 0.00169605, 0.00183059, ..., 0.00180298,
             0.00171221, 0.0023817 ],
            [0.00088318, 0.00169605, 0.00183059, ..., 0.00180298,
             0.00171221, 0.0023817 ]]])</pre></div></div></li><li class='xr-section-item'><input id='section-9ca73ffa-48c8-4c6b-a177-eb79a3210055' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9ca73ffa-48c8-4c6b-a177-eb79a3210055' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2009-12-30T23:59:59 ... 2014-12-31</div><input id='attrs-558a726b-9191-4696-aff6-d8f57bf2c857' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-558a726b-9191-4696-aff6-d8f57bf2c857' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a55df1c5-745f-4c6e-b120-80176d5df021' class='xr-var-data-in' type='checkbox'><label for='data-a55df1c5-745f-4c6e-b120-80176d5df021' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2009-12-30T23:59:59.000000000&#x27;, &#x27;2009-12-31T00:00:00.000000000&#x27;,
           &#x27;2010-12-31T00:00:00.000000000&#x27;, &#x27;2011-12-31T00:00:00.000000000&#x27;,
           &#x27;2012-12-31T00:00:00.000000000&#x27;, &#x27;2013-12-31T00:00:00.000000000&#x27;,
           &#x27;2014-12-31T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-7bc69f4a-568c-4857-ac83-5835f9c88380' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7bc69f4a-568c-4857-ac83-5835f9c88380' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d76b7cde-639c-4ced-b941-a60c503e3e39' class='xr-var-data-in' type='checkbox'><label for='data-d76b7cde-639c-4ced-b941-a60c503e3e39' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
           563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
           563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
           563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
           563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
           563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
           562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
           562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
           562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
           562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
           562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
           562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
           561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
           561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
           561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
           561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
           561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
           561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
           560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
           560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
           560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
           560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
           560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
           559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
           559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
           559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
           559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
           559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
           559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-1313bafd-b030-4202-bdb7-19a9ae4e0bb1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1313bafd-b030-4202-bdb7-19a9ae4e0bb1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-71a3b502-5027-4484-98a9-5c247d2509e2' class='xr-var-data-in' type='checkbox'><label for='data-71a3b502-5027-4484-98a9-5c247d2509e2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>25.0</div><input id='attrs-885b8e27-45bc-4b68-a1d7-8668e6da7c9a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-885b8e27-45bc-4b68-a1d7-8668e6da7c9a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-960dfd7a-b5fd-4dd6-9b9b-3da0f9ad31e7' class='xr-var-data-in' type='checkbox'><label for='data-960dfd7a-b5fd-4dd6-9b9b-3da0f9ad31e7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-25.0</div><input id='attrs-a5b3227d-bf04-4c6a-a03e-463054ceacbb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a5b3227d-bf04-4c6a-a03e-463054ceacbb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e64c9064-f30a-4f7c-a211-846cedf68622' class='xr-var-data-in' type='checkbox'><label for='data-e64c9064-f30a-4f7c-a211-846cedf68622' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>layer</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1</div><input id='attrs-929619de-2749-4e29-ae7a-30a866a4558f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-929619de-2749-4e29-ae7a-30a866a4558f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-80e82a17-fb23-4d7c-93ce-e714f83d29bf' class='xr-var-data-in' type='checkbox'><label for='data-80e82a17-fb23-4d7c-93ce-e714f83d29bf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4bd9f179-9b12-4579-b44b-f4411144d637' class='xr-section-summary-in' type='checkbox'  ><label for='section-4bd9f179-9b12-4579-b44b-f4411144d637' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-c2107838-2051-4a31-a93a-f16541e62d67' class='xr-index-data-in' type='checkbox'/><label for='index-c2107838-2051-4a31-a93a-f16541e62d67' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2009-12-30 23:59:59&#x27;, &#x27;2009-12-31 00:00:00&#x27;,
                   &#x27;2010-12-31 00:00:00&#x27;, &#x27;2011-12-31 00:00:00&#x27;,
                   &#x27;2012-12-31 00:00:00&#x27;, &#x27;2013-12-31 00:00:00&#x27;,
                   &#x27;2014-12-31 00:00:00&#x27;],
                  dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-8a1c9e34-d41b-41d7-bd1c-6177a43e869a' class='xr-index-data-in' type='checkbox'/><label for='index-8a1c9e34-d41b-41d7-bd1c-6177a43e869a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5,
                  563837.5, 563812.5, 563787.5, 563762.5,
                  ...
                  559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
                  559087.5, 559062.5, 559037.5, 559012.5],
                 dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=200))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-3b140876-3fae-4d54-8d22-36a438a76252' class='xr-index-data-in' type='checkbox'/><label for='index-3b140876-3fae-4d54-8d22-36a438a76252' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([237512.5, 237537.5, 237562.5, 237587.5, 237612.5, 237637.5,
                  237662.5, 237687.5, 237712.5, 237737.5,
                  ...
                  249762.5, 249787.5, 249812.5, 249837.5, 249862.5, 249887.5,
                  249912.5, 249937.5, 249962.5, 249987.5],
                 dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=500))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ade6fb03-7e51-47fd-ad9c-e464a9ea3b27' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-ade6fb03-7e51-47fd-ad9c-e464a9ea3b27' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 382-388

The previously created recharge array is a 2D array
that needs to be assigned to a 3D array. This is done using the xarray
`DataArray.where <http://xarray.pydata.org/en/stable/generated/xarray.DataArray.where.html#xarray.DataArray.where>`_
option, where the recharge values are applied to the cells where the
idomain value is larger than zero (that is, the active cells) and for the uppermost
active cell (indicated by the minimum layer number).

.. GENERATED FROM PYTHON SOURCE LINES 388-394

.. code-block:: Python


    rch_total = rch_ss_trans.where(
        idomain["layer"] == idomain["layer"].where(idomain > 0).min("layer")
    )
    rch_total






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 20px 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: none;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (y: 200, x: 500, time: 7, layer: 13)&gt;
    array([[[[       nan,        nan, 0.00089943, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00190719, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00182535, ...,        nan,
                     nan,        nan],
             ...,
             [       nan,        nan, 0.00179266, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00169166, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00232221, ...,        nan,
                     nan,        nan]],

            [[       nan,        nan, 0.00089943, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00190719, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00182535, ...,        nan,
                     nan,        nan],
    ...
             [       nan,        nan, 0.00180298, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00171221, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.0023817 , ...,        nan,
                     nan,        nan]],

            [[       nan,        nan, 0.00088318, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00169605, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00183059, ...,        nan,
                     nan,        nan],
             ...,
             [       nan,        nan, 0.00180298, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00171221, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.0023817 , ...,        nan,
                     nan,        nan]]]])
    Coordinates:
      * time     (time) datetime64[ns] 2009-12-30T23:59:59 2009-12-31 ... 2014-12-31
      * y        (y) float64 5.64e+05 5.64e+05 5.639e+05 ... 5.59e+05 5.59e+05
      * x        (x) float64 2.375e+05 2.375e+05 2.376e+05 ... 2.5e+05 2.5e+05
        dx       float64 25.0
        dy       float64 -25.0
      * layer    (layer) int32 1 2 3 4 5 6 7 8 9 10 11 12 13</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>x</span>: 500</li><li><span class='xr-has-index'>time</span>: 7</li><li><span class='xr-has-index'>layer</span>: 13</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-72c1e077-3271-4c66-9178-ae3e11240d92' class='xr-array-in' type='checkbox' checked><label for='section-72c1e077-3271-4c66-9178-ae3e11240d92' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>nan nan 0.0008994 nan nan nan nan nan ... nan nan nan nan nan nan nan</span></div><div class='xr-array-data'><pre>array([[[[       nan,        nan, 0.00089943, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00190719, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00182535, ...,        nan,
                     nan,        nan],
             ...,
             [       nan,        nan, 0.00179266, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00169166, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00232221, ...,        nan,
                     nan,        nan]],

            [[       nan,        nan, 0.00089943, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00190719, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00182535, ...,        nan,
                     nan,        nan],
    ...
             [       nan,        nan, 0.00180298, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00171221, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.0023817 , ...,        nan,
                     nan,        nan]],

            [[       nan,        nan, 0.00088318, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00169605, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00183059, ...,        nan,
                     nan,        nan],
             ...,
             [       nan,        nan, 0.00180298, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.00171221, ...,        nan,
                     nan,        nan],
             [       nan,        nan, 0.0023817 , ...,        nan,
                     nan,        nan]]]])</pre></div></div></li><li class='xr-section-item'><input id='section-bfee788e-bd8e-4a15-9da8-82d95cfb1c9a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-bfee788e-bd8e-4a15-9da8-82d95cfb1c9a' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2009-12-30T23:59:59 ... 2014-12-31</div><input id='attrs-ec5dfef9-6d06-4c20-99f7-6afb22bb28da' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ec5dfef9-6d06-4c20-99f7-6afb22bb28da' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0e80a395-657f-4223-b53f-21c57532b102' class='xr-var-data-in' type='checkbox'><label for='data-0e80a395-657f-4223-b53f-21c57532b102' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2009-12-30T23:59:59.000000000&#x27;, &#x27;2009-12-31T00:00:00.000000000&#x27;,
           &#x27;2010-12-31T00:00:00.000000000&#x27;, &#x27;2011-12-31T00:00:00.000000000&#x27;,
           &#x27;2012-12-31T00:00:00.000000000&#x27;, &#x27;2013-12-31T00:00:00.000000000&#x27;,
           &#x27;2014-12-31T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-dbb66d62-9e78-403d-a28d-2856a9a6ffca' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-dbb66d62-9e78-403d-a28d-2856a9a6ffca' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8492f245-e5ef-4607-be0d-ef0c2af66c71' class='xr-var-data-in' type='checkbox'><label for='data-8492f245-e5ef-4607-be0d-ef0c2af66c71' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
           563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
           563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
           563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
           563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
           563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
           562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
           562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
           562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
           562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
           562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
           562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
           561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
           561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
           561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
           561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
           561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
           561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
           560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
           560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
           560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
           560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
           560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
           559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
           559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
           559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
           559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
           559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
           559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-810e1a6b-b28c-47d9-9ddb-b0ae0ec4ee71' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-810e1a6b-b28c-47d9-9ddb-b0ae0ec4ee71' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8f13a9e4-7472-4ac4-91fe-95af4088da92' class='xr-var-data-in' type='checkbox'><label for='data-8f13a9e4-7472-4ac4-91fe-95af4088da92' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>25.0</div><input id='attrs-70842c0c-6e01-437d-98b4-e5501c865132' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-70842c0c-6e01-437d-98b4-e5501c865132' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6a17ccc7-dfad-492c-9c52-0a3db21424d8' class='xr-var-data-in' type='checkbox'><label for='data-6a17ccc7-dfad-492c-9c52-0a3db21424d8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-25.0</div><input id='attrs-289fb25f-29f9-4112-bd30-19a90135d8aa' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-289fb25f-29f9-4112-bd30-19a90135d8aa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-df852844-03fb-48d5-96c8-a6097be72ee4' class='xr-var-data-in' type='checkbox'><label for='data-df852844-03fb-48d5-96c8-a6097be72ee4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12 13</div><input id='attrs-e23c1e44-ac44-4367-adf4-5bcb23a05b0e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e23c1e44-ac44-4367-adf4-5bcb23a05b0e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-982d609c-92c4-483b-bf1b-7954683b4e8c' class='xr-var-data-in' type='checkbox'><label for='data-982d609c-92c4-483b-bf1b-7954683b4e8c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9447208a-b89c-491b-8378-02ebfe576e8c' class='xr-section-summary-in' type='checkbox'  ><label for='section-9447208a-b89c-491b-8378-02ebfe576e8c' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-ced4a121-3735-4f6a-ac11-73a1b1930771' class='xr-index-data-in' type='checkbox'/><label for='index-ced4a121-3735-4f6a-ac11-73a1b1930771' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2009-12-30 23:59:59&#x27;, &#x27;2009-12-31 00:00:00&#x27;,
                   &#x27;2010-12-31 00:00:00&#x27;, &#x27;2011-12-31 00:00:00&#x27;,
                   &#x27;2012-12-31 00:00:00&#x27;, &#x27;2013-12-31 00:00:00&#x27;,
                   &#x27;2014-12-31 00:00:00&#x27;],
                  dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a6777ce1-9800-4a90-9886-cf581e4a7b71' class='xr-index-data-in' type='checkbox'/><label for='index-a6777ce1-9800-4a90-9886-cf581e4a7b71' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5,
                  563837.5, 563812.5, 563787.5, 563762.5,
                  ...
                  559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
                  559087.5, 559062.5, 559037.5, 559012.5],
                 dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=200))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-251eec9c-41c5-4e5b-9139-62caaba90b5f' class='xr-index-data-in' type='checkbox'/><label for='index-251eec9c-41c5-4e5b-9139-62caaba90b5f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([237512.5, 237537.5, 237562.5, 237587.5, 237612.5, 237637.5,
                  237662.5, 237687.5, 237712.5, 237737.5,
                  ...
                  249762.5, 249787.5, 249812.5, 249837.5, 249862.5, 249887.5,
                  249912.5, 249937.5, 249962.5, 249987.5],
                 dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=500))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>layer</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-e74dbcc3-81d9-4146-b138-e2c5fcc9b327' class='xr-index-data-in' type='checkbox'/><label for='index-e74dbcc3-81d9-4146-b138-e2c5fcc9b327' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Int64Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], dtype=&#x27;int64&#x27;, name=&#x27;layer&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-171012b2-38d7-4739-b04c-5ffeaf1b3710' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-171012b2-38d7-4739-b04c-5ffeaf1b3710' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 395-398

Finally, transposing the array dimensions using
`DataArray.transpose <http://xarray.pydata.org/en/stable/generated/xarray.DataArray.transpose.html#xarray.DataArray.transpose>`_
so they are in the correct order.

.. GENERATED FROM PYTHON SOURCE LINES 398-405

.. code-block:: Python


    rch_total = rch_total.transpose("time", "layer", "y", "x")
    rch_total

    fig, ax = plt.subplots()
    rch_total.isel(layer=2, time=6).plot.imshow(ax=ax)




.. image-sg:: /examples/mf6/images/sphx_glr_hondsrug_006.png
   :alt: time = 2014-12-31, dx = 25.0, dy = -25.0, layer...
   :srcset: /examples/mf6/images/sphx_glr_hondsrug_006.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.image.AxesImage object at 0x0000014B2F171C30>



.. GENERATED FROM PYTHON SOURCE LINES 406-413

Adding information to the RCH package
--------------------------------------

The information for the RCH package is added with the function
`imod.mf6.Recharge <https://deltares.gitlab.io/imod/imod-python/api/mf6.html?highlight=structured%20discretization#imod.mf6.Recharge>`_.
It is required to insert the recharge flux rate, and it is optional
to include the print_input, print_flows and save_flows information.

.. GENERATED FROM PYTHON SOURCE LINES 413-416

.. code-block:: Python


    gwf_model["rch"] = imod.mf6.Recharge(rch_total)








.. GENERATED FROM PYTHON SOURCE LINES 417-429

Drainage package - DRN
=======================

The drain package is used to simulate features that remove water from the aquifer,
such as agricultural drains or springs.
This occurs at a rate proportional to the head difference between the head in the
aquifer and the drain elevation
(the head in the aquifer has to be above that elevation).
The conductance is the proportionality constant.

Import drainage information
----------------------------

.. GENERATED FROM PYTHON SOURCE LINES 429-437

.. code-block:: Python


    drainage = imod.data.hondsrug_drainage()

    pipe_cond = drainage["conductance"]
    pipe_elev = drainage["elevation"]

    pipe_cond






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 20px 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: none;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;conductance&#x27; (layer: 4, y: 200, x: 500)&gt;
    [400000 values with dtype=float32]
    Coordinates:
      * x        (x) float64 2.375e+05 2.375e+05 2.376e+05 ... 2.5e+05 2.5e+05
      * y        (y) float64 5.64e+05 5.64e+05 5.639e+05 ... 5.59e+05 5.59e+05
        dx       float64 ...
        dy       float64 ...
      * layer    (layer) int32 1 3 5 6</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'conductance'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>layer</span>: 4</li><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>x</span>: 500</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-7f97659e-6ce2-43be-9729-2cd32d6b538b' class='xr-array-in' type='checkbox' checked><label for='section-7f97659e-6ce2-43be-9729-2cd32d6b538b' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>...</span></div><div class='xr-array-data'><pre>[400000 values with dtype=float32]</pre></div></div></li><li class='xr-section-item'><input id='section-46457bdb-0245-46c2-9c3e-aad218998548' class='xr-section-summary-in' type='checkbox'  checked><label for='section-46457bdb-0245-46c2-9c3e-aad218998548' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-b738c4b0-18e4-4ec6-8816-adbf0f1e4ec5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b738c4b0-18e4-4ec6-8816-adbf0f1e4ec5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3fb9d320-5fa5-42ec-934a-b29fa08b7b0e' class='xr-var-data-in' type='checkbox'><label for='data-3fb9d320-5fa5-42ec-934a-b29fa08b7b0e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-3c475f78-f015-487d-970d-54bd4538c6b4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3c475f78-f015-487d-970d-54bd4538c6b4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-55f74b61-29c1-4ebd-9e7f-12702ee527dc' class='xr-var-data-in' type='checkbox'><label for='data-55f74b61-29c1-4ebd-9e7f-12702ee527dc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
           563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
           563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
           563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
           563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
           563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
           562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
           562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
           562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
           562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
           562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
           562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
           561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
           561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
           561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
           561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
           561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
           561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
           560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
           560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
           560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
           560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
           560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
           559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
           559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
           559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
           559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
           559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
           559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-2c84e73b-6ba5-451d-b557-ba927441548e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2c84e73b-6ba5-451d-b557-ba927441548e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2e81a747-3acd-4f6f-80e4-fa0cb636addb' class='xr-var-data-in' type='checkbox'><label for='data-2e81a747-3acd-4f6f-80e4-fa0cb636addb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-021a2bd4-ac67-4600-9f26-029739a13362' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-021a2bd4-ac67-4600-9f26-029739a13362' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f5d8f0c2-9619-4fbd-9715-f184deef6d3d' class='xr-var-data-in' type='checkbox'><label for='data-f5d8f0c2-9619-4fbd-9715-f184deef6d3d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 3 5 6</div><input id='attrs-804dea7c-cb0b-43ba-bf2c-de685d1de6ce' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-804dea7c-cb0b-43ba-bf2c-de685d1de6ce' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-92307a22-987d-49ce-a0ed-0d10fcbeacba' class='xr-var-data-in' type='checkbox'><label for='data-92307a22-987d-49ce-a0ed-0d10fcbeacba' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1, 3, 5, 6])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f6b0483f-34a8-460b-aa9e-0a91aca52845' class='xr-section-summary-in' type='checkbox'  ><label for='section-f6b0483f-34a8-460b-aa9e-0a91aca52845' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-65b11d5f-ee3d-4482-928c-9ff8131a3283' class='xr-index-data-in' type='checkbox'/><label for='index-65b11d5f-ee3d-4482-928c-9ff8131a3283' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([237512.5, 237537.5, 237562.5, 237587.5, 237612.5, 237637.5,
                  237662.5, 237687.5, 237712.5, 237737.5,
                  ...
                  249762.5, 249787.5, 249812.5, 249837.5, 249862.5, 249887.5,
                  249912.5, 249937.5, 249962.5, 249987.5],
                 dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=500))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-62c3ce95-543e-42e9-808b-05540b3bf876' class='xr-index-data-in' type='checkbox'/><label for='index-62c3ce95-543e-42e9-808b-05540b3bf876' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5,
                  563837.5, 563812.5, 563787.5, 563762.5,
                  ...
                  559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
                  559087.5, 559062.5, 559037.5, 559012.5],
                 dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=200))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>layer</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-81a87671-5f5b-40cd-8588-c0547e548d50' class='xr-index-data-in' type='checkbox'/><label for='index-81a87671-5f5b-40cd-8588-c0547e548d50' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Int64Index([1, 3, 5, 6], dtype=&#x27;int64&#x27;, name=&#x27;layer&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-599ce92c-a18d-414f-a16d-3bddf3c37927' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-599ce92c-a18d-414f-a16d-3bddf3c37927' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 438-448

Adding information to the DRN package
-------------------------------------

To add the information to the DRN package within the gwf_model variable, the
`imod.mf6.Drainage <https://deltares.gitlab.io/imod/imod-python/api/mf6.html?highlight=structured%20discretization#imod.mf6.Drainage>`_
function is used. It is required to add the previously created arrays for
the drain elevation and the drain conductance.
It is optional to insert the information for
``print_input``, ``print_flows`` and ``save_flows``
which are set to False by default.

.. GENERATED FROM PYTHON SOURCE LINES 448-451

.. code-block:: Python


    gwf_model["drn-pipe"] = imod.mf6.Drainage(conductance=pipe_cond, elevation=pipe_elev)








.. GENERATED FROM PYTHON SOURCE LINES 452-460

River package - RIV
===================

This package simulates the effects of flow between
surface-water features and groundwater systems.

Import river information
------------------------

.. GENERATED FROM PYTHON SOURCE LINES 460-466

.. code-block:: Python


    river = imod.data.hondsrug_river()
    riv_cond = river["conductance"]
    riv_stage = river["stage"]
    riv_bot = river["bottom"]








.. GENERATED FROM PYTHON SOURCE LINES 467-473

Adding information to the RIV package
-------------------------------------

The data is assigned to the gwf_model variable by using
`imod.mf6.River <https://deltares.gitlab.io/imod/imod-python/api/mf6.html#imod.mf6.River>`_,
based on the previously imported conductance, stage and bottom arrays.

.. GENERATED FROM PYTHON SOURCE LINES 473-478

.. code-block:: Python


    gwf_model["riv"] = imod.mf6.River(
        conductance=riv_cond, stage=riv_stage, bottom_elevation=riv_bot
    )








.. GENERATED FROM PYTHON SOURCE LINES 479-484

Storage package - STO
======================

When the STO Package is included in a model, storage changes
will be calculated, and thus, the model will be transient.

.. GENERATED FROM PYTHON SOURCE LINES 484-509

.. code-block:: Python


    ss = 0.0003
    layer = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13])
    sy = xr.DataArray(
        [0.16, 0.16, 0.16, 0.16, 0.15, 0.15, 0.15, 0.15, 0.14, 0.14, 0.14, 0.14, 0.14],
        {"layer": layer},
        ("layer",),
    )
    times_sto = np.array(
        [
            "2009-12-30T23:59:59.00",
            "2009-12-31T00:00:00.00",
            "2010-12-31T00:00:00.00",
            "2011-12-31T00:00:00.00",
            "2012-12-31T00:00:00.00",
            "2013-12-31T00:00:00.00",
            "2014-12-31T00:00:00.00",
        ],
        dtype="datetime64[ns]",
    )

    transient = xr.DataArray(
        [False, True, True, True, True, True, True], {"time": times_sto}, ("time",)
    )








.. GENERATED FROM PYTHON SOURCE LINES 510-517

Adding information to the STO package
-------------------------------------

The data is assigned to the gwf_model variable by using
`imod.mf6.Storage <https://deltares.gitlab.io/imod/imod-python/api/generated/mf6/imod.mf6.SpecificStorage.html>`_.
It is necessary to indicate the values of specific storage,
specific yield and if the layers are convertible.

.. GENERATED FROM PYTHON SOURCE LINES 517-526

.. code-block:: Python


    gwf_model["sto"] = imod.mf6.SpecificStorage(
        specific_storage=ss,
        specific_yield=sy,
        transient=transient,
        convertible=0,
        save_flows=True,
    )








.. GENERATED FROM PYTHON SOURCE LINES 527-543

Output Control package - OC
===========================

This package determines how and when heads are printed to the
listing file and/or written to a separate binary output file

Adding information to the OC package
------------------------------------

The function
`imod.mf6.OutputControl <https://deltares.gitlab.io/imod/imod-python/api/mf6.html?highlight=structured%20discretization#imod.mf6.OutputControl>`_
is used to store the information for this package.
It is possible to indicate if the heads and budget information is saved
at the end of each stress period (``last``),
for all timesteps a stress period (``all``),
or at the start of a stress period (``first``)

.. GENERATED FROM PYTHON SOURCE LINES 543-546

.. code-block:: Python


    gwf_model["oc"] = imod.mf6.OutputControl(save_head="last", save_budget="last")








.. GENERATED FROM PYTHON SOURCE LINES 547-559

Model simulation
================

In MODFLOW 6, the concept of "model" is that part of the program
that solves a hydrologic process. MODFLOW 6 documentation supports
one type of model: the GWF Model.
It is possible within the MODFLOW 6 framewotk to solve multiple,
tightly coupled, numerical models in a single system of equation,
which may be multiple models of the same type or of different types.

The previously created gwf_model variable now contains
the information from all the variables.

.. GENERATED FROM PYTHON SOURCE LINES 559-562

.. code-block:: Python


    gwf_model





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    GroundwaterFlowModel(
        listing_file=None,
        print_input=False,
        print_flows=False,
        save_flows=False,
        newton=False,
        under_relaxation=False,
    ){
        'dis': StructuredDiscretization,
        'npf': NodePropertyFlow,
        'ic': InitialConditions,
        'chd': ConstantHead,
        'rch': Recharge,
        'drn-pipe': Drainage,
        'riv': River,
        'sto': SpecificStorage,
        'oc': OutputControl,
    }



.. GENERATED FROM PYTHON SOURCE LINES 563-569

Attach the model information to a simulation
--------------------------------------------

The function
`imod.mf6.Modflow6Simulation <https://deltares.gitlab.io/imod/imod-python/api/mf6.html?highlight=structured%20discretization#imod.mf6.Modflow6Simulation>`_
allows to assign models to a simulation (in this case, the gwf_model).

.. GENERATED FROM PYTHON SOURCE LINES 569-573

.. code-block:: Python


    simulation = imod.mf6.Modflow6Simulation("mf6-mipwa2-example")
    simulation["GWF_1"] = gwf_model








.. GENERATED FROM PYTHON SOURCE LINES 574-580

Solver settings
---------------

The solver settings are indicated using
`imod.mf6.Solution <https://deltares.gitlab.io/imod/imod-python/api/mf6.html?highlight=structured%20discretization#imod.mf6.Solution>`_.
If the values are not indicated manually, the defaults values will be considered.

.. GENERATED FROM PYTHON SOURCE LINES 580-598

.. code-block:: Python


    simulation["solver"] = imod.mf6.Solution(
        modelnames=["GWF_1"],
        print_option="summary",
        csv_output=False,
        no_ptc=True,
        outer_dvclose=1.0e-4,
        outer_maximum=500,
        under_relaxation=None,
        inner_dvclose=1.0e-4,
        inner_rclose=0.001,
        inner_maximum=100,
        linear_acceleration="cg",
        scaling_method=None,
        reordering_method=None,
        relaxation_factor=0.97,
    )








.. GENERATED FROM PYTHON SOURCE LINES 599-603

Assign time discretization
--------------------------

The time discretization of this model is 6 years.

.. GENERATED FROM PYTHON SOURCE LINES 603-608

.. code-block:: Python


    simulation.create_time_discretization(
        additional_times=["2009-12-30T23:59:59.000000000", "2015-12-31T00:00:00.000000000"]
    )








.. GENERATED FROM PYTHON SOURCE LINES 609-617

Run the model
-------------

.. note::

  The following lines assume the ``mf6`` executable is available on your PATH.
  :ref:`The Modflow 6 examples introduction <mf6-introduction>` shortly
  describes how to add it to yours.

.. GENERATED FROM PYTHON SOURCE LINES 617-622

.. code-block:: Python


    modeldir = imod.util.temporary_directory()
    simulation.write(modeldir, binary=False)
    simulation.run()








.. GENERATED FROM PYTHON SOURCE LINES 623-634

Results visualization
=====================

The next section indicated how to visualize the model results.

Import heads results
--------------------

The heads results are imported using
`imod.mf6.open_hds <https://deltares.gitlab.io/imod/imod-python/api/mf6.html?highlight=imod%20mf6%20open_hds#imod.mf6.open_hds>`_
on the background.

.. GENERATED FROM PYTHON SOURCE LINES 634-637

.. code-block:: Python


    hds = simulation.open_head()








.. GENERATED FROM PYTHON SOURCE LINES 638-639

We can plot the data of an individual layer as follows

.. GENERATED FROM PYTHON SOURCE LINES 639-642

.. code-block:: Python

    fig, ax = plt.subplots()
    hds.sel(layer=3).isel(time=3).plot(ax=ax)




.. image-sg:: /examples/mf6/images/sphx_glr_hondsrug_007.png
   :alt: dx = 25.0, dy = -25.0, layer = 3, time = 1.096e+03
   :srcset: /examples/mf6/images/sphx_glr_hondsrug_007.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.collections.QuadMesh object at 0x0000014B2CFBE5C0>



.. GENERATED FROM PYTHON SOURCE LINES 643-646

As you can see layer 3 has some missing cells in the west
Whereas layer 4 only contains active cells in the
eastern peatland area

.. GENERATED FROM PYTHON SOURCE LINES 646-648

.. code-block:: Python

    fig, ax = plt.subplots()
    hds.sel(layer=4).isel(time=3).plot(ax=ax)



.. image-sg:: /examples/mf6/images/sphx_glr_hondsrug_008.png
   :alt: dx = 25.0, dy = -25.0, layer = 4, time = 1.096e+03
   :srcset: /examples/mf6/images/sphx_glr_hondsrug_008.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.collections.QuadMesh object at 0x0000014B2F197970>



.. GENERATED FROM PYTHON SOURCE LINES 649-651

Layer 5 contains more data towards the west,
but has no active cells in the centre.

.. GENERATED FROM PYTHON SOURCE LINES 651-654

.. code-block:: Python

    fig, ax = plt.subplots()
    hds.sel(layer=5).isel(time=3).plot(ax=ax)




.. image-sg:: /examples/mf6/images/sphx_glr_hondsrug_009.png
   :alt: dx = 25.0, dy = -25.0, layer = 5, time = 1.096e+03
   :srcset: /examples/mf6/images/sphx_glr_hondsrug_009.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.collections.QuadMesh object at 0x0000014B2F32E260>



.. GENERATED FROM PYTHON SOURCE LINES 655-666

As you can see the data is individual layers
have lots of inactive in different places.

It is difficult for this model to get a good idea
what is happening across the area based on 1 layer alone.
Luckily xarray allows us to compute the mean across a selection
of layers and plot this.

By first selecting 3 layers with ``sel```,
and then computing the mean across the layer dimension
with ``mean(dim="layer")``.

.. GENERATED FROM PYTHON SOURCE LINES 666-670

.. code-block:: Python


    fig, ax = plt.subplots()
    hds.sel(layer=slice(3, 5)).mean(dim="layer").isel(time=3).plot(ax=ax)




.. image-sg:: /examples/mf6/images/sphx_glr_hondsrug_010.png
   :alt: dx = 25.0, dy = -25.0, time = 1.096e+03
   :srcset: /examples/mf6/images/sphx_glr_hondsrug_010.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.collections.QuadMesh object at 0x0000014B2CDAE380>



.. GENERATED FROM PYTHON SOURCE LINES 671-677

Assign dates to head
--------------------

MODFLOW6 has no concept of a calendar, so the output is not labelled only
in terms of "time since start" in floating point numbers. For this model
the time unit is days and we can assign a date coordinate as follows:

.. GENERATED FROM PYTHON SOURCE LINES 677-682

.. code-block:: Python


    starttime = pd.to_datetime("2000-01-01")
    timedelta = pd.to_timedelta(hds["time"], "D")
    hds = hds.assign_coords(time=starttime + timedelta)








.. GENERATED FROM PYTHON SOURCE LINES 683-689

Extract head at points
----------------------

A typical operation is to extract simulated heads at point locations to
compare them with measurements. In this example, we select the heads at
two points:

.. GENERATED FROM PYTHON SOURCE LINES 689-694

.. code-block:: Python


    x = [240_000.0, 244_000.0]
    y = [560_000.0, 562_000.0]
    selection = imod.select.points_values(hds, x=x, y=y)








.. GENERATED FROM PYTHON SOURCE LINES 695-697

The result can be converted into a pandas dataframe for timeseries analysis,
or written to a variety of tabular file formats.

.. GENERATED FROM PYTHON SOURCE LINES 697-701

.. code-block:: Python


    dataframe = selection.to_dataframe().reset_index()
    dataframe = dataframe.rename(columns={"index": "id"})
    dataframe





.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>time</th>
          <th>layer</th>
          <th>id</th>
          <th>x</th>
          <th>y</th>
          <th>dx</th>
          <th>dy</th>
          <th>head</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>2000-01-01 00:00:00.999993600</td>
          <td>1</td>
          <td>0</td>
          <td>240012.5</td>
          <td>560012.5</td>
          <td>25.0</td>
          <td>-25.0</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>1</th>
          <td>2000-01-01 00:00:00.999993600</td>
          <td>1</td>
          <td>1</td>
          <td>244012.5</td>
          <td>562012.5</td>
          <td>25.0</td>
          <td>-25.0</td>
          <td>10.534013</td>
        </tr>
        <tr>
          <th>2</th>
          <td>2000-01-01 00:00:00.999993600</td>
          <td>2</td>
          <td>0</td>
          <td>240012.5</td>
          <td>560012.5</td>
          <td>25.0</td>
          <td>-25.0</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>3</th>
          <td>2000-01-01 00:00:00.999993600</td>
          <td>2</td>
          <td>1</td>
          <td>244012.5</td>
          <td>562012.5</td>
          <td>25.0</td>
          <td>-25.0</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>4</th>
          <td>2000-01-01 00:00:00.999993600</td>
          <td>3</td>
          <td>0</td>
          <td>240012.5</td>
          <td>560012.5</td>
          <td>25.0</td>
          <td>-25.0</td>
          <td>7.682111</td>
        </tr>
        <tr>
          <th>...</th>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
        <tr>
          <th>177</th>
          <td>2005-12-31 00:00:00.999993600</td>
          <td>11</td>
          <td>1</td>
          <td>244012.5</td>
          <td>562012.5</td>
          <td>25.0</td>
          <td>-25.0</td>
          <td>4.787419</td>
        </tr>
        <tr>
          <th>178</th>
          <td>2005-12-31 00:00:00.999993600</td>
          <td>12</td>
          <td>0</td>
          <td>240012.5</td>
          <td>560012.5</td>
          <td>25.0</td>
          <td>-25.0</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>179</th>
          <td>2005-12-31 00:00:00.999993600</td>
          <td>12</td>
          <td>1</td>
          <td>244012.5</td>
          <td>562012.5</td>
          <td>25.0</td>
          <td>-25.0</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>180</th>
          <td>2005-12-31 00:00:00.999993600</td>
          <td>13</td>
          <td>0</td>
          <td>240012.5</td>
          <td>560012.5</td>
          <td>25.0</td>
          <td>-25.0</td>
          <td>7.498579</td>
        </tr>
        <tr>
          <th>181</th>
          <td>2005-12-31 00:00:00.999993600</td>
          <td>13</td>
          <td>1</td>
          <td>244012.5</td>
          <td>562012.5</td>
          <td>25.0</td>
          <td>-25.0</td>
          <td>4.787407</td>
        </tr>
      </tbody>
    </table>
    <p>182 rows × 8 columns</p>
    </div>
    </div>
    <br />
    <br />


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (2 minutes 34.860 seconds)


.. _sphx_glr_download_examples_mf6_hondsrug.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: hondsrug.ipynb <hondsrug.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: hondsrug.py <hondsrug.py>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
