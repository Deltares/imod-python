
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples\imodflow\ImodflowProjectfile.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_examples_imodflow_ImodflowProjectfile.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_imodflow_ImodflowProjectfile.py:


Model Creation
==============
In this example, we'll create an iMODFLOW model
from scratch with complex boundary conditions
and horizontal barriers.

There are two surface water systems:
the outer two edges of the grid feature ditches
with a rising stage, whereas the central ditch
has a periodic boundary conditions with a
summer and winter stage.

The model will be written as a projectfile
with a set of IDFs containing all the grid information
and a .tim file containing the time discretization.

.. GENERATED FROM PYTHON SOURCE LINES 20-23

We'll start with the usual imports, supplied
with geopandas and shapely to specify vector data
for the `hfb` package.

.. GENERATED FROM PYTHON SOURCE LINES 23-33

.. code-block:: Python


    import geopandas as gpd
    import numpy as np
    import pandas as pd
    import xarray as xr
    from shapely.geometry import LineString

    import imod
    import imod.flow as flow








.. GENERATED FROM PYTHON SOURCE LINES 34-41

Discretization
--------------

We'll start off by creating a model discretization.
The model consists of a 3 by 9 by 9 three-dimensional grid.

We'll specify the grid first.

.. GENERATED FROM PYTHON SOURCE LINES 41-52

.. code-block:: Python

    shape = nlay, nrow, ncol = 3, 9, 9

    dx = 100.0
    dy = -100.0
    dz = np.array([5, 30, 100])
    xmin = 0.0
    xmax = dx * ncol
    ymin = 0.0
    ymax = abs(dy) * nrow
    dims = ("layer", "y", "x")








.. GENERATED FROM PYTHON SOURCE LINES 53-55

Next, we'll create the coordinates
which set the grid dimensions.

.. GENERATED FROM PYTHON SOURCE LINES 55-61

.. code-block:: Python


    layer = np.arange(1, nlay + 1)
    y = np.arange(ymax, ymin, dy) + 0.5 * dy
    x = np.arange(xmin, xmax, dx) + 0.5 * dx
    coords = {"layer": layer, "y": y, "x": x}








.. GENERATED FROM PYTHON SOURCE LINES 62-63

The vertical grid discretization (tops and bottoms) are set with a 1D DataArray.

.. GENERATED FROM PYTHON SOURCE LINES 63-70

.. code-block:: Python


    surface = 0.0
    interfaces = np.insert((surface - np.cumsum(dz)), 0, surface)

    bottom = xr.DataArray(interfaces[1:], coords={"layer": layer}, dims="layer")
    top = xr.DataArray(interfaces[:-1], coords={"layer": layer}, dims="layer")








.. GENERATED FROM PYTHON SOURCE LINES 71-73

We'll have to create a time discretization as well.
Create 1 year of monthly timesteps

.. GENERATED FROM PYTHON SOURCE LINES 73-75

.. code-block:: Python

    times = pd.date_range(start="1/1/2018", end="12/1/2018", freq="MS")








.. GENERATED FROM PYTHON SOURCE LINES 76-78

We'll create our first 3 dimensional grid here,
the `ibound` grid, which sets where active cells are `(ibound = 1.0)`

.. GENERATED FROM PYTHON SOURCE LINES 78-81

.. code-block:: Python

    ibound = xr.DataArray(np.ones(shape), coords=coords, dims=dims)
    ibound






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    html[data-theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (layer: 3, y: 9, x: 9)&gt; Size: 2kB
    array([[[1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.]],

           [[1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.]],

           [[1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.]]])
    Coordinates:
      * layer    (layer) int64 24B 1 2 3
      * y        (y) float64 72B 850.0 750.0 650.0 550.0 ... 350.0 250.0 150.0 50.0
      * x        (x) float64 72B 50.0 150.0 250.0 350.0 ... 550.0 650.0 750.0 850.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>layer</span>: 3</li><li><span class='xr-has-index'>y</span>: 9</li><li><span class='xr-has-index'>x</span>: 9</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-b4d14a4a-8a81-411e-9518-64f42cc04239' class='xr-array-in' type='checkbox' checked><label for='section-b4d14a4a-8a81-411e-9518-64f42cc04239' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 ... 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0</span></div><div class='xr-array-data'><pre>array([[[1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.]],

           [[1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.]],

           [[1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.]]])</pre></div></div></li><li class='xr-section-item'><input id='section-1ac70794-49a2-46cc-9b40-d10b287c4ebc' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1ac70794-49a2-46cc-9b40-d10b287c4ebc' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3</div><input id='attrs-a667596d-1846-4e1c-ae71-15e0f38be930' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a667596d-1846-4e1c-ae71-15e0f38be930' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-10ac0f6f-b491-43e2-9ddf-7824b3299c8b' class='xr-var-data-in' type='checkbox'><label for='data-10ac0f6f-b491-43e2-9ddf-7824b3299c8b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1, 2, 3])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>850.0 750.0 650.0 ... 150.0 50.0</div><input id='attrs-1ffa94d0-dd4c-4ffc-b4c1-2d3e7b24d9da' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1ffa94d0-dd4c-4ffc-b4c1-2d3e7b24d9da' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fa294dfa-199e-4af6-93bc-972c7df90568' class='xr-var-data-in' type='checkbox'><label for='data-fa294dfa-199e-4af6-93bc-972c7df90568' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([850., 750., 650., 550., 450., 350., 250., 150.,  50.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>50.0 150.0 250.0 ... 750.0 850.0</div><input id='attrs-7c9e553d-8dc0-4d81-8eff-0fc518be3087' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7c9e553d-8dc0-4d81-8eff-0fc518be3087' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-659ea8f8-7982-445c-b8b9-c718797d37a7' class='xr-var-data-in' type='checkbox'><label for='data-659ea8f8-7982-445c-b8b9-c718797d37a7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 50., 150., 250., 350., 450., 550., 650., 750., 850.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b7e6121b-c0f9-41fa-b640-46b7dbdf8b2b' class='xr-section-summary-in' type='checkbox'  ><label for='section-b7e6121b-c0f9-41fa-b640-46b7dbdf8b2b' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>layer</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-4974e8a5-a198-4f2b-b916-e1d6473d2f34' class='xr-index-data-in' type='checkbox'/><label for='index-4974e8a5-a198-4f2b-b916-e1d6473d2f34' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3], dtype=&#x27;int64&#x27;, name=&#x27;layer&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d27f264e-f836-4344-a710-7e7e151649fa' class='xr-index-data-in' type='checkbox'/><label for='index-d27f264e-f836-4344-a710-7e7e151649fa' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([850.0, 750.0, 650.0, 550.0, 450.0, 350.0, 250.0, 150.0, 50.0], dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-023aed4e-20c6-4ad0-8a88-8c6838a184c8' class='xr-index-data-in' type='checkbox'/><label for='index-023aed4e-20c6-4ad0-8a88-8c6838a184c8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([50.0, 150.0, 250.0, 350.0, 450.0, 550.0, 650.0, 750.0, 850.0], dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5547e734-4337-4ea0-9e54-80431c610be4' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-5547e734-4337-4ea0-9e54-80431c610be4' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 82-87

Hydrogeology
------------

We'll create a very simple hydrogeology,
by specifying kh, kva, and sto as constants

.. GENERATED FROM PYTHON SOURCE LINES 87-92

.. code-block:: Python


    kh = 10.0
    kva = 1.0
    sto = 0.001








.. GENERATED FROM PYTHON SOURCE LINES 93-100

Initial conditions
------------------

We do not put much effort in the creation of the initial conditions
in this example, instead we copy the ibounds.
This is a 3D grid filled with the value 1, and we can use it as a
inital condition as well.

.. GENERATED FROM PYTHON SOURCE LINES 100-102

.. code-block:: Python

    starting_head = ibound.copy()








.. GENERATED FROM PYTHON SOURCE LINES 103-117

Boundary conditions
-------------------

We will put some more effort in creating some complex
boundary conditions. We'll create both two outer ditches
with a rising stage, as well as a central ditch with periodic
(summer-winter) stage.

Rising outer ditches
~~~~~~~~~~~~~~~~~~~~

First, we'll create rising trend,
by creating a 1D array ones with the same size as the time dimension,
and computing the cumulative sum over it.

.. GENERATED FROM PYTHON SOURCE LINES 117-123

.. code-block:: Python

    trend = np.ones(times[:-1].shape)
    trend = np.cumsum(trend)
    trend_da = xr.DataArray(trend, coords={"time": times[:-1]}, dims=["time"])

    trend_da






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    html[data-theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (time: 11)&gt; Size: 88B
    array([ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11.])
    Coordinates:
      * time     (time) datetime64[ns] 88B 2018-01-01 2018-02-01 ... 2018-11-01</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 11</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-6b6393be-219a-404c-866a-723e97dd82aa' class='xr-array-in' type='checkbox' checked><label for='section-6b6393be-219a-404c-866a-723e97dd82aa' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0</span></div><div class='xr-array-data'><pre>array([ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11.])</pre></div></div></li><li class='xr-section-item'><input id='section-691e6152-d2c2-46b7-ac0c-9b413c26f046' class='xr-section-summary-in' type='checkbox'  checked><label for='section-691e6152-d2c2-46b7-ac0c-9b413c26f046' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2018-01-01 ... 2018-11-01</div><input id='attrs-746ed0e1-9308-4bd8-9762-3a2d4b5ebf3d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-746ed0e1-9308-4bd8-9762-3a2d4b5ebf3d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-81c64b96-a21d-4198-89cf-d5a64efecb5f' class='xr-var-data-in' type='checkbox'><label for='data-81c64b96-a21d-4198-89cf-d5a64efecb5f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2018-01-01T00:00:00.000000000&#x27;, &#x27;2018-02-01T00:00:00.000000000&#x27;,
           &#x27;2018-03-01T00:00:00.000000000&#x27;, &#x27;2018-04-01T00:00:00.000000000&#x27;,
           &#x27;2018-05-01T00:00:00.000000000&#x27;, &#x27;2018-06-01T00:00:00.000000000&#x27;,
           &#x27;2018-07-01T00:00:00.000000000&#x27;, &#x27;2018-08-01T00:00:00.000000000&#x27;,
           &#x27;2018-09-01T00:00:00.000000000&#x27;, &#x27;2018-10-01T00:00:00.000000000&#x27;,
           &#x27;2018-11-01T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-79d40ce9-d8ca-4233-b4c9-63b9c9cd95ba' class='xr-section-summary-in' type='checkbox'  ><label for='section-79d40ce9-d8ca-4233-b4c9-63b9c9cd95ba' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-cdd97359-e5ac-42c6-816a-f164a4e8a63a' class='xr-index-data-in' type='checkbox'/><label for='index-cdd97359-e5ac-42c6-816a-f164a4e8a63a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2018-01-01&#x27;, &#x27;2018-02-01&#x27;, &#x27;2018-03-01&#x27;, &#x27;2018-04-01&#x27;,
                   &#x27;2018-05-01&#x27;, &#x27;2018-06-01&#x27;, &#x27;2018-07-01&#x27;, &#x27;2018-08-01&#x27;,
                   &#x27;2018-09-01&#x27;, &#x27;2018-10-01&#x27;, &#x27;2018-11-01&#x27;],
                  dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=&#x27;MS&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2f54617e-fb61-4641-8cb8-cabeaf48531e' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-2f54617e-fb61-4641-8cb8-cabeaf48531e' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 124-125

Next, we assign values only to edges of model x domain.

.. GENERATED FROM PYTHON SOURCE LINES 125-130

.. code-block:: Python


    is_x_edge = starting_head.x.isin([x[0], x[-1]])
    head_edge = starting_head.where(is_x_edge)
    head_edge






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    html[data-theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (layer: 3, y: 9, x: 9)&gt; Size: 2kB
    array([[[ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.]],

           [[ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.]],

           [[ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.]]])
    Coordinates:
      * layer    (layer) int64 24B 1 2 3
      * y        (y) float64 72B 850.0 750.0 650.0 550.0 ... 350.0 250.0 150.0 50.0
      * x        (x) float64 72B 50.0 150.0 250.0 350.0 ... 550.0 650.0 750.0 850.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>layer</span>: 3</li><li><span class='xr-has-index'>y</span>: 9</li><li><span class='xr-has-index'>x</span>: 9</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-4c1585b0-612a-4775-8237-add2e664906f' class='xr-array-in' type='checkbox' checked><label for='section-4c1585b0-612a-4775-8237-add2e664906f' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1.0 nan nan nan nan nan nan nan ... nan nan nan nan nan nan nan 1.0</span></div><div class='xr-array-data'><pre>array([[[ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.]],

           [[ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.]],

           [[ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.],
            [ 1., nan, nan, nan, nan, nan, nan, nan,  1.]]])</pre></div></div></li><li class='xr-section-item'><input id='section-8c65d63d-0451-4bbf-9c2a-6f183aa23b10' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8c65d63d-0451-4bbf-9c2a-6f183aa23b10' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3</div><input id='attrs-fe2a26b0-a500-4b52-9ca5-813560966dac' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fe2a26b0-a500-4b52-9ca5-813560966dac' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4e34673e-b464-4256-a932-0d8b2c8d6d05' class='xr-var-data-in' type='checkbox'><label for='data-4e34673e-b464-4256-a932-0d8b2c8d6d05' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1, 2, 3])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>850.0 750.0 650.0 ... 150.0 50.0</div><input id='attrs-fe857944-17ba-41ec-94f5-15579857c00a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fe857944-17ba-41ec-94f5-15579857c00a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-31a6a87a-6bbf-46dc-a0aa-e9c3111ace78' class='xr-var-data-in' type='checkbox'><label for='data-31a6a87a-6bbf-46dc-a0aa-e9c3111ace78' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([850., 750., 650., 550., 450., 350., 250., 150.,  50.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>50.0 150.0 250.0 ... 750.0 850.0</div><input id='attrs-6005ae68-d899-412d-9942-edd427120b70' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6005ae68-d899-412d-9942-edd427120b70' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-672a7f66-977e-402b-9605-c3749b7d40b4' class='xr-var-data-in' type='checkbox'><label for='data-672a7f66-977e-402b-9605-c3749b7d40b4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 50., 150., 250., 350., 450., 550., 650., 750., 850.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9cccd6ed-08dd-4d1e-a84a-4c5c0822bf90' class='xr-section-summary-in' type='checkbox'  ><label for='section-9cccd6ed-08dd-4d1e-a84a-4c5c0822bf90' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>layer</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-64dbf9f5-fa58-473e-82ad-b30c46a63704' class='xr-index-data-in' type='checkbox'/><label for='index-64dbf9f5-fa58-473e-82ad-b30c46a63704' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3], dtype=&#x27;int64&#x27;, name=&#x27;layer&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-b0dde19c-a2d1-40ba-9811-c8b68bc47b58' class='xr-index-data-in' type='checkbox'/><label for='index-b0dde19c-a2d1-40ba-9811-c8b68bc47b58' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([850.0, 750.0, 650.0, 550.0, 450.0, 350.0, 250.0, 150.0, 50.0], dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-0ec4edaf-992f-49fd-b5af-983f76b4f96e' class='xr-index-data-in' type='checkbox'/><label for='index-0ec4edaf-992f-49fd-b5af-983f76b4f96e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([50.0, 150.0, 250.0, 350.0, 450.0, 550.0, 650.0, 750.0, 850.0], dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-55b8f234-31f9-4aea-bcfc-1ac24c403572' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-55b8f234-31f9-4aea-bcfc-1ac24c403572' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 131-137

Now let's multiply our
1D DataArray with dimension ``time``, with the static 3D grid
with dimension ``layer, y, x``,
which xarray automatically broadcasts to a 4D array,
with dimensions ``time, layer, y, x``
This finishes our

.. GENERATED FROM PYTHON SOURCE LINES 137-141

.. code-block:: Python


    head_edge_rising = trend_da * head_edge
    head_edge_rising






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    html[data-theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (time: 11, layer: 3, y: 9, x: 9)&gt; Size: 21kB
    array([[[[ 1., nan, nan, ..., nan, nan,  1.],
             [ 1., nan, nan, ..., nan, nan,  1.],
             [ 1., nan, nan, ..., nan, nan,  1.],
             ...,
             [ 1., nan, nan, ..., nan, nan,  1.],
             [ 1., nan, nan, ..., nan, nan,  1.],
             [ 1., nan, nan, ..., nan, nan,  1.]],

            [[ 1., nan, nan, ..., nan, nan,  1.],
             [ 1., nan, nan, ..., nan, nan,  1.],
             [ 1., nan, nan, ..., nan, nan,  1.],
             ...,
             [ 1., nan, nan, ..., nan, nan,  1.],
             [ 1., nan, nan, ..., nan, nan,  1.],
             [ 1., nan, nan, ..., nan, nan,  1.]],

            [[ 1., nan, nan, ..., nan, nan,  1.],
             [ 1., nan, nan, ..., nan, nan,  1.],
             [ 1., nan, nan, ..., nan, nan,  1.],
             ...,
    ...
             ...,
             [11., nan, nan, ..., nan, nan, 11.],
             [11., nan, nan, ..., nan, nan, 11.],
             [11., nan, nan, ..., nan, nan, 11.]],

            [[11., nan, nan, ..., nan, nan, 11.],
             [11., nan, nan, ..., nan, nan, 11.],
             [11., nan, nan, ..., nan, nan, 11.],
             ...,
             [11., nan, nan, ..., nan, nan, 11.],
             [11., nan, nan, ..., nan, nan, 11.],
             [11., nan, nan, ..., nan, nan, 11.]],

            [[11., nan, nan, ..., nan, nan, 11.],
             [11., nan, nan, ..., nan, nan, 11.],
             [11., nan, nan, ..., nan, nan, 11.],
             ...,
             [11., nan, nan, ..., nan, nan, 11.],
             [11., nan, nan, ..., nan, nan, 11.],
             [11., nan, nan, ..., nan, nan, 11.]]]])
    Coordinates:
      * time     (time) datetime64[ns] 88B 2018-01-01 2018-02-01 ... 2018-11-01
      * layer    (layer) int64 24B 1 2 3
      * y        (y) float64 72B 850.0 750.0 650.0 550.0 ... 350.0 250.0 150.0 50.0
      * x        (x) float64 72B 50.0 150.0 250.0 350.0 ... 550.0 650.0 750.0 850.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 11</li><li><span class='xr-has-index'>layer</span>: 3</li><li><span class='xr-has-index'>y</span>: 9</li><li><span class='xr-has-index'>x</span>: 9</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-71465e4c-4a44-4f7a-ae27-cd3bc91cb6c9' class='xr-array-in' type='checkbox' checked><label for='section-71465e4c-4a44-4f7a-ae27-cd3bc91cb6c9' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1.0 nan nan nan nan nan nan nan ... nan nan nan nan nan nan nan 11.0</span></div><div class='xr-array-data'><pre>array([[[[ 1., nan, nan, ..., nan, nan,  1.],
             [ 1., nan, nan, ..., nan, nan,  1.],
             [ 1., nan, nan, ..., nan, nan,  1.],
             ...,
             [ 1., nan, nan, ..., nan, nan,  1.],
             [ 1., nan, nan, ..., nan, nan,  1.],
             [ 1., nan, nan, ..., nan, nan,  1.]],

            [[ 1., nan, nan, ..., nan, nan,  1.],
             [ 1., nan, nan, ..., nan, nan,  1.],
             [ 1., nan, nan, ..., nan, nan,  1.],
             ...,
             [ 1., nan, nan, ..., nan, nan,  1.],
             [ 1., nan, nan, ..., nan, nan,  1.],
             [ 1., nan, nan, ..., nan, nan,  1.]],

            [[ 1., nan, nan, ..., nan, nan,  1.],
             [ 1., nan, nan, ..., nan, nan,  1.],
             [ 1., nan, nan, ..., nan, nan,  1.],
             ...,
    ...
             ...,
             [11., nan, nan, ..., nan, nan, 11.],
             [11., nan, nan, ..., nan, nan, 11.],
             [11., nan, nan, ..., nan, nan, 11.]],

            [[11., nan, nan, ..., nan, nan, 11.],
             [11., nan, nan, ..., nan, nan, 11.],
             [11., nan, nan, ..., nan, nan, 11.],
             ...,
             [11., nan, nan, ..., nan, nan, 11.],
             [11., nan, nan, ..., nan, nan, 11.],
             [11., nan, nan, ..., nan, nan, 11.]],

            [[11., nan, nan, ..., nan, nan, 11.],
             [11., nan, nan, ..., nan, nan, 11.],
             [11., nan, nan, ..., nan, nan, 11.],
             ...,
             [11., nan, nan, ..., nan, nan, 11.],
             [11., nan, nan, ..., nan, nan, 11.],
             [11., nan, nan, ..., nan, nan, 11.]]]])</pre></div></div></li><li class='xr-section-item'><input id='section-d8160d04-e583-4b17-90a5-66a84d162395' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d8160d04-e583-4b17-90a5-66a84d162395' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2018-01-01 ... 2018-11-01</div><input id='attrs-dfde75d4-3085-4f71-a1f8-0044d30764a3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-dfde75d4-3085-4f71-a1f8-0044d30764a3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8627a03d-a243-4ace-ba53-63bfd57e90a2' class='xr-var-data-in' type='checkbox'><label for='data-8627a03d-a243-4ace-ba53-63bfd57e90a2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2018-01-01T00:00:00.000000000&#x27;, &#x27;2018-02-01T00:00:00.000000000&#x27;,
           &#x27;2018-03-01T00:00:00.000000000&#x27;, &#x27;2018-04-01T00:00:00.000000000&#x27;,
           &#x27;2018-05-01T00:00:00.000000000&#x27;, &#x27;2018-06-01T00:00:00.000000000&#x27;,
           &#x27;2018-07-01T00:00:00.000000000&#x27;, &#x27;2018-08-01T00:00:00.000000000&#x27;,
           &#x27;2018-09-01T00:00:00.000000000&#x27;, &#x27;2018-10-01T00:00:00.000000000&#x27;,
           &#x27;2018-11-01T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3</div><input id='attrs-71e8cbb1-3cf0-494e-aecb-052a6250c434' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-71e8cbb1-3cf0-494e-aecb-052a6250c434' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ca6bc4c8-bb85-4a2e-bb48-976784779f38' class='xr-var-data-in' type='checkbox'><label for='data-ca6bc4c8-bb85-4a2e-bb48-976784779f38' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1, 2, 3])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>850.0 750.0 650.0 ... 150.0 50.0</div><input id='attrs-2a80452a-8115-493d-86b6-01cc90458378' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2a80452a-8115-493d-86b6-01cc90458378' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e498a352-ea4f-4e88-8438-7b65c7e9e027' class='xr-var-data-in' type='checkbox'><label for='data-e498a352-ea4f-4e88-8438-7b65c7e9e027' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([850., 750., 650., 550., 450., 350., 250., 150.,  50.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>50.0 150.0 250.0 ... 750.0 850.0</div><input id='attrs-e893e72b-1401-489d-b120-326515b97e00' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e893e72b-1401-489d-b120-326515b97e00' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8d2c4141-7ce3-4ad1-b5cf-584bfe74cd51' class='xr-var-data-in' type='checkbox'><label for='data-8d2c4141-7ce3-4ad1-b5cf-584bfe74cd51' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 50., 150., 250., 350., 450., 550., 650., 750., 850.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-638b3343-8152-4e15-be77-bd19ac4ba086' class='xr-section-summary-in' type='checkbox'  ><label for='section-638b3343-8152-4e15-be77-bd19ac4ba086' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-63e6406f-bd64-46b3-874d-44febbd96c04' class='xr-index-data-in' type='checkbox'/><label for='index-63e6406f-bd64-46b3-874d-44febbd96c04' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2018-01-01&#x27;, &#x27;2018-02-01&#x27;, &#x27;2018-03-01&#x27;, &#x27;2018-04-01&#x27;,
                   &#x27;2018-05-01&#x27;, &#x27;2018-06-01&#x27;, &#x27;2018-07-01&#x27;, &#x27;2018-08-01&#x27;,
                   &#x27;2018-09-01&#x27;, &#x27;2018-10-01&#x27;, &#x27;2018-11-01&#x27;],
                  dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=&#x27;MS&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>layer</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-6e6f5798-fb6d-450b-bbe8-28d673da6d09' class='xr-index-data-in' type='checkbox'/><label for='index-6e6f5798-fb6d-450b-bbe8-28d673da6d09' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3], dtype=&#x27;int64&#x27;, name=&#x27;layer&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-00592de6-a6a6-45a3-b1a7-0a45fd703343' class='xr-index-data-in' type='checkbox'/><label for='index-00592de6-a6a6-45a3-b1a7-0a45fd703343' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([850.0, 750.0, 650.0, 550.0, 450.0, 350.0, 250.0, 150.0, 50.0], dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-39dbe9ff-2970-4c40-aec0-ff30ca27b20e' class='xr-index-data-in' type='checkbox'/><label for='index-39dbe9ff-2970-4c40-aec0-ff30ca27b20e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([50.0, 150.0, 250.0, 350.0, 450.0, 550.0, 650.0, 750.0, 850.0], dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9899094d-e914-4e6e-8931-bfccb10e804a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-9899094d-e914-4e6e-8931-bfccb10e804a' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 142-149

Periodic central ditch
~~~~~~~~~~~~~~~~~~~~~~

We'll take only the central column of the grid with
(``where``), the rest will be set to ``np.nan``,
and from this we'll select only the upper layer,
as the ditch will be located only in the upper layer.

.. GENERATED FROM PYTHON SOURCE LINES 149-153

.. code-block:: Python


    is_x_central = starting_head.x == x[4]
    head_central = starting_head.where(is_x_central).sel(layer=1)








.. GENERATED FROM PYTHON SOURCE LINES 154-162

Create period times, we let these times start before
the model starts.
This is necessary because `iMODFLOW` only forward fills periods.
Otherwise, in this case there wouldn't be a
periodic boundary condition until april.

We will do this by selecting the months april and october,
and then subtracting a year

.. GENERATED FROM PYTHON SOURCE LINES 162-164

.. code-block:: Python

    period_times = times[[3, 9]] - np.timedelta64(365, "D")








.. GENERATED FROM PYTHON SOURCE LINES 165-166

We are creating a summer and winter level.

.. GENERATED FROM PYTHON SOURCE LINES 166-171

.. code-block:: Python

    periods_da = xr.DataArray([4, 10], coords={"time": period_times}, dims=["time"])
    head_periodic = periods_da * head_central

    head_periodic






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    html[data-theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (time: 2, y: 9, x: 9)&gt; Size: 1kB
    array([[[nan, nan, nan, nan,  4., nan, nan, nan, nan],
            [nan, nan, nan, nan,  4., nan, nan, nan, nan],
            [nan, nan, nan, nan,  4., nan, nan, nan, nan],
            [nan, nan, nan, nan,  4., nan, nan, nan, nan],
            [nan, nan, nan, nan,  4., nan, nan, nan, nan],
            [nan, nan, nan, nan,  4., nan, nan, nan, nan],
            [nan, nan, nan, nan,  4., nan, nan, nan, nan],
            [nan, nan, nan, nan,  4., nan, nan, nan, nan],
            [nan, nan, nan, nan,  4., nan, nan, nan, nan]],

           [[nan, nan, nan, nan, 10., nan, nan, nan, nan],
            [nan, nan, nan, nan, 10., nan, nan, nan, nan],
            [nan, nan, nan, nan, 10., nan, nan, nan, nan],
            [nan, nan, nan, nan, 10., nan, nan, nan, nan],
            [nan, nan, nan, nan, 10., nan, nan, nan, nan],
            [nan, nan, nan, nan, 10., nan, nan, nan, nan],
            [nan, nan, nan, nan, 10., nan, nan, nan, nan],
            [nan, nan, nan, nan, 10., nan, nan, nan, nan],
            [nan, nan, nan, nan, 10., nan, nan, nan, nan]]])
    Coordinates:
      * time     (time) datetime64[ns] 16B 2017-04-01 2017-10-01
        layer    int64 8B 1
      * y        (y) float64 72B 850.0 750.0 650.0 550.0 ... 350.0 250.0 150.0 50.0
      * x        (x) float64 72B 50.0 150.0 250.0 350.0 ... 550.0 650.0 750.0 850.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 2</li><li><span class='xr-has-index'>y</span>: 9</li><li><span class='xr-has-index'>x</span>: 9</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-a0d83799-5688-4ced-bcd9-7b7ac6ba5be2' class='xr-array-in' type='checkbox' checked><label for='section-a0d83799-5688-4ced-bcd9-7b7ac6ba5be2' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>nan nan nan nan 4.0 nan nan nan ... nan nan nan 10.0 nan nan nan nan</span></div><div class='xr-array-data'><pre>array([[[nan, nan, nan, nan,  4., nan, nan, nan, nan],
            [nan, nan, nan, nan,  4., nan, nan, nan, nan],
            [nan, nan, nan, nan,  4., nan, nan, nan, nan],
            [nan, nan, nan, nan,  4., nan, nan, nan, nan],
            [nan, nan, nan, nan,  4., nan, nan, nan, nan],
            [nan, nan, nan, nan,  4., nan, nan, nan, nan],
            [nan, nan, nan, nan,  4., nan, nan, nan, nan],
            [nan, nan, nan, nan,  4., nan, nan, nan, nan],
            [nan, nan, nan, nan,  4., nan, nan, nan, nan]],

           [[nan, nan, nan, nan, 10., nan, nan, nan, nan],
            [nan, nan, nan, nan, 10., nan, nan, nan, nan],
            [nan, nan, nan, nan, 10., nan, nan, nan, nan],
            [nan, nan, nan, nan, 10., nan, nan, nan, nan],
            [nan, nan, nan, nan, 10., nan, nan, nan, nan],
            [nan, nan, nan, nan, 10., nan, nan, nan, nan],
            [nan, nan, nan, nan, 10., nan, nan, nan, nan],
            [nan, nan, nan, nan, 10., nan, nan, nan, nan],
            [nan, nan, nan, nan, 10., nan, nan, nan, nan]]])</pre></div></div></li><li class='xr-section-item'><input id='section-b4cc4095-5394-4b33-b9fa-37397e06f581' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b4cc4095-5394-4b33-b9fa-37397e06f581' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2017-04-01 2017-10-01</div><input id='attrs-bd45fd3c-c5d8-41b9-aea9-9b5700d02141' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bd45fd3c-c5d8-41b9-aea9-9b5700d02141' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-40510c06-bf84-4cef-b526-3c08e2744835' class='xr-var-data-in' type='checkbox'><label for='data-40510c06-bf84-4cef-b526-3c08e2744835' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2017-04-01T00:00:00.000000000&#x27;, &#x27;2017-10-01T00:00:00.000000000&#x27;],
          dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>layer</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1</div><input id='attrs-f6e3d9fc-2341-40b7-af4d-16a4b4b62115' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f6e3d9fc-2341-40b7-af4d-16a4b4b62115' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fee8881f-e05c-4565-a8b8-c93fdf86d1ad' class='xr-var-data-in' type='checkbox'><label for='data-fee8881f-e05c-4565-a8b8-c93fdf86d1ad' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>850.0 750.0 650.0 ... 150.0 50.0</div><input id='attrs-3ced6194-64ff-41cd-b577-b6745a409759' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3ced6194-64ff-41cd-b577-b6745a409759' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c42cf1c0-f675-4839-9493-5448fd831f15' class='xr-var-data-in' type='checkbox'><label for='data-c42cf1c0-f675-4839-9493-5448fd831f15' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([850., 750., 650., 550., 450., 350., 250., 150.,  50.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>50.0 150.0 250.0 ... 750.0 850.0</div><input id='attrs-71a7ab1e-0083-46fd-8337-fae2c75b3614' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-71a7ab1e-0083-46fd-8337-fae2c75b3614' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-37e64bdd-081d-45c8-9f68-04401687a378' class='xr-var-data-in' type='checkbox'><label for='data-37e64bdd-081d-45c8-9f68-04401687a378' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 50., 150., 250., 350., 450., 550., 650., 750., 850.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4932df77-51eb-4515-965b-63d21beadc91' class='xr-section-summary-in' type='checkbox'  ><label for='section-4932df77-51eb-4515-965b-63d21beadc91' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d3aa1655-6d8f-474b-955a-ef86af399126' class='xr-index-data-in' type='checkbox'/><label for='index-d3aa1655-6d8f-474b-955a-ef86af399126' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2017-04-01&#x27;, &#x27;2017-10-01&#x27;], dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-c2f5b35b-c246-4f24-a791-89d306bbfe30' class='xr-index-data-in' type='checkbox'/><label for='index-c2f5b35b-c246-4f24-a791-89d306bbfe30' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([850.0, 750.0, 650.0, 550.0, 450.0, 350.0, 250.0, 150.0, 50.0], dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-5899682d-44ad-4c0e-b8ac-067912de3368' class='xr-index-data-in' type='checkbox'/><label for='index-5899682d-44ad-4c0e-b8ac-067912de3368' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([50.0, 150.0, 250.0, 350.0, 450.0, 550.0, 650.0, 750.0, 850.0], dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d505bfda-2c5f-4b8e-a9d6-a0924518944c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d505bfda-2c5f-4b8e-a9d6-a0924518944c' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 172-174

Create dictionary to tell `iMOD`
which period name corresponds to which date.

.. GENERATED FROM PYTHON SOURCE LINES 174-179

.. code-block:: Python

    timemap = {
        period_times[0]: "summer",
        period_times[1]: "winter",
    }








.. GENERATED FROM PYTHON SOURCE LINES 180-187

Wells
~~~~~

Wells are specified as a pandas dataframe.
We create a diagonal line of wells through the domain.

Because we can.

.. GENERATED FROM PYTHON SOURCE LINES 187-198

.. code-block:: Python


    wel_df = pd.DataFrame()
    wel_df["id_name"] = np.arange(len(x)).astype(str)
    wel_df["x"] = x
    wel_df["y"] = y
    wel_df["rate"] = dx * dy * -1 * 0.5
    wel_df["time"] = np.tile(times[:-1], 2)[: len(x)]
    wel_df["layer"] = 2

    wel_df






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>id_name</th>
          <th>x</th>
          <th>y</th>
          <th>rate</th>
          <th>time</th>
          <th>layer</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>0</td>
          <td>50.0</td>
          <td>850.0</td>
          <td>5000.0</td>
          <td>2018-01-01</td>
          <td>2</td>
        </tr>
        <tr>
          <th>1</th>
          <td>1</td>
          <td>150.0</td>
          <td>750.0</td>
          <td>5000.0</td>
          <td>2018-02-01</td>
          <td>2</td>
        </tr>
        <tr>
          <th>2</th>
          <td>2</td>
          <td>250.0</td>
          <td>650.0</td>
          <td>5000.0</td>
          <td>2018-03-01</td>
          <td>2</td>
        </tr>
        <tr>
          <th>3</th>
          <td>3</td>
          <td>350.0</td>
          <td>550.0</td>
          <td>5000.0</td>
          <td>2018-04-01</td>
          <td>2</td>
        </tr>
        <tr>
          <th>4</th>
          <td>4</td>
          <td>450.0</td>
          <td>450.0</td>
          <td>5000.0</td>
          <td>2018-05-01</td>
          <td>2</td>
        </tr>
        <tr>
          <th>5</th>
          <td>5</td>
          <td>550.0</td>
          <td>350.0</td>
          <td>5000.0</td>
          <td>2018-06-01</td>
          <td>2</td>
        </tr>
        <tr>
          <th>6</th>
          <td>6</td>
          <td>650.0</td>
          <td>250.0</td>
          <td>5000.0</td>
          <td>2018-07-01</td>
          <td>2</td>
        </tr>
        <tr>
          <th>7</th>
          <td>7</td>
          <td>750.0</td>
          <td>150.0</td>
          <td>5000.0</td>
          <td>2018-08-01</td>
          <td>2</td>
        </tr>
        <tr>
          <th>8</th>
          <td>8</td>
          <td>850.0</td>
          <td>50.0</td>
          <td>5000.0</td>
          <td>2018-09-01</td>
          <td>2</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 199-203

Horizontal Flow Barrier
-----------------------

Create barriers between ditches in layer 1 and 2 (but not 3).

.. GENERATED FROM PYTHON SOURCE LINES 203-207

.. code-block:: Python


    line1 = LineString([(x[2], ymin), (x[2], ymax)])
    line2 = LineString([(x[7], ymin), (x[7], ymax)])








.. GENERATED FROM PYTHON SOURCE LINES 208-209

We'll have to repeat each line for each layer

.. GENERATED FROM PYTHON SOURCE LINES 209-212

.. code-block:: Python

    lines = np.array([line1, line2, line1, line2], dtype="object")
    hfb_layers = np.array([1, 1, 2, 2])








.. GENERATED FROM PYTHON SOURCE LINES 213-214

We can specify names for our own bookkeeping

.. GENERATED FROM PYTHON SOURCE LINES 214-225

.. code-block:: Python

    id_name = ["left_upper", "right_upper", "left_lower", "right_lower"]

    # The hfb has to specified as a geopandas `GeoDataFrame
    # <https://geopandas.org/en/stable/docs/reference/api/geopandas.GeoDataFrame.html>`_

    hfb_gdf = gpd.GeoDataFrame(
        geometry=lines, data={"id_name": id_name, "layer": hfb_layers, "resistance": 100.0}
    )

    hfb_gdf






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>id_name</th>
          <th>layer</th>
          <th>resistance</th>
          <th>geometry</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>left_upper</td>
          <td>1</td>
          <td>100.0</td>
          <td>LINESTRING (250 0, 250 900)</td>
        </tr>
        <tr>
          <th>1</th>
          <td>right_upper</td>
          <td>1</td>
          <td>100.0</td>
          <td>LINESTRING (750 0, 750 900)</td>
        </tr>
        <tr>
          <th>2</th>
          <td>left_lower</td>
          <td>2</td>
          <td>100.0</td>
          <td>LINESTRING (250 0, 250 900)</td>
        </tr>
        <tr>
          <th>3</th>
          <td>right_lower</td>
          <td>2</td>
          <td>100.0</td>
          <td>LINESTRING (750 0, 750 900)</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 226-230

Build
-----

Finally, we build the model.

.. GENERATED FROM PYTHON SOURCE LINES 230-246

.. code-block:: Python


    m = flow.ImodflowModel("my_first_imodflow_model")
    m["pcg"] = flow.PreconditionedConjugateGradientSolver()

    m["bnd"] = flow.Boundary(ibound)
    m["top"] = flow.Top(top)
    m["bottom"] = flow.Bottom(bottom)

    m["khv"] = flow.HorizontalHydraulicConductivity(kh)
    m["kva"] = flow.VerticalAnisotropy(kva)
    m["sto"] = flow.StorageCoefficient(sto)

    m["shd"] = flow.StartingHead(starting_head)

    m["chd"] = flow.ConstantHead(head=head_edge_rising)








.. GENERATED FROM PYTHON SOURCE LINES 247-249

Create periodic boundary condition
and specify it as a periodic stress package.

.. GENERATED FROM PYTHON SOURCE LINES 249-252

.. code-block:: Python

    m["ghb"] = flow.GeneralHeadBoundary(head=head_periodic, conductance=10.0)
    m["ghb"].periodic_stress(timemap)








.. GENERATED FROM PYTHON SOURCE LINES 253-254

We can specify a second stress package as follows:

.. GENERATED FROM PYTHON SOURCE LINES 254-262

.. code-block:: Python

    m["ghb2"] = flow.GeneralHeadBoundary(head=head_periodic + 10.0, conductance=1.0)
    # You also need to specify periodic stresses for second system.
    m["ghb2"].periodic_stress(timemap)

    m["wel"] = flow.Well(**wel_df)

    m["hfb"] = flow.HorizontalFlowBarrier(**hfb_gdf)








.. GENERATED FROM PYTHON SOURCE LINES 263-264

Specify output control; -1 specifies to save the output of interest for all layers.

.. GENERATED FROM PYTHON SOURCE LINES 264-267

.. code-block:: Python


    m["oc"] = flow.OutputControl(save_head=-1, save_flux=-1)








.. GENERATED FROM PYTHON SOURCE LINES 268-269

imod-python wants you to provide the model endtime to your time_discretization!

.. GENERATED FROM PYTHON SOURCE LINES 269-271

.. code-block:: Python

    m.create_time_discretization(additional_times=times[-1])








.. GENERATED FROM PYTHON SOURCE LINES 272-275

Now we write the model
Writes both .IDFs as well as projectfile, an inifile,
and a .tim file that contains the time discretization.

.. GENERATED FROM PYTHON SOURCE LINES 275-279

.. code-block:: Python


    modeldir = imod.util.temporary_directory()
    m.write(directory=modeldir)








.. GENERATED FROM PYTHON SOURCE LINES 280-302

Run
---

You can run the model using the comand prompt and the iMOD executables.
This is part of the iMOD v5 release, which can be downloaded here:
https://oss.deltares.nl/web/imod/download-imod5 .
iMOD only works on Windows.

To run your model, open up a command prompt
and run the following commands:

.. code-block:: batch

   cd c:\path\to\modeldir
   c:\path\to\imod\folder\iMOD_v5_3_X64R.EXE config_run.ini
   c:\path\to\imod\folder\iMODFLOW_V5_3_METASWAP_SVN1977_X64R.EXE my_first_imodflow_model.nam

.. note::

   iMODFLOW requires you to change directory into the model directory
   before calling its executable. Otherwise the program will throw an error.



.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.609 seconds)


.. _sphx_glr_download_examples_imodflow_ImodflowProjectfile.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: ImodflowProjectfile.ipynb <ImodflowProjectfile.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: ImodflowProjectfile.py <ImodflowProjectfile.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: ImodflowProjectfile.zip <ImodflowProjectfile.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
