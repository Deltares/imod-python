
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "user-guide\08-regridding.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_user-guide_08-regridding.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_user-guide_08-regridding.py:


Regridding
==========

Most MF6 packages have spatial data arrays as input. These arrays
are discrete: they are defined over the simulation grid and contain
values associated to each cell.

Regridding these package means: create a new package with
spatial data arrays defined over a different grid. Computing what
the values in these new arrays should be, is done by xugrid.

xugrid will compute a regridded array based on:

- the original array
- the original discretization (this is described in the coordinates of the original arry)
- the new discretization
- a regridding method

More information on the available regridding methods can be found in the xugrid documentation
https://deltares.github.io/xugrid/user_guide.html

The regridding method that should be used depends on the property being
regridded. For example a point-based property (whose value do not depend
intrinsically on the grid block size) such as temperature or density can be
regridded by an averaging approach (for upscaling) or sampling (for
downscaling). Volume-based properties (whose values do depend on the grid block
size) include (water) mass and pore volume of a gridblock, and the regridding
method should be chosen to reflect that. Finally regridding methods for
conductivity-like properties follow the rules for parallel or serial resistors-
at least when the tensor rotation angles are constant or comparable in the
involved gridblocks.

Note that the different regridding methods may have a different output domain
when regridding: if the original array has no-data values in some cells, then
the output array may have no-data values as well, and where these end up depends
on the chosen regridding method. Also note that regridding is only possible in
the xy-plane, and not across the layer dimension. The output array will have the
same number of layers as the input array.

.. GENERATED FROM PYTHON SOURCE LINES 41-43

.. code-block:: Python
   :dedent: 1










.. GENERATED FROM PYTHON SOURCE LINES 45-87

Obtaining the final (i)domain
-----------------------------

In many real-world models, some cells will be inactive or marked as "vertical
passthrough" (VPT) in the idomain array of the simulation. Some packages require
that all cells that are inactictive or VPT in idomain are excluded from the
package as well. An example is the npf package: cells that are inactive or VPT
in idomain, should not have conductivity data in the npf package. Therefore at
the end of the regridding process, a final step consists in enforcing
consistency between those of idomain and all the packages. This is a 2-step
process:

1) for cells that do not have inputs in crucial packages like npf or storage,
   idomain will be set to inactive.
2) for cells that are marked as inactive or VPT in idomain, all package inputs
   will be removed from all the packages

This synchronization step between idomain and the packages is automated, and it
is carried out when calling regrid_like on the simulation object or the model
object. There are 2 caveats:

1) the synchronization between idomain and the package domains is done on the
   model-level. If we have a simulation containing both a flow model and a
   transport model then idomain for flow is determined independent from that for
   transport. These models may therefore end up using different domains (this
   may lead to undesired results, so a manual synchronization may be necessary
   between the flow regridding and the transport regridding) This manual
   synchronization can be done using the "mask_all_packages" function- this
   function removes input from all packages that are marked as inactive or VPT
   in the idomain passed to this method.
2) The idomain/packages synchronization step is carried out when regridding a
   model, and when regridding a model it will use default methods for all the
   packages. So if you have regridded some packages yourself with non-default
   methods, then these are not taken into account during this synchonization
   step.

Regridding using default methods
--------------------------------

The regrid_like function is available on packages, models and simulations.
When the default methods are acceptable, regridding the whole simulation is the most convenient
from a user-perspective.

.. GENERATED FROM PYTHON SOURCE LINES 87-94

.. code-block:: Python


    import imod

    tmpdir = imod.util.temporary_directory()

    original_simulation = imod.data.hondsrug_simulation(tmpdir / "hondsrug_saved")








.. GENERATED FROM PYTHON SOURCE LINES 95-97

To reduce computational overhead for this example, we are going to clip off
most of the timesteps.

.. GENERATED FROM PYTHON SOURCE LINES 97-100

.. code-block:: Python


    original_simulation = original_simulation.clip_box(time_max="2010-01-01")








.. GENERATED FROM PYTHON SOURCE LINES 101-102

Let's take a look at the original discretization:

.. GENERATED FROM PYTHON SOURCE LINES 102-105

.. code-block:: Python


    original_simulation["GWF"]["dis"]






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>StructuredDiscretization</div><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 11MB
    Dimensions:  (layer: 13, y: 200, x: 500)
    Coordinates:
      * x        (x) float64 4kB 2.375e+05 2.375e+05 2.376e+05 ... 2.5e+05 2.5e+05
      * y        (y) float64 2kB 5.64e+05 5.64e+05 5.639e+05 ... 5.59e+05 5.59e+05
        dx       float64 8B ...
        dy       float64 8B ...
      * layer    (layer) int32 52B 1 2 3 4 5 6 7 8 9 10 11 12 13
    Data variables:
        idomain  (layer, y, x) int32 5MB ...
        top      (y, x) float32 400kB ...
        bottom   (layer, y, x) float32 5MB ...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-5bcefb1c-536b-4717-9976-ad3e4fc59699' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-5bcefb1c-536b-4717-9976-ad3e4fc59699' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>layer</span>: 13</li><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>x</span>: 500</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-dfe40fe2-9368-4458-b1a4-ce6062fad155' class='xr-section-summary-in' type='checkbox'  checked><label for='section-dfe40fe2-9368-4458-b1a4-ce6062fad155' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-b8e22f9b-7682-46d0-aecd-c4e513b6aab8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b8e22f9b-7682-46d0-aecd-c4e513b6aab8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ec544953-4cb9-44e5-bbf2-0756c3c3f308' class='xr-var-data-in' type='checkbox'><label for='data-ec544953-4cb9-44e5-bbf2-0756c3c3f308' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5],
          shape=(500,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-99dcefcc-f511-4176-acde-a49089f786ba' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-99dcefcc-f511-4176-acde-a49089f786ba' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-75eec8d8-a393-41ea-a47a-1b5592a99839' class='xr-var-data-in' type='checkbox'><label for='data-75eec8d8-a393-41ea-a47a-1b5592a99839' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
           563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
           563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
           563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
           563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
           563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
           562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
           562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
           562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
           562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
           562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
           562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
           561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
           561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
           561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
           561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
           561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
           561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
           560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
           560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
           560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
           560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
           560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
           559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
           559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
           559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
           559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
           559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
           559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-4f61d561-126d-453b-a51c-d1b3b6469896' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4f61d561-126d-453b-a51c-d1b3b6469896' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ed2d9725-d647-4924-9eda-2b4167c090a3' class='xr-var-data-in' type='checkbox'><label for='data-ed2d9725-d647-4924-9eda-2b4167c090a3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-58dc9872-7453-4d8f-9efc-2a7da929e7cc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-58dc9872-7453-4d8f-9efc-2a7da929e7cc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2e70f7e5-0edd-4899-9c2f-5cda75617905' class='xr-var-data-in' type='checkbox'><label for='data-2e70f7e5-0edd-4899-9c2f-5cda75617905' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12 13</div><input id='attrs-7ddab2d9-6b55-4124-accc-2ae9917aedaa' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7ddab2d9-6b55-4124-accc-2ae9917aedaa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0dd4558f-bd77-4fc9-b3f3-b1970573c3e4' class='xr-var-data-in' type='checkbox'><label for='data-0dd4558f-bd77-4fc9-b3f3-b1970573c3e4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13], dtype=int32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-52e29c38-7b36-4765-a322-27a35b4a054a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-52e29c38-7b36-4765-a322-27a35b4a054a' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>idomain</span></div><div class='xr-var-dims'>(layer, y, x)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-49c3e616-f8f7-4fcb-acf7-b2277fc02f8d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-49c3e616-f8f7-4fcb-acf7-b2277fc02f8d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7e2f5a8a-2cda-4720-859d-fdde5ca9a3b4' class='xr-var-data-in' type='checkbox'><label for='data-7e2f5a8a-2cda-4720-859d-fdde5ca9a3b4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1300000 values with dtype=int32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>top</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-6678414e-f59d-42a9-9477-0527514f358d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6678414e-f59d-42a9-9477-0527514f358d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-39534033-2c43-40a2-af56-67794b5e238e' class='xr-var-data-in' type='checkbox'><label for='data-39534033-2c43-40a2-af56-67794b5e238e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[100000 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>bottom</span></div><div class='xr-var-dims'>(layer, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-0abee03e-d6e5-4554-a8c3-4f7cf585ab1b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0abee03e-d6e5-4554-a8c3-4f7cf585ab1b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f12c0d16-1075-407b-b70e-aa6dfc185def' class='xr-var-data-in' type='checkbox'><label for='data-f12c0d16-1075-407b-b70e-aa6dfc185def' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1300000 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1c8b6f83-b43c-4c34-b143-d97e16ecfe0e' class='xr-section-summary-in' type='checkbox'  ><label for='section-1c8b6f83-b43c-4c34-b143-d97e16ecfe0e' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-d402f524-070a-458e-adb0-64b98173e2b2' class='xr-index-data-in' type='checkbox'/><label for='index-d402f524-070a-458e-adb0-64b98173e2b2' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([237512.5, 237537.5, 237562.5, 237587.5, 237612.5, 237637.5, 237662.5,
           237687.5, 237712.5, 237737.5,
           ...
           249762.5, 249787.5, 249812.5, 249837.5, 249862.5, 249887.5, 249912.5,
           249937.5, 249962.5, 249987.5],
          dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=500))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-9daebfe2-ebbc-4935-bbd4-0c87442f2af5' class='xr-index-data-in' type='checkbox'/><label for='index-9daebfe2-ebbc-4935-bbd4-0c87442f2af5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
           563812.5, 563787.5, 563762.5,
           ...
           559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5, 559087.5,
           559062.5, 559037.5, 559012.5],
          dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=200))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>layer</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-0f674923-3032-44cf-8c7c-1902e26cbf78' class='xr-index-data-in' type='checkbox'/><label for='index-0f674923-3032-44cf-8c7c-1902e26cbf78' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], dtype=&#x27;int32&#x27;, name=&#x27;layer&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ade6ebf5-0ef4-41c4-b962-e792c37529e7' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-ade6ebf5-0ef4-41c4-b962-e792c37529e7' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 106-107

We want to regrid this to the following target grid:

.. GENERATED FROM PYTHON SOURCE LINES 107-123

.. code-block:: Python

    import xarray as xr

    import imod

    dx = 100
    dy = -100
    xmin = 237500.0
    xmax = 250000.0
    ymin = 559000.0
    ymax = 564000.0
    target_grid = imod.util.empty_2d(
        dx=dx, dy=dy, xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax
    )

    target_grid






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (y: 50, x: 125)&gt; Size: 50kB
    array([[nan, nan, nan, ..., nan, nan, nan],
           [nan, nan, nan, ..., nan, nan, nan],
           [nan, nan, nan, ..., nan, nan, nan],
           ...,
           [nan, nan, nan, ..., nan, nan, nan],
           [nan, nan, nan, ..., nan, nan, nan],
           [nan, nan, nan, ..., nan, nan, nan]], shape=(50, 125))
    Coordinates:
      * x        (x) float64 1kB 2.376e+05 2.376e+05 2.378e+05 ... 2.498e+05 2.5e+05
      * y        (y) float64 400B 5.64e+05 5.638e+05 ... 5.592e+05 5.59e+05
        dx       float64 8B 100.0
        dy       float64 8B -100.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 50</li><li><span class='xr-has-index'>x</span>: 125</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-319c8c3c-f2e4-49e1-8c78-9fcf86a99ec7' class='xr-array-in' type='checkbox' checked><label for='section-319c8c3c-f2e4-49e1-8c78-9fcf86a99ec7' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>nan nan nan nan nan nan nan nan ... nan nan nan nan nan nan nan nan</span></div><div class='xr-array-data'><pre>array([[nan, nan, nan, ..., nan, nan, nan],
           [nan, nan, nan, ..., nan, nan, nan],
           [nan, nan, nan, ..., nan, nan, nan],
           ...,
           [nan, nan, nan, ..., nan, nan, nan],
           [nan, nan, nan, ..., nan, nan, nan],
           [nan, nan, nan, ..., nan, nan, nan]], shape=(50, 125))</pre></div></div></li><li class='xr-section-item'><input id='section-91a10cac-c7bd-4eb0-bc44-11521a4d9202' class='xr-section-summary-in' type='checkbox'  checked><label for='section-91a10cac-c7bd-4eb0-bc44-11521a4d9202' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.376e+05 2.376e+05 ... 2.5e+05</div><input id='attrs-60d3e2cc-78bf-48f5-a439-79a54bc12b63' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-60d3e2cc-78bf-48f5-a439-79a54bc12b63' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dd50d608-51fd-422b-9f77-9bb00830fb43' class='xr-var-data-in' type='checkbox'><label for='data-dd50d608-51fd-422b-9f77-9bb00830fb43' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237550., 237650., 237750., 237850., 237950., 238050., 238150., 238250.,
           238350., 238450., 238550., 238650., 238750., 238850., 238950., 239050.,
           239150., 239250., 239350., 239450., 239550., 239650., 239750., 239850.,
           239950., 240050., 240150., 240250., 240350., 240450., 240550., 240650.,
           240750., 240850., 240950., 241050., 241150., 241250., 241350., 241450.,
           241550., 241650., 241750., 241850., 241950., 242050., 242150., 242250.,
           242350., 242450., 242550., 242650., 242750., 242850., 242950., 243050.,
           243150., 243250., 243350., 243450., 243550., 243650., 243750., 243850.,
           243950., 244050., 244150., 244250., 244350., 244450., 244550., 244650.,
           244750., 244850., 244950., 245050., 245150., 245250., 245350., 245450.,
           245550., 245650., 245750., 245850., 245950., 246050., 246150., 246250.,
           246350., 246450., 246550., 246650., 246750., 246850., 246950., 247050.,
           247150., 247250., 247350., 247450., 247550., 247650., 247750., 247850.,
           247950., 248050., 248150., 248250., 248350., 248450., 248550., 248650.,
           248750., 248850., 248950., 249050., 249150., 249250., 249350., 249450.,
           249550., 249650., 249750., 249850., 249950.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.638e+05 ... 5.59e+05</div><input id='attrs-a563b453-3a19-491e-9242-2ea8d0ebbd7f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a563b453-3a19-491e-9242-2ea8d0ebbd7f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2e45569b-8d24-4c0c-b88f-7ebb6a60dd1d' class='xr-var-data-in' type='checkbox'><label for='data-2e45569b-8d24-4c0c-b88f-7ebb6a60dd1d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563950., 563850., 563750., 563650., 563550., 563450., 563350., 563250.,
           563150., 563050., 562950., 562850., 562750., 562650., 562550., 562450.,
           562350., 562250., 562150., 562050., 561950., 561850., 561750., 561650.,
           561550., 561450., 561350., 561250., 561150., 561050., 560950., 560850.,
           560750., 560650., 560550., 560450., 560350., 560250., 560150., 560050.,
           559950., 559850., 559750., 559650., 559550., 559450., 559350., 559250.,
           559150., 559050.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>100.0</div><input id='attrs-f6ca8c39-3fee-4762-87e7-f61eac545464' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f6ca8c39-3fee-4762-87e7-f61eac545464' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7c346e5d-c761-4917-b69a-de39f8928785' class='xr-var-data-in' type='checkbox'><label for='data-7c346e5d-c761-4917-b69a-de39f8928785' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(100.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-100.0</div><input id='attrs-91cd8603-51f4-48f6-aa7e-8d9960ae70b1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-91cd8603-51f4-48f6-aa7e-8d9960ae70b1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bf3ba87e-c741-4e33-bf2e-1d15d71eddbc' class='xr-var-data-in' type='checkbox'><label for='data-bf3ba87e-c741-4e33-bf2e-1d15d71eddbc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-100.)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3290532c-cc0e-4f68-9bde-196169621424' class='xr-section-summary-in' type='checkbox'  ><label for='section-3290532c-cc0e-4f68-9bde-196169621424' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-d947099d-1b1c-4f5c-8013-881e6e474546' class='xr-index-data-in' type='checkbox'/><label for='index-d947099d-1b1c-4f5c-8013-881e6e474546' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([237550.0, 237650.0, 237750.0, 237850.0, 237950.0, 238050.0, 238150.0,
           238250.0, 238350.0, 238450.0,
           ...
           249050.0, 249150.0, 249250.0, 249350.0, 249450.0, 249550.0, 249650.0,
           249750.0, 249850.0, 249950.0],
          dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=125))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-91b97b40-ee6b-4d36-81b8-c8e59b938642' class='xr-index-data-in' type='checkbox'/><label for='index-91b97b40-ee6b-4d36-81b8-c8e59b938642' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([563950.0, 563850.0, 563750.0, 563650.0, 563550.0, 563450.0, 563350.0,
           563250.0, 563150.0, 563050.0, 562950.0, 562850.0, 562750.0, 562650.0,
           562550.0, 562450.0, 562350.0, 562250.0, 562150.0, 562050.0, 561950.0,
           561850.0, 561750.0, 561650.0, 561550.0, 561450.0, 561350.0, 561250.0,
           561150.0, 561050.0, 560950.0, 560850.0, 560750.0, 560650.0, 560550.0,
           560450.0, 560350.0, 560250.0, 560150.0, 560050.0, 559950.0, 559850.0,
           559750.0, 559650.0, 559550.0, 559450.0, 559350.0, 559250.0, 559150.0,
           559050.0],
          dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-cd9c6d2d-e4ec-48b1-8fcd-ac9e08d97080' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-cd9c6d2d-e4ec-48b1-8fcd-ac9e08d97080' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 124-126

This is a grid of nans, and we require a grid of ones, which can create with
xarray:

.. GENERATED FROM PYTHON SOURCE LINES 126-130

.. code-block:: Python

    target_grid = xr.ones_like(target_grid)

    target_grid






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (y: 50, x: 125)&gt; Size: 50kB
    array([[1., 1., 1., ..., 1., 1., 1.],
           [1., 1., 1., ..., 1., 1., 1.],
           [1., 1., 1., ..., 1., 1., 1.],
           ...,
           [1., 1., 1., ..., 1., 1., 1.],
           [1., 1., 1., ..., 1., 1., 1.],
           [1., 1., 1., ..., 1., 1., 1.]], shape=(50, 125))
    Coordinates:
      * x        (x) float64 1kB 2.376e+05 2.376e+05 2.378e+05 ... 2.498e+05 2.5e+05
      * y        (y) float64 400B 5.64e+05 5.638e+05 ... 5.592e+05 5.59e+05
        dx       float64 8B 100.0
        dy       float64 8B -100.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 50</li><li><span class='xr-has-index'>x</span>: 125</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-2b163180-9c03-4d61-a583-219dca0ae81f' class='xr-array-in' type='checkbox' checked><label for='section-2b163180-9c03-4d61-a583-219dca0ae81f' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 ... 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0</span></div><div class='xr-array-data'><pre>array([[1., 1., 1., ..., 1., 1., 1.],
           [1., 1., 1., ..., 1., 1., 1.],
           [1., 1., 1., ..., 1., 1., 1.],
           ...,
           [1., 1., 1., ..., 1., 1., 1.],
           [1., 1., 1., ..., 1., 1., 1.],
           [1., 1., 1., ..., 1., 1., 1.]], shape=(50, 125))</pre></div></div></li><li class='xr-section-item'><input id='section-1dc8bbb7-f4aa-41d7-9a42-65878351bb89' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1dc8bbb7-f4aa-41d7-9a42-65878351bb89' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.376e+05 2.376e+05 ... 2.5e+05</div><input id='attrs-9f244c39-364c-430c-95e6-bfda41bdfe0c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9f244c39-364c-430c-95e6-bfda41bdfe0c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d14874ef-799e-48c0-9417-6714e505bafa' class='xr-var-data-in' type='checkbox'><label for='data-d14874ef-799e-48c0-9417-6714e505bafa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237550., 237650., 237750., 237850., 237950., 238050., 238150., 238250.,
           238350., 238450., 238550., 238650., 238750., 238850., 238950., 239050.,
           239150., 239250., 239350., 239450., 239550., 239650., 239750., 239850.,
           239950., 240050., 240150., 240250., 240350., 240450., 240550., 240650.,
           240750., 240850., 240950., 241050., 241150., 241250., 241350., 241450.,
           241550., 241650., 241750., 241850., 241950., 242050., 242150., 242250.,
           242350., 242450., 242550., 242650., 242750., 242850., 242950., 243050.,
           243150., 243250., 243350., 243450., 243550., 243650., 243750., 243850.,
           243950., 244050., 244150., 244250., 244350., 244450., 244550., 244650.,
           244750., 244850., 244950., 245050., 245150., 245250., 245350., 245450.,
           245550., 245650., 245750., 245850., 245950., 246050., 246150., 246250.,
           246350., 246450., 246550., 246650., 246750., 246850., 246950., 247050.,
           247150., 247250., 247350., 247450., 247550., 247650., 247750., 247850.,
           247950., 248050., 248150., 248250., 248350., 248450., 248550., 248650.,
           248750., 248850., 248950., 249050., 249150., 249250., 249350., 249450.,
           249550., 249650., 249750., 249850., 249950.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.638e+05 ... 5.59e+05</div><input id='attrs-aadc62c3-8dce-4298-bd31-769e2193a843' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-aadc62c3-8dce-4298-bd31-769e2193a843' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-34a398e2-5606-4acd-9e11-1213cb9c1f05' class='xr-var-data-in' type='checkbox'><label for='data-34a398e2-5606-4acd-9e11-1213cb9c1f05' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563950., 563850., 563750., 563650., 563550., 563450., 563350., 563250.,
           563150., 563050., 562950., 562850., 562750., 562650., 562550., 562450.,
           562350., 562250., 562150., 562050., 561950., 561850., 561750., 561650.,
           561550., 561450., 561350., 561250., 561150., 561050., 560950., 560850.,
           560750., 560650., 560550., 560450., 560350., 560250., 560150., 560050.,
           559950., 559850., 559750., 559650., 559550., 559450., 559350., 559250.,
           559150., 559050.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>100.0</div><input id='attrs-9f104fc9-b8b2-4187-b4df-2a36c533fc3c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9f104fc9-b8b2-4187-b4df-2a36c533fc3c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3e54161c-ec5f-4389-ad94-94ba87f1bae2' class='xr-var-data-in' type='checkbox'><label for='data-3e54161c-ec5f-4389-ad94-94ba87f1bae2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(100.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-100.0</div><input id='attrs-acaa4de8-6cbf-4d29-b5ff-50208f2495b0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-acaa4de8-6cbf-4d29-b5ff-50208f2495b0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-67523216-7ff9-4551-aa20-30c38a4127e9' class='xr-var-data-in' type='checkbox'><label for='data-67523216-7ff9-4551-aa20-30c38a4127e9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-100.)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-fcbbef0c-6003-4823-a442-7e3476b9f52a' class='xr-section-summary-in' type='checkbox'  ><label for='section-fcbbef0c-6003-4823-a442-7e3476b9f52a' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-cf7f0e01-658b-47fd-88ec-d202c9bd56dc' class='xr-index-data-in' type='checkbox'/><label for='index-cf7f0e01-658b-47fd-88ec-d202c9bd56dc' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([237550.0, 237650.0, 237750.0, 237850.0, 237950.0, 238050.0, 238150.0,
           238250.0, 238350.0, 238450.0,
           ...
           249050.0, 249150.0, 249250.0, 249350.0, 249450.0, 249550.0, 249650.0,
           249750.0, 249850.0, 249950.0],
          dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=125))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-f21fa085-7213-43c5-bce2-f8fcb0addb3e' class='xr-index-data-in' type='checkbox'/><label for='index-f21fa085-7213-43c5-bce2-f8fcb0addb3e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([563950.0, 563850.0, 563750.0, 563650.0, 563550.0, 563450.0, 563350.0,
           563250.0, 563150.0, 563050.0, 562950.0, 562850.0, 562750.0, 562650.0,
           562550.0, 562450.0, 562350.0, 562250.0, 562150.0, 562050.0, 561950.0,
           561850.0, 561750.0, 561650.0, 561550.0, 561450.0, 561350.0, 561250.0,
           561150.0, 561050.0, 560950.0, 560850.0, 560750.0, 560650.0, 560550.0,
           560450.0, 560350.0, 560250.0, 560150.0, 560050.0, 559950.0, 559850.0,
           559750.0, 559650.0, 559550.0, 559450.0, 559350.0, 559250.0, 559150.0,
           559050.0],
          dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c8f6849c-2247-4b5a-bdab-cdca5609ec6c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-c8f6849c-2247-4b5a-bdab-cdca5609ec6c' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 131-132

Now regrid the simulation (without recharge):

.. GENERATED FROM PYTHON SOURCE LINES 132-134

.. code-block:: Python

    regridded_simulation = original_simulation.regrid_like("regridded", target_grid)








.. GENERATED FROM PYTHON SOURCE LINES 135-136

Let's look at the discretization again:

.. GENERATED FROM PYTHON SOURCE LINES 136-138

.. code-block:: Python

    regridded_simulation["GWF"]["dis"]






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>StructuredDiscretization</div><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1MB
    Dimensions:  (layer: 13, y: 50, x: 125)
    Coordinates:
        dx       float64 8B 100.0
        dy       float64 8B -100.0
      * layer    (layer) int32 52B 1 2 3 4 5 6 7 8 9 10 11 12 13
      * y        (y) float64 400B 5.64e+05 5.638e+05 ... 5.592e+05 5.59e+05
      * x        (x) float64 1kB 2.376e+05 2.376e+05 2.378e+05 ... 2.498e+05 2.5e+05
    Data variables:
        idomain  (layer, y, x) int64 650kB -1 -1 -1 -1 -1 -1 -1 -1 ... 1 1 1 1 1 1 1
        top      (y, x) float32 25kB nan nan nan nan nan nan ... nan nan nan nan nan
        bottom   (layer, y, x) float32 325kB 6.329 6.432 6.536 ... -166.8 -166.8</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-f1e0571a-3dcd-4991-b056-01d500f80726' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-f1e0571a-3dcd-4991-b056-01d500f80726' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>layer</span>: 13</li><li><span class='xr-has-index'>y</span>: 50</li><li><span class='xr-has-index'>x</span>: 125</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-356ccadf-03b7-4e83-96e3-06628f0918e1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-356ccadf-03b7-4e83-96e3-06628f0918e1' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>100.0</div><input id='attrs-ae0b7f33-ed89-435b-a75a-caf66b9455d7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ae0b7f33-ed89-435b-a75a-caf66b9455d7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7a72f50b-e331-44cb-b36d-f23616891f78' class='xr-var-data-in' type='checkbox'><label for='data-7a72f50b-e331-44cb-b36d-f23616891f78' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(100.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-100.0</div><input id='attrs-54094522-8af9-42ba-83cf-45032105b855' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-54094522-8af9-42ba-83cf-45032105b855' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-af4733bc-f8d2-4edf-9412-662829971b04' class='xr-var-data-in' type='checkbox'><label for='data-af4733bc-f8d2-4edf-9412-662829971b04' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-100.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12 13</div><input id='attrs-21abcaa3-2636-4eaa-bc6e-61b9f04f484c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-21abcaa3-2636-4eaa-bc6e-61b9f04f484c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-41f91b06-2994-4c97-a178-42dd75c1ad1a' class='xr-var-data-in' type='checkbox'><label for='data-41f91b06-2994-4c97-a178-42dd75c1ad1a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.638e+05 ... 5.59e+05</div><input id='attrs-f69a3f57-ffff-4981-8819-0797429e113c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f69a3f57-ffff-4981-8819-0797429e113c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-86936d00-05e9-47c2-be05-24926890cfdd' class='xr-var-data-in' type='checkbox'><label for='data-86936d00-05e9-47c2-be05-24926890cfdd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563950., 563850., 563750., 563650., 563550., 563450., 563350., 563250.,
           563150., 563050., 562950., 562850., 562750., 562650., 562550., 562450.,
           562350., 562250., 562150., 562050., 561950., 561850., 561750., 561650.,
           561550., 561450., 561350., 561250., 561150., 561050., 560950., 560850.,
           560750., 560650., 560550., 560450., 560350., 560250., 560150., 560050.,
           559950., 559850., 559750., 559650., 559550., 559450., 559350., 559250.,
           559150., 559050.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.376e+05 2.376e+05 ... 2.5e+05</div><input id='attrs-c4b14c6d-67ff-4623-b453-d72c430e9a87' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c4b14c6d-67ff-4623-b453-d72c430e9a87' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f01a0882-de1f-42f0-9520-43f6a70fc507' class='xr-var-data-in' type='checkbox'><label for='data-f01a0882-de1f-42f0-9520-43f6a70fc507' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237550., 237650., 237750., 237850., 237950., 238050., 238150., 238250.,
           238350., 238450., 238550., 238650., 238750., 238850., 238950., 239050.,
           239150., 239250., 239350., 239450., 239550., 239650., 239750., 239850.,
           239950., 240050., 240150., 240250., 240350., 240450., 240550., 240650.,
           240750., 240850., 240950., 241050., 241150., 241250., 241350., 241450.,
           241550., 241650., 241750., 241850., 241950., 242050., 242150., 242250.,
           242350., 242450., 242550., 242650., 242750., 242850., 242950., 243050.,
           243150., 243250., 243350., 243450., 243550., 243650., 243750., 243850.,
           243950., 244050., 244150., 244250., 244350., 244450., 244550., 244650.,
           244750., 244850., 244950., 245050., 245150., 245250., 245350., 245450.,
           245550., 245650., 245750., 245850., 245950., 246050., 246150., 246250.,
           246350., 246450., 246550., 246650., 246750., 246850., 246950., 247050.,
           247150., 247250., 247350., 247450., 247550., 247650., 247750., 247850.,
           247950., 248050., 248150., 248250., 248350., 248450., 248550., 248650.,
           248750., 248850., 248950., 249050., 249150., 249250., 249350., 249450.,
           249550., 249650., 249750., 249850., 249950.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e4b2aa57-ee47-441a-99e9-65f097249065' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e4b2aa57-ee47-441a-99e9-65f097249065' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>idomain</span></div><div class='xr-var-dims'>(layer, y, x)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>-1 -1 -1 -1 -1 -1 ... 1 1 1 1 1 1</div><input id='attrs-3915f795-a71e-4082-8a4d-8ead2d6d3663' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3915f795-a71e-4082-8a4d-8ead2d6d3663' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e93b7e7d-ac0b-4a4f-acf8-a0c147224553' class='xr-var-data-in' type='checkbox'><label for='data-e93b7e7d-ac0b-4a4f-acf8-a0c147224553' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[-1, -1, -1, ...,  1,  1,  1],
            [-1, -1, -1, ...,  1,  1,  1],
            [-1, -1, -1, ...,  1,  1,  1],
            ...,
            [ 1,  1,  1, ..., -1, -1, -1],
            [ 1,  1,  1, ..., -1, -1, -1],
            [ 1,  1,  1, ..., -1, -1, -1]],

           [[-1, -1, -1, ..., -1, -1, -1],
            [-1, -1, -1, ..., -1, -1, -1],
            [-1, -1, -1, ..., -1, -1, -1],
            ...,
            [-1, -1, -1, ..., -1, -1, -1],
            [-1, -1, -1, ..., -1, -1, -1],
            [-1, -1, -1, ..., -1, -1, -1]],

           [[ 1,  1,  1, ...,  1,  1,  1],
            [ 1,  1,  1, ...,  1,  1,  1],
            [ 1,  1,  1, ...,  1,  1,  1],
            ...,
    ...
            ...,
            [ 1,  1,  1, ...,  1,  1,  1],
            [ 1,  1,  1, ...,  1,  1,  1],
            [ 1,  1,  1, ...,  1,  1,  1]],

           [[ 1,  1,  1, ..., -1, -1, -1],
            [ 1,  1,  1, ..., -1, -1, -1],
            [ 1,  1,  1, ..., -1, -1, -1],
            ...,
            [-1, -1, -1, ..., -1, -1, -1],
            [-1, -1, -1, ..., -1, -1, -1],
            [-1, -1, -1, ..., -1, -1, -1]],

           [[ 1,  1,  1, ...,  1,  1,  1],
            [ 1,  1,  1, ...,  1,  1,  1],
            [ 1,  1,  1, ...,  1,  1,  1],
            ...,
            [ 1,  1,  1, ...,  1,  1,  1],
            [ 1,  1,  1, ...,  1,  1,  1],
            [ 1,  1,  1, ...,  1,  1,  1]]], shape=(13, 50, 125))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>top</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-22f94d48-997f-4029-908b-04f7fb8f8093' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-22f94d48-997f-4029-908b-04f7fb8f8093' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-35a44c16-29a1-4713-aec7-b189922eee28' class='xr-var-data-in' type='checkbox'><label for='data-35a44c16-29a1-4713-aec7-b189922eee28' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[     nan,      nan,      nan, ..., 2.422   , 2.4668  , 2.5116  ],
           [     nan,      nan,      nan, ..., 2.336   , 2.3724  , 2.4088  ],
           [     nan,      nan,      nan, ..., 2.25    , 2.278   , 2.306   ],
           ...,
           [9.574   , 9.092   , 8.61    , ...,      nan,      nan,      nan],
           [9.4996  , 9.1048  , 8.71    , ...,      nan,      nan,      nan],
           [9.4252  , 9.117599, 8.809999, ...,      nan,      nan,      nan]],
          shape=(50, 125), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>bottom</span></div><div class='xr-var-dims'>(layer, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>6.329 6.432 6.536 ... -166.8 -166.8</div><input id='attrs-ba615906-e295-4069-a10e-5735bbc6619c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ba615906-e295-4069-a10e-5735bbc6619c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a720b2ac-76e4-4ce1-a5d9-937afa3b4c6a' class='xr-var-data-in' type='checkbox'><label for='data-a720b2ac-76e4-4ce1-a5d9-937afa3b4c6a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[   6.3288 ,    6.4324 ,    6.536  , ...,   -4.072  ,
               -2.7284 ,   -1.3848 ],
            [   6.4664 ,    6.6172 ,    6.768  , ...,   -4.656  ,
               -3.2212 ,   -1.7864 ],
            [   6.604  ,    6.802  ,    7.     , ...,   -5.24   ,
               -3.714  ,   -2.188  ],
            ...,
            [   7.888  ,    7.724  ,    7.56   , ...,    2.92   ,
                2.952  ,    2.984  ],
            [   8.0056 ,    7.8608 ,    7.716  , ...,    3.088  ,
                3.0896 ,    3.0912 ],
            [   8.1232 ,    7.9976 ,    7.872  , ...,    3.256  ,
                3.2272 ,    3.1984 ]],

           [[   6.3288 ,    6.4324 ,    6.536  , ...,   -4.072  ,
               -2.7284 ,   -1.3848 ],
            [   6.4664 ,    6.6172 ,    6.768  , ...,   -4.656  ,
               -3.2212 ,   -1.7864 ],
            [   6.604  ,    6.802  ,    7.     , ...,   -5.24   ,
               -3.714  ,   -2.188  ],
    ...
            [-100.706  , -100.408  , -100.11   , ...,  -88.82   ,
              -88.792  ,  -88.764  ],
            [-100.6516 , -100.3648 , -100.078  , ...,  -88.77   ,
              -88.7412 ,  -88.7124 ],
            [-100.5972 , -100.3216 , -100.046  , ...,  -88.72   ,
              -88.6904 ,  -88.6608 ]],

           [[-161.11   , -161.11   , -158.41   , ..., -187.276  ,
             -187.276  , -187.276  ],
            [-161.11   , -161.11   , -158.41   , ..., -187.276  ,
             -187.276  , -187.276  ],
            [-159.45   , -159.45   , -156.73   , ..., -186.67   ,
             -186.67   , -186.67   ],
            ...,
            [-175.28   , -175.28   , -173.5    , ..., -166.763  ,
             -166.763  , -166.763  ],
            [-175.28   , -175.28   , -173.5    , ..., -166.763  ,
             -166.763  , -166.763  ],
            [-175.28   , -175.28   , -173.5    , ..., -166.763  ,
             -166.763  , -166.763  ]]], shape=(13, 50, 125), dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9fe177a6-6519-441d-965f-808701de7597' class='xr-section-summary-in' type='checkbox'  ><label for='section-9fe177a6-6519-441d-965f-808701de7597' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>layer</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-3a82520b-0e6e-4f8e-bf0c-65ef34ffa30a' class='xr-index-data-in' type='checkbox'/><label for='index-3a82520b-0e6e-4f8e-bf0c-65ef34ffa30a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], dtype=&#x27;int32&#x27;, name=&#x27;layer&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-adfc290f-842a-4334-af99-2ffead99d07b' class='xr-index-data-in' type='checkbox'/><label for='index-adfc290f-842a-4334-af99-2ffead99d07b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([563950.0, 563850.0, 563750.0, 563650.0, 563550.0, 563450.0, 563350.0,
           563250.0, 563150.0, 563050.0, 562950.0, 562850.0, 562750.0, 562650.0,
           562550.0, 562450.0, 562350.0, 562250.0, 562150.0, 562050.0, 561950.0,
           561850.0, 561750.0, 561650.0, 561550.0, 561450.0, 561350.0, 561250.0,
           561150.0, 561050.0, 560950.0, 560850.0, 560750.0, 560650.0, 560550.0,
           560450.0, 560350.0, 560250.0, 560150.0, 560050.0, 559950.0, 559850.0,
           559750.0, 559650.0, 559550.0, 559450.0, 559350.0, 559250.0, 559150.0,
           559050.0],
          dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-1ef893d7-d5ae-40b0-a187-e92b589f4afa' class='xr-index-data-in' type='checkbox'/><label for='index-1ef893d7-d5ae-40b0-a187-e92b589f4afa' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([237550.0, 237650.0, 237750.0, 237850.0, 237950.0, 238050.0, 238150.0,
           238250.0, 238350.0, 238450.0,
           ...
           249050.0, 249150.0, 249250.0, 249350.0, 249450.0, 249550.0, 249650.0,
           249750.0, 249850.0, 249950.0],
          dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=125))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-95dad39a-c85b-4675-b21c-17c835c98eff' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-95dad39a-c85b-4675-b21c-17c835c98eff' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 139-140

All packages have been regridded, for example the NPF package:

.. GENERATED FROM PYTHON SOURCE LINES 140-143

.. code-block:: Python


    regridded_simulation["GWF"]["npf"]






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>NodePropertyFlow</div><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 652kB
    Dimensions:                              (layer: 13, y: 50, x: 125)
    Coordinates:
        dx                                   float64 8B 100.0
        dy                                   float64 8B -100.0
      * layer                                (layer) int32 52B 1 2 3 4 ... 11 12 13
      * y                                    (y) float64 400B 5.64e+05 ... 5.59e+05
      * x                                    (x) float64 1kB 2.376e+05 ... 2.5e+05
    Data variables: (12/22)
        icelltype                            int32 4B 0
        k                                    (layer, y, x) float32 325kB nan ... ...
        rewet                                bool 1B False
        rewet_layer                          object 8B None
        rewet_factor                         object 8B None
        rewet_iterations                     object 8B None
        ...                                   ...
        dewatered                            bool 1B True
        perched                              bool 1B True
        save_specific_discharge              bool 1B False
        save_saturation                      bool 1B False
        xt3d_option                          bool 1B False
        rhs_option                           bool 1B False</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-eb0c9c30-6653-4cdc-bd3c-92993cb26b0a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-eb0c9c30-6653-4cdc-bd3c-92993cb26b0a' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>layer</span>: 13</li><li><span class='xr-has-index'>y</span>: 50</li><li><span class='xr-has-index'>x</span>: 125</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-5b55f4db-ab54-4c73-beb2-044b2300b97d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5b55f4db-ab54-4c73-beb2-044b2300b97d' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>100.0</div><input id='attrs-dbebcf96-61bf-42ab-a7a5-2d39cee97345' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-dbebcf96-61bf-42ab-a7a5-2d39cee97345' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-071839f7-0ac0-4af8-98bf-b2c8ab8c8ace' class='xr-var-data-in' type='checkbox'><label for='data-071839f7-0ac0-4af8-98bf-b2c8ab8c8ace' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(100.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-100.0</div><input id='attrs-845efce8-231d-4678-94fa-a9ae220b9a00' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-845efce8-231d-4678-94fa-a9ae220b9a00' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-191ce6c2-ed17-448d-90ed-9773b191ab3a' class='xr-var-data-in' type='checkbox'><label for='data-191ce6c2-ed17-448d-90ed-9773b191ab3a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-100.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12 13</div><input id='attrs-9e180254-4f7d-4266-8a1d-c3ac6d17c60a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9e180254-4f7d-4266-8a1d-c3ac6d17c60a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c49de531-7b6f-42a9-858f-7e67a38a2459' class='xr-var-data-in' type='checkbox'><label for='data-c49de531-7b6f-42a9-858f-7e67a38a2459' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.638e+05 ... 5.59e+05</div><input id='attrs-cfd2e89c-19e4-49a8-8217-4161d297410f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cfd2e89c-19e4-49a8-8217-4161d297410f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8f49104c-6d74-4599-8409-ad40a6a982d2' class='xr-var-data-in' type='checkbox'><label for='data-8f49104c-6d74-4599-8409-ad40a6a982d2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563950., 563850., 563750., 563650., 563550., 563450., 563350., 563250.,
           563150., 563050., 562950., 562850., 562750., 562650., 562550., 562450.,
           562350., 562250., 562150., 562050., 561950., 561850., 561750., 561650.,
           561550., 561450., 561350., 561250., 561150., 561050., 560950., 560850.,
           560750., 560650., 560550., 560450., 560350., 560250., 560150., 560050.,
           559950., 559850., 559750., 559650., 559550., 559450., 559350., 559250.,
           559150., 559050.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.376e+05 2.376e+05 ... 2.5e+05</div><input id='attrs-920e8f07-cd5b-4838-84d3-41a1334a9017' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-920e8f07-cd5b-4838-84d3-41a1334a9017' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-68e1cc27-700f-45ae-895a-5eddd99d7568' class='xr-var-data-in' type='checkbox'><label for='data-68e1cc27-700f-45ae-895a-5eddd99d7568' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237550., 237650., 237750., 237850., 237950., 238050., 238150., 238250.,
           238350., 238450., 238550., 238650., 238750., 238850., 238950., 239050.,
           239150., 239250., 239350., 239450., 239550., 239650., 239750., 239850.,
           239950., 240050., 240150., 240250., 240350., 240450., 240550., 240650.,
           240750., 240850., 240950., 241050., 241150., 241250., 241350., 241450.,
           241550., 241650., 241750., 241850., 241950., 242050., 242150., 242250.,
           242350., 242450., 242550., 242650., 242750., 242850., 242950., 243050.,
           243150., 243250., 243350., 243450., 243550., 243650., 243750., 243850.,
           243950., 244050., 244150., 244250., 244350., 244450., 244550., 244650.,
           244750., 244850., 244950., 245050., 245150., 245250., 245350., 245450.,
           245550., 245650., 245750., 245850., 245950., 246050., 246150., 246250.,
           246350., 246450., 246550., 246650., 246750., 246850., 246950., 247050.,
           247150., 247250., 247350., 247450., 247550., 247650., 247750., 247850.,
           247950., 248050., 248150., 248250., 248350., 248450., 248550., 248650.,
           248750., 248850., 248950., 249050., 249150., 249250., 249350., 249450.,
           249550., 249650., 249750., 249850., 249950.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a2cefe6f-1a76-407b-b4c9-086d2b3762fe' class='xr-section-summary-in' type='checkbox'  ><label for='section-a2cefe6f-1a76-407b-b4c9-086d2b3762fe' class='xr-section-summary' >Data variables: <span>(22)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>icelltype</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-9ff0b44c-30f5-437b-8e21-33609c3dd5a1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9ff0b44c-30f5-437b-8e21-33609c3dd5a1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-aab7afb4-6e1a-4e7d-b5df-25f1b768fbe7' class='xr-var-data-in' type='checkbox'><label for='data-aab7afb4-6e1a-4e7d-b5df-25f1b768fbe7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0, dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>k</span></div><div class='xr-var-dims'>(layer, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... 4.38 4.651 6.06</div><input id='attrs-4c49e46e-cb33-4474-a618-c22e4204fbf7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4c49e46e-cb33-4474-a618-c22e4204fbf7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2c4389fa-a084-4ae8-abd6-c4cf421ae779' class='xr-var-data-in' type='checkbox'><label for='data-2c4389fa-a084-4ae8-abd6-c4cf421ae779' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[           nan,            nan,            nan, ...,
             1.71045101e+00, 2.06758380e+00, 2.13754582e+00],
            [           nan,            nan,            nan, ...,
             2.57982802e+00, 2.92900181e+00, 2.97071409e+00],
            [           nan,            nan,            nan, ...,
             3.26586366e+00, 3.61737657e+00, 4.02017498e+00],
            ...,
            [6.52613735e+00, 7.31937456e+00, 8.07691193e+00, ...,
                        nan,            nan,            nan],
            [6.75934601e+00, 7.43262911e+00, 7.75328350e+00, ...,
                        nan,            nan,            nan],
            [6.89848566e+00, 7.72873783e+00, 7.24491787e+00, ...,
                        nan,            nan,            nan]],

           [[           nan,            nan,            nan, ...,
                        nan,            nan,            nan],
            [           nan,            nan,            nan, ...,
                        nan,            nan,            nan],
            [           nan,            nan,            nan, ...,
                        nan,            nan,            nan],
    ...
                        nan,            nan,            nan],
            [           nan,            nan,            nan, ...,
                        nan,            nan,            nan],
            [           nan,            nan,            nan, ...,
                        nan,            nan,            nan]],

           [[3.50853882e+01, 3.35398254e+01, 3.31028404e+01, ...,
             1.11550407e+01, 1.10419674e+01, 1.10544491e+01],
            [3.57339859e+01, 3.40993958e+01, 3.36731339e+01, ...,
             1.07958746e+01, 1.06821775e+01, 1.07412310e+01],
            [3.71318932e+01, 3.54708900e+01, 3.50784569e+01, ...,
             1.06320744e+01, 1.04805851e+01, 1.05435915e+01],
            ...,
            [5.03838577e+01, 5.14991608e+01, 5.39692154e+01, ...,
             4.94934893e+00, 7.53968716e+00, 1.01326780e+01],
            [5.07901382e+01, 5.20933380e+01, 5.46933594e+01, ...,
             4.54834080e+00, 6.02678776e+00, 8.55815029e+00],
            [5.12099190e+01, 5.24668083e+01, 5.51531830e+01, ...,
             4.37981462e+00, 4.65149546e+00, 6.05957603e+00]]],
          shape=(13, 50, 125), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rewet</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-a365558b-6a14-4bb3-a151-3e8e513c816d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a365558b-6a14-4bb3-a151-3e8e513c816d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fe0d6ddc-184b-41b0-a02d-9466405fb447' class='xr-var-data-in' type='checkbox'><label for='data-fe0d6ddc-184b-41b0-a02d-9466405fb447' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rewet_layer</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-13fd0f8e-fd57-4c2c-a2c4-7bcbde793ed8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-13fd0f8e-fd57-4c2c-a2c4-7bcbde793ed8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4d701732-2792-4f7f-8291-5868226debef' class='xr-var-data-in' type='checkbox'><label for='data-4d701732-2792-4f7f-8291-5868226debef' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rewet_factor</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-1e69c9df-8613-490f-abb3-70543c94d983' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1e69c9df-8613-490f-abb3-70543c94d983' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b4d7df4c-7e2c-4338-aeef-59b8bbd98d37' class='xr-var-data-in' type='checkbox'><label for='data-b4d7df4c-7e2c-4338-aeef-59b8bbd98d37' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rewet_iterations</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-dab3aa8a-3b53-4450-ae26-ab9373413913' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-dab3aa8a-3b53-4450-ae26-ab9373413913' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ac3009ea-2cc4-47ab-b8ab-9cdecc91ec31' class='xr-var-data-in' type='checkbox'><label for='data-ac3009ea-2cc4-47ab-b8ab-9cdecc91ec31' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rewet_method</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-c85da899-6167-4231-8924-d13167bb3ddf' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c85da899-6167-4231-8924-d13167bb3ddf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7fd7c6a6-f0ff-4bf3-9a62-c8018f5faec0' class='xr-var-data-in' type='checkbox'><label for='data-7fd7c6a6-f0ff-4bf3-9a62-c8018f5faec0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>k22</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-c0b44ec2-19fd-4143-acc5-674cbba2becc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c0b44ec2-19fd-4143-acc5-674cbba2becc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d166f239-0be2-4b9d-a413-6ba4946046c3' class='xr-var-data-in' type='checkbox'><label for='data-d166f239-0be2-4b9d-a413-6ba4946046c3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>k33</span></div><div class='xr-var-dims'>(layer, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 4.379 4.635 5.987</div><input id='attrs-dcce9d53-d7d8-4b3f-9201-df67be6620d3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-dcce9d53-d7d8-4b3f-9201-df67be6620d3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6fe1c877-1622-4359-b821-9ad938b069ef' class='xr-var-data-in' type='checkbox'><label for='data-6fe1c877-1622-4359-b821-9ad938b069ef' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[           nan,            nan,            nan, ...,
             1.68908155e+00, 2.05299568e+00, 2.07375240e+00],
            [           nan,            nan,            nan, ...,
             2.56002688e+00, 2.90870237e+00, 2.93282318e+00],
            [           nan,            nan,            nan, ...,
             3.25846219e+00, 3.60833979e+00, 3.96773362e+00],
            ...,
            [6.52359343e+00, 7.31123686e+00, 8.06107712e+00, ...,
                        nan,            nan,            nan],
            [6.75605583e+00, 7.42485857e+00, 7.72925758e+00, ...,
                        nan,            nan,            nan],
            [6.89221048e+00, 7.72043324e+00, 7.19585562e+00, ...,
                        nan,            nan,            nan]],

           [[           nan,            nan,            nan, ...,
                        nan,            nan,            nan],
            [           nan,            nan,            nan, ...,
                        nan,            nan,            nan],
            [           nan,            nan,            nan, ...,
                        nan,            nan,            nan],
    ...
                        nan,            nan,            nan],
            [           nan,            nan,            nan, ...,
                        nan,            nan,            nan],
            [           nan,            nan,            nan, ...,
                        nan,            nan,            nan]],

           [[3.50840683e+01, 3.35387764e+01, 3.31001320e+01, ...,
             1.11541767e+01, 1.10412979e+01, 1.10539465e+01],
            [3.57323608e+01, 3.40979767e+01, 3.36704140e+01, ...,
             1.07952986e+01, 1.06817684e+01, 1.07408428e+01],
            [3.71310349e+01, 3.54699516e+01, 3.50761642e+01, ...,
             1.06316519e+01, 1.04804630e+01, 1.05433397e+01],
            ...,
            [5.03830185e+01, 5.14964905e+01, 5.39657822e+01, ...,
             4.91560221e+00, 7.46072292e+00, 1.01161366e+01],
            [5.07891464e+01, 5.20898857e+01, 5.46896210e+01, ...,
             4.54136038e+00, 5.96547222e+00, 8.49976540e+00],
            [5.12087021e+01, 5.24633751e+01, 5.51496162e+01, ...,
             4.37948227e+00, 4.63479853e+00, 5.98664236e+00]]],
          shape=(13, 50, 125), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>angle1</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-c000d2eb-85fa-4a75-8288-8d8640731b6e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c000d2eb-85fa-4a75-8288-8d8640731b6e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ccf0e742-8612-4eac-89b8-78d7fac43bf2' class='xr-var-data-in' type='checkbox'><label for='data-ccf0e742-8612-4eac-89b8-78d7fac43bf2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>angle2</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-799be67f-4c74-4af8-901c-0c7312f750e0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-799be67f-4c74-4af8-901c-0c7312f750e0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-709ffb1b-109a-4742-99aa-122ab54c3554' class='xr-var-data-in' type='checkbox'><label for='data-709ffb1b-109a-4742-99aa-122ab54c3554' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>angle3</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-c94aa931-0e14-4673-b957-225766a12589' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c94aa931-0e14-4673-b957-225766a12589' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-76c4b8c0-330f-4952-b7aa-fa65b8f8b6e7' class='xr-var-data-in' type='checkbox'><label for='data-76c4b8c0-330f-4952-b7aa-fa65b8f8b6e7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>alternative_cell_averaging</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-caba2779-cb45-48bf-b9f7-c4eea623bb8e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-caba2779-cb45-48bf-b9f7-c4eea623bb8e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-55fadda6-7754-4652-9fd6-ae2fba3f2bc1' class='xr-var-data-in' type='checkbox'><label for='data-55fadda6-7754-4652-9fd6-ae2fba3f2bc1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>save_flows</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>True</div><input id='attrs-9394f600-680a-468b-9e6c-6f2672c85672' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9394f600-680a-468b-9e6c-6f2672c85672' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8199bd5f-1c41-4c9c-8066-06d1f9450214' class='xr-var-data-in' type='checkbox'><label for='data-8199bd5f-1c41-4c9c-8066-06d1f9450214' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(True)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>starting_head_as_confined_thickness</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-794804de-6345-4946-8986-8656829b0589' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-794804de-6345-4946-8986-8656829b0589' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dd9ce395-2e67-47ff-959e-d1bb7c926128' class='xr-var-data-in' type='checkbox'><label for='data-dd9ce395-2e67-47ff-959e-d1bb7c926128' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>variable_vertical_conductance</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>True</div><input id='attrs-5b913096-f0ae-4fa3-accf-3015f6108ea5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5b913096-f0ae-4fa3-accf-3015f6108ea5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d563a694-5175-40ac-ad39-3594cb7eb4a7' class='xr-var-data-in' type='checkbox'><label for='data-d563a694-5175-40ac-ad39-3594cb7eb4a7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(True)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dewatered</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>True</div><input id='attrs-fecee77a-4e73-4e8e-9c18-154e93b8cb00' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fecee77a-4e73-4e8e-9c18-154e93b8cb00' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9aa9fd07-a15d-4052-937c-bdfbbb74ff05' class='xr-var-data-in' type='checkbox'><label for='data-9aa9fd07-a15d-4052-937c-bdfbbb74ff05' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(True)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>perched</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>True</div><input id='attrs-b60b4fcb-aa6d-4b2b-8ff5-a71ed47b02ea' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b60b4fcb-aa6d-4b2b-8ff5-a71ed47b02ea' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-50581b29-fd3a-4a18-b13f-6b1d8ff809eb' class='xr-var-data-in' type='checkbox'><label for='data-50581b29-fd3a-4a18-b13f-6b1d8ff809eb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(True)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>save_specific_discharge</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-d3646512-4496-494d-993f-5b5867395a97' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d3646512-4496-494d-993f-5b5867395a97' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fbb5fbb9-a879-4af2-b331-fb989890ba49' class='xr-var-data-in' type='checkbox'><label for='data-fbb5fbb9-a879-4af2-b331-fb989890ba49' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>save_saturation</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-8b4e5fbd-52ac-445f-9fd4-622064456d66' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8b4e5fbd-52ac-445f-9fd4-622064456d66' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e6b115c0-dee4-4bca-86a2-97ca98ef9814' class='xr-var-data-in' type='checkbox'><label for='data-e6b115c0-dee4-4bca-86a2-97ca98ef9814' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>xt3d_option</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-9eb5b214-b83d-4fe5-ada5-bd06dd4101c5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9eb5b214-b83d-4fe5-ada5-bd06dd4101c5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7aa45003-a873-429c-9a77-a9689ef8309f' class='xr-var-data-in' type='checkbox'><label for='data-7aa45003-a873-429c-9a77-a9689ef8309f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rhs_option</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-fa82ce11-6622-44ea-98c7-a6d941cdf906' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fa82ce11-6622-44ea-98c7-a6d941cdf906' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cc0fbfdd-bc84-4dce-b88f-6027d6328b58' class='xr-var-data-in' type='checkbox'><label for='data-cc0fbfdd-bc84-4dce-b88f-6027d6328b58' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-09568953-8582-4561-af10-563e1b34de56' class='xr-section-summary-in' type='checkbox'  ><label for='section-09568953-8582-4561-af10-563e1b34de56' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>layer</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-8326c7e3-01c8-418e-a5a0-fd1c02310ba6' class='xr-index-data-in' type='checkbox'/><label for='index-8326c7e3-01c8-418e-a5a0-fd1c02310ba6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], dtype=&#x27;int32&#x27;, name=&#x27;layer&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-493d75c7-0ee6-434d-b588-0bd069640789' class='xr-index-data-in' type='checkbox'/><label for='index-493d75c7-0ee6-434d-b588-0bd069640789' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([563950.0, 563850.0, 563750.0, 563650.0, 563550.0, 563450.0, 563350.0,
           563250.0, 563150.0, 563050.0, 562950.0, 562850.0, 562750.0, 562650.0,
           562550.0, 562450.0, 562350.0, 562250.0, 562150.0, 562050.0, 561950.0,
           561850.0, 561750.0, 561650.0, 561550.0, 561450.0, 561350.0, 561250.0,
           561150.0, 561050.0, 560950.0, 560850.0, 560750.0, 560650.0, 560550.0,
           560450.0, 560350.0, 560250.0, 560150.0, 560050.0, 559950.0, 559850.0,
           559750.0, 559650.0, 559550.0, 559450.0, 559350.0, 559250.0, 559150.0,
           559050.0],
          dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-cfa26cc2-103f-4e44-95d8-3e4101c9e2f9' class='xr-index-data-in' type='checkbox'/><label for='index-cfa26cc2-103f-4e44-95d8-3e4101c9e2f9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([237550.0, 237650.0, 237750.0, 237850.0, 237950.0, 238050.0, 238150.0,
           238250.0, 238350.0, 238450.0,
           ...
           249050.0, 249150.0, 249250.0, 249350.0, 249450.0, 249550.0, 249650.0,
           249750.0, 249850.0, 249950.0],
          dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=125))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-74a64278-9f3f-424b-8fab-bcd1b8b202dd' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-74a64278-9f3f-424b-8fab-bcd1b8b202dd' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 144-145

Let's make a comparison plot of the hydraulic conductivities:

.. GENERATED FROM PYTHON SOURCE LINES 145-161

.. code-block:: Python

    import matplotlib.pyplot as plt
    import numpy as np

    fig, axes = plt.subplots(nrows=2, sharex=True)
    plot_kwargs = {"colors": "viridis", "levels": np.linspace(0.0, 100.0, 21), "fig": fig}

    imod.visualize.spatial.plot_map(
        original_simulation["GWF"]["npf"]["k"].sel(layer=3), ax=axes[0], **plot_kwargs
    )
    imod.visualize.spatial.plot_map(
        regridded_simulation["GWF"]["npf"]["k"].sel(layer=3), ax=axes[1], **plot_kwargs
    )

    axes[0].set_ylabel("original")
    axes[1].set_ylabel("regridded")




.. image-sg:: /user-guide/images/sphx_glr_08-regridding_001.png
   :alt: 08 regridding
   :srcset: /user-guide/images/sphx_glr_08-regridding_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(28.472222222222243, 0.5, 'regridded')



.. GENERATED FROM PYTHON SOURCE LINES 162-182

Regridding using non-default methods
------------------------------------

When non-default methods are used for one or more packages, these should be
regridded separately. In that case, the most convenient approach is likely:

- pop the packages that should use non-default methods from the source simulation (the
  popping is optional, and is only recommended for packages whose presence is not
  mandatory for validation.)
- regrid the source simulation: this takes care of all the packages that should use default methods.
- regrid the package(s) where you want to use non-standard rergridding methods indivudually starting from the
  packages in the source simulation
- insert the custom-regridded packages to the
  regridded simulation (or replace the package regridded with default methods with
  the one you just regridded with non-default methods if it was not popped)

In code, consider an example where we want to regrid the recharge package using non default methods
then we would do the following. First we'll load some example simulation.
There is a separate example contained in :doc:`/examples/mf6/hondsrug`
that you should look at if you are interested in the model building

.. GENERATED FROM PYTHON SOURCE LINES 185-188

Set up the input needed for custom regridding. Create a regridder
weight-cache. This object can (and should) be reused for all the packages that
undergo custom regridding at this stage.

.. GENERATED FROM PYTHON SOURCE LINES 188-194

.. code-block:: Python

    from imod.util.regrid import RegridderWeightsCache

    regrid_cache = RegridderWeightsCache()

    regrid_cache





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <imod.util.regrid.RegridderWeightsCache object at 0x00000251D1AEA330>



.. GENERATED FROM PYTHON SOURCE LINES 195-196

Next, we'll remove the recharge package and obtain it as a variable. We'll do this for later use.

.. GENERATED FROM PYTHON SOURCE LINES 196-201

.. code-block:: Python


    original_rch_package = original_simulation["GWF"].pop("rch")

    original_rch_package






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>Recharge</div><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 21MB
    Dimensions:        (time: 2, layer: 13, y: 200, x: 500)
    Coordinates:
      * y              (y) float64 2kB 5.64e+05 5.64e+05 ... 5.59e+05 5.59e+05
      * x              (x) float64 4kB 2.375e+05 2.375e+05 ... 2.5e+05 2.5e+05
        dx             float64 8B ...
        dy             float64 8B ...
      * layer          (layer) int32 52B 1 2 3 4 5 6 7 8 9 10 11 12 13
      * time           (time) datetime64[ns] 16B 2009-12-30T23:59:59 2009-12-31
    Data variables:
        rate           (time, layer, y, x) float64 21MB nan nan nan ... nan nan nan
        print_input    bool 1B False
        print_flows    bool 1B False
        save_flows     bool 1B False
        observations   object 8B None
        repeat_stress  object 8B None</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-cd3aceac-6f0c-4627-91b0-71ee9bc37d0b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-cd3aceac-6f0c-4627-91b0-71ee9bc37d0b' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 2</li><li><span class='xr-has-index'>layer</span>: 13</li><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>x</span>: 500</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-a14e7e52-4b2e-4706-9cea-73d1bed8e5cc' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a14e7e52-4b2e-4706-9cea-73d1bed8e5cc' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-09683904-1531-4475-88a9-41a452cd337f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-09683904-1531-4475-88a9-41a452cd337f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-11561ccf-cade-4dd9-b9f7-719cd7517677' class='xr-var-data-in' type='checkbox'><label for='data-11561ccf-cade-4dd9-b9f7-719cd7517677' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
           563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
           563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
           563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
           563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
           563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
           562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
           562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
           562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
           562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
           562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
           562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
           561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
           561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
           561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
           561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
           561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
           561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
           560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
           560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
           560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
           560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
           560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
           559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
           559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
           559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
           559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
           559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
           559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-bcb9d90a-52f0-4f55-a2d7-ce73f20ec193' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bcb9d90a-52f0-4f55-a2d7-ce73f20ec193' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8b6c0708-c1a1-414b-a3ec-987174b1cff7' class='xr-var-data-in' type='checkbox'><label for='data-8b6c0708-c1a1-414b-a3ec-987174b1cff7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5],
          shape=(500,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-84f9d858-3855-4f71-8867-89bb8e816db5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-84f9d858-3855-4f71-8867-89bb8e816db5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-13b4c4e8-c9f5-4289-bb00-27ba3828c603' class='xr-var-data-in' type='checkbox'><label for='data-13b4c4e8-c9f5-4289-bb00-27ba3828c603' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-3824d6c2-60bc-4bd5-bba5-79c92deae1a0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3824d6c2-60bc-4bd5-bba5-79c92deae1a0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c9310a9a-7c81-4193-bd4c-9cb7fd568b4f' class='xr-var-data-in' type='checkbox'><label for='data-c9310a9a-7c81-4193-bd4c-9cb7fd568b4f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12 13</div><input id='attrs-f506948a-5d20-4541-b61e-a152599c54c2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f506948a-5d20-4541-b61e-a152599c54c2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-36767600-3ffb-48ee-993d-f1f6a32ddbb7' class='xr-var-data-in' type='checkbox'><label for='data-36767600-3ffb-48ee-993d-f1f6a32ddbb7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2009-12-30T23:59:59 2009-12-31</div><input id='attrs-f8c8f6db-3e15-46f0-946e-c9f1467eb541' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f8c8f6db-3e15-46f0-946e-c9f1467eb541' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-366082c1-c6fe-4c08-8a88-fec83f40bafe' class='xr-var-data-in' type='checkbox'><label for='data-366082c1-c6fe-4c08-8a88-fec83f40bafe' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2009-12-30T23:59:59.000000000&#x27;, &#x27;2009-12-31T00:00:00.000000000&#x27;],
          dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-62963e37-59d0-4df6-b0d0-bfa0935acd38' class='xr-section-summary-in' type='checkbox'  checked><label for='section-62963e37-59d0-4df6-b0d0-bfa0935acd38' class='xr-section-summary' >Data variables: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>rate</span></div><div class='xr-var-dims'>(time, layer, y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-520db020-da12-4a4a-967e-46f92204a447' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-520db020-da12-4a4a-967e-46f92204a447' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9bd513af-670d-4139-b973-73e70e238389' class='xr-var-data-in' type='checkbox'><label for='data-9bd513af-670d-4139-b973-73e70e238389' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[[     nan, ..., 0.000834],
             ...,
             [0.000918, ...,      nan]],

            ...,

            [[     nan, ...,      nan],
             ...,
             [     nan, ...,      nan]]],


           [[[     nan, ..., 0.001638],
             ...,
             [0.001982, ...,      nan]],

            ...,

            [[     nan, ...,      nan],
             ...,
             [     nan, ...,      nan]]]], shape=(2, 13, 200, 500))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>print_input</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-dabeec2b-36a1-4c6f-81b6-32f155dbaf7b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-dabeec2b-36a1-4c6f-81b6-32f155dbaf7b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-94b9ab44-f6d3-458a-86c4-58b966af5b14' class='xr-var-data-in' type='checkbox'><label for='data-94b9ab44-f6d3-458a-86c4-58b966af5b14' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>print_flows</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-5d5cdc8e-8046-47af-96e1-4722637f9fc3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5d5cdc8e-8046-47af-96e1-4722637f9fc3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-37f9f50a-382f-440c-a8fd-f058ed2b6db3' class='xr-var-data-in' type='checkbox'><label for='data-37f9f50a-382f-440c-a8fd-f058ed2b6db3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>save_flows</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-9533d783-5841-455c-be1b-bf1f590aa674' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9533d783-5841-455c-be1b-bf1f590aa674' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-653e186b-7c25-4bca-a167-74d671064486' class='xr-var-data-in' type='checkbox'><label for='data-653e186b-7c25-4bca-a167-74d671064486' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>observations</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-711cbfa2-3f10-4e89-af4d-c2e643b959a5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-711cbfa2-3f10-4e89-af4d-c2e643b959a5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fbf435a1-0651-442d-ac0e-2e91a2020209' class='xr-var-data-in' type='checkbox'><label for='data-fbf435a1-0651-442d-ac0e-2e91a2020209' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>repeat_stress</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-70ff2294-cfb1-4ef1-ae9f-6fe510682a19' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-70ff2294-cfb1-4ef1-ae9f-6fe510682a19' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ee75fbfd-b78a-4d98-bf51-9030067fdcce' class='xr-var-data-in' type='checkbox'><label for='data-ee75fbfd-b78a-4d98-bf51-9030067fdcce' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-234e43e7-4664-49cb-8fb4-8a891c3ec066' class='xr-section-summary-in' type='checkbox'  ><label for='section-234e43e7-4664-49cb-8fb4-8a891c3ec066' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-9a5f08ec-cb39-4e85-be7a-24fc04c11689' class='xr-index-data-in' type='checkbox'/><label for='index-9a5f08ec-cb39-4e85-be7a-24fc04c11689' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
           563812.5, 563787.5, 563762.5,
           ...
           559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5, 559087.5,
           559062.5, 559037.5, 559012.5],
          dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=200))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-47bf9e89-9026-4b5d-8f01-064a75bf70ae' class='xr-index-data-in' type='checkbox'/><label for='index-47bf9e89-9026-4b5d-8f01-064a75bf70ae' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([237512.5, 237537.5, 237562.5, 237587.5, 237612.5, 237637.5, 237662.5,
           237687.5, 237712.5, 237737.5,
           ...
           249762.5, 249787.5, 249812.5, 249837.5, 249862.5, 249887.5, 249912.5,
           249937.5, 249962.5, 249987.5],
          dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=500))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>layer</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-6cda2ae6-96f5-4838-80b1-6768fef5a87d' class='xr-index-data-in' type='checkbox'/><label for='index-6cda2ae6-96f5-4838-80b1-6768fef5a87d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], dtype=&#x27;int32&#x27;, name=&#x27;layer&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-bf204e8d-7c6f-47a0-a1f2-170a83970b5d' class='xr-index-data-in' type='checkbox'/><label for='index-bf204e8d-7c6f-47a0-a1f2-170a83970b5d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2009-12-30 23:59:59&#x27;, &#x27;2009-12-31 00:00:00&#x27;], dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-77b24477-d1e3-494e-baf7-39490faaea82' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-77b24477-d1e3-494e-baf7-39490faaea82' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 202-205

Regrid the recharge package with a custom regridder. In this case we opt
for the centroid locator regridder. This regridder is similar to using a
"nearest neighbour" lookup.

.. GENERATED FROM PYTHON SOURCE LINES 205-218

.. code-block:: Python

    from imod.common.utilities.regrid import RegridderType
    from imod.mf6.regrid import RechargeRegridMethod

    regridder_types = RechargeRegridMethod(rate=(RegridderType.CENTROIDLOCATOR,))

    regridded_recharge = original_rch_package.regrid_like(
        target_grid,
        regrid_cache=regrid_cache,
        regridder_types=regridder_types,
    )

    regridded_recharge






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>Recharge</div><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1MB
    Dimensions:        (layer: 13, time: 2, y: 50, x: 125)
    Coordinates:
        dx             float64 8B 100.0
        dy             float64 8B -100.0
      * layer          (layer) int32 52B 1 2 3 4 5 6 7 8 9 10 11 12 13
      * time           (time) datetime64[ns] 16B 2009-12-30T23:59:59 2009-12-31
      * y              (y) float64 400B 5.64e+05 5.638e+05 ... 5.592e+05 5.59e+05
      * x              (x) float64 1kB 2.376e+05 2.376e+05 ... 2.498e+05 2.5e+05
    Data variables:
        rate           (time, layer, y, x) float64 1MB nan nan nan ... nan nan nan
        print_input    bool 1B False
        print_flows    bool 1B False
        save_flows     bool 1B False
        observations   object 8B None
        repeat_stress  object 8B None
        fixed_cell     bool 1B False</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-cb7d5f09-b06c-449d-ba70-f5a32f72ae33' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-cb7d5f09-b06c-449d-ba70-f5a32f72ae33' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>layer</span>: 13</li><li><span class='xr-has-index'>time</span>: 2</li><li><span class='xr-has-index'>y</span>: 50</li><li><span class='xr-has-index'>x</span>: 125</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-f276ab55-4b4e-47f8-a279-52328acaf155' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f276ab55-4b4e-47f8-a279-52328acaf155' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>100.0</div><input id='attrs-fa3a57c5-d4fd-4b8e-8772-6c2c365862ff' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fa3a57c5-d4fd-4b8e-8772-6c2c365862ff' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9b1f5455-d5cf-4b73-a0ec-b0eb4f8d3b13' class='xr-var-data-in' type='checkbox'><label for='data-9b1f5455-d5cf-4b73-a0ec-b0eb4f8d3b13' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(100.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-100.0</div><input id='attrs-c722e28d-4095-4183-aff9-64f171b99597' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c722e28d-4095-4183-aff9-64f171b99597' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-372c5af5-ee13-470d-a98d-7e8296af6743' class='xr-var-data-in' type='checkbox'><label for='data-372c5af5-ee13-470d-a98d-7e8296af6743' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-100.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12 13</div><input id='attrs-5537c995-500f-4f04-9c07-074ac63db87a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5537c995-500f-4f04-9c07-074ac63db87a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e29ffe8d-9693-4949-98d9-fa61762fd748' class='xr-var-data-in' type='checkbox'><label for='data-e29ffe8d-9693-4949-98d9-fa61762fd748' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2009-12-30T23:59:59 2009-12-31</div><input id='attrs-0111f35c-e0df-4220-89fd-8986412cb3d1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0111f35c-e0df-4220-89fd-8986412cb3d1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5dbabbd0-5801-4ff7-82dc-f236047ae1c3' class='xr-var-data-in' type='checkbox'><label for='data-5dbabbd0-5801-4ff7-82dc-f236047ae1c3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2009-12-30T23:59:59.000000000&#x27;, &#x27;2009-12-31T00:00:00.000000000&#x27;],
          dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.638e+05 ... 5.59e+05</div><input id='attrs-864ad84f-b87d-4839-bff9-dd5fa26fe43e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-864ad84f-b87d-4839-bff9-dd5fa26fe43e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2ce3c43b-08d9-4fd4-846d-24a18efa613b' class='xr-var-data-in' type='checkbox'><label for='data-2ce3c43b-08d9-4fd4-846d-24a18efa613b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563950., 563850., 563750., 563650., 563550., 563450., 563350., 563250.,
           563150., 563050., 562950., 562850., 562750., 562650., 562550., 562450.,
           562350., 562250., 562150., 562050., 561950., 561850., 561750., 561650.,
           561550., 561450., 561350., 561250., 561150., 561050., 560950., 560850.,
           560750., 560650., 560550., 560450., 560350., 560250., 560150., 560050.,
           559950., 559850., 559750., 559650., 559550., 559450., 559350., 559250.,
           559150., 559050.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.376e+05 2.376e+05 ... 2.5e+05</div><input id='attrs-5df8d45b-f356-4c3e-9aa7-b71f61c8e01d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5df8d45b-f356-4c3e-9aa7-b71f61c8e01d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0311452e-0a96-47bf-a567-75f203b9c899' class='xr-var-data-in' type='checkbox'><label for='data-0311452e-0a96-47bf-a567-75f203b9c899' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237550., 237650., 237750., 237850., 237950., 238050., 238150., 238250.,
           238350., 238450., 238550., 238650., 238750., 238850., 238950., 239050.,
           239150., 239250., 239350., 239450., 239550., 239650., 239750., 239850.,
           239950., 240050., 240150., 240250., 240350., 240450., 240550., 240650.,
           240750., 240850., 240950., 241050., 241150., 241250., 241350., 241450.,
           241550., 241650., 241750., 241850., 241950., 242050., 242150., 242250.,
           242350., 242450., 242550., 242650., 242750., 242850., 242950., 243050.,
           243150., 243250., 243350., 243450., 243550., 243650., 243750., 243850.,
           243950., 244050., 244150., 244250., 244350., 244450., 244550., 244650.,
           244750., 244850., 244950., 245050., 245150., 245250., 245350., 245450.,
           245550., 245650., 245750., 245850., 245950., 246050., 246150., 246250.,
           246350., 246450., 246550., 246650., 246750., 246850., 246950., 247050.,
           247150., 247250., 247350., 247450., 247550., 247650., 247750., 247850.,
           247950., 248050., 248150., 248250., 248350., 248450., 248550., 248650.,
           248750., 248850., 248950., 249050., 249150., 249250., 249350., 249450.,
           249550., 249650., 249750., 249850., 249950.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a02ec636-4539-4593-9061-798d5bddf5d4' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a02ec636-4539-4593-9061-798d5bddf5d4' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>rate</span></div><div class='xr-var-dims'>(time, layer, y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-85868ba5-ae2b-4a87-91bf-709e7781e9a7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-85868ba5-ae2b-4a87-91bf-709e7781e9a7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a486e33f-ce70-4859-ad3e-2baf52e12e7d' class='xr-var-data-in' type='checkbox'><label for='data-a486e33f-ce70-4859-ad3e-2baf52e12e7d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[[       nan,        nan,        nan, ..., 0.00083373,
              0.00083373, 0.00083373],
             [       nan,        nan,        nan, ..., 0.00083373,
              0.00083373, 0.00083373],
             [       nan,        nan,        nan, ..., 0.00083373,
              0.00083373, 0.00083373],
             ...,
             [0.00091826, 0.00091826, 0.00091826, ...,        nan,
                     nan,        nan],
             [0.00091826, 0.00091826, 0.00091826, ...,        nan,
                     nan,        nan],
             [0.00091826, 0.00091826, 0.00091826, ...,        nan,
                     nan,        nan]],

            [[       nan,        nan,        nan, ...,        nan,
                     nan,        nan],
             [       nan,        nan,        nan, ...,        nan,
                     nan,        nan],
             [       nan,        nan,        nan, ...,        nan,
                     nan,        nan],
    ...
             [       nan,        nan,        nan, ...,        nan,
                     nan,        nan],
             [       nan,        nan,        nan, ...,        nan,
                     nan,        nan],
             [       nan,        nan,        nan, ...,        nan,
                     nan,        nan]],

            [[       nan,        nan,        nan, ...,        nan,
                     nan,        nan],
             [       nan,        nan,        nan, ...,        nan,
                     nan,        nan],
             [       nan,        nan,        nan, ...,        nan,
                     nan,        nan],
             ...,
             [       nan,        nan,        nan, ...,        nan,
                     nan,        nan],
             [       nan,        nan,        nan, ...,        nan,
                     nan,        nan],
             [       nan,        nan,        nan, ...,        nan,
                     nan,        nan]]]], shape=(2, 13, 50, 125))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>print_input</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-f7380c5f-f015-4910-993b-8f3b949bce2d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f7380c5f-f015-4910-993b-8f3b949bce2d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5089d07e-7a32-4869-acbc-e9e04cecde93' class='xr-var-data-in' type='checkbox'><label for='data-5089d07e-7a32-4869-acbc-e9e04cecde93' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>print_flows</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-1b6479f9-f70d-4c39-8d3b-de2fb267476b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1b6479f9-f70d-4c39-8d3b-de2fb267476b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-60cfd097-282b-400d-8f86-ad28e8c9ec4d' class='xr-var-data-in' type='checkbox'><label for='data-60cfd097-282b-400d-8f86-ad28e8c9ec4d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>save_flows</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-faf19d01-2ffc-428c-93e1-33627e9025f6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-faf19d01-2ffc-428c-93e1-33627e9025f6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dc9cc65e-46fd-4d8e-bd96-c7a23773ec9d' class='xr-var-data-in' type='checkbox'><label for='data-dc9cc65e-46fd-4d8e-bd96-c7a23773ec9d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>observations</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-e93012a0-37c3-4f58-88ec-24d2412c2a3e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e93012a0-37c3-4f58-88ec-24d2412c2a3e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-062c9812-2c17-4aec-8f62-c91aa2871712' class='xr-var-data-in' type='checkbox'><label for='data-062c9812-2c17-4aec-8f62-c91aa2871712' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>repeat_stress</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-8f5c4d61-a35e-4363-9dc2-d408c553223d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8f5c4d61-a35e-4363-9dc2-d408c553223d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-52f858d7-f8e4-4675-ad3f-8474faab2528' class='xr-var-data-in' type='checkbox'><label for='data-52f858d7-f8e4-4675-ad3f-8474faab2528' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>fixed_cell</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-640fc3f9-2153-4103-aeef-c0f65ac69af1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-640fc3f9-2153-4103-aeef-c0f65ac69af1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-11612add-6b70-43db-aa31-e850261549a1' class='xr-var-data-in' type='checkbox'><label for='data-11612add-6b70-43db-aa31-e850261549a1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e0e3d4a3-5825-47b5-b0a5-600d8b32b2a1' class='xr-section-summary-in' type='checkbox'  ><label for='section-e0e3d4a3-5825-47b5-b0a5-600d8b32b2a1' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>layer</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-7de93098-cbe0-41cf-aea7-f1bee5aba11a' class='xr-index-data-in' type='checkbox'/><label for='index-7de93098-cbe0-41cf-aea7-f1bee5aba11a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], dtype=&#x27;int32&#x27;, name=&#x27;layer&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-5994db59-1871-4c24-a7c0-f5dfe3b83933' class='xr-index-data-in' type='checkbox'/><label for='index-5994db59-1871-4c24-a7c0-f5dfe3b83933' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2009-12-30 23:59:59&#x27;, &#x27;2009-12-31 00:00:00&#x27;], dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-d3155d19-aebf-4511-83ba-5a92895cf8ef' class='xr-index-data-in' type='checkbox'/><label for='index-d3155d19-aebf-4511-83ba-5a92895cf8ef' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([563950.0, 563850.0, 563750.0, 563650.0, 563550.0, 563450.0, 563350.0,
           563250.0, 563150.0, 563050.0, 562950.0, 562850.0, 562750.0, 562650.0,
           562550.0, 562450.0, 562350.0, 562250.0, 562150.0, 562050.0, 561950.0,
           561850.0, 561750.0, 561650.0, 561550.0, 561450.0, 561350.0, 561250.0,
           561150.0, 561050.0, 560950.0, 560850.0, 560750.0, 560650.0, 560550.0,
           560450.0, 560350.0, 560250.0, 560150.0, 560050.0, 559950.0, 559850.0,
           559750.0, 559650.0, 559550.0, 559450.0, 559350.0, 559250.0, 559150.0,
           559050.0],
          dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-61732cda-72aa-4082-a416-a4a8bbab8b72' class='xr-index-data-in' type='checkbox'/><label for='index-61732cda-72aa-4082-a416-a4a8bbab8b72' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([237550.0, 237650.0, 237750.0, 237850.0, 237950.0, 238050.0, 238150.0,
           238250.0, 238350.0, 238450.0,
           ...
           249050.0, 249150.0, 249250.0, 249350.0, 249450.0, 249550.0, 249650.0,
           249750.0, 249850.0, 249950.0],
          dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=125))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b17e9aae-87fa-40ab-8e3f-ed765c67ca5b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-b17e9aae-87fa-40ab-8e3f-ed765c67ca5b' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 219-220

Next, add the recharge package to the regridded simulation

.. GENERATED FROM PYTHON SOURCE LINES 220-225

.. code-block:: Python

    regridded_simulation["GWF"]["rch"] = regridded_recharge

    # We can also reattach the original again
    original_simulation["GWF"]["rch"] = original_rch_package








.. GENERATED FROM PYTHON SOURCE LINES 226-233

Comparison with histograms
--------------------------

In the next segment we will compare the input of the models on different grids.
We advice to always check how your input is regridded. In this example we upscaled grid,
many input parameters are regridded with a ``mean`` method. This means that their input
range is reduced, which can be seen in tailings in the histograms becoming shorter

.. GENERATED FROM PYTHON SOURCE LINES 233-245

.. code-block:: Python



    def plot_histograms_side_by_side(array_original, array_regridded, title):
        """This function creates a plot of normalized histograms of the 2 input
        DataArray. It plots a title above each histogram."""
        _, (ax0, ax1) = plt.subplots(1, 2, sharex=True, sharey=True, tight_layout=True)
        array_original.plot.hist(ax=ax0, bins=25, density=True)
        array_regridded.plot.hist(ax=ax1, bins=25, density=True)
        ax0.title.set_text(f"{title} (original)")
        ax1.title.set_text(f"{title} (regridded)")









.. GENERATED FROM PYTHON SOURCE LINES 246-247

Compare constant head arrays.

.. GENERATED FROM PYTHON SOURCE LINES 247-253

.. code-block:: Python

    plot_histograms_side_by_side(
        original_simulation["GWF"]["chd"]["head"],
        regridded_simulation["GWF"]["chd"]["head"],
        "chd head",
    )




.. image-sg:: /user-guide/images/sphx_glr_08-regridding_002.png
   :alt: chd head (original), chd head (regridded)
   :srcset: /user-guide/images/sphx_glr_08-regridding_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 254-255

Compare horizontal hydraulic conductivities.

.. GENERATED FROM PYTHON SOURCE LINES 255-260

.. code-block:: Python

    plot_histograms_side_by_side(
        original_simulation["GWF"]["npf"]["k"],
        regridded_simulation["GWF"]["npf"]["k"],
        "npf k",
    )



.. image-sg:: /user-guide/images/sphx_glr_08-regridding_003.png
   :alt: npf k (original), npf k (regridded)
   :srcset: /user-guide/images/sphx_glr_08-regridding_003.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 261-262

Compare vertical hydraulic conductivities.

.. GENERATED FROM PYTHON SOURCE LINES 262-267

.. code-block:: Python

    plot_histograms_side_by_side(
        original_simulation["GWF"]["npf"]["k33"],
        regridded_simulation["GWF"]["npf"]["k33"],
        "npf k33",
    )



.. image-sg:: /user-guide/images/sphx_glr_08-regridding_004.png
   :alt: npf k33 (original), npf k33 (regridded)
   :srcset: /user-guide/images/sphx_glr_08-regridding_004.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 268-269

Compare starting heads.

.. GENERATED FROM PYTHON SOURCE LINES 269-275

.. code-block:: Python

    plot_histograms_side_by_side(
        original_simulation["GWF"]["ic"]["start"],
        regridded_simulation["GWF"]["ic"]["start"],
        "ic start",
    )




.. image-sg:: /user-guide/images/sphx_glr_08-regridding_005.png
   :alt: ic start (original), ic start (regridded)
   :srcset: /user-guide/images/sphx_glr_08-regridding_005.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 276-277

Compare river stages.

.. GENERATED FROM PYTHON SOURCE LINES 277-283

.. code-block:: Python

    plot_histograms_side_by_side(
        original_simulation["GWF"]["riv"]["stage"],
        regridded_simulation["GWF"]["riv"]["stage"],
        "riv stage",
    )




.. image-sg:: /user-guide/images/sphx_glr_08-regridding_006.png
   :alt: riv stage (original), riv stage (regridded)
   :srcset: /user-guide/images/sphx_glr_08-regridding_006.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 284-285

Compare river bottom elevations.

.. GENERATED FROM PYTHON SOURCE LINES 285-291

.. code-block:: Python

    plot_histograms_side_by_side(
        original_simulation["GWF"]["riv"]["bottom_elevation"],
        regridded_simulation["GWF"]["riv"]["bottom_elevation"],
        "riv bottom elevation",
    )




.. image-sg:: /user-guide/images/sphx_glr_08-regridding_007.png
   :alt: riv bottom elevation (original), riv bottom elevation (regridded)
   :srcset: /user-guide/images/sphx_glr_08-regridding_007.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 292-293

Compare riverbed conductance.

.. GENERATED FROM PYTHON SOURCE LINES 293-299

.. code-block:: Python

    plot_histograms_side_by_side(
        original_simulation["GWF"]["riv"]["conductance"],
        regridded_simulation["GWF"]["riv"]["conductance"],
        "riv conductance",
    )




.. image-sg:: /user-guide/images/sphx_glr_08-regridding_008.png
   :alt: riv conductance (original), riv conductance (regridded)
   :srcset: /user-guide/images/sphx_glr_08-regridding_008.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 300-301

Compare recharge rates.

.. GENERATED FROM PYTHON SOURCE LINES 301-307

.. code-block:: Python

    plot_histograms_side_by_side(
        original_simulation["GWF"]["rch"]["rate"],
        regridded_simulation["GWF"]["rch"]["rate"],
        "rch rate",
    )




.. image-sg:: /user-guide/images/sphx_glr_08-regridding_009.png
   :alt: rch rate (original), rch rate (regridded)
   :srcset: /user-guide/images/sphx_glr_08-regridding_009.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 308-309

Compare drainage elevations.

.. GENERATED FROM PYTHON SOURCE LINES 309-315

.. code-block:: Python

    plot_histograms_side_by_side(
        original_simulation["GWF"]["drn-pipe"]["elevation"],
        regridded_simulation["GWF"]["drn-pipe"]["elevation"],
        "drn-pipe elevation",
    )




.. image-sg:: /user-guide/images/sphx_glr_08-regridding_010.png
   :alt: drn-pipe elevation (original), drn-pipe elevation (regridded)
   :srcset: /user-guide/images/sphx_glr_08-regridding_010.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 316-317

Compare drain conductances.

.. GENERATED FROM PYTHON SOURCE LINES 317-323

.. code-block:: Python

    plot_histograms_side_by_side(
        original_simulation["GWF"]["drn-pipe"]["conductance"],
        regridded_simulation["GWF"]["drn-pipe"]["conductance"],
        "drn-pipe conductance",
    )




.. image-sg:: /user-guide/images/sphx_glr_08-regridding_011.png
   :alt: drn-pipe conductance (original), drn-pipe conductance (regridded)
   :srcset: /user-guide/images/sphx_glr_08-regridding_011.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 324-325

Let's compare outputs now.

.. GENERATED FROM PYTHON SOURCE LINES 325-334

.. code-block:: Python


    # Write simulation
    original_simulation.write(tmpdir / "original")
    # Run and open heads
    original_simulation.run()
    hds_original = original_simulation.open_head()

    hds_original






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;head&#x27; (time: 2, layer: 13, y: 200, x: 500)&gt; Size: 21MB
    dask.array&lt;stack, shape=(2, 13, 200, 500), dtype=float64, chunksize=(1, 13, 200, 500), chunktype=numpy.ndarray&gt;
    Coordinates:
      * x        (x) float64 4kB 2.375e+05 2.375e+05 2.376e+05 ... 2.5e+05 2.5e+05
      * y        (y) float64 2kB 5.64e+05 5.64e+05 5.639e+05 ... 5.59e+05 5.59e+05
        dx       float64 8B 25.0
        dy       float64 8B -25.0
      * layer    (layer) int64 104B 1 2 3 4 5 6 7 8 9 10 11 12 13
      * time     (time) float64 16B 1.157e-05 365.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'head'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 2</li><li><span class='xr-has-index'>layer</span>: 13</li><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>x</span>: 500</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-d54cc940-63c7-4b0e-970f-10282764b547' class='xr-array-in' type='checkbox' checked><label for='section-d54cc940-63c7-4b0e-970f-10282764b547' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(1, 13, 200, 500), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>
        <tr>
            <td>
                <table style="border-collapse: collapse;">
                    <thead>
                        <tr>
                            <td> </td>
                            <th> Array </th>
                            <th> Chunk </th>
                        </tr>
                    </thead>
                    <tbody>
                    
                        <tr>
                            <th> Bytes </th>
                            <td> 19.84 MiB </td>
                            <td> 9.92 MiB </td>
                        </tr>
                    
                        <tr>
                            <th> Shape </th>
                            <td> (2, 13, 200, 500) </td>
                            <td> (1, 13, 200, 500) </td>
                        </tr>
                        <tr>
                            <th> Dask graph </th>
                            <td colspan="2"> 2 chunks in 5 graph layers </td>
                        </tr>
                        <tr>
                            <th> Data type </th>
                            <td colspan="2"> float64 numpy.ndarray </td>
                        </tr>
                    </tbody>
                </table>
            </td>
            <td>
            <svg width="377" height="115" style="stroke:rgb(0,0,0);stroke-width:1" >

      <!-- Horizontal lines -->
      <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
      <line x1="0" y1="25" x2="25" y2="25" style="stroke-width:2" />

      <!-- Vertical lines -->
      <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
      <line x1="12" y1="0" x2="12" y2="25" />
      <line x1="25" y1="0" x2="25" y2="25" style="stroke-width:2" />

      <!-- Colored Rectangle -->
      <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

      <!-- Text -->
      <text x="12.706308" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >2</text>
      <text x="45.412617" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,45.412617,12.706308)">1</text>


      <!-- Horizontal lines -->
      <line x1="95" y1="0" x2="112" y2="17" style="stroke-width:2" />
      <line x1="95" y1="48" x2="112" y2="65" style="stroke-width:2" />

      <!-- Vertical lines -->
      <line x1="95" y1="0" x2="95" y2="48" style="stroke-width:2" />
      <line x1="112" y1="17" x2="112" y2="65" style="stroke-width:2" />

      <!-- Colored Rectangle -->
      <polygon points="95.0,0.0 112.96546521682274,17.965465216822732 112.96546521682274,65.96546521682274 95.0,48.0" style="fill:#ECB172A0;stroke-width:0"/>

      <!-- Horizontal lines -->
      <line x1="95" y1="0" x2="215" y2="0" style="stroke-width:2" />
      <line x1="112" y1="17" x2="232" y2="17" style="stroke-width:2" />

      <!-- Vertical lines -->
      <line x1="95" y1="0" x2="112" y2="17" style="stroke-width:2" />
      <line x1="215" y1="0" x2="232" y2="17" style="stroke-width:2" />

      <!-- Colored Rectangle -->
      <polygon points="95.0,0.0 215.0,0.0 232.96546521682274,17.965465216822732 112.96546521682274,17.965465216822732" style="fill:#ECB172A0;stroke-width:0"/>

      <!-- Horizontal lines -->
      <line x1="112" y1="17" x2="232" y2="17" style="stroke-width:2" />
      <line x1="112" y1="65" x2="232" y2="65" style="stroke-width:2" />

      <!-- Vertical lines -->
      <line x1="112" y1="17" x2="112" y2="65" style="stroke-width:2" />
      <line x1="232" y1="17" x2="232" y2="65" style="stroke-width:2" />

      <!-- Colored Rectangle -->
      <polygon points="112.96546521682274,17.965465216822732 232.96546521682274,17.965465216822732 232.96546521682274,65.96546521682274 112.96546521682274,65.96546521682274" style="fill:#ECB172A0;stroke-width:0"/>

      <!-- Text -->
      <text x="172.965465" y="85.965465" font-size="1.0rem" font-weight="100" text-anchor="middle" >500</text>
      <text x="252.965465" y="41.965465" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,252.965465,41.965465)">200</text>
      <text x="93.982733" y="76.982733" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,93.982733,76.982733)">13</text>
    </svg>
            </td>
        </tr>
    </table></div></div></li><li class='xr-section-item'><input id='section-bc8c1290-d611-4d3d-8316-f817c2534c98' class='xr-section-summary-in' type='checkbox'  checked><label for='section-bc8c1290-d611-4d3d-8316-f817c2534c98' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-c0dcb63c-757a-4bee-9cf2-1fb969fe6a3b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c0dcb63c-757a-4bee-9cf2-1fb969fe6a3b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b4e42743-4e2a-4a29-b1fb-65d335241b9b' class='xr-var-data-in' type='checkbox'><label for='data-b4e42743-4e2a-4a29-b1fb-65d335241b9b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5],
          shape=(500,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-72db11ef-4dcb-4afa-af49-330d7ac18d7a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-72db11ef-4dcb-4afa-af49-330d7ac18d7a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7538c93d-e976-47d9-8358-ef4c83925e4b' class='xr-var-data-in' type='checkbox'><label for='data-7538c93d-e976-47d9-8358-ef4c83925e4b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
           563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
           563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
           563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
           563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
           563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
           562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
           562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
           562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
           562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
           562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
           562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
           561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
           561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
           561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
           561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
           561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
           561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
           560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
           560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
           560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
           560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
           560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
           559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
           559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
           559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
           559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
           559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
           559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>25.0</div><input id='attrs-e76a22eb-1045-4614-9541-5a8d014a5759' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e76a22eb-1045-4614-9541-5a8d014a5759' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9cd762f8-ea71-4ab2-8c54-68ed880fa8ce' class='xr-var-data-in' type='checkbox'><label for='data-9cd762f8-ea71-4ab2-8c54-68ed880fa8ce' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-25.0</div><input id='attrs-81856726-3ae8-41f8-b6c0-fd9269638446' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-81856726-3ae8-41f8-b6c0-fd9269638446' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c47c7948-7ad5-4fd6-9a07-7e48f7223c66' class='xr-var-data-in' type='checkbox'><label for='data-c47c7948-7ad5-4fd6-9a07-7e48f7223c66' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12 13</div><input id='attrs-74dd15ea-24ad-4913-afe6-ba01f4766026' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-74dd15ea-24ad-4913-afe6-ba01f4766026' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1159e582-705d-4008-a9fe-6714c90a0bfa' class='xr-var-data-in' type='checkbox'><label for='data-1159e582-705d-4008-a9fe-6714c90a0bfa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.157e-05 365.0</div><input id='attrs-684e3a5a-3243-42d0-a33f-70586e1d71dc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-684e3a5a-3243-42d0-a33f-70586e1d71dc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9fea92ca-b623-483c-bf98-feb37cf5e181' class='xr-var-data-in' type='checkbox'><label for='data-9fea92ca-b623-483c-bf98-feb37cf5e181' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1.157407e-05, 3.650000e+02])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8f817475-ca99-4586-8707-dc550ee8b7f3' class='xr-section-summary-in' type='checkbox'  ><label for='section-8f817475-ca99-4586-8707-dc550ee8b7f3' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-ab5cdec2-527d-4c04-97ec-196d4309bd33' class='xr-index-data-in' type='checkbox'/><label for='index-ab5cdec2-527d-4c04-97ec-196d4309bd33' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([237512.5, 237537.5, 237562.5, 237587.5, 237612.5, 237637.5, 237662.5,
           237687.5, 237712.5, 237737.5,
           ...
           249762.5, 249787.5, 249812.5, 249837.5, 249862.5, 249887.5, 249912.5,
           249937.5, 249962.5, 249987.5],
          dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=500))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-9ea817a5-3659-46ad-80f5-9905f278a312' class='xr-index-data-in' type='checkbox'/><label for='index-9ea817a5-3659-46ad-80f5-9905f278a312' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
           563812.5, 563787.5, 563762.5,
           ...
           559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5, 559087.5,
           559062.5, 559037.5, 559012.5],
          dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=200))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>layer</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-ce003390-b784-459d-8e4e-c2f9caa2ce78' class='xr-index-data-in' type='checkbox'/><label for='index-ce003390-b784-459d-8e4e-c2f9caa2ce78' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], dtype=&#x27;int64&#x27;, name=&#x27;layer&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-7e8c2338-6721-4ba8-9179-5fb9d02ac3a8' class='xr-index-data-in' type='checkbox'/><label for='index-7e8c2338-6721-4ba8-9179-5fb9d02ac3a8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1.1574074074074073e-05, 365.00001157407405], dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-cec4ab33-2167-46ab-8031-2cb377e0ac30' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-cec4ab33-2167-46ab-8031-2cb377e0ac30' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 335-341

.. code-block:: Python

    regridded_simulation.write(tmpdir / "regridded", validate=False)
    regridded_simulation.run()
    hds_regridded = regridded_simulation.open_head()

    hds_regridded






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;head&#x27; (time: 2, layer: 13, y: 50, x: 125)&gt; Size: 1MB
    dask.array&lt;stack, shape=(2, 13, 50, 125), dtype=float64, chunksize=(1, 13, 50, 125), chunktype=numpy.ndarray&gt;
    Coordinates:
      * x        (x) float64 1kB 2.376e+05 2.376e+05 2.378e+05 ... 2.498e+05 2.5e+05
      * y        (y) float64 400B 5.64e+05 5.638e+05 ... 5.592e+05 5.59e+05
        dx       float64 8B 100.0
        dy       float64 8B -100.0
      * layer    (layer) int64 104B 1 2 3 4 5 6 7 8 9 10 11 12 13
      * time     (time) float64 16B 1.157e-05 365.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'head'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 2</li><li><span class='xr-has-index'>layer</span>: 13</li><li><span class='xr-has-index'>y</span>: 50</li><li><span class='xr-has-index'>x</span>: 125</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-1628f861-6ac4-413e-b479-6cbd57c458b1' class='xr-array-in' type='checkbox' checked><label for='section-1628f861-6ac4-413e-b479-6cbd57c458b1' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(1, 13, 50, 125), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>
        <tr>
            <td>
                <table style="border-collapse: collapse;">
                    <thead>
                        <tr>
                            <td> </td>
                            <th> Array </th>
                            <th> Chunk </th>
                        </tr>
                    </thead>
                    <tbody>
                    
                        <tr>
                            <th> Bytes </th>
                            <td> 1.24 MiB </td>
                            <td> 634.77 kiB </td>
                        </tr>
                    
                        <tr>
                            <th> Shape </th>
                            <td> (2, 13, 50, 125) </td>
                            <td> (1, 13, 50, 125) </td>
                        </tr>
                        <tr>
                            <th> Dask graph </th>
                            <td colspan="2"> 2 chunks in 5 graph layers </td>
                        </tr>
                        <tr>
                            <th> Data type </th>
                            <td colspan="2"> float64 numpy.ndarray </td>
                        </tr>
                    </tbody>
                </table>
            </td>
            <td>
            <svg width="386" height="120" style="stroke:rgb(0,0,0);stroke-width:1" >

      <!-- Horizontal lines -->
      <line x1="0" y1="0" x2="27" y2="0" style="stroke-width:2" />
      <line x1="0" y1="25" x2="27" y2="25" style="stroke-width:2" />

      <!-- Vertical lines -->
      <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
      <line x1="13" y1="0" x2="13" y2="25" />
      <line x1="27" y1="0" x2="27" y2="25" style="stroke-width:2" />

      <!-- Colored Rectangle -->
      <polygon points="0.0,0.0 27.802530457377745,0.0 27.802530457377745,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

      <!-- Text -->
      <text x="13.901265" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >2</text>
      <text x="47.802530" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,47.802530,12.706308)">1</text>


      <!-- Horizontal lines -->
      <line x1="97" y1="0" x2="119" y2="22" style="stroke-width:2" />
      <line x1="97" y1="48" x2="119" y2="70" style="stroke-width:2" />

      <!-- Vertical lines -->
      <line x1="97" y1="0" x2="97" y2="48" style="stroke-width:2" />
      <line x1="119" y1="22" x2="119" y2="70" style="stroke-width:2" />

      <!-- Colored Rectangle -->
      <polygon points="97.0,0.0 119.83122152144657,22.831221521446558 119.83122152144657,70.83122152144657 97.0,48.0" style="fill:#ECB172A0;stroke-width:0"/>

      <!-- Horizontal lines -->
      <line x1="97" y1="0" x2="217" y2="0" style="stroke-width:2" />
      <line x1="119" y1="22" x2="239" y2="22" style="stroke-width:2" />

      <!-- Vertical lines -->
      <line x1="97" y1="0" x2="119" y2="22" style="stroke-width:2" />
      <line x1="217" y1="0" x2="239" y2="22" style="stroke-width:2" />

      <!-- Colored Rectangle -->
      <polygon points="97.0,0.0 217.0,0.0 239.83122152144657,22.831221521446558 119.83122152144657,22.831221521446558" style="fill:#ECB172A0;stroke-width:0"/>

      <!-- Horizontal lines -->
      <line x1="119" y1="22" x2="239" y2="22" style="stroke-width:2" />
      <line x1="119" y1="70" x2="239" y2="70" style="stroke-width:2" />

      <!-- Vertical lines -->
      <line x1="119" y1="22" x2="119" y2="70" style="stroke-width:2" />
      <line x1="239" y1="22" x2="239" y2="70" style="stroke-width:2" />

      <!-- Colored Rectangle -->
      <polygon points="119.83122152144657,22.831221521446558 239.83122152144657,22.831221521446558 239.83122152144657,70.83122152144657 119.83122152144657,70.83122152144657" style="fill:#ECB172A0;stroke-width:0"/>

      <!-- Text -->
      <text x="179.831222" y="90.831222" font-size="1.0rem" font-weight="100" text-anchor="middle" >125</text>
      <text x="259.831222" y="46.831222" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,259.831222,46.831222)">50</text>
      <text x="98.415611" y="79.415611" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,98.415611,79.415611)">13</text>
    </svg>
            </td>
        </tr>
    </table></div></div></li><li class='xr-section-item'><input id='section-a4a4c4e1-1ada-4573-8d4e-a829062f0e51' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a4a4c4e1-1ada-4573-8d4e-a829062f0e51' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.376e+05 2.376e+05 ... 2.5e+05</div><input id='attrs-9d5bf74c-165e-4e15-aed8-7845e12f8719' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9d5bf74c-165e-4e15-aed8-7845e12f8719' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9b95795d-b22d-413e-8131-10b727ddcbe6' class='xr-var-data-in' type='checkbox'><label for='data-9b95795d-b22d-413e-8131-10b727ddcbe6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237550., 237650., 237750., 237850., 237950., 238050., 238150., 238250.,
           238350., 238450., 238550., 238650., 238750., 238850., 238950., 239050.,
           239150., 239250., 239350., 239450., 239550., 239650., 239750., 239850.,
           239950., 240050., 240150., 240250., 240350., 240450., 240550., 240650.,
           240750., 240850., 240950., 241050., 241150., 241250., 241350., 241450.,
           241550., 241650., 241750., 241850., 241950., 242050., 242150., 242250.,
           242350., 242450., 242550., 242650., 242750., 242850., 242950., 243050.,
           243150., 243250., 243350., 243450., 243550., 243650., 243750., 243850.,
           243950., 244050., 244150., 244250., 244350., 244450., 244550., 244650.,
           244750., 244850., 244950., 245050., 245150., 245250., 245350., 245450.,
           245550., 245650., 245750., 245850., 245950., 246050., 246150., 246250.,
           246350., 246450., 246550., 246650., 246750., 246850., 246950., 247050.,
           247150., 247250., 247350., 247450., 247550., 247650., 247750., 247850.,
           247950., 248050., 248150., 248250., 248350., 248450., 248550., 248650.,
           248750., 248850., 248950., 249050., 249150., 249250., 249350., 249450.,
           249550., 249650., 249750., 249850., 249950.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.638e+05 ... 5.59e+05</div><input id='attrs-f4678aaa-8a90-48dd-834b-dbe515515a33' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f4678aaa-8a90-48dd-834b-dbe515515a33' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b9aca191-0deb-4e5d-89c1-22714c8a2ca6' class='xr-var-data-in' type='checkbox'><label for='data-b9aca191-0deb-4e5d-89c1-22714c8a2ca6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563950., 563850., 563750., 563650., 563550., 563450., 563350., 563250.,
           563150., 563050., 562950., 562850., 562750., 562650., 562550., 562450.,
           562350., 562250., 562150., 562050., 561950., 561850., 561750., 561650.,
           561550., 561450., 561350., 561250., 561150., 561050., 560950., 560850.,
           560750., 560650., 560550., 560450., 560350., 560250., 560150., 560050.,
           559950., 559850., 559750., 559650., 559550., 559450., 559350., 559250.,
           559150., 559050.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>100.0</div><input id='attrs-019139b2-840f-4c22-9b08-ad359d8778f5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-019139b2-840f-4c22-9b08-ad359d8778f5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b5d236b9-b7b4-48e4-944a-44135fd90180' class='xr-var-data-in' type='checkbox'><label for='data-b5d236b9-b7b4-48e4-944a-44135fd90180' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(100.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-100.0</div><input id='attrs-06aeace3-e093-400c-8fae-7db1c4e21a53' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-06aeace3-e093-400c-8fae-7db1c4e21a53' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6532dbdc-4a2b-4683-996e-7d7b911b30d6' class='xr-var-data-in' type='checkbox'><label for='data-6532dbdc-4a2b-4683-996e-7d7b911b30d6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-100.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12 13</div><input id='attrs-05336ed7-8c54-4282-bf5c-f379414966c4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-05336ed7-8c54-4282-bf5c-f379414966c4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b65b92eb-184a-48ea-bd13-4649638c17d7' class='xr-var-data-in' type='checkbox'><label for='data-b65b92eb-184a-48ea-bd13-4649638c17d7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.157e-05 365.0</div><input id='attrs-15c3fedd-5c84-467f-b33c-caef8cbf9656' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-15c3fedd-5c84-467f-b33c-caef8cbf9656' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7bc45550-8959-4d66-882b-bbdcb63c8a61' class='xr-var-data-in' type='checkbox'><label for='data-7bc45550-8959-4d66-882b-bbdcb63c8a61' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1.157407e-05, 3.650000e+02])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0941208d-c20e-4c6e-bc8e-c15aa6139a1c' class='xr-section-summary-in' type='checkbox'  ><label for='section-0941208d-c20e-4c6e-bc8e-c15aa6139a1c' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-60740ea7-6840-4a85-93d3-ae80d1eb409d' class='xr-index-data-in' type='checkbox'/><label for='index-60740ea7-6840-4a85-93d3-ae80d1eb409d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([237550.0, 237650.0, 237750.0, 237850.0, 237950.0, 238050.0, 238150.0,
           238250.0, 238350.0, 238450.0,
           ...
           249050.0, 249150.0, 249250.0, 249350.0, 249450.0, 249550.0, 249650.0,
           249750.0, 249850.0, 249950.0],
          dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=125))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-fdd010be-c96d-49af-a084-80c92bbd670b' class='xr-index-data-in' type='checkbox'/><label for='index-fdd010be-c96d-49af-a084-80c92bbd670b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([563950.0, 563850.0, 563750.0, 563650.0, 563550.0, 563450.0, 563350.0,
           563250.0, 563150.0, 563050.0, 562950.0, 562850.0, 562750.0, 562650.0,
           562550.0, 562450.0, 562350.0, 562250.0, 562150.0, 562050.0, 561950.0,
           561850.0, 561750.0, 561650.0, 561550.0, 561450.0, 561350.0, 561250.0,
           561150.0, 561050.0, 560950.0, 560850.0, 560750.0, 560650.0, 560550.0,
           560450.0, 560350.0, 560250.0, 560150.0, 560050.0, 559950.0, 559850.0,
           559750.0, 559650.0, 559550.0, 559450.0, 559350.0, 559250.0, 559150.0,
           559050.0],
          dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>layer</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-a696a2d3-293f-4b10-842a-20f1b9bd5688' class='xr-index-data-in' type='checkbox'/><label for='index-a696a2d3-293f-4b10-842a-20f1b9bd5688' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], dtype=&#x27;int64&#x27;, name=&#x27;layer&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-bc060eaa-e198-43cb-8178-3a9bfc2a0ffb' class='xr-index-data-in' type='checkbox'/><label for='index-bc060eaa-e198-43cb-8178-3a9bfc2a0ffb' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1.1574074074074073e-05, 365.00001157407405], dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d580937a-f84f-416f-9a6e-5cacca680e9e' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d580937a-f84f-416f-9a6e-5cacca680e9e' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 342-343

Let's make a comparison plot of the regridded heads.

.. GENERATED FROM PYTHON SOURCE LINES 343-356

.. code-block:: Python

    fig, axes = plt.subplots(nrows=2, sharex=True)
    plot_kwargs = {"colors": "viridis", "levels": np.linspace(0.0, 11.0, 12), "fig": fig}

    imod.visualize.spatial.plot_map(
        hds_original.isel(layer=6, time=-1), ax=axes[0], **plot_kwargs
    )
    imod.visualize.spatial.plot_map(
        hds_regridded.isel(layer=6, time=-1), ax=axes[1], **plot_kwargs
    )

    axes[0].set_ylabel("original")
    axes[1].set_ylabel("regridded")




.. image-sg:: /user-guide/images/sphx_glr_08-regridding_012.png
   :alt: 08 regridding
   :srcset: /user-guide/images/sphx_glr_08-regridding_012.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(28.472222222222243, 0.5, 'regridded')



.. GENERATED FROM PYTHON SOURCE LINES 357-419

A note on regridding conductivity
---------------------------------
In the npf package, it is possible to use for definining the conductivity tensor:

- 1 array (K)
- 2 arrays (K and K22)
- 3 arrays (K, K22, K33)

If 1 array is given the tensor
is called isotropic. Defining only K gives the same behavior as specifying K,
K22 and K33 with the same value. When regridding, K33 has a default method
different from that of K and K22, but it can only be applied if K33 exists in
the source model in the first place. So it is recommended to introduce K33 as a
separate array in the source model even if it is isotropic.
Also note that default regridding methods were chosen assuming that K and K22
are roughly horizontal and K33 roughly vertical. But this may not be the case
if the input arrays angle2 and/or angle3 have large values.

Regridding boundary conditions
------------------------------
Special care must be taken when regridding boundary conditions, and it is
recommended that users verify the balance output of a regridded simulation and
compare it to the original model. If the regridded simulation is a good
representation of the original simulation, the mass contributions on the balance
by the different boundary conditions should be comparable in both simulations.
To achieve this, it may be necessary to tweak the input or the regridding
methods. An example of this is upscaling recharge (so the target grid has
coarser cells than the source grid). Its default method is averaging, with the
following rules:

- if a cell in the source grid is inactive in the source recharge package
  (meaning no recharge), it will not count when averaging. So if a target cell
  has partial overlap with one source recharge cell, and the rest of the target
  cell has no overlap with any source active recharge cell, it will get the
  recharge of the one cell it has overlap with. But since the target cell is
  larger, this effectively means the regridded recharge will be more in the
  regridded simulation than it was in the source simulation
- but we do the same regridding this time assigning a zero recharge to cells
  without recharge then the averaging will take the zero-recharge cells into
  account and the regridded recharge will be the same as the source recharge.


A note on regridding transport
------------------------------
Transport simulations can be unstable if constraints related to the grid Peclet
number and the courant number are exceeded. This can easily happen when
regridding. It may be necessary to reduce the simulation's time step size
especially when downscaling, to prevent numerical issues. Increasing
dispersivities or the molecular diffusion constant can also help to stabilize
the simulation. Inversely, when upscaling, a larger time step size can be acceptable.


Unsupported packages
--------------------
Some packages cannot be regridded. This includes the Lake package and the UZF
package. Such packages should be removed from the simulation before regridding,
and then new packages should be created by the user and then added to the
regridded simulation.


This code snippet prints all default methods:


.. GENERATED FROM PYTHON SOURCE LINES 419-465

.. code-block:: Python

    import inspect
    import sys
    from dataclasses import asdict

    import pandas as pd

    regrid_method_setup = {
        "package name": [],
        "array name": [],
        "method name": [],
        "function name": [],
    }
    regrid_method_table = pd.DataFrame(regrid_method_setup)
    # Get all classes in the imod.mf6 module (e.g. imod.mf6.NodePropertyFlow,
    # imod.mf6.GroundwaterFlowModel, imod.mf6.River)
    mf6_classes = [
        obj for _, obj in inspect.getmembers(sys.modules["imod.mf6"], inspect.isclass)
    ]

    counter = 0
    for obj in mf6_classes:
        if hasattr(obj, "_regrid_method"):
            package_name = obj.__name__
            regrid_methods = asdict(obj.get_regrid_methods())
            for array_name in regrid_methods.keys():
                method_name = regrid_methods[array_name][0].name
                function_name = ""
                if len(regrid_methods[array_name]) > 0:
                    function_name = regrid_methods[array_name][1]
                regrid_method_table.loc[counter] = (
                    package_name,
                    array_name,
                    method_name,
                    function_name,
                )
                counter = counter + 1

    # Set multi index to group with packages
    regrid_method_table = regrid_method_table.set_index(["package name", "array name"])
    # Pandas by default displays at max 60 rows, which this table exceeds.
    nrows = regrid_method_table.shape[0]
    # Configure pandas to increase the max amount of displayable rows.
    pd.set_option("display.max_rows", nrows + 1)
    # Display rows:
    regrid_method_table






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th></th>
          <th>method name</th>
          <th>function name</th>
        </tr>
        <tr>
          <th>package name</th>
          <th>array name</th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th rowspan="3" valign="top">ConstantHead</th>
          <th>head</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>concentration</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>ibound</th>
          <td>OVERLAP</td>
          <td>mode</td>
        </tr>
        <tr>
          <th rowspan="6" valign="top">Dispersion</th>
          <th>diffusion_coefficient</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>longitudinal_horizontal</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>transversal_horizontal1</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>longitudinal_vertical</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>transversal_horizontal2</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>transversal_vertical</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th rowspan="3" valign="top">Drainage</th>
          <th>elevation</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>conductance</th>
          <td>RELATIVEOVERLAP</td>
          <td>conductance</td>
        </tr>
        <tr>
          <th>concentration</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th rowspan="5" valign="top">Evapotranspiration</th>
          <th>surface</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>rate</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>depth</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>proportion_rate</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>proportion_depth</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th rowspan="3" valign="top">GeneralHeadBoundary</th>
          <th>head</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>conductance</th>
          <td>RELATIVEOVERLAP</td>
          <td>conductance</td>
        </tr>
        <tr>
          <th>concentration</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>InitialConditions</th>
          <th>start</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th rowspan="6" valign="top">MobileStorageTransfer</th>
          <th>porosity</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>decay</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>decay_sorbed</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>bulk_density</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>distcoef</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>sp2</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th rowspan="8" valign="top">NodePropertyFlow</th>
          <th>icelltype</th>
          <td>OVERLAP</td>
          <td>mode</td>
        </tr>
        <tr>
          <th>k</th>
          <td>OVERLAP</td>
          <td>geometric_mean</td>
        </tr>
        <tr>
          <th>k22</th>
          <td>OVERLAP</td>
          <td>geometric_mean</td>
        </tr>
        <tr>
          <th>k33</th>
          <td>OVERLAP</td>
          <td>harmonic_mean</td>
        </tr>
        <tr>
          <th>angle1</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>angle2</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>angle3</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>rewet_layer</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th rowspan="2" valign="top">Recharge</th>
          <th>rate</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>concentration</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th rowspan="5" valign="top">River</th>
          <th>stage</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>conductance</th>
          <td>RELATIVEOVERLAP</td>
          <td>conductance</td>
        </tr>
        <tr>
          <th>bottom_elevation</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>concentration</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>infiltration_factor</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th rowspan="3" valign="top">SpecificStorage</th>
          <th>convertible</th>
          <td>OVERLAP</td>
          <td>mode</td>
        </tr>
        <tr>
          <th>specific_storage</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>specific_yield</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th rowspan="3" valign="top">StorageCoefficient</th>
          <th>convertible</th>
          <td>OVERLAP</td>
          <td>mode</td>
        </tr>
        <tr>
          <th>storage_coefficient</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>specific_yield</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th rowspan="3" valign="top">StructuredDiscretization</th>
          <th>top</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>bottom</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>idomain</th>
          <td>OVERLAP</td>
          <td>mode</td>
        </tr>
        <tr>
          <th rowspan="3" valign="top">VerticesDiscretization</th>
          <th>top</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>bottom</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>idomain</th>
          <td>OVERLAP</td>
          <td>mode</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (1 minutes 12.475 seconds)


.. _sphx_glr_download_user-guide_08-regridding.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: 08-regridding.ipynb <08-regridding.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: 08-regridding.py <08-regridding.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: 08-regridding.zip <08-regridding.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
