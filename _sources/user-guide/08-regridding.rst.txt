
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "user-guide\08-regridding.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_user-guide_08-regridding.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_user-guide_08-regridding.py:


Regridding
==========

Introduction
------------

Most MODFLOW 6 packages have spatial data arrays as input. These arrays are
discrete: they are defined over the simulation grid and contain values
associated to each cell.

Regridding these package means: create a new package with spatial data arrays
defined over a different grid. Computing what the values in these new arrays
should be, is done by xugrid.

xugrid will compute a regridded array based on:

- the original array
- the original discretization (this is described in the coordinates of the
  original arry)
- the new discretization
- a regridding method

More information on the available regridding methods can be found in the xugrid
documentation https://deltares.github.io/xugrid/user_guide.html

The regridding method that should be used depends on the property being
regridded. For example a point-based property (whose value do not depend
intrinsically on the grid block size) such as temperature or density can be
regridded by an averaging approach (for upscaling) or sampling (for
downscaling). Volume-based properties (whose values do depend on the grid block
size) include (water) mass and pore volume of a gridblock, and the regridding
method should be chosen to reflect that. Finally regridding methods for
conductivity-like properties follow the rules for parallel or serial resistors-
at least when the tensor rotation angles are constant or comparable in the
involved gridblocks.

Note that the different regridding methods may have a different output domain
when regridding: if the original array has no-data values in some cells, then
the output array may have no-data values as well, and where these end up depends
on the chosen regridding method. Also note that regridding is only possible in
the xy-plane, and not across the layer dimension. The output array will have the
same number of layers as the input array.

.. GENERATED FROM PYTHON SOURCE LINES 45-47

.. code-block:: Python
   :dedent: 1










.. GENERATED FROM PYTHON SOURCE LINES 49-91

Obtaining the final (i)domain
-----------------------------

In many real-world models, some cells will be inactive or marked as "vertical
passthrough" (VPT) in the idomain array of the simulation. Some packages
require that all cells that are inactictive or VPT in idomain are excluded
from the package as well. An example is the :class:`imod.mf6.NodePropertyFlow`
package: cells that are inactive or VPT in idomain, should not have
conductivity data in the npf package. Therefore at the end of the regridding
process, a final step consists in enforcing consistency between those of
idomain and all the packages. This is a 2-step process:

1) for cells that do not have inputs in crucial packages like npf or storage,
   idomain will be set to inactive.
2) for cells that are marked as inactive or VPT in idomain, all package inputs
   will be removed from all the packages

This synchronization step between idomain and the packages is automated, and it
is carried out when calling regrid_like on the simulation object or the model
object. There are 2 caveats:

1) the synchronization between idomain and the package domains is done on the
   model-level. If we have a simulation containing both a flow model and a
   transport model then idomain for flow is determined independent from that for
   transport. These models may therefore end up using different domains (this
   may lead to undesired results, so a manual synchronization may be necessary
   between the flow regridding and the transport regridding) This manual
   synchronization can be done using the "mask_all_packages" function- this
   function removes input from all packages that are marked as inactive or VPT
   in the idomain passed to this method.
2) The idomain/packages synchronization step is carried out when regridding a
   model, and when regridding a model it will use default methods for all the
   packages. So if you have regridded some packages yourself with non-default
   methods, then these are not taken into account during this synchonization
   step.

Regridding using default methods
--------------------------------

The regrid_like function is available on packages, models and simulations.
When the default methods are acceptable, regridding the whole simulation is
the most convenient from a user-perspective.

.. GENERATED FROM PYTHON SOURCE LINES 91-98

.. code-block:: Python


    import imod

    tmpdir = imod.util.temporary_directory()

    original_simulation = imod.data.hondsrug_simulation(tmpdir / "hondsrug_saved")








.. GENERATED FROM PYTHON SOURCE LINES 99-101

To reduce computational overhead for this example, we are going to clip off
most of the timesteps.

.. GENERATED FROM PYTHON SOURCE LINES 101-104

.. code-block:: Python


    original_simulation = original_simulation.clip_box(time_max="2010-01-01")








.. GENERATED FROM PYTHON SOURCE LINES 105-106

Let's take a look at the original discretization:

.. GENERATED FROM PYTHON SOURCE LINES 106-109

.. code-block:: Python


    original_simulation["GWF"]["dis"]






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>StructuredDiscretization</div><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "📁";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 11MB
    Dimensions:  (layer: 13, y: 200, x: 500)
    Coordinates:
      * layer    (layer) int32 52B 1 2 3 4 5 6 7 8 9 10 11 12 13
      * y        (y) float64 2kB 5.64e+05 5.64e+05 5.639e+05 ... 5.59e+05 5.59e+05
      * x        (x) float64 4kB 2.375e+05 2.375e+05 2.376e+05 ... 2.5e+05 2.5e+05
        dx       float64 8B ...
        dy       float64 8B ...
    Data variables:
        idomain  (layer, y, x) int32 5MB ...
        top      (y, x) float32 400kB ...
        bottom   (layer, y, x) float32 5MB ...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-405955ea-5e19-44ca-b7d9-2a9ad7c31d20' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-405955ea-5e19-44ca-b7d9-2a9ad7c31d20' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>layer</span>: 13</li><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>x</span>: 500</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-d25dc1ce-9c7d-4304-aa1c-8319563bb157' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d25dc1ce-9c7d-4304-aa1c-8319563bb157' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12 13</div><input id='attrs-bec37cdb-c33e-4a11-8959-02d29eadf3bb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bec37cdb-c33e-4a11-8959-02d29eadf3bb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-95e8bf43-1f61-4bd5-a6f9-731e79d69e25' class='xr-var-data-in' type='checkbox'><label for='data-95e8bf43-1f61-4bd5-a6f9-731e79d69e25' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-4d26e524-4b37-4abf-b255-2f155b42890b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4d26e524-4b37-4abf-b255-2f155b42890b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9c3788a7-f465-4ad3-952e-6d2458a25d33' class='xr-var-data-in' type='checkbox'><label for='data-9c3788a7-f465-4ad3-952e-6d2458a25d33' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
           563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
           563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
           563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
           563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
           563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
           562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
           562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
           562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
           562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
           562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
           562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
           561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
           561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
           561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
           561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
           561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
           561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
           560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
           560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
           560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
           560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
           560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
           559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
           559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
           559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
           559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
           559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
           559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-64237cd6-12ae-4022-a661-8822946c6c1a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-64237cd6-12ae-4022-a661-8822946c6c1a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d65c902d-e762-4b35-8bc4-3a69166ca0ef' class='xr-var-data-in' type='checkbox'><label for='data-d65c902d-e762-4b35-8bc4-3a69166ca0ef' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5],
          shape=(500,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-3d58f785-6d4e-44ab-87f7-ab32ce60440f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3d58f785-6d4e-44ab-87f7-ab32ce60440f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0637e81a-7f80-4011-9a15-ece74451e145' class='xr-var-data-in' type='checkbox'><label for='data-0637e81a-7f80-4011-9a15-ece74451e145' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-d2477a5c-9bcb-4ff6-a45e-6bfc39609845' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d2477a5c-9bcb-4ff6-a45e-6bfc39609845' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9f24b6fb-81d2-4b11-9a50-9ba5209778ac' class='xr-var-data-in' type='checkbox'><label for='data-9f24b6fb-81d2-4b11-9a50-9ba5209778ac' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float64]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-dba94f5c-da1f-4f76-b526-dccd69420183' class='xr-section-summary-in' type='checkbox'  checked><label for='section-dba94f5c-da1f-4f76-b526-dccd69420183' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>idomain</span></div><div class='xr-var-dims'>(layer, y, x)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-53f91d28-d176-4fe4-8d9d-b4b86825445c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-53f91d28-d176-4fe4-8d9d-b4b86825445c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3fbd992a-d8cb-40b8-9bda-b93871eb212d' class='xr-var-data-in' type='checkbox'><label for='data-3fbd992a-d8cb-40b8-9bda-b93871eb212d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1300000 values with dtype=int32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>top</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-62c29238-5ca5-403b-b957-9caf24987ddf' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-62c29238-5ca5-403b-b957-9caf24987ddf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-60495146-9ac3-485e-bf2e-b79167a65ba6' class='xr-var-data-in' type='checkbox'><label for='data-60495146-9ac3-485e-bf2e-b79167a65ba6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[100000 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>bottom</span></div><div class='xr-var-dims'>(layer, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-c913ec38-dd7e-47b4-b325-36df11c5aa73' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c913ec38-dd7e-47b4-b325-36df11c5aa73' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-20025bed-51c7-427c-984b-8e4fc6157309' class='xr-var-data-in' type='checkbox'><label for='data-20025bed-51c7-427c-984b-8e4fc6157309' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1300000 values with dtype=float32]</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 110-111

We want to regrid this to the following target grid:

.. GENERATED FROM PYTHON SOURCE LINES 111-127

.. code-block:: Python

    import xarray as xr

    import imod

    dx = 100
    dy = -100
    xmin = 237500.0
    xmax = 250000.0
    ymin = 559000.0
    ymax = 564000.0
    target_grid = imod.util.empty_2d(
        dx=dx, dy=dy, xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax
    )

    target_grid






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "📁";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (y: 50, x: 125)&gt; Size: 50kB
    array([[nan, nan, nan, ..., nan, nan, nan],
           [nan, nan, nan, ..., nan, nan, nan],
           [nan, nan, nan, ..., nan, nan, nan],
           ...,
           [nan, nan, nan, ..., nan, nan, nan],
           [nan, nan, nan, ..., nan, nan, nan],
           [nan, nan, nan, ..., nan, nan, nan]], shape=(50, 125))
    Coordinates:
      * y        (y) float64 400B 5.64e+05 5.638e+05 ... 5.592e+05 5.59e+05
      * x        (x) float64 1kB 2.376e+05 2.376e+05 2.378e+05 ... 2.498e+05 2.5e+05
        dx       float64 8B 100.0
        dy       float64 8B -100.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 50</li><li><span class='xr-has-index'>x</span>: 125</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-e796ec95-fafc-46c7-93da-59b8267a0c0a' class='xr-array-in' type='checkbox' checked><label for='section-e796ec95-fafc-46c7-93da-59b8267a0c0a' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>nan nan nan nan nan nan nan nan ... nan nan nan nan nan nan nan nan</span></div><div class='xr-array-data'><pre>array([[nan, nan, nan, ..., nan, nan, nan],
           [nan, nan, nan, ..., nan, nan, nan],
           [nan, nan, nan, ..., nan, nan, nan],
           ...,
           [nan, nan, nan, ..., nan, nan, nan],
           [nan, nan, nan, ..., nan, nan, nan],
           [nan, nan, nan, ..., nan, nan, nan]], shape=(50, 125))</pre></div></div></li><li class='xr-section-item'><input id='section-d49f3c25-2da5-44b8-9125-e25d3c5b5ac0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d49f3c25-2da5-44b8-9125-e25d3c5b5ac0' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.638e+05 ... 5.59e+05</div><input id='attrs-96b9076d-2071-426e-9f08-f0cb694b4f5d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-96b9076d-2071-426e-9f08-f0cb694b4f5d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-15814758-15e9-49b0-8554-5f3428ed2bc0' class='xr-var-data-in' type='checkbox'><label for='data-15814758-15e9-49b0-8554-5f3428ed2bc0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563950., 563850., 563750., 563650., 563550., 563450., 563350., 563250.,
           563150., 563050., 562950., 562850., 562750., 562650., 562550., 562450.,
           562350., 562250., 562150., 562050., 561950., 561850., 561750., 561650.,
           561550., 561450., 561350., 561250., 561150., 561050., 560950., 560850.,
           560750., 560650., 560550., 560450., 560350., 560250., 560150., 560050.,
           559950., 559850., 559750., 559650., 559550., 559450., 559350., 559250.,
           559150., 559050.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.376e+05 2.376e+05 ... 2.5e+05</div><input id='attrs-f4a2be79-198b-4133-8688-f1a42c45c666' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f4a2be79-198b-4133-8688-f1a42c45c666' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3cec0270-ee0a-4351-b2a2-07fbe1b67277' class='xr-var-data-in' type='checkbox'><label for='data-3cec0270-ee0a-4351-b2a2-07fbe1b67277' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237550., 237650., 237750., 237850., 237950., 238050., 238150., 238250.,
           238350., 238450., 238550., 238650., 238750., 238850., 238950., 239050.,
           239150., 239250., 239350., 239450., 239550., 239650., 239750., 239850.,
           239950., 240050., 240150., 240250., 240350., 240450., 240550., 240650.,
           240750., 240850., 240950., 241050., 241150., 241250., 241350., 241450.,
           241550., 241650., 241750., 241850., 241950., 242050., 242150., 242250.,
           242350., 242450., 242550., 242650., 242750., 242850., 242950., 243050.,
           243150., 243250., 243350., 243450., 243550., 243650., 243750., 243850.,
           243950., 244050., 244150., 244250., 244350., 244450., 244550., 244650.,
           244750., 244850., 244950., 245050., 245150., 245250., 245350., 245450.,
           245550., 245650., 245750., 245850., 245950., 246050., 246150., 246250.,
           246350., 246450., 246550., 246650., 246750., 246850., 246950., 247050.,
           247150., 247250., 247350., 247450., 247550., 247650., 247750., 247850.,
           247950., 248050., 248150., 248250., 248350., 248450., 248550., 248650.,
           248750., 248850., 248950., 249050., 249150., 249250., 249350., 249450.,
           249550., 249650., 249750., 249850., 249950.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>100.0</div><input id='attrs-635d3fa7-be84-496d-9b37-b031cd91ad07' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-635d3fa7-be84-496d-9b37-b031cd91ad07' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-58c41e58-da77-4e4f-b343-3843dbeaa7f0' class='xr-var-data-in' type='checkbox'><label for='data-58c41e58-da77-4e4f-b343-3843dbeaa7f0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(100.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-100.0</div><input id='attrs-551f8bc4-fa89-45c0-91ad-0aafa07fa8ff' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-551f8bc4-fa89-45c0-91ad-0aafa07fa8ff' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e10dc288-34fd-413c-9693-781913cf94bd' class='xr-var-data-in' type='checkbox'><label for='data-e10dc288-34fd-413c-9693-781913cf94bd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-100.)</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 128-130

This is a grid of nans, and we require a grid of ones, which can create with
xarray:

.. GENERATED FROM PYTHON SOURCE LINES 130-134

.. code-block:: Python

    target_grid = xr.ones_like(target_grid)

    target_grid






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "📁";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (y: 50, x: 125)&gt; Size: 50kB
    array([[1., 1., 1., ..., 1., 1., 1.],
           [1., 1., 1., ..., 1., 1., 1.],
           [1., 1., 1., ..., 1., 1., 1.],
           ...,
           [1., 1., 1., ..., 1., 1., 1.],
           [1., 1., 1., ..., 1., 1., 1.],
           [1., 1., 1., ..., 1., 1., 1.]], shape=(50, 125))
    Coordinates:
      * y        (y) float64 400B 5.64e+05 5.638e+05 ... 5.592e+05 5.59e+05
      * x        (x) float64 1kB 2.376e+05 2.376e+05 2.378e+05 ... 2.498e+05 2.5e+05
        dx       float64 8B 100.0
        dy       float64 8B -100.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 50</li><li><span class='xr-has-index'>x</span>: 125</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-77cd04cd-adff-43a8-b123-81f1fec9c6c6' class='xr-array-in' type='checkbox' checked><label for='section-77cd04cd-adff-43a8-b123-81f1fec9c6c6' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 ... 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0</span></div><div class='xr-array-data'><pre>array([[1., 1., 1., ..., 1., 1., 1.],
           [1., 1., 1., ..., 1., 1., 1.],
           [1., 1., 1., ..., 1., 1., 1.],
           ...,
           [1., 1., 1., ..., 1., 1., 1.],
           [1., 1., 1., ..., 1., 1., 1.],
           [1., 1., 1., ..., 1., 1., 1.]], shape=(50, 125))</pre></div></div></li><li class='xr-section-item'><input id='section-0436fb95-5f09-45d3-abb1-7f7140128df1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0436fb95-5f09-45d3-abb1-7f7140128df1' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.638e+05 ... 5.59e+05</div><input id='attrs-7a2f8326-7969-4089-aac3-e788097e993b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7a2f8326-7969-4089-aac3-e788097e993b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ae3eaf24-cf89-4c5f-8c5f-3b4ba1f049c3' class='xr-var-data-in' type='checkbox'><label for='data-ae3eaf24-cf89-4c5f-8c5f-3b4ba1f049c3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563950., 563850., 563750., 563650., 563550., 563450., 563350., 563250.,
           563150., 563050., 562950., 562850., 562750., 562650., 562550., 562450.,
           562350., 562250., 562150., 562050., 561950., 561850., 561750., 561650.,
           561550., 561450., 561350., 561250., 561150., 561050., 560950., 560850.,
           560750., 560650., 560550., 560450., 560350., 560250., 560150., 560050.,
           559950., 559850., 559750., 559650., 559550., 559450., 559350., 559250.,
           559150., 559050.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.376e+05 2.376e+05 ... 2.5e+05</div><input id='attrs-3ed2703c-f517-445b-ac1c-2cab0de2927d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3ed2703c-f517-445b-ac1c-2cab0de2927d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2ab4fa48-706d-4b7f-ac8f-fa7cd9c8ce91' class='xr-var-data-in' type='checkbox'><label for='data-2ab4fa48-706d-4b7f-ac8f-fa7cd9c8ce91' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237550., 237650., 237750., 237850., 237950., 238050., 238150., 238250.,
           238350., 238450., 238550., 238650., 238750., 238850., 238950., 239050.,
           239150., 239250., 239350., 239450., 239550., 239650., 239750., 239850.,
           239950., 240050., 240150., 240250., 240350., 240450., 240550., 240650.,
           240750., 240850., 240950., 241050., 241150., 241250., 241350., 241450.,
           241550., 241650., 241750., 241850., 241950., 242050., 242150., 242250.,
           242350., 242450., 242550., 242650., 242750., 242850., 242950., 243050.,
           243150., 243250., 243350., 243450., 243550., 243650., 243750., 243850.,
           243950., 244050., 244150., 244250., 244350., 244450., 244550., 244650.,
           244750., 244850., 244950., 245050., 245150., 245250., 245350., 245450.,
           245550., 245650., 245750., 245850., 245950., 246050., 246150., 246250.,
           246350., 246450., 246550., 246650., 246750., 246850., 246950., 247050.,
           247150., 247250., 247350., 247450., 247550., 247650., 247750., 247850.,
           247950., 248050., 248150., 248250., 248350., 248450., 248550., 248650.,
           248750., 248850., 248950., 249050., 249150., 249250., 249350., 249450.,
           249550., 249650., 249750., 249850., 249950.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>100.0</div><input id='attrs-9cbd930e-ae0e-4828-9eea-403d6b79c82a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9cbd930e-ae0e-4828-9eea-403d6b79c82a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-94954264-f930-4798-8e8a-6f1071743323' class='xr-var-data-in' type='checkbox'><label for='data-94954264-f930-4798-8e8a-6f1071743323' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(100.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-100.0</div><input id='attrs-769309c1-9498-4748-b365-ad71a5edcbe2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-769309c1-9498-4748-b365-ad71a5edcbe2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-aa892241-400e-4b25-bbfd-b979af6a0e6f' class='xr-var-data-in' type='checkbox'><label for='data-aa892241-400e-4b25-bbfd-b979af6a0e6f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-100.)</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 135-136

Now regrid the simulation (without recharge):

.. GENERATED FROM PYTHON SOURCE LINES 136-138

.. code-block:: Python

    regridded_simulation = original_simulation.regrid_like("regridded", target_grid)








.. GENERATED FROM PYTHON SOURCE LINES 139-140

Let's look at the discretization again:

.. GENERATED FROM PYTHON SOURCE LINES 140-142

.. code-block:: Python

    regridded_simulation["GWF"]["dis"]






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>StructuredDiscretization</div><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "📁";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1MB
    Dimensions:  (layer: 13, y: 50, x: 125)
    Coordinates:
      * layer    (layer) int32 52B 1 2 3 4 5 6 7 8 9 10 11 12 13
      * y        (y) float64 400B 5.64e+05 5.638e+05 ... 5.592e+05 5.59e+05
      * x        (x) float64 1kB 2.376e+05 2.376e+05 2.378e+05 ... 2.498e+05 2.5e+05
        dx       float64 8B 100.0
        dy       float64 8B -100.0
    Data variables:
        idomain  (layer, y, x) int64 650kB -1 -1 -1 -1 -1 -1 -1 -1 ... 1 1 1 1 1 1 1
        top      (y, x) float32 25kB nan nan nan nan nan nan ... nan nan nan nan nan
        bottom   (layer, y, x) float32 325kB 6.329 6.432 6.536 ... -166.8 -166.8</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-b0d8546d-cc92-4228-9e46-4221c12d3ba6' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-b0d8546d-cc92-4228-9e46-4221c12d3ba6' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>layer</span>: 13</li><li><span class='xr-has-index'>y</span>: 50</li><li><span class='xr-has-index'>x</span>: 125</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-442d4aab-c296-4c8d-8702-0a6a53693fca' class='xr-section-summary-in' type='checkbox'  checked><label for='section-442d4aab-c296-4c8d-8702-0a6a53693fca' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12 13</div><input id='attrs-f9be1e96-3479-4a3e-a79f-04a7c495bdf6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f9be1e96-3479-4a3e-a79f-04a7c495bdf6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a50e6b8c-c468-4b2c-8098-04c8c7090629' class='xr-var-data-in' type='checkbox'><label for='data-a50e6b8c-c468-4b2c-8098-04c8c7090629' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.638e+05 ... 5.59e+05</div><input id='attrs-410f6615-7a50-414a-a831-d1668fb6ad15' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-410f6615-7a50-414a-a831-d1668fb6ad15' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-21d75c31-07ab-487f-8121-8f06d6671a48' class='xr-var-data-in' type='checkbox'><label for='data-21d75c31-07ab-487f-8121-8f06d6671a48' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563950., 563850., 563750., 563650., 563550., 563450., 563350., 563250.,
           563150., 563050., 562950., 562850., 562750., 562650., 562550., 562450.,
           562350., 562250., 562150., 562050., 561950., 561850., 561750., 561650.,
           561550., 561450., 561350., 561250., 561150., 561050., 560950., 560850.,
           560750., 560650., 560550., 560450., 560350., 560250., 560150., 560050.,
           559950., 559850., 559750., 559650., 559550., 559450., 559350., 559250.,
           559150., 559050.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.376e+05 2.376e+05 ... 2.5e+05</div><input id='attrs-e1025611-c411-4023-ad28-b9ccbe9375d2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e1025611-c411-4023-ad28-b9ccbe9375d2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0c2c82b6-8ca5-428e-9c27-55870e92aa65' class='xr-var-data-in' type='checkbox'><label for='data-0c2c82b6-8ca5-428e-9c27-55870e92aa65' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237550., 237650., 237750., 237850., 237950., 238050., 238150., 238250.,
           238350., 238450., 238550., 238650., 238750., 238850., 238950., 239050.,
           239150., 239250., 239350., 239450., 239550., 239650., 239750., 239850.,
           239950., 240050., 240150., 240250., 240350., 240450., 240550., 240650.,
           240750., 240850., 240950., 241050., 241150., 241250., 241350., 241450.,
           241550., 241650., 241750., 241850., 241950., 242050., 242150., 242250.,
           242350., 242450., 242550., 242650., 242750., 242850., 242950., 243050.,
           243150., 243250., 243350., 243450., 243550., 243650., 243750., 243850.,
           243950., 244050., 244150., 244250., 244350., 244450., 244550., 244650.,
           244750., 244850., 244950., 245050., 245150., 245250., 245350., 245450.,
           245550., 245650., 245750., 245850., 245950., 246050., 246150., 246250.,
           246350., 246450., 246550., 246650., 246750., 246850., 246950., 247050.,
           247150., 247250., 247350., 247450., 247550., 247650., 247750., 247850.,
           247950., 248050., 248150., 248250., 248350., 248450., 248550., 248650.,
           248750., 248850., 248950., 249050., 249150., 249250., 249350., 249450.,
           249550., 249650., 249750., 249850., 249950.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>100.0</div><input id='attrs-74a9c481-475f-40df-b0d2-bba9d9f397d7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-74a9c481-475f-40df-b0d2-bba9d9f397d7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8502ced6-61c6-4948-9412-62925637f8ae' class='xr-var-data-in' type='checkbox'><label for='data-8502ced6-61c6-4948-9412-62925637f8ae' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(100.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-100.0</div><input id='attrs-92d72fda-d48e-4080-8e51-211c44c67c6e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-92d72fda-d48e-4080-8e51-211c44c67c6e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-455379fb-ad05-49da-abba-a17054efa8c7' class='xr-var-data-in' type='checkbox'><label for='data-455379fb-ad05-49da-abba-a17054efa8c7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-100.)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b27ac7d0-a7aa-4308-8ca8-3446a53867d6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b27ac7d0-a7aa-4308-8ca8-3446a53867d6' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>idomain</span></div><div class='xr-var-dims'>(layer, y, x)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>-1 -1 -1 -1 -1 -1 ... 1 1 1 1 1 1</div><input id='attrs-0f3e5f06-af3c-49c1-bcbb-7cc01f5269ca' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0f3e5f06-af3c-49c1-bcbb-7cc01f5269ca' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e07315f1-7917-41a0-b558-25b7824d606f' class='xr-var-data-in' type='checkbox'><label for='data-e07315f1-7917-41a0-b558-25b7824d606f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[-1, -1, -1, ...,  1,  1,  1],
            [-1, -1, -1, ...,  1,  1,  1],
            [-1, -1, -1, ...,  1,  1,  1],
            ...,
            [ 1,  1,  1, ..., -1, -1, -1],
            [ 1,  1,  1, ..., -1, -1, -1],
            [ 1,  1,  1, ..., -1, -1, -1]],

           [[-1, -1, -1, ..., -1, -1, -1],
            [-1, -1, -1, ..., -1, -1, -1],
            [-1, -1, -1, ..., -1, -1, -1],
            ...,
            [-1, -1, -1, ..., -1, -1, -1],
            [-1, -1, -1, ..., -1, -1, -1],
            [-1, -1, -1, ..., -1, -1, -1]],

           [[ 1,  1,  1, ...,  1,  1,  1],
            [ 1,  1,  1, ...,  1,  1,  1],
            [ 1,  1,  1, ...,  1,  1,  1],
            ...,
    ...
            ...,
            [ 1,  1,  1, ...,  1,  1,  1],
            [ 1,  1,  1, ...,  1,  1,  1],
            [ 1,  1,  1, ...,  1,  1,  1]],

           [[ 1,  1,  1, ..., -1, -1, -1],
            [ 1,  1,  1, ..., -1, -1, -1],
            [ 1,  1,  1, ..., -1, -1, -1],
            ...,
            [-1, -1, -1, ..., -1, -1, -1],
            [-1, -1, -1, ..., -1, -1, -1],
            [-1, -1, -1, ..., -1, -1, -1]],

           [[ 1,  1,  1, ...,  1,  1,  1],
            [ 1,  1,  1, ...,  1,  1,  1],
            [ 1,  1,  1, ...,  1,  1,  1],
            ...,
            [ 1,  1,  1, ...,  1,  1,  1],
            [ 1,  1,  1, ...,  1,  1,  1],
            [ 1,  1,  1, ...,  1,  1,  1]]], shape=(13, 50, 125))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>top</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-7c3a4812-902c-4b05-85d4-429865f4ca75' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7c3a4812-902c-4b05-85d4-429865f4ca75' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-593bddd9-b904-46ea-9e26-002f27703307' class='xr-var-data-in' type='checkbox'><label for='data-593bddd9-b904-46ea-9e26-002f27703307' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[     nan,      nan,      nan, ..., 2.422   , 2.4668  , 2.5116  ],
           [     nan,      nan,      nan, ..., 2.336   , 2.3724  , 2.4088  ],
           [     nan,      nan,      nan, ..., 2.25    , 2.278   , 2.306   ],
           ...,
           [9.574   , 9.092   , 8.61    , ...,      nan,      nan,      nan],
           [9.4996  , 9.1048  , 8.71    , ...,      nan,      nan,      nan],
           [9.4252  , 9.117599, 8.809999, ...,      nan,      nan,      nan]],
          shape=(50, 125), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>bottom</span></div><div class='xr-var-dims'>(layer, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>6.329 6.432 6.536 ... -166.8 -166.8</div><input id='attrs-a57436c5-0954-4a8a-9895-28a0449678d6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a57436c5-0954-4a8a-9895-28a0449678d6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d3de82d6-d9c0-45e0-b026-a6ae9cc028a9' class='xr-var-data-in' type='checkbox'><label for='data-d3de82d6-d9c0-45e0-b026-a6ae9cc028a9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[   6.3288 ,    6.4324 ,    6.536  , ...,   -4.072  ,
               -2.7284 ,   -1.3848 ],
            [   6.4664 ,    6.6172 ,    6.768  , ...,   -4.656  ,
               -3.2212 ,   -1.7864 ],
            [   6.604  ,    6.802  ,    7.     , ...,   -5.24   ,
               -3.714  ,   -2.188  ],
            ...,
            [   7.888  ,    7.724  ,    7.56   , ...,    2.92   ,
                2.952  ,    2.984  ],
            [   8.0056 ,    7.8608 ,    7.716  , ...,    3.088  ,
                3.0896 ,    3.0912 ],
            [   8.1232 ,    7.9976 ,    7.872  , ...,    3.256  ,
                3.2272 ,    3.1984 ]],

           [[   6.3288 ,    6.4324 ,    6.536  , ...,   -4.072  ,
               -2.7284 ,   -1.3848 ],
            [   6.4664 ,    6.6172 ,    6.768  , ...,   -4.656  ,
               -3.2212 ,   -1.7864 ],
            [   6.604  ,    6.802  ,    7.     , ...,   -5.24   ,
               -3.714  ,   -2.188  ],
    ...
            [-100.706  , -100.408  , -100.11   , ...,  -88.82   ,
              -88.792  ,  -88.764  ],
            [-100.6516 , -100.3648 , -100.078  , ...,  -88.77   ,
              -88.7412 ,  -88.7124 ],
            [-100.5972 , -100.3216 , -100.046  , ...,  -88.72   ,
              -88.6904 ,  -88.6608 ]],

           [[-161.11   , -161.11   , -158.41   , ..., -187.276  ,
             -187.276  , -187.276  ],
            [-161.11   , -161.11   , -158.41   , ..., -187.276  ,
             -187.276  , -187.276  ],
            [-159.45   , -159.45   , -156.73   , ..., -186.67   ,
             -186.67   , -186.67   ],
            ...,
            [-175.28   , -175.28   , -173.5    , ..., -166.763  ,
             -166.763  , -166.763  ],
            [-175.28   , -175.28   , -173.5    , ..., -166.763  ,
             -166.763  , -166.763  ],
            [-175.28   , -175.28   , -173.5    , ..., -166.763  ,
             -166.763  , -166.763  ]]], shape=(13, 50, 125), dtype=float32)</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 143-144

All packages have been regridded, for example the NPF package:

.. GENERATED FROM PYTHON SOURCE LINES 144-147

.. code-block:: Python


    regridded_simulation["GWF"]["npf"]






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>NodePropertyFlow</div><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "📁";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 652kB
    Dimensions:                              (layer: 13, y: 50, x: 125)
    Coordinates:
      * layer                                (layer) int32 52B 1 2 3 4 ... 11 12 13
      * y                                    (y) float64 400B 5.64e+05 ... 5.59e+05
      * x                                    (x) float64 1kB 2.376e+05 ... 2.5e+05
        dx                                   float64 8B 100.0
        dy                                   float64 8B -100.0
    Data variables: (12/22)
        icelltype                            int32 4B 0
        k                                    (layer, y, x) float32 325kB nan ... ...
        rewet                                bool 1B False
        rewet_layer                          object 8B None
        rewet_factor                         object 8B None
        rewet_iterations                     object 8B None
        ...                                   ...
        dewatered                            bool 1B True
        perched                              bool 1B True
        save_specific_discharge              bool 1B False
        save_saturation                      bool 1B False
        xt3d_option                          bool 1B False
        rhs_option                           bool 1B False</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-75f7942b-1f92-4bab-8670-7a9036441db0' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-75f7942b-1f92-4bab-8670-7a9036441db0' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>layer</span>: 13</li><li><span class='xr-has-index'>y</span>: 50</li><li><span class='xr-has-index'>x</span>: 125</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-5033504b-d93a-4484-91cf-1c785f3dda94' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5033504b-d93a-4484-91cf-1c785f3dda94' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12 13</div><input id='attrs-98e0c7f6-3ae0-400d-916b-f69134df6347' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-98e0c7f6-3ae0-400d-916b-f69134df6347' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dcdaca46-7ab9-4c3f-a7c5-cbaf4dc28b5a' class='xr-var-data-in' type='checkbox'><label for='data-dcdaca46-7ab9-4c3f-a7c5-cbaf4dc28b5a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.638e+05 ... 5.59e+05</div><input id='attrs-c2ececa7-7680-4ab0-93be-9c3934f994a7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c2ececa7-7680-4ab0-93be-9c3934f994a7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d1a22b55-9f1d-472e-bab1-9f6dffd65d7e' class='xr-var-data-in' type='checkbox'><label for='data-d1a22b55-9f1d-472e-bab1-9f6dffd65d7e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563950., 563850., 563750., 563650., 563550., 563450., 563350., 563250.,
           563150., 563050., 562950., 562850., 562750., 562650., 562550., 562450.,
           562350., 562250., 562150., 562050., 561950., 561850., 561750., 561650.,
           561550., 561450., 561350., 561250., 561150., 561050., 560950., 560850.,
           560750., 560650., 560550., 560450., 560350., 560250., 560150., 560050.,
           559950., 559850., 559750., 559650., 559550., 559450., 559350., 559250.,
           559150., 559050.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.376e+05 2.376e+05 ... 2.5e+05</div><input id='attrs-77b171a0-8bc3-40e8-8a4f-1e80615c32d6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-77b171a0-8bc3-40e8-8a4f-1e80615c32d6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5f51853d-b97e-43ab-8d90-a45a2d729971' class='xr-var-data-in' type='checkbox'><label for='data-5f51853d-b97e-43ab-8d90-a45a2d729971' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237550., 237650., 237750., 237850., 237950., 238050., 238150., 238250.,
           238350., 238450., 238550., 238650., 238750., 238850., 238950., 239050.,
           239150., 239250., 239350., 239450., 239550., 239650., 239750., 239850.,
           239950., 240050., 240150., 240250., 240350., 240450., 240550., 240650.,
           240750., 240850., 240950., 241050., 241150., 241250., 241350., 241450.,
           241550., 241650., 241750., 241850., 241950., 242050., 242150., 242250.,
           242350., 242450., 242550., 242650., 242750., 242850., 242950., 243050.,
           243150., 243250., 243350., 243450., 243550., 243650., 243750., 243850.,
           243950., 244050., 244150., 244250., 244350., 244450., 244550., 244650.,
           244750., 244850., 244950., 245050., 245150., 245250., 245350., 245450.,
           245550., 245650., 245750., 245850., 245950., 246050., 246150., 246250.,
           246350., 246450., 246550., 246650., 246750., 246850., 246950., 247050.,
           247150., 247250., 247350., 247450., 247550., 247650., 247750., 247850.,
           247950., 248050., 248150., 248250., 248350., 248450., 248550., 248650.,
           248750., 248850., 248950., 249050., 249150., 249250., 249350., 249450.,
           249550., 249650., 249750., 249850., 249950.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>100.0</div><input id='attrs-4f14dbb8-8d0d-4cda-8381-10f3bf32b2a6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4f14dbb8-8d0d-4cda-8381-10f3bf32b2a6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e5bd9849-6401-42fd-b6e7-c098a092121a' class='xr-var-data-in' type='checkbox'><label for='data-e5bd9849-6401-42fd-b6e7-c098a092121a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(100.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-100.0</div><input id='attrs-cf27eba9-4864-4161-9868-c6a7562b4b92' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cf27eba9-4864-4161-9868-c6a7562b4b92' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-352f56d4-89af-4ddd-8872-4ad0c03027ca' class='xr-var-data-in' type='checkbox'><label for='data-352f56d4-89af-4ddd-8872-4ad0c03027ca' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-100.)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-824c62fc-92a0-4f3b-bda3-6d6792da85e2' class='xr-section-summary-in' type='checkbox'  ><label for='section-824c62fc-92a0-4f3b-bda3-6d6792da85e2' class='xr-section-summary' >Data variables: <span>(22)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>icelltype</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-872c57b9-a1a2-4ca9-bcba-1ca6409cea1f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-872c57b9-a1a2-4ca9-bcba-1ca6409cea1f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c9393c84-b92e-495d-b191-1900aef8178f' class='xr-var-data-in' type='checkbox'><label for='data-c9393c84-b92e-495d-b191-1900aef8178f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0, dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>k</span></div><div class='xr-var-dims'>(layer, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... 4.38 4.651 6.06</div><input id='attrs-63794176-5fd6-47dd-bc9e-98ff09377212' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-63794176-5fd6-47dd-bc9e-98ff09377212' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-93861641-a128-4f1c-b534-a438acf9fdc0' class='xr-var-data-in' type='checkbox'><label for='data-93861641-a128-4f1c-b534-a438acf9fdc0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[           nan,            nan,            nan, ...,
             1.71045101e+00, 2.06758380e+00, 2.13754582e+00],
            [           nan,            nan,            nan, ...,
             2.57982802e+00, 2.92900181e+00, 2.97071409e+00],
            [           nan,            nan,            nan, ...,
             3.26586366e+00, 3.61737657e+00, 4.02017498e+00],
            ...,
            [6.52613735e+00, 7.31937456e+00, 8.07691193e+00, ...,
                        nan,            nan,            nan],
            [6.75934601e+00, 7.43262911e+00, 7.75328350e+00, ...,
                        nan,            nan,            nan],
            [6.89848566e+00, 7.72873783e+00, 7.24491787e+00, ...,
                        nan,            nan,            nan]],

           [[           nan,            nan,            nan, ...,
                        nan,            nan,            nan],
            [           nan,            nan,            nan, ...,
                        nan,            nan,            nan],
            [           nan,            nan,            nan, ...,
                        nan,            nan,            nan],
    ...
                        nan,            nan,            nan],
            [           nan,            nan,            nan, ...,
                        nan,            nan,            nan],
            [           nan,            nan,            nan, ...,
                        nan,            nan,            nan]],

           [[3.50853882e+01, 3.35398254e+01, 3.31028404e+01, ...,
             1.11550407e+01, 1.10419674e+01, 1.10544491e+01],
            [3.57339859e+01, 3.40993958e+01, 3.36731339e+01, ...,
             1.07958746e+01, 1.06821775e+01, 1.07412310e+01],
            [3.71318932e+01, 3.54708900e+01, 3.50784569e+01, ...,
             1.06320744e+01, 1.04805851e+01, 1.05435915e+01],
            ...,
            [5.03838577e+01, 5.14991608e+01, 5.39692154e+01, ...,
             4.94934893e+00, 7.53968716e+00, 1.01326780e+01],
            [5.07901382e+01, 5.20933380e+01, 5.46933594e+01, ...,
             4.54834080e+00, 6.02678776e+00, 8.55815029e+00],
            [5.12099190e+01, 5.24668083e+01, 5.51531830e+01, ...,
             4.37981462e+00, 4.65149546e+00, 6.05957603e+00]]],
          shape=(13, 50, 125), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rewet</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-8eede088-b6d2-4a41-b4e5-317a3211dcba' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8eede088-b6d2-4a41-b4e5-317a3211dcba' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f4cc512a-1dec-4a18-b080-8cc415f6f7b6' class='xr-var-data-in' type='checkbox'><label for='data-f4cc512a-1dec-4a18-b080-8cc415f6f7b6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rewet_layer</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-f9e47ebb-43ed-4732-9616-c28f8018cb9e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f9e47ebb-43ed-4732-9616-c28f8018cb9e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-454ca4aa-73f5-4a57-828a-a31e13aa7d52' class='xr-var-data-in' type='checkbox'><label for='data-454ca4aa-73f5-4a57-828a-a31e13aa7d52' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rewet_factor</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-be3199c5-7cd8-49f9-8845-fa3c96ee0ed1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-be3199c5-7cd8-49f9-8845-fa3c96ee0ed1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-08920d7c-206a-45d4-ab9e-ccff31e300fc' class='xr-var-data-in' type='checkbox'><label for='data-08920d7c-206a-45d4-ab9e-ccff31e300fc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rewet_iterations</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-b50a5302-1807-4eed-b5fb-2b2a5b1e5991' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b50a5302-1807-4eed-b5fb-2b2a5b1e5991' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8fd3713b-9c79-4dd2-b6ca-4a8a6887299b' class='xr-var-data-in' type='checkbox'><label for='data-8fd3713b-9c79-4dd2-b6ca-4a8a6887299b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rewet_method</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-7bcc62e8-24f2-423f-a915-8ba9360ca3bb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7bcc62e8-24f2-423f-a915-8ba9360ca3bb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2e6bd664-b4eb-4647-a1ed-73561e493f1e' class='xr-var-data-in' type='checkbox'><label for='data-2e6bd664-b4eb-4647-a1ed-73561e493f1e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>k22</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-8d399cbe-d6d1-4f36-ac6a-de812169fdf4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8d399cbe-d6d1-4f36-ac6a-de812169fdf4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-461080fe-aede-40bc-b57f-c0ae391a31f0' class='xr-var-data-in' type='checkbox'><label for='data-461080fe-aede-40bc-b57f-c0ae391a31f0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>k33</span></div><div class='xr-var-dims'>(layer, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 4.379 4.635 5.987</div><input id='attrs-f4cc66ca-490d-426e-9ca4-f587b27a39cb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f4cc66ca-490d-426e-9ca4-f587b27a39cb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1e58fd53-097b-4baf-b308-503fe85746fb' class='xr-var-data-in' type='checkbox'><label for='data-1e58fd53-097b-4baf-b308-503fe85746fb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[           nan,            nan,            nan, ...,
             1.68908155e+00, 2.05299568e+00, 2.07375240e+00],
            [           nan,            nan,            nan, ...,
             2.56002688e+00, 2.90870237e+00, 2.93282318e+00],
            [           nan,            nan,            nan, ...,
             3.25846219e+00, 3.60833979e+00, 3.96773362e+00],
            ...,
            [6.52359343e+00, 7.31123686e+00, 8.06107712e+00, ...,
                        nan,            nan,            nan],
            [6.75605583e+00, 7.42485857e+00, 7.72925758e+00, ...,
                        nan,            nan,            nan],
            [6.89221048e+00, 7.72043324e+00, 7.19585562e+00, ...,
                        nan,            nan,            nan]],

           [[           nan,            nan,            nan, ...,
                        nan,            nan,            nan],
            [           nan,            nan,            nan, ...,
                        nan,            nan,            nan],
            [           nan,            nan,            nan, ...,
                        nan,            nan,            nan],
    ...
                        nan,            nan,            nan],
            [           nan,            nan,            nan, ...,
                        nan,            nan,            nan],
            [           nan,            nan,            nan, ...,
                        nan,            nan,            nan]],

           [[3.50840683e+01, 3.35387764e+01, 3.31001320e+01, ...,
             1.11541767e+01, 1.10412979e+01, 1.10539465e+01],
            [3.57323608e+01, 3.40979767e+01, 3.36704140e+01, ...,
             1.07952986e+01, 1.06817684e+01, 1.07408428e+01],
            [3.71310349e+01, 3.54699516e+01, 3.50761642e+01, ...,
             1.06316519e+01, 1.04804630e+01, 1.05433397e+01],
            ...,
            [5.03830185e+01, 5.14964905e+01, 5.39657822e+01, ...,
             4.91560221e+00, 7.46072292e+00, 1.01161366e+01],
            [5.07891464e+01, 5.20898857e+01, 5.46896210e+01, ...,
             4.54136038e+00, 5.96547222e+00, 8.49976540e+00],
            [5.12087021e+01, 5.24633751e+01, 5.51496162e+01, ...,
             4.37948227e+00, 4.63479853e+00, 5.98664236e+00]]],
          shape=(13, 50, 125), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>angle1</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-abe12a24-9aed-4716-8aca-916abc5835be' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-abe12a24-9aed-4716-8aca-916abc5835be' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-98d41681-736f-4f58-9358-40c6c8c9b442' class='xr-var-data-in' type='checkbox'><label for='data-98d41681-736f-4f58-9358-40c6c8c9b442' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>angle2</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-233c660f-8623-42d9-a142-900c8b4aa3de' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-233c660f-8623-42d9-a142-900c8b4aa3de' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-083e71b3-a3b9-49d1-b5a8-cacbb2bc6163' class='xr-var-data-in' type='checkbox'><label for='data-083e71b3-a3b9-49d1-b5a8-cacbb2bc6163' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>angle3</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-fb832430-2b2d-4511-95d6-ae5a56aa3863' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fb832430-2b2d-4511-95d6-ae5a56aa3863' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-10214419-319a-4d45-b076-53a516595d6a' class='xr-var-data-in' type='checkbox'><label for='data-10214419-319a-4d45-b076-53a516595d6a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>alternative_cell_averaging</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-aab77b29-a5b4-4a85-a3d5-360b54132e5c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-aab77b29-a5b4-4a85-a3d5-360b54132e5c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b4a471ea-fe38-417c-95f3-058ab789e04b' class='xr-var-data-in' type='checkbox'><label for='data-b4a471ea-fe38-417c-95f3-058ab789e04b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>save_flows</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>True</div><input id='attrs-ab1ab36f-bdbf-42ef-ad9d-d5c760e5d580' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ab1ab36f-bdbf-42ef-ad9d-d5c760e5d580' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a3981eed-644f-48a7-bbe1-b814db3a41d2' class='xr-var-data-in' type='checkbox'><label for='data-a3981eed-644f-48a7-bbe1-b814db3a41d2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(True)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>starting_head_as_confined_thickness</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-296eeca3-676d-46d6-9641-005faf365495' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-296eeca3-676d-46d6-9641-005faf365495' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-daf053e1-de26-49cd-800f-b05c34d300b8' class='xr-var-data-in' type='checkbox'><label for='data-daf053e1-de26-49cd-800f-b05c34d300b8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>variable_vertical_conductance</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>True</div><input id='attrs-3c0e9df4-ab96-4494-9b06-3361b4dfef71' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3c0e9df4-ab96-4494-9b06-3361b4dfef71' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-52e61064-7b62-439f-9091-cefeb6f93842' class='xr-var-data-in' type='checkbox'><label for='data-52e61064-7b62-439f-9091-cefeb6f93842' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(True)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dewatered</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>True</div><input id='attrs-afd81e89-0548-4bea-a6ad-56ac6990ce17' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-afd81e89-0548-4bea-a6ad-56ac6990ce17' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-32a395f4-1e45-40cf-9aa4-e910e8b54826' class='xr-var-data-in' type='checkbox'><label for='data-32a395f4-1e45-40cf-9aa4-e910e8b54826' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(True)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>perched</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>True</div><input id='attrs-86454868-cf6d-4bd7-a73d-9d14463eb611' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-86454868-cf6d-4bd7-a73d-9d14463eb611' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-91446cb0-4e9f-4283-8cff-4b5556ca8c02' class='xr-var-data-in' type='checkbox'><label for='data-91446cb0-4e9f-4283-8cff-4b5556ca8c02' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(True)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>save_specific_discharge</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-f9298d72-6b31-4421-b7a3-8a80bfe8c7c8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f9298d72-6b31-4421-b7a3-8a80bfe8c7c8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4bf9efe8-f202-4a1b-acc5-ac204acd758b' class='xr-var-data-in' type='checkbox'><label for='data-4bf9efe8-f202-4a1b-acc5-ac204acd758b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>save_saturation</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-4dac4117-edff-4aa4-8f2d-96d679428362' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4dac4117-edff-4aa4-8f2d-96d679428362' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-827e7fed-8bfb-4228-9018-360bdfef5d95' class='xr-var-data-in' type='checkbox'><label for='data-827e7fed-8bfb-4228-9018-360bdfef5d95' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>xt3d_option</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-d4576512-2ad2-41c7-8080-567641a355c1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d4576512-2ad2-41c7-8080-567641a355c1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-714089c4-c69e-40a1-a31a-81b2cf090c01' class='xr-var-data-in' type='checkbox'><label for='data-714089c4-c69e-40a1-a31a-81b2cf090c01' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rhs_option</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-27841ed6-8d08-4a7f-bb66-1188ba99cb3b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-27841ed6-8d08-4a7f-bb66-1188ba99cb3b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8487bf64-b4b8-475d-baa5-ab581151e0fb' class='xr-var-data-in' type='checkbox'><label for='data-8487bf64-b4b8-475d-baa5-ab581151e0fb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 148-149

Let's make a comparison plot of the hydraulic conductivities:

.. GENERATED FROM PYTHON SOURCE LINES 149-165

.. code-block:: Python

    import matplotlib.pyplot as plt
    import numpy as np

    fig, axes = plt.subplots(nrows=2, sharex=True)
    plot_kwargs = {"colors": "viridis", "levels": np.linspace(0.0, 100.0, 21), "fig": fig}

    imod.visualize.spatial.plot_map(
        original_simulation["GWF"]["npf"]["k"].sel(layer=3), ax=axes[0], **plot_kwargs
    )
    imod.visualize.spatial.plot_map(
        regridded_simulation["GWF"]["npf"]["k"].sel(layer=3), ax=axes[1], **plot_kwargs
    )

    axes[0].set_ylabel("original")
    axes[1].set_ylabel("regridded")




.. image-sg:: /user-guide/images/sphx_glr_08-regridding_001.png
   :alt: 08 regridding
   :srcset: /user-guide/images/sphx_glr_08-regridding_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(28.472222222222243, 0.5, 'regridded')



.. GENERATED FROM PYTHON SOURCE LINES 166-188

Regridding using non-default methods
------------------------------------

When non-default methods are used for one or more packages, these should be
regridded separately. In that case, the most convenient approach is likely:

- pop the packages that should use non-default methods from the source
  simulation (the popping is optional, and is only recommended for packages
  whose presence is not mandatory for validation.)
- regrid the source simulation: this takes care of all the packages that
  should use default methods.
- regrid the package(s) where you want to use non-standard rergridding methods
  indivudually starting from the packages in the source simulation
- insert the custom-regridded packages to the regridded simulation (or replace
  the package regridded with default methods with the one you just regridded
  with non-default methods if it was not popped)

In code, consider an example where we want to regrid the recharge package
using non default methods then we would do the following. First we'll load
some example simulation. There is a separate example contained in
:doc:`/examples/mf6/hondsrug` that you should look at if you are interested in
the model building

.. GENERATED FROM PYTHON SOURCE LINES 191-194

Set up the input needed for custom regridding. Create a regridder
weight-cache. This object can (and should) be reused for all the packages that
undergo custom regridding at this stage.

.. GENERATED FROM PYTHON SOURCE LINES 195-201

.. code-block:: Python

    from imod.util.regrid import RegridderWeightsCache

    regrid_cache = RegridderWeightsCache()

    regrid_cache





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <imod.util.regrid.RegridderWeightsCache object at 0x0000025741E30710>



.. GENERATED FROM PYTHON SOURCE LINES 202-204

Next, we'll remove the recharge package and obtain it as a variable. We'll do
this for later use.

.. GENERATED FROM PYTHON SOURCE LINES 205-210

.. code-block:: Python


    original_rch_package = original_simulation["GWF"].pop("rch")

    original_rch_package






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>Recharge</div><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "📁";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 21MB
    Dimensions:        (time: 2, layer: 13, y: 200, x: 500)
    Coordinates:
      * time           (time) datetime64[ns] 16B 2009-12-30T23:59:59 2009-12-31
      * layer          (layer) int32 52B 1 2 3 4 5 6 7 8 9 10 11 12 13
      * y              (y) float64 2kB 5.64e+05 5.64e+05 ... 5.59e+05 5.59e+05
      * x              (x) float64 4kB 2.375e+05 2.375e+05 ... 2.5e+05 2.5e+05
        dx             float64 8B ...
        dy             float64 8B ...
    Data variables:
        rate           (time, layer, y, x) float64 21MB nan nan nan ... nan nan nan
        print_input    bool 1B False
        print_flows    bool 1B False
        save_flows     bool 1B False
        observations   object 8B None
        repeat_stress  object 8B None</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-97c72541-55db-49ba-9563-086f34c4570d' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-97c72541-55db-49ba-9563-086f34c4570d' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 2</li><li><span class='xr-has-index'>layer</span>: 13</li><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>x</span>: 500</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-02c8053a-e5c2-4117-9b33-3ee4cc7cbc64' class='xr-section-summary-in' type='checkbox'  checked><label for='section-02c8053a-e5c2-4117-9b33-3ee4cc7cbc64' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2009-12-30T23:59:59 2009-12-31</div><input id='attrs-68097c92-b512-44a2-8a63-82e97cca6e1b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-68097c92-b512-44a2-8a63-82e97cca6e1b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f50c4137-6bdc-421f-a007-67b716e2675b' class='xr-var-data-in' type='checkbox'><label for='data-f50c4137-6bdc-421f-a007-67b716e2675b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2009-12-30T23:59:59.000000000&#x27;, &#x27;2009-12-31T00:00:00.000000000&#x27;],
          dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12 13</div><input id='attrs-71d65445-ffc4-448c-810c-88f18dd61ab3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-71d65445-ffc4-448c-810c-88f18dd61ab3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0e0210bd-959d-47c9-8e6a-b31461a8e632' class='xr-var-data-in' type='checkbox'><label for='data-0e0210bd-959d-47c9-8e6a-b31461a8e632' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-c07db2c3-0da5-49ed-9e66-f7bc3071d1d1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c07db2c3-0da5-49ed-9e66-f7bc3071d1d1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bdea6902-db31-4091-91d5-7466ca48e1b4' class='xr-var-data-in' type='checkbox'><label for='data-bdea6902-db31-4091-91d5-7466ca48e1b4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
           563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
           563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
           563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
           563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
           563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
           562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
           562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
           562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
           562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
           562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
           562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
           561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
           561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
           561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
           561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
           561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
           561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
           560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
           560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
           560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
           560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
           560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
           559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
           559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
           559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
           559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
           559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
           559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-73ff7603-654a-46d3-bb42-2c81f8175f76' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-73ff7603-654a-46d3-bb42-2c81f8175f76' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2a40e04f-f513-4cd1-b86d-90480a0d9099' class='xr-var-data-in' type='checkbox'><label for='data-2a40e04f-f513-4cd1-b86d-90480a0d9099' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5],
          shape=(500,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-4cf59237-2e3e-4252-9446-0aa73eef345b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4cf59237-2e3e-4252-9446-0aa73eef345b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b422e1bb-5ef1-4e85-a525-657465138a68' class='xr-var-data-in' type='checkbox'><label for='data-b422e1bb-5ef1-4e85-a525-657465138a68' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-045cea8e-1247-43c1-a854-313aa26d903d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-045cea8e-1247-43c1-a854-313aa26d903d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ed573a01-1f9e-41a9-8161-ebc87a674d43' class='xr-var-data-in' type='checkbox'><label for='data-ed573a01-1f9e-41a9-8161-ebc87a674d43' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float64]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-294df105-2f54-4de9-a9b2-4e9f89b2cbcd' class='xr-section-summary-in' type='checkbox'  checked><label for='section-294df105-2f54-4de9-a9b2-4e9f89b2cbcd' class='xr-section-summary' >Data variables: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>rate</span></div><div class='xr-var-dims'>(time, layer, y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-60884fbf-4850-41fa-859b-1f037e3aac7a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-60884fbf-4850-41fa-859b-1f037e3aac7a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-38513c64-6a5f-4e58-98a9-3ce879807051' class='xr-var-data-in' type='checkbox'><label for='data-38513c64-6a5f-4e58-98a9-3ce879807051' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[[     nan, ..., 0.000834],
             ...,
             [0.000918, ...,      nan]],

            ...,

            [[     nan, ...,      nan],
             ...,
             [     nan, ...,      nan]]],


           [[[     nan, ..., 0.001638],
             ...,
             [0.001982, ...,      nan]],

            ...,

            [[     nan, ...,      nan],
             ...,
             [     nan, ...,      nan]]]], shape=(2, 13, 200, 500))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>print_input</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-37866e90-412c-4124-83fb-d67c9e9e9d2f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-37866e90-412c-4124-83fb-d67c9e9e9d2f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d8f98b47-d8cb-4c27-b0f0-afaa687fff39' class='xr-var-data-in' type='checkbox'><label for='data-d8f98b47-d8cb-4c27-b0f0-afaa687fff39' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>print_flows</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-eea69039-567c-407a-b680-1475ea490fb3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-eea69039-567c-407a-b680-1475ea490fb3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-98038f3a-354d-473e-842d-2d72d501c0fb' class='xr-var-data-in' type='checkbox'><label for='data-98038f3a-354d-473e-842d-2d72d501c0fb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>save_flows</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-41d46dc6-7ff8-4b47-98b3-85c72c5ba8d1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-41d46dc6-7ff8-4b47-98b3-85c72c5ba8d1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ab6caa5c-9b35-4589-b8e4-0da4dee5ffda' class='xr-var-data-in' type='checkbox'><label for='data-ab6caa5c-9b35-4589-b8e4-0da4dee5ffda' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>observations</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-aa40fa16-80c8-4e57-bb2e-5955bfc2ea24' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-aa40fa16-80c8-4e57-bb2e-5955bfc2ea24' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5584a48b-f462-406e-9cd0-bc9bf1503b05' class='xr-var-data-in' type='checkbox'><label for='data-5584a48b-f462-406e-9cd0-bc9bf1503b05' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>repeat_stress</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-35d46b0e-c28e-4ac5-b755-f32218ba3617' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-35d46b0e-c28e-4ac5-b755-f32218ba3617' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-855a0d13-e6ef-4027-ada5-676bf3391d4b' class='xr-var-data-in' type='checkbox'><label for='data-855a0d13-e6ef-4027-ada5-676bf3391d4b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 211-214

Regrid the recharge package with a custom regridder. In this case we opt for
the centroid locator regridder. This regridder is similar to using a "nearest
neighbour" lookup.

.. GENERATED FROM PYTHON SOURCE LINES 215-228

.. code-block:: Python

    from imod.common.utilities.regrid import RegridderType
    from imod.mf6.regrid import RechargeRegridMethod

    regridder_types = RechargeRegridMethod(rate=(RegridderType.CENTROIDLOCATOR,))

    regridded_recharge = original_rch_package.regrid_like(
        target_grid,
        regrid_cache=regrid_cache,
        regridder_types=regridder_types,
    )

    regridded_recharge






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>Recharge</div><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "📁";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1MB
    Dimensions:        (layer: 13, time: 2, y: 50, x: 125)
    Coordinates:
      * layer          (layer) int32 52B 1 2 3 4 5 6 7 8 9 10 11 12 13
      * time           (time) datetime64[ns] 16B 2009-12-30T23:59:59 2009-12-31
      * y              (y) float64 400B 5.64e+05 5.638e+05 ... 5.592e+05 5.59e+05
      * x              (x) float64 1kB 2.376e+05 2.376e+05 ... 2.498e+05 2.5e+05
        dx             float64 8B 100.0
        dy             float64 8B -100.0
    Data variables:
        rate           (time, layer, y, x) float64 1MB nan nan nan ... nan nan nan
        print_input    bool 1B False
        print_flows    bool 1B False
        save_flows     bool 1B False
        observations   object 8B None
        repeat_stress  object 8B None
        fixed_cell     bool 1B False</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-bc569d21-f2fa-48f2-a3fc-87c4dbadb1c9' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-bc569d21-f2fa-48f2-a3fc-87c4dbadb1c9' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>layer</span>: 13</li><li><span class='xr-has-index'>time</span>: 2</li><li><span class='xr-has-index'>y</span>: 50</li><li><span class='xr-has-index'>x</span>: 125</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-4d010380-1b69-43fb-b7d4-a005a8facc78' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4d010380-1b69-43fb-b7d4-a005a8facc78' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12 13</div><input id='attrs-f51c7c06-724c-4561-ae37-d21ce4ce2c2a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f51c7c06-724c-4561-ae37-d21ce4ce2c2a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0946af79-2d33-4d57-8c8c-ff3d977c9dfc' class='xr-var-data-in' type='checkbox'><label for='data-0946af79-2d33-4d57-8c8c-ff3d977c9dfc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2009-12-30T23:59:59 2009-12-31</div><input id='attrs-a5754633-fb4a-4898-83df-58116aee9a02' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a5754633-fb4a-4898-83df-58116aee9a02' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a88808ff-974d-4d00-80de-3bcb812304ce' class='xr-var-data-in' type='checkbox'><label for='data-a88808ff-974d-4d00-80de-3bcb812304ce' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2009-12-30T23:59:59.000000000&#x27;, &#x27;2009-12-31T00:00:00.000000000&#x27;],
          dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.638e+05 ... 5.59e+05</div><input id='attrs-154dad7e-85fc-439f-aa60-95b94d945016' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-154dad7e-85fc-439f-aa60-95b94d945016' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9b5cdcc6-e4fc-4ffd-8ea7-6900ebe8c549' class='xr-var-data-in' type='checkbox'><label for='data-9b5cdcc6-e4fc-4ffd-8ea7-6900ebe8c549' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563950., 563850., 563750., 563650., 563550., 563450., 563350., 563250.,
           563150., 563050., 562950., 562850., 562750., 562650., 562550., 562450.,
           562350., 562250., 562150., 562050., 561950., 561850., 561750., 561650.,
           561550., 561450., 561350., 561250., 561150., 561050., 560950., 560850.,
           560750., 560650., 560550., 560450., 560350., 560250., 560150., 560050.,
           559950., 559850., 559750., 559650., 559550., 559450., 559350., 559250.,
           559150., 559050.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.376e+05 2.376e+05 ... 2.5e+05</div><input id='attrs-961a3145-70de-4b78-b7ef-327e4c68d8af' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-961a3145-70de-4b78-b7ef-327e4c68d8af' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d7449208-164c-4ba5-9241-87cc1482e914' class='xr-var-data-in' type='checkbox'><label for='data-d7449208-164c-4ba5-9241-87cc1482e914' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237550., 237650., 237750., 237850., 237950., 238050., 238150., 238250.,
           238350., 238450., 238550., 238650., 238750., 238850., 238950., 239050.,
           239150., 239250., 239350., 239450., 239550., 239650., 239750., 239850.,
           239950., 240050., 240150., 240250., 240350., 240450., 240550., 240650.,
           240750., 240850., 240950., 241050., 241150., 241250., 241350., 241450.,
           241550., 241650., 241750., 241850., 241950., 242050., 242150., 242250.,
           242350., 242450., 242550., 242650., 242750., 242850., 242950., 243050.,
           243150., 243250., 243350., 243450., 243550., 243650., 243750., 243850.,
           243950., 244050., 244150., 244250., 244350., 244450., 244550., 244650.,
           244750., 244850., 244950., 245050., 245150., 245250., 245350., 245450.,
           245550., 245650., 245750., 245850., 245950., 246050., 246150., 246250.,
           246350., 246450., 246550., 246650., 246750., 246850., 246950., 247050.,
           247150., 247250., 247350., 247450., 247550., 247650., 247750., 247850.,
           247950., 248050., 248150., 248250., 248350., 248450., 248550., 248650.,
           248750., 248850., 248950., 249050., 249150., 249250., 249350., 249450.,
           249550., 249650., 249750., 249850., 249950.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>100.0</div><input id='attrs-1cb8014c-d83a-4e55-a490-719de97289df' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1cb8014c-d83a-4e55-a490-719de97289df' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-32ef48d0-c025-4cc5-9faf-d2d114ab17f1' class='xr-var-data-in' type='checkbox'><label for='data-32ef48d0-c025-4cc5-9faf-d2d114ab17f1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(100.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-100.0</div><input id='attrs-db5144c7-ed8d-4a3d-a539-48ebb4a6d295' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-db5144c7-ed8d-4a3d-a539-48ebb4a6d295' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7bf6071c-9e0c-4d70-977d-37607c3b9cef' class='xr-var-data-in' type='checkbox'><label for='data-7bf6071c-9e0c-4d70-977d-37607c3b9cef' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-100.)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3c40648f-6946-4877-8296-df6f1972be1d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3c40648f-6946-4877-8296-df6f1972be1d' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>rate</span></div><div class='xr-var-dims'>(time, layer, y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-6c861975-cd45-4a02-955c-bfe82e345ae6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6c861975-cd45-4a02-955c-bfe82e345ae6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b64fceaf-93cd-4f59-97c1-656a1ebbf110' class='xr-var-data-in' type='checkbox'><label for='data-b64fceaf-93cd-4f59-97c1-656a1ebbf110' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[[       nan,        nan,        nan, ..., 0.00083373,
              0.00083373, 0.00083373],
             [       nan,        nan,        nan, ..., 0.00083373,
              0.00083373, 0.00083373],
             [       nan,        nan,        nan, ..., 0.00083373,
              0.00083373, 0.00083373],
             ...,
             [0.00091826, 0.00091826, 0.00091826, ...,        nan,
                     nan,        nan],
             [0.00091826, 0.00091826, 0.00091826, ...,        nan,
                     nan,        nan],
             [0.00091826, 0.00091826, 0.00091826, ...,        nan,
                     nan,        nan]],

            [[       nan,        nan,        nan, ...,        nan,
                     nan,        nan],
             [       nan,        nan,        nan, ...,        nan,
                     nan,        nan],
             [       nan,        nan,        nan, ...,        nan,
                     nan,        nan],
    ...
             [       nan,        nan,        nan, ...,        nan,
                     nan,        nan],
             [       nan,        nan,        nan, ...,        nan,
                     nan,        nan],
             [       nan,        nan,        nan, ...,        nan,
                     nan,        nan]],

            [[       nan,        nan,        nan, ...,        nan,
                     nan,        nan],
             [       nan,        nan,        nan, ...,        nan,
                     nan,        nan],
             [       nan,        nan,        nan, ...,        nan,
                     nan,        nan],
             ...,
             [       nan,        nan,        nan, ...,        nan,
                     nan,        nan],
             [       nan,        nan,        nan, ...,        nan,
                     nan,        nan],
             [       nan,        nan,        nan, ...,        nan,
                     nan,        nan]]]], shape=(2, 13, 50, 125))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>print_input</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-6888be68-eeb5-4237-9cf4-b342206cd498' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6888be68-eeb5-4237-9cf4-b342206cd498' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9b3ad9ca-8846-47b1-be40-c083de828b98' class='xr-var-data-in' type='checkbox'><label for='data-9b3ad9ca-8846-47b1-be40-c083de828b98' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>print_flows</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-0cc866a1-5486-4f82-a667-58fc30601a4a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0cc866a1-5486-4f82-a667-58fc30601a4a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-417e562f-b40e-4be7-bb6a-1ef372d8131c' class='xr-var-data-in' type='checkbox'><label for='data-417e562f-b40e-4be7-bb6a-1ef372d8131c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>save_flows</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-a409cd82-aa8b-4c26-bb38-d67cd46dece2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a409cd82-aa8b-4c26-bb38-d67cd46dece2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c46fdd75-e1af-4bd5-816a-d2115a2f3d17' class='xr-var-data-in' type='checkbox'><label for='data-c46fdd75-e1af-4bd5-816a-d2115a2f3d17' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>observations</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-459c2573-ffd3-4b82-9eaf-07615ae264b1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-459c2573-ffd3-4b82-9eaf-07615ae264b1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7569c6aa-f604-45b7-8456-dc54ed178acc' class='xr-var-data-in' type='checkbox'><label for='data-7569c6aa-f604-45b7-8456-dc54ed178acc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>repeat_stress</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None</div><input id='attrs-73d62780-5a76-4a5f-ac64-e6bae118c113' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-73d62780-5a76-4a5f-ac64-e6bae118c113' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-672b9319-a6f7-4194-b05d-cdbd6cb835fe' class='xr-var-data-in' type='checkbox'><label for='data-672b9319-a6f7-4194-b05d-cdbd6cb835fe' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(None, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>fixed_cell</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-a03cc268-84bc-4388-b4f5-2631bfb76839' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a03cc268-84bc-4388-b4f5-2631bfb76839' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d9e84164-97d2-4782-b779-008f16a4382b' class='xr-var-data-in' type='checkbox'><label for='data-d9e84164-97d2-4782-b779-008f16a4382b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(False)</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 229-230

Next, add the recharge package to the regridded simulation

.. GENERATED FROM PYTHON SOURCE LINES 230-235

.. code-block:: Python

    regridded_simulation["GWF"]["rch"] = regridded_recharge

    # We can also reattach the original again
    original_simulation["GWF"]["rch"] = original_rch_package








.. GENERATED FROM PYTHON SOURCE LINES 236-244

Comparison with histograms
--------------------------

In the next segment we will compare the input of the models on different
grids. We advice to always check how your input is regridded. In this example
we upscaled grid, many input parameters are regridded with a ``mean`` method.
This means that their input range is reduced, which can be seen in tailings in
the histograms becoming shorter

.. GENERATED FROM PYTHON SOURCE LINES 244-256

.. code-block:: Python



    def plot_histograms_side_by_side(array_original, array_regridded, title):
        """This function creates a plot of normalized histograms of the 2 input
        DataArray. It plots a title above each histogram."""
        _, (ax0, ax1) = plt.subplots(1, 2, sharex=True, sharey=True, tight_layout=True)
        array_original.plot.hist(ax=ax0, bins=25, density=True)
        array_regridded.plot.hist(ax=ax1, bins=25, density=True)
        ax0.title.set_text(f"{title} (original)")
        ax1.title.set_text(f"{title} (regridded)")









.. GENERATED FROM PYTHON SOURCE LINES 257-258

Compare constant head arrays.

.. GENERATED FROM PYTHON SOURCE LINES 258-264

.. code-block:: Python

    plot_histograms_side_by_side(
        original_simulation["GWF"]["chd"]["head"],
        regridded_simulation["GWF"]["chd"]["head"],
        "chd head",
    )




.. image-sg:: /user-guide/images/sphx_glr_08-regridding_002.png
   :alt: chd head (original), chd head (regridded)
   :srcset: /user-guide/images/sphx_glr_08-regridding_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 265-266

Compare horizontal hydraulic conductivities.

.. GENERATED FROM PYTHON SOURCE LINES 266-271

.. code-block:: Python

    plot_histograms_side_by_side(
        original_simulation["GWF"]["npf"]["k"],
        regridded_simulation["GWF"]["npf"]["k"],
        "npf k",
    )



.. image-sg:: /user-guide/images/sphx_glr_08-regridding_003.png
   :alt: npf k (original), npf k (regridded)
   :srcset: /user-guide/images/sphx_glr_08-regridding_003.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 272-273

Compare vertical hydraulic conductivities.

.. GENERATED FROM PYTHON SOURCE LINES 273-278

.. code-block:: Python

    plot_histograms_side_by_side(
        original_simulation["GWF"]["npf"]["k33"],
        regridded_simulation["GWF"]["npf"]["k33"],
        "npf k33",
    )



.. image-sg:: /user-guide/images/sphx_glr_08-regridding_004.png
   :alt: npf k33 (original), npf k33 (regridded)
   :srcset: /user-guide/images/sphx_glr_08-regridding_004.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 279-280

Compare starting heads.

.. GENERATED FROM PYTHON SOURCE LINES 280-286

.. code-block:: Python

    plot_histograms_side_by_side(
        original_simulation["GWF"]["ic"]["start"],
        regridded_simulation["GWF"]["ic"]["start"],
        "ic start",
    )




.. image-sg:: /user-guide/images/sphx_glr_08-regridding_005.png
   :alt: ic start (original), ic start (regridded)
   :srcset: /user-guide/images/sphx_glr_08-regridding_005.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 287-288

Compare river stages.

.. GENERATED FROM PYTHON SOURCE LINES 288-294

.. code-block:: Python

    plot_histograms_side_by_side(
        original_simulation["GWF"]["riv"]["stage"],
        regridded_simulation["GWF"]["riv"]["stage"],
        "riv stage",
    )




.. image-sg:: /user-guide/images/sphx_glr_08-regridding_006.png
   :alt: riv stage (original), riv stage (regridded)
   :srcset: /user-guide/images/sphx_glr_08-regridding_006.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 295-296

Compare river bottom elevations.

.. GENERATED FROM PYTHON SOURCE LINES 296-302

.. code-block:: Python

    plot_histograms_side_by_side(
        original_simulation["GWF"]["riv"]["bottom_elevation"],
        regridded_simulation["GWF"]["riv"]["bottom_elevation"],
        "riv bottom elevation",
    )




.. image-sg:: /user-guide/images/sphx_glr_08-regridding_007.png
   :alt: riv bottom elevation (original), riv bottom elevation (regridded)
   :srcset: /user-guide/images/sphx_glr_08-regridding_007.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 303-304

Compare riverbed conductance.

.. GENERATED FROM PYTHON SOURCE LINES 304-310

.. code-block:: Python

    plot_histograms_side_by_side(
        original_simulation["GWF"]["riv"]["conductance"],
        regridded_simulation["GWF"]["riv"]["conductance"],
        "riv conductance",
    )




.. image-sg:: /user-guide/images/sphx_glr_08-regridding_008.png
   :alt: riv conductance (original), riv conductance (regridded)
   :srcset: /user-guide/images/sphx_glr_08-regridding_008.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 311-312

Compare recharge rates.

.. GENERATED FROM PYTHON SOURCE LINES 312-318

.. code-block:: Python

    plot_histograms_side_by_side(
        original_simulation["GWF"]["rch"]["rate"],
        regridded_simulation["GWF"]["rch"]["rate"],
        "rch rate",
    )




.. image-sg:: /user-guide/images/sphx_glr_08-regridding_009.png
   :alt: rch rate (original), rch rate (regridded)
   :srcset: /user-guide/images/sphx_glr_08-regridding_009.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 319-320

Compare drainage elevations.

.. GENERATED FROM PYTHON SOURCE LINES 320-326

.. code-block:: Python

    plot_histograms_side_by_side(
        original_simulation["GWF"]["drn-pipe"]["elevation"],
        regridded_simulation["GWF"]["drn-pipe"]["elevation"],
        "drn-pipe elevation",
    )




.. image-sg:: /user-guide/images/sphx_glr_08-regridding_010.png
   :alt: drn-pipe elevation (original), drn-pipe elevation (regridded)
   :srcset: /user-guide/images/sphx_glr_08-regridding_010.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 327-328

Compare drain conductances.

.. GENERATED FROM PYTHON SOURCE LINES 328-334

.. code-block:: Python

    plot_histograms_side_by_side(
        original_simulation["GWF"]["drn-pipe"]["conductance"],
        regridded_simulation["GWF"]["drn-pipe"]["conductance"],
        "drn-pipe conductance",
    )




.. image-sg:: /user-guide/images/sphx_glr_08-regridding_011.png
   :alt: drn-pipe conductance (original), drn-pipe conductance (regridded)
   :srcset: /user-guide/images/sphx_glr_08-regridding_011.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 335-339

Compare simulation outputs
--------------------------

Let's compare outputs now.

.. GENERATED FROM PYTHON SOURCE LINES 340-349

.. code-block:: Python


    # Write simulation
    original_simulation.write(tmpdir / "original")
    # Run and open heads
    original_simulation.run()
    hds_original = original_simulation.open_head()

    hds_original






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "📁";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;head&#x27; (time: 2, layer: 13, y: 200, x: 500)&gt; Size: 21MB
    dask.array&lt;stack, shape=(2, 13, 200, 500), dtype=float64, chunksize=(1, 13, 200, 500), chunktype=numpy.ndarray&gt;
    Coordinates:
      * time     (time) float64 16B 1.157e-05 365.0
      * layer    (layer) int64 104B 1 2 3 4 5 6 7 8 9 10 11 12 13
      * y        (y) float64 2kB 5.64e+05 5.64e+05 5.639e+05 ... 5.59e+05 5.59e+05
      * x        (x) float64 4kB 2.375e+05 2.375e+05 2.376e+05 ... 2.5e+05 2.5e+05
        dx       float64 8B 25.0
        dy       float64 8B -25.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'>&#x27;head&#x27;</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 2</li><li><span class='xr-has-index'>layer</span>: 13</li><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>x</span>: 500</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-5d03b9e6-9120-42c6-86fe-83aaa8fa4ad6' class='xr-array-in' type='checkbox' checked><label for='section-5d03b9e6-9120-42c6-86fe-83aaa8fa4ad6' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(1, 13, 200, 500), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>
        <tr>
            <td>
                <table style="border-collapse: collapse;">
                    <thead>
                        <tr>
                            <td> </td>
                            <th> Array </th>
                            <th> Chunk </th>
                        </tr>
                    </thead>
                    <tbody>
                    
                        <tr>
                            <th> Bytes </th>
                            <td> 19.84 MiB </td>
                            <td> 9.92 MiB </td>
                        </tr>
                    
                        <tr>
                            <th> Shape </th>
                            <td> (2, 13, 200, 500) </td>
                            <td> (1, 13, 200, 500) </td>
                        </tr>
                        <tr>
                            <th> Dask graph </th>
                            <td colspan="2"> 2 chunks in 5 graph layers </td>
                        </tr>
                        <tr>
                            <th> Data type </th>
                            <td colspan="2"> float64 numpy.ndarray </td>
                        </tr>
                    </tbody>
                </table>
            </td>
            <td>
            <svg width="377" height="115" style="stroke:rgb(0,0,0);stroke-width:1" >

      <!-- Horizontal lines -->
      <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
      <line x1="0" y1="25" x2="25" y2="25" style="stroke-width:2" />

      <!-- Vertical lines -->
      <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
      <line x1="12" y1="0" x2="12" y2="25" />
      <line x1="25" y1="0" x2="25" y2="25" style="stroke-width:2" />

      <!-- Colored Rectangle -->
      <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

      <!-- Text -->
      <text x="12.706308" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >2</text>
      <text x="45.412617" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,45.412617,12.706308)">1</text>


      <!-- Horizontal lines -->
      <line x1="95" y1="0" x2="112" y2="17" style="stroke-width:2" />
      <line x1="95" y1="48" x2="112" y2="65" style="stroke-width:2" />

      <!-- Vertical lines -->
      <line x1="95" y1="0" x2="95" y2="48" style="stroke-width:2" />
      <line x1="112" y1="17" x2="112" y2="65" style="stroke-width:2" />

      <!-- Colored Rectangle -->
      <polygon points="95.0,0.0 112.96546521682274,17.965465216822732 112.96546521682274,65.96546521682274 95.0,48.0" style="fill:#ECB172A0;stroke-width:0"/>

      <!-- Horizontal lines -->
      <line x1="95" y1="0" x2="215" y2="0" style="stroke-width:2" />
      <line x1="112" y1="17" x2="232" y2="17" style="stroke-width:2" />

      <!-- Vertical lines -->
      <line x1="95" y1="0" x2="112" y2="17" style="stroke-width:2" />
      <line x1="215" y1="0" x2="232" y2="17" style="stroke-width:2" />

      <!-- Colored Rectangle -->
      <polygon points="95.0,0.0 215.0,0.0 232.96546521682274,17.965465216822732 112.96546521682274,17.965465216822732" style="fill:#ECB172A0;stroke-width:0"/>

      <!-- Horizontal lines -->
      <line x1="112" y1="17" x2="232" y2="17" style="stroke-width:2" />
      <line x1="112" y1="65" x2="232" y2="65" style="stroke-width:2" />

      <!-- Vertical lines -->
      <line x1="112" y1="17" x2="112" y2="65" style="stroke-width:2" />
      <line x1="232" y1="17" x2="232" y2="65" style="stroke-width:2" />

      <!-- Colored Rectangle -->
      <polygon points="112.96546521682274,17.965465216822732 232.96546521682274,17.965465216822732 232.96546521682274,65.96546521682274 112.96546521682274,65.96546521682274" style="fill:#ECB172A0;stroke-width:0"/>

      <!-- Text -->
      <text x="172.965465" y="85.965465" font-size="1.0rem" font-weight="100" text-anchor="middle" >500</text>
      <text x="252.965465" y="41.965465" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,252.965465,41.965465)">200</text>
      <text x="93.982733" y="76.982733" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,93.982733,76.982733)">13</text>
    </svg>
            </td>
        </tr>
    </table></div></div></li><li class='xr-section-item'><input id='section-24b16a89-e36d-450b-9387-ab0f7a74d396' class='xr-section-summary-in' type='checkbox'  checked><label for='section-24b16a89-e36d-450b-9387-ab0f7a74d396' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.157e-05 365.0</div><input id='attrs-09582b77-2ccc-4b86-917b-d0e7506067f3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-09582b77-2ccc-4b86-917b-d0e7506067f3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c4dab6ee-1454-4479-84d9-4d52c775c8db' class='xr-var-data-in' type='checkbox'><label for='data-c4dab6ee-1454-4479-84d9-4d52c775c8db' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1.157407e-05, 3.650000e+02])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12 13</div><input id='attrs-7ad90eec-88d6-4f65-83c4-00af5b0d8496' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7ad90eec-88d6-4f65-83c4-00af5b0d8496' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dc6bbedb-584f-4a47-b1a4-977978ea3372' class='xr-var-data-in' type='checkbox'><label for='data-dc6bbedb-584f-4a47-b1a4-977978ea3372' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-d40539d9-b098-4849-8ff0-1c5b028367e4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d40539d9-b098-4849-8ff0-1c5b028367e4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-165e4560-0f4e-481a-b0e1-3cd524a49bc9' class='xr-var-data-in' type='checkbox'><label for='data-165e4560-0f4e-481a-b0e1-3cd524a49bc9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
           563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
           563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
           563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
           563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
           563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
           562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
           562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
           562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
           562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
           562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
           562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
           561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
           561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
           561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
           561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
           561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
           561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
           560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
           560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
           560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
           560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
           560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
           559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
           559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
           559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
           559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
           559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
           559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-9277179d-ac09-4a1d-9bca-8a768ed10b00' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9277179d-ac09-4a1d-9bca-8a768ed10b00' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6e5357a1-9d55-40d1-9c30-d37b1646366f' class='xr-var-data-in' type='checkbox'><label for='data-6e5357a1-9d55-40d1-9c30-d37b1646366f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5],
          shape=(500,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>25.0</div><input id='attrs-f9f8d81c-b0aa-4ff5-9b10-bfb0d56a03c4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f9f8d81c-b0aa-4ff5-9b10-bfb0d56a03c4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3cdc3e80-8974-42da-852a-1017155acae8' class='xr-var-data-in' type='checkbox'><label for='data-3cdc3e80-8974-42da-852a-1017155acae8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-25.0</div><input id='attrs-1b696ab7-df5c-436d-bb45-d951f37790e1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1b696ab7-df5c-436d-bb45-d951f37790e1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-238348ef-5052-4100-8c1c-8c0f37555cdc' class='xr-var-data-in' type='checkbox'><label for='data-238348ef-5052-4100-8c1c-8c0f37555cdc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-25.)</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 350-356

.. code-block:: Python

    regridded_simulation.write(tmpdir / "regridded", validate=False)
    regridded_simulation.run()
    hds_regridded = regridded_simulation.open_head()

    hds_regridded






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in notebooks */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
      line-height: 1.6;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-obj-name,
    .xr-group-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-group-name::before {
      content: "📁";
      padding-right: 0.3em;
    }

    .xr-group-name,
    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
      margin: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-top: 4px;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-group-box {
      display: inline-grid;
      grid-template-columns: 0px 20px auto;
      width: 100%;
    }

    .xr-group-box-vline {
      grid-column-start: 1;
      border-right: 0.2em solid;
      border-color: var(--xr-border-color);
      width: 0px;
    }

    .xr-group-box-hline {
      grid-column-start: 2;
      grid-row-start: 1;
      height: 1em;
      width: 20px;
      border-bottom: 0.2em solid;
      border-color: var(--xr-border-color);
    }

    .xr-group-box-contents {
      grid-column-start: 3;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;head&#x27; (time: 2, layer: 13, y: 50, x: 125)&gt; Size: 1MB
    dask.array&lt;stack, shape=(2, 13, 50, 125), dtype=float64, chunksize=(1, 13, 50, 125), chunktype=numpy.ndarray&gt;
    Coordinates:
      * time     (time) float64 16B 1.157e-05 365.0
      * layer    (layer) int64 104B 1 2 3 4 5 6 7 8 9 10 11 12 13
      * y        (y) float64 400B 5.64e+05 5.638e+05 ... 5.592e+05 5.59e+05
      * x        (x) float64 1kB 2.376e+05 2.376e+05 2.378e+05 ... 2.498e+05 2.5e+05
        dx       float64 8B 100.0
        dy       float64 8B -100.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'>&#x27;head&#x27;</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 2</li><li><span class='xr-has-index'>layer</span>: 13</li><li><span class='xr-has-index'>y</span>: 50</li><li><span class='xr-has-index'>x</span>: 125</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-ef386c0e-2e19-4da8-8026-f932cb3594c3' class='xr-array-in' type='checkbox' checked><label for='section-ef386c0e-2e19-4da8-8026-f932cb3594c3' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(1, 13, 50, 125), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>
        <tr>
            <td>
                <table style="border-collapse: collapse;">
                    <thead>
                        <tr>
                            <td> </td>
                            <th> Array </th>
                            <th> Chunk </th>
                        </tr>
                    </thead>
                    <tbody>
                    
                        <tr>
                            <th> Bytes </th>
                            <td> 1.24 MiB </td>
                            <td> 634.77 kiB </td>
                        </tr>
                    
                        <tr>
                            <th> Shape </th>
                            <td> (2, 13, 50, 125) </td>
                            <td> (1, 13, 50, 125) </td>
                        </tr>
                        <tr>
                            <th> Dask graph </th>
                            <td colspan="2"> 2 chunks in 5 graph layers </td>
                        </tr>
                        <tr>
                            <th> Data type </th>
                            <td colspan="2"> float64 numpy.ndarray </td>
                        </tr>
                    </tbody>
                </table>
            </td>
            <td>
            <svg width="386" height="120" style="stroke:rgb(0,0,0);stroke-width:1" >

      <!-- Horizontal lines -->
      <line x1="0" y1="0" x2="27" y2="0" style="stroke-width:2" />
      <line x1="0" y1="25" x2="27" y2="25" style="stroke-width:2" />

      <!-- Vertical lines -->
      <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
      <line x1="13" y1="0" x2="13" y2="25" />
      <line x1="27" y1="0" x2="27" y2="25" style="stroke-width:2" />

      <!-- Colored Rectangle -->
      <polygon points="0.0,0.0 27.802530457377745,0.0 27.802530457377745,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

      <!-- Text -->
      <text x="13.901265" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >2</text>
      <text x="47.802530" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,47.802530,12.706308)">1</text>


      <!-- Horizontal lines -->
      <line x1="97" y1="0" x2="119" y2="22" style="stroke-width:2" />
      <line x1="97" y1="48" x2="119" y2="70" style="stroke-width:2" />

      <!-- Vertical lines -->
      <line x1="97" y1="0" x2="97" y2="48" style="stroke-width:2" />
      <line x1="119" y1="22" x2="119" y2="70" style="stroke-width:2" />

      <!-- Colored Rectangle -->
      <polygon points="97.0,0.0 119.83122152144657,22.831221521446558 119.83122152144657,70.83122152144657 97.0,48.0" style="fill:#ECB172A0;stroke-width:0"/>

      <!-- Horizontal lines -->
      <line x1="97" y1="0" x2="217" y2="0" style="stroke-width:2" />
      <line x1="119" y1="22" x2="239" y2="22" style="stroke-width:2" />

      <!-- Vertical lines -->
      <line x1="97" y1="0" x2="119" y2="22" style="stroke-width:2" />
      <line x1="217" y1="0" x2="239" y2="22" style="stroke-width:2" />

      <!-- Colored Rectangle -->
      <polygon points="97.0,0.0 217.0,0.0 239.83122152144657,22.831221521446558 119.83122152144657,22.831221521446558" style="fill:#ECB172A0;stroke-width:0"/>

      <!-- Horizontal lines -->
      <line x1="119" y1="22" x2="239" y2="22" style="stroke-width:2" />
      <line x1="119" y1="70" x2="239" y2="70" style="stroke-width:2" />

      <!-- Vertical lines -->
      <line x1="119" y1="22" x2="119" y2="70" style="stroke-width:2" />
      <line x1="239" y1="22" x2="239" y2="70" style="stroke-width:2" />

      <!-- Colored Rectangle -->
      <polygon points="119.83122152144657,22.831221521446558 239.83122152144657,22.831221521446558 239.83122152144657,70.83122152144657 119.83122152144657,70.83122152144657" style="fill:#ECB172A0;stroke-width:0"/>

      <!-- Text -->
      <text x="179.831222" y="90.831222" font-size="1.0rem" font-weight="100" text-anchor="middle" >125</text>
      <text x="259.831222" y="46.831222" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,259.831222,46.831222)">50</text>
      <text x="98.415611" y="79.415611" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,98.415611,79.415611)">13</text>
    </svg>
            </td>
        </tr>
    </table></div></div></li><li class='xr-section-item'><input id='section-8790cb1b-ca3d-4b6a-a095-f3d2dc6c0cc7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8790cb1b-ca3d-4b6a-a095-f3d2dc6c0cc7' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.157e-05 365.0</div><input id='attrs-7e2c44ae-2011-4b6e-b40f-70ca03bcdbf5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7e2c44ae-2011-4b6e-b40f-70ca03bcdbf5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ecac1f5c-9450-4ae8-9a14-3f8f5d9b1f7f' class='xr-var-data-in' type='checkbox'><label for='data-ecac1f5c-9450-4ae8-9a14-3f8f5d9b1f7f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1.157407e-05, 3.650000e+02])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12 13</div><input id='attrs-c84bfc3f-d239-4778-8913-e85f28a4090c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c84bfc3f-d239-4778-8913-e85f28a4090c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9a48ceb5-ed65-482b-9a3e-5b92381e0196' class='xr-var-data-in' type='checkbox'><label for='data-9a48ceb5-ed65-482b-9a3e-5b92381e0196' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.638e+05 ... 5.59e+05</div><input id='attrs-3c779882-8824-4869-9a52-02b86697f68b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3c779882-8824-4869-9a52-02b86697f68b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cea79266-7609-436b-bbae-82dfedd6be31' class='xr-var-data-in' type='checkbox'><label for='data-cea79266-7609-436b-bbae-82dfedd6be31' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563950., 563850., 563750., 563650., 563550., 563450., 563350., 563250.,
           563150., 563050., 562950., 562850., 562750., 562650., 562550., 562450.,
           562350., 562250., 562150., 562050., 561950., 561850., 561750., 561650.,
           561550., 561450., 561350., 561250., 561150., 561050., 560950., 560850.,
           560750., 560650., 560550., 560450., 560350., 560250., 560150., 560050.,
           559950., 559850., 559750., 559650., 559550., 559450., 559350., 559250.,
           559150., 559050.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.376e+05 2.376e+05 ... 2.5e+05</div><input id='attrs-7edd617e-025c-4be0-bf30-a3a8fcad00b1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7edd617e-025c-4be0-bf30-a3a8fcad00b1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c576496d-ed0a-452e-ad1f-86e0207e13af' class='xr-var-data-in' type='checkbox'><label for='data-c576496d-ed0a-452e-ad1f-86e0207e13af' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237550., 237650., 237750., 237850., 237950., 238050., 238150., 238250.,
           238350., 238450., 238550., 238650., 238750., 238850., 238950., 239050.,
           239150., 239250., 239350., 239450., 239550., 239650., 239750., 239850.,
           239950., 240050., 240150., 240250., 240350., 240450., 240550., 240650.,
           240750., 240850., 240950., 241050., 241150., 241250., 241350., 241450.,
           241550., 241650., 241750., 241850., 241950., 242050., 242150., 242250.,
           242350., 242450., 242550., 242650., 242750., 242850., 242950., 243050.,
           243150., 243250., 243350., 243450., 243550., 243650., 243750., 243850.,
           243950., 244050., 244150., 244250., 244350., 244450., 244550., 244650.,
           244750., 244850., 244950., 245050., 245150., 245250., 245350., 245450.,
           245550., 245650., 245750., 245850., 245950., 246050., 246150., 246250.,
           246350., 246450., 246550., 246650., 246750., 246850., 246950., 247050.,
           247150., 247250., 247350., 247450., 247550., 247650., 247750., 247850.,
           247950., 248050., 248150., 248250., 248350., 248450., 248550., 248650.,
           248750., 248850., 248950., 249050., 249150., 249250., 249350., 249450.,
           249550., 249650., 249750., 249850., 249950.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>100.0</div><input id='attrs-984f26a2-5646-4428-bed1-6ef6d69af40f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-984f26a2-5646-4428-bed1-6ef6d69af40f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-41bd82a8-fc90-42ad-98dc-37a4904dca60' class='xr-var-data-in' type='checkbox'><label for='data-41bd82a8-fc90-42ad-98dc-37a4904dca60' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(100.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-100.0</div><input id='attrs-15b52de6-a6ab-4a06-969d-deae6c32cb0e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-15b52de6-a6ab-4a06-969d-deae6c32cb0e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8542e54a-155e-4683-8a78-92b06ebc399e' class='xr-var-data-in' type='checkbox'><label for='data-8542e54a-155e-4683-8a78-92b06ebc399e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-100.)</pre></div></li></ul></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 357-358

Let's make a comparison plot of the regridded heads.

.. GENERATED FROM PYTHON SOURCE LINES 358-371

.. code-block:: Python

    fig, axes = plt.subplots(nrows=2, sharex=True)
    plot_kwargs = {"colors": "viridis", "levels": np.linspace(0.0, 11.0, 12), "fig": fig}

    imod.visualize.spatial.plot_map(
        hds_original.isel(layer=6, time=-1), ax=axes[0], **plot_kwargs
    )
    imod.visualize.spatial.plot_map(
        hds_regridded.isel(layer=6, time=-1), ax=axes[1], **plot_kwargs
    )

    axes[0].set_ylabel("original")
    axes[1].set_ylabel("regridded")




.. image-sg:: /user-guide/images/sphx_glr_08-regridding_012.png
   :alt: 08 regridding
   :srcset: /user-guide/images/sphx_glr_08-regridding_012.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(28.472222222222243, 0.5, 'regridded')



.. GENERATED FROM PYTHON SOURCE LINES 372-444

A note on regridding conductivity
---------------------------------

In the npf package, it is possible to use for definining the conductivity
tensor:

- 1 array (K)
- 2 arrays (K and K22)
- 3 arrays (K, K22, K33)

If 1 array is given the tensor is called isotropic. Defining only K gives the
same behavior as specifying K, K22 and K33 with the same value. When
regridding, K33 has a default method different from that of K and K22, but it
can only be applied if K33 exists in the source model in the first place. So
it is recommended to introduce K33 as a separate array in the source model
even if it is isotropic. Also note that default regridding methods were chosen
assuming that K and K22 are roughly horizontal and K33 roughly vertical. But
this may not be the case if the input arrays angle2 and/or angle3 have large
values.

Regridding boundary conditions
------------------------------

Special care must be taken when regridding boundary conditions, and it is
recommended that users verify the balance output of a regridded simulation and
compare it to the original model. If the regridded simulation is a good
representation of the original simulation, the mass contributions on the
balance by the different boundary conditions should be comparable in both
simulations. To achieve this, it may be necessary to tweak the input or the
regridding methods. An example of this is upscaling recharge (so the target
grid has coarser cells than the source grid). Its default method is averaging,
with the following rules:

- if a cell in the source grid is inactive in the source recharge package
  (meaning no recharge), it will not count when averaging. So if a target cell
  has partial overlap with one source recharge cell, and the rest of the
  target cell has no overlap with any source active recharge cell, it will get
  the recharge of the one cell it has overlap with. But since the target cell
  is larger, this effectively means the regridded recharge will be more in the
  regridded simulation than it was in the source simulation
- but we do the same regridding this time assigning a zero recharge to cells
  without recharge then the averaging will take the zero-recharge cells into
  account and the regridded recharge will be the same as the source recharge.


A note on regridding transport
------------------------------

Transport simulations can be unstable if constraints related to the grid
Peclet number and the courant number are exceeded. This can easily happen when
regridding. It may be necessary to reduce the simulation's time step size
especially when downscaling, to prevent numerical issues. Increasing
dispersivities or the molecular diffusion constant can also help to stabilize
the simulation. Inversely, when upscaling, a larger time step size can be
acceptable.


Unsupported packages
--------------------

Some packages cannot be regridded. This includes the Lake package and the UZF
package. Such packages should be removed from the simulation before
regridding, and then new packages should be created by the user and then added
to the regridded simulation.

Listing all default regridding methods
--------------------------------------

MODFLOW 6
^^^^^^^^^
This code snippet prints all default methods:


.. GENERATED FROM PYTHON SOURCE LINES 444-499

.. code-block:: Python

    import inspect
    import sys
    from dataclasses import asdict

    import pandas as pd


    def collect_regrid_methods(classes: list):
        """Collect all regrid methods from all list of package classes."""
        regrid_method_setup = {
            "package name": [],
            "array name": [],
            "method name": [],
            "function name": [],
        }
        regrid_method_table = pd.DataFrame(regrid_method_setup)
        counter = 0
        for obj in classes:
            if hasattr(obj, "_regrid_method"):
                package_name = obj.__name__
                regrid_methods = asdict(obj.get_regrid_methods())
                for array_name in regrid_methods.keys():
                    method_name = regrid_methods[array_name][0].name
                    function_name = ""
                    if len(regrid_methods[array_name]) > 0:
                        function_name = regrid_methods[array_name][1]
                    regrid_method_table.loc[counter] = (
                        package_name,
                        array_name,
                        method_name,
                        function_name,
                    )
                    counter = counter + 1

        # Set multi index to group with packages
        regrid_method_table = regrid_method_table.set_index(["package name", "array name"])
        return regrid_method_table


    # Get all classes in the imod.mf6 module (e.g.
    # :class:`imod.mf6.NodePropertyFlow`, :class:`imod.mf6.GroundwaterFlowModel`,
    # :class:`imod.mf6.River`)
    mf6_classes = [
        obj for _, obj in inspect.getmembers(sys.modules["imod.mf6"], inspect.isclass)
    ]

    mf6_regrid_methods = collect_regrid_methods(mf6_classes)

    # Pandas by default displays at max 60 rows, which this table exceeds.
    nrows = mf6_regrid_methods.shape[0]
    # Configure pandas to increase the max amount of displayable rows.
    pd.set_option("display.max_rows", nrows + 1)
    # Display rows:
    mf6_regrid_methods






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th></th>
          <th>method name</th>
          <th>function name</th>
        </tr>
        <tr>
          <th>package name</th>
          <th>array name</th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th rowspan="3" valign="top">ConstantHead</th>
          <th>head</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>concentration</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>ibound</th>
          <td>OVERLAP</td>
          <td>mode</td>
        </tr>
        <tr>
          <th rowspan="6" valign="top">Dispersion</th>
          <th>diffusion_coefficient</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>longitudinal_horizontal</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>transversal_horizontal1</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>longitudinal_vertical</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>transversal_horizontal2</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>transversal_vertical</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th rowspan="3" valign="top">Drainage</th>
          <th>elevation</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>conductance</th>
          <td>RELATIVEOVERLAP</td>
          <td>conductance</td>
        </tr>
        <tr>
          <th>concentration</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th rowspan="5" valign="top">Evapotranspiration</th>
          <th>surface</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>rate</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>depth</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>proportion_rate</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>proportion_depth</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th rowspan="3" valign="top">GeneralHeadBoundary</th>
          <th>head</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>conductance</th>
          <td>RELATIVEOVERLAP</td>
          <td>conductance</td>
        </tr>
        <tr>
          <th>concentration</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>InitialConditions</th>
          <th>start</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th rowspan="6" valign="top">MobileStorageTransfer</th>
          <th>porosity</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>decay</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>decay_sorbed</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>bulk_density</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>distcoef</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>sp2</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th rowspan="8" valign="top">NodePropertyFlow</th>
          <th>icelltype</th>
          <td>OVERLAP</td>
          <td>mode</td>
        </tr>
        <tr>
          <th>k</th>
          <td>OVERLAP</td>
          <td>geometric_mean</td>
        </tr>
        <tr>
          <th>k22</th>
          <td>OVERLAP</td>
          <td>geometric_mean</td>
        </tr>
        <tr>
          <th>k33</th>
          <td>OVERLAP</td>
          <td>harmonic_mean</td>
        </tr>
        <tr>
          <th>angle1</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>angle2</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>angle3</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>rewet_layer</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th rowspan="2" valign="top">Recharge</th>
          <th>rate</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>concentration</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th rowspan="5" valign="top">River</th>
          <th>stage</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>conductance</th>
          <td>RELATIVEOVERLAP</td>
          <td>conductance</td>
        </tr>
        <tr>
          <th>bottom_elevation</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>concentration</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>infiltration_factor</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th rowspan="3" valign="top">SpecificStorage</th>
          <th>convertible</th>
          <td>OVERLAP</td>
          <td>mode</td>
        </tr>
        <tr>
          <th>specific_storage</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>specific_yield</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th rowspan="3" valign="top">StorageCoefficient</th>
          <th>convertible</th>
          <td>OVERLAP</td>
          <td>mode</td>
        </tr>
        <tr>
          <th>storage_coefficient</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>specific_yield</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th rowspan="3" valign="top">StructuredDiscretization</th>
          <th>top</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>bottom</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>idomain</th>
          <td>OVERLAP</td>
          <td>mode</td>
        </tr>
        <tr>
          <th rowspan="3" valign="top">VerticesDiscretization</th>
          <th>top</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>bottom</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>idomain</th>
          <td>OVERLAP</td>
          <td>mode</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 500-504

MetaSWAP
^^^^^^^^^

Let's list all default regridding methods for all MetaSWAP packages:

.. GENERATED FROM PYTHON SOURCE LINES 505-514

.. code-block:: Python


    msw_classes = [
        obj for _, obj in inspect.getmembers(sys.modules["imod.msw"], inspect.isclass)
    ]

    msw_regrid_methods = collect_regrid_methods(msw_classes)

    msw_regrid_methods






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th></th>
          <th>method name</th>
          <th>function name</th>
        </tr>
        <tr>
          <th>package name</th>
          <th>array name</th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th rowspan="6" valign="top">GridData</th>
          <th>area</th>
          <td>RELATIVEOVERLAP</td>
          <td>conductance</td>
        </tr>
        <tr>
          <th>landuse</th>
          <td>OVERLAP</td>
          <td>mode</td>
        </tr>
        <tr>
          <th>rootzone_depth</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>surface_elevation</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>soil_physical_unit</th>
          <td>OVERLAP</td>
          <td>mode</td>
        </tr>
        <tr>
          <th>active</th>
          <td>OVERLAP</td>
          <td>mode</td>
        </tr>
        <tr>
          <th>IdfMapping</th>
          <th>area</th>
          <td>RELATIVEOVERLAP</td>
          <td>conductance</td>
        </tr>
        <tr>
          <th rowspan="6" valign="top">Infiltration</th>
          <th>infiltration_capacity</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>downward_resistance</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>upward_resistance</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>longitudinal_vertical</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>bottom_resistance</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>extra_storage_coefficient</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th rowspan="2" valign="top">MeteoGrid</th>
          <th>precipitation</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>evapotranspiration</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th rowspan="3" valign="top">Ponding</th>
          <th>ponding_depth</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>runon_resistance</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>runoff_resistance</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th rowspan="4" valign="top">ScalingFactors</th>
          <th>scale_soil_moisture</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>scale_hydraulic_conductivity</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>scale_pressure_head</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>depth_perched_water_table</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th rowspan="2" valign="top">Sprinkling</th>
          <th>max_abstraction_groundwater</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
        <tr>
          <th>max_abstraction_surfacewater</th>
          <td>OVERLAP</td>
          <td>mean</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (1 minutes 14.538 seconds)


.. _sphx_glr_download_user-guide_08-regridding.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: 08-regridding.ipynb <08-regridding.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: 08-regridding.py <08-regridding.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: 08-regridding.zip <08-regridding.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
