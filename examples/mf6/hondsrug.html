
<!DOCTYPE html>


<html lang="en" data-content_root="../../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Regional model &#8212; iMOD Python 1.0.0rc1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../_static/documentation_options.js?v=77c1c56c"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/mf6/hondsrug';</script>
    <script src="../../_static/deltares.js?v=8d5578be"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Partitioning a regional model" href="hondsrug_partitioning.html" />
    <link rel="prev" title="Example models" href="example_models.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.0.0rc1.dev" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
    
    <img src="../../_static/imod-python-logo-light.svg" class="logo__image only-light" alt="iMOD Python 1.0.0rc1 documentation - Home"/>
    <img src="../../_static/imod-python-logo-dark.svg" class="logo__image only-dark pst-js-only" alt="iMOD Python 1.0.0rc1 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../installation.html">
    Installing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user-guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../faq/index.html">
    FAQ
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../developing/index.html">
    Developing
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.deltares.nl/en/" title="Deltares" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-deltares fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Deltares</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Deltares/imod-python" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../installation.html">
    Installing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user-guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../faq/index.html">
    FAQ
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../developing/index.html">
    Developing
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.deltares.nl/en/" title="Deltares" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-deltares fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Deltares</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Deltares/imod-python" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">MODFLOW6</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Henry.html">Henry</a></li>
<li class="toctree-l2"><a class="reference internal" href="circle.html">Circle</a></li>
<li class="toctree-l2"><a class="reference internal" href="circle_partitioned.html">Circle partitioned</a></li>
<li class="toctree-l2"><a class="reference internal" href="circle_transport.html">Freshwater lens (circle)</a></li>
<li class="toctree-l2"><a class="reference internal" href="different_ways_to_regrid_models.html">Different ways to regrid models</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex01_twri.html">TWRI</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_1d_transport.html">1D Solute Transport Benchmarks</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_models.html">Example models</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Regional model</a></li>










<li class="toctree-l2"><a class="reference internal" href="hondsrug_partitioning.html">Partitioning a regional model</a></li>
<li class="toctree-l2"><a class="reference internal" href="lake.html">Lake package example</a></li>
<li class="toctree-l2"><a class="reference internal" href="transport_2d.html">Transport 2d example</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../imodflow/index.html">iMODFLOW</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../imodflow/ImodflowProjectfile.html">Model Creation</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../imod-wq/index.html">iMOD-WQ</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../imod-wq/Elder.html">Elder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imod-wq/FreshwaterLens.html">Freshwater Lens</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imod-wq/Henry-wq.html">Henry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imod-wq/Hydrocoin.html">Hydrocoin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imod-wq/SaltwaterPocket.html">Saltwater Pocket</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imod-wq/VerticalInterface.html">Vertical Interface</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../metaswap/index.html">MetaSWAP</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../metaswap/metaswap_example.html">Coupled MetaSWAP - Modflow6 model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metaswap/read_metaswap_file.html">Reading existing MetaSWAP input</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../prepare/index.html">Prepare</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../prepare/point_interpolation.html">Head point interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../prepare/polygonize_raster.html">Polygonize raster</a></li>
<li class="toctree-l2"><a class="reference internal" href="../prepare/rasterize_shp.html">Rasterize shapefiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../prepare/reproject.html">Reproject data</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualize/index.html">Visualization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualize/flowvel_streamlines.html">Flow velocities and streamlines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualize/plot_map.html">Plot maps</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Examples</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">MODFLOW6</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Regional model</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-examples-mf6-hondsrug-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="regional-model">
<span id="sphx-glr-examples-mf6-hondsrug-py"></span><h1>Regional model<a class="headerlink" href="#regional-model" title="Link to this heading">#</a></h1>
<p>This example shows a simplified script for building a groundwater model in the
northeast of the Netherlands. A primary feature of this area is an ice-pushed
ridge called the Hondsrug. This examples demonstrates modifying external data
for use in a MODFLOW6 model.</p>
<p>In overview, the model features:</p>
<blockquote>
<div><ul class="simple">
<li><p>Thirteen layers: seven aquifers and six aquitards;</p></li>
<li><p>A dense ditch network in the east;</p></li>
<li><p>Pipe drainage for agriculture;</p></li>
<li><p>Precipitation and evapotranspiration.</p></li>
</ul>
</div></blockquote>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>We’ll start with the usual imports, and an import from scipy.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">scipy.ndimage</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>

<span class="kn">import</span> <span class="nn">imod</span>
</pre></div>
</div>
<p>Before starting to create the input data, we will create the groundwater
<a class="reference internal" href="../../api/generated/mf6/imod.mf6.GroundwaterFlowModel.html"><span class="doc">imod.mf6.GroundwaterFlowModel</span></a>.
The data from all the model packages will be added to this variable.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gwf_model</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">GroundwaterFlowModel</span><span class="p">()</span>
</pre></div>
</div>
<p>This package allows specifying a regular MODFLOW grid. This grid is assumed
to be rectangular horizontally, but can be distorted vertically.</p>
<section id="load-data">
<h2>Load data<a class="headerlink" href="#load-data" title="Link to this heading">#</a></h2>
<p>We’ll load the data from the examples that come with this package.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">layermodel</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">hondsrug_layermodel</span><span class="p">()</span>

<span class="c1"># Make sure that the idomain is provided as integers</span>
<span class="n">idomain</span> <span class="o">=</span> <span class="n">layermodel</span><span class="p">[</span><span class="s2">&quot;idomain&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># We only need to provide the data for the top as a 2D array. Modflow 6 will</span>
<span class="c1"># compare the top against the uppermost active bottom cell.</span>
<span class="n">top</span> <span class="o">=</span> <span class="n">layermodel</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;layer&quot;</span><span class="p">)</span>

<span class="n">bot</span> <span class="o">=</span> <span class="n">layermodel</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span>

<span class="n">top</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_hondsrug_001.png" srcset="../../_images/sphx_glr_hondsrug_001.png" alt="dx = 25.0, dy = -25.0" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage object at 0x0000017F8933F910&gt;
</pre></div>
</div>
</section>
<section id="adding-information-to-the-dis-package">
<h2>Adding information to the DIS package<a class="headerlink" href="#adding-information-to-the-dis-package" title="Link to this heading">#</a></h2>
<p>The following step is to add the previously created discretization data to
the gwf_model variable.  This is done using the function
<a class="reference internal" href="../../api/generated/mf6/imod.mf6.StructuredDiscretization.html"><span class="doc">imod.mf6.StructuredDiscretization</span></a>.
The data to include is the top of the model domain, the bottom of the layers,
and the idomain. All this information comes from the previously imported
tifs (now converted to <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray">xarray.DataArray</a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gwf_model</span><span class="p">[</span><span class="s2">&quot;dis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">StructuredDiscretization</span><span class="p">(</span>
    <span class="n">top</span><span class="o">=</span><span class="n">top</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">bot</span><span class="p">,</span> <span class="n">idomain</span><span class="o">=</span><span class="n">idomain</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="node-property-flow-package-npf">
<h1>Node property flow package - NPF<a class="headerlink" href="#node-property-flow-package-npf" title="Link to this heading">#</a></h1>
<p>This package contains the information related to the aquifer properties used to calculate
hydraulic conductance. This package replaces the Layer Property Flow (LPF),
Block-Centered Flow (BCF), and Upstream Weighting (UPW) packages from previous MODFLOW versions.</p>
<section id="hydraulic-conductivity">
<h2>Hydraulic conductivity<a class="headerlink" href="#hydraulic-conductivity" title="Link to this heading">#</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="n">layermodel</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="icelltype">
<h2>icelltype<a class="headerlink" href="#icelltype" title="Link to this heading">#</a></h2>
<p>The cell type to be used in the model (confined or convertible) can be
defined under ICELLTYPE, which is an input to the NPF package.  ICELLTYPE ==
0: <em>Confined cell</em> - Constant transmissivity ICELLTYPE != 0: <em>Convertible
cell</em> - Transmissivity varies depending on the calculated head in the cell
(based on the saturated cell thickness)</p>
<p>In this example, all layers have a ICELLTYPE equal to 0, indicating confined
cells.  This is defined in the following section.</p>
</section>
<section id="adding-information-to-the-npf-package">
<h2>Adding information to the NPF package<a class="headerlink" href="#adding-information-to-the-npf-package" title="Link to this heading">#</a></h2>
<p>The information for the NPF package is added to the gwf_model variable using
<a class="reference internal" href="../../api/generated/mf6/imod.mf6.NodePropertyFlow.html"><span class="doc">imod.mf6.NodePropertyFlow</span></a>.
The information included is the icelltype value (equal to zero), the array
for  the hydraulic conductivity (considered to be the same for the horizontal
and vertical direction) and, optionally, the
variable_vertical_conductance, dewatered, perched and save_flows options have
been activated.  For more details about the meaning of these variables and
other variables available to be used within this package, please refer to the
<a class="reference internal" href="../../api/generated/mf6/imod.mf6.NodePropertyFlow.html"><span class="doc">documentation</span></a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gwf_model</span><span class="p">[</span><span class="s2">&quot;npf&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">NodePropertyFlow</span><span class="p">(</span>
    <span class="n">icelltype</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
    <span class="n">k33</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
    <span class="n">variable_vertical_conductance</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">dewatered</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">perched</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">save_flows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="initial-conditions-package-ic">
<h1>Initial conditions package - IC<a class="headerlink" href="#initial-conditions-package-ic" title="Link to this heading">#</a></h1>
<p>This package reads the starting heads for a simulation.</p>
<section id="starting-heads-interpolation">
<h2>Starting heads interpolation<a class="headerlink" href="#starting-heads-interpolation" title="Link to this heading">#</a></h2>
<p>The starting heads to be used in this model are based on the interpolation of
x-y head measurements, which were interpolated on a larger area.  This
example was created in this example –insert-link-here–</p>
<p>The heads were interpolated on a larger area, therefore these have to be
clipped first</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">initial</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">hondsrug_initial</span><span class="p">()</span>
<span class="n">interpolated_head_larger</span> <span class="o">=</span> <span class="n">initial</span><span class="p">[</span><span class="s2">&quot;head&quot;</span><span class="p">]</span>

<span class="n">xmin</span> <span class="o">=</span> <span class="mf">237_500.0</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mf">250_000.0</span>
<span class="n">ymin</span> <span class="o">=</span> <span class="mf">559_000.0</span>
<span class="n">ymax</span> <span class="o">=</span> <span class="mf">564_000.0</span>

<span class="n">interpolated_head</span> <span class="o">=</span> <span class="n">interpolated_head_larger</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">ymax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Plotting the clipped interpolation</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">interpolated_head</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_hondsrug_002.png" srcset="../../_images/sphx_glr_hondsrug_002.png" alt="dx = 25.0, dy = -25.0" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage object at 0x0000017F8A1BD590&gt;
</pre></div>
</div>
<p>The final step is to assign the 2D heads interpolation to all the
model layers (as a reference value) by using the xarray tool
<a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.full_like.html#xarray.full_like">xarray.full_like</a>.
The 3d idomain array is used as reference for the geometry and then
its original values are replaced by NaNs.
This array is combined with the interpolated_head array using the xarray
<a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.combine_first.html#xarray.DataArray.combine_first">DataArray.combine_first</a>
option.
The final result is an starting_heads xarray where all layers have the 2d interpolated_head information.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assign interpolated head values to all the model layers</span>
<span class="n">like_3d</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">idomain</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">starting_head</span> <span class="o">=</span> <span class="n">like_3d</span><span class="o">.</span><span class="n">combine_first</span><span class="p">(</span><span class="n">interpolated_head</span><span class="p">)</span>
<span class="c1"># Consequently ensure no data is specified in inactive cells:</span>
<span class="n">starting_head</span> <span class="o">=</span> <span class="n">starting_head</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">idomain</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">starting_head</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;idomain&#x27; (layer: 13, y: 200, x: 500)&gt; Size: 10MB
array([[[       nan,        nan,        nan, ..., 1.27008811,
         1.27823924, 1.28676046],
        [       nan,        nan,        nan, ..., 1.26336139,
         1.27183901, 1.28070347],
        [       nan,        nan,        nan, ..., 1.25620192,
         1.26504986, 1.27431479],
        ...,
        [7.28608515, 7.26550211, 7.24273429, ...,        nan,
                nan,        nan],
        [7.2907364 , 7.26985601, 7.24672249, ...,        nan,
                nan,        nan],
        [7.29728577, 7.27649525, 7.25355321, ...,        nan,
                nan,        nan]],

       [[       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
...
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan]],

       [[5.6706604 , 5.65319374, 5.63573351, ..., 1.27008811,
         1.27823924, 1.28676046],
        [5.67764711, 5.66021213, 5.64275829, ..., 1.26336139,
         1.27183901, 1.28070347],
        [5.68462064, 5.66720984, 5.64976361, ..., 1.25620192,
         1.26504986, 1.27431479],
        ...,
        [7.28608515, 7.26550211, 7.24273429, ..., 4.67051889,
         4.66997651, 4.66944365],
        [7.2907364 , 7.26985601, 7.24672249, ..., 4.70303061,
         4.70234778, 4.70168152],
        [7.29728577, 7.27649525, 7.25355321, ..., 4.73551559,
         4.73469247, 4.73389453]]])
Coordinates:
  * x        (x) float64 4kB 2.375e+05 2.375e+05 2.376e+05 ... 2.5e+05 2.5e+05
  * y        (y) float64 2kB 5.64e+05 5.64e+05 5.639e+05 ... 5.59e+05 5.59e+05
    dx       float64 8B 25.0
    dy       float64 8B -25.0
  * layer    (layer) int32 52B 1 2 3 4 5 6 7 8 9 10 11 12 13</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'idomain'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>layer</span>: 13</li><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>x</span>: 500</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-24e4348a-fba9-4471-8831-d695a0a4f879' class='xr-array-in' type='checkbox' checked><label for='section-24e4348a-fba9-4471-8831-d695a0a4f879' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>nan nan nan nan nan nan nan ... 4.738 4.737 4.736 4.736 4.735 4.734</span></div><div class='xr-array-data'><pre>array([[[       nan,        nan,        nan, ..., 1.27008811,
         1.27823924, 1.28676046],
        [       nan,        nan,        nan, ..., 1.26336139,
         1.27183901, 1.28070347],
        [       nan,        nan,        nan, ..., 1.25620192,
         1.26504986, 1.27431479],
        ...,
        [7.28608515, 7.26550211, 7.24273429, ...,        nan,
                nan,        nan],
        [7.2907364 , 7.26985601, 7.24672249, ...,        nan,
                nan,        nan],
        [7.29728577, 7.27649525, 7.25355321, ...,        nan,
                nan,        nan]],

       [[       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
...
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan]],

       [[5.6706604 , 5.65319374, 5.63573351, ..., 1.27008811,
         1.27823924, 1.28676046],
        [5.67764711, 5.66021213, 5.64275829, ..., 1.26336139,
         1.27183901, 1.28070347],
        [5.68462064, 5.66720984, 5.64976361, ..., 1.25620192,
         1.26504986, 1.27431479],
        ...,
        [7.28608515, 7.26550211, 7.24273429, ..., 4.67051889,
         4.66997651, 4.66944365],
        [7.2907364 , 7.26985601, 7.24672249, ..., 4.70303061,
         4.70234778, 4.70168152],
        [7.29728577, 7.27649525, 7.25355321, ..., 4.73551559,
         4.73469247, 4.73389453]]])</pre></div></div></li><li class='xr-section-item'><input id='section-1226ed10-ba9a-4148-9113-35879500a636' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1226ed10-ba9a-4148-9113-35879500a636' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-945fbf25-cb5a-4a9b-b41c-9c5593f1bcd2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-945fbf25-cb5a-4a9b-b41c-9c5593f1bcd2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-de6febfb-b360-411d-8037-ac9601165e22' class='xr-var-data-in' type='checkbox'><label for='data-de6febfb-b360-411d-8037-ac9601165e22' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-254f9bca-1b9a-40be-a4df-845809f77189' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-254f9bca-1b9a-40be-a4df-845809f77189' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ee32cf2a-15c4-47ca-babf-6be8f4aac197' class='xr-var-data-in' type='checkbox'><label for='data-ee32cf2a-15c4-47ca-babf-6be8f4aac197' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
       563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
       563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
       563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
       563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
       563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
       562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
       562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
       562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
       562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
       562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
       562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
       561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
       561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
       561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
       561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
       561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
       561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
       560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
       560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
       560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
       560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
       560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
       559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
       559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
       559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
       559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
       559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
       559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>25.0</div><input id='attrs-66cef86f-5cc6-43ad-9ed3-f45b76b1adff' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-66cef86f-5cc6-43ad-9ed3-f45b76b1adff' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-96d3bcee-95cd-4eaf-a12b-97aaa8dc544c' class='xr-var-data-in' type='checkbox'><label for='data-96d3bcee-95cd-4eaf-a12b-97aaa8dc544c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-25.0</div><input id='attrs-fa608488-da6b-4aad-89bc-65b1709fef64' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fa608488-da6b-4aad-89bc-65b1709fef64' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ea4632c8-3e56-417c-aea0-c223307201a7' class='xr-var-data-in' type='checkbox'><label for='data-ea4632c8-3e56-417c-aea0-c223307201a7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12 13</div><input id='attrs-b4de47d9-c4f1-48d1-b455-74a53788d142' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b4de47d9-c4f1-48d1-b455-74a53788d142' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-be3bc751-11b5-442b-8c94-b1ff1f61add3' class='xr-var-data-in' type='checkbox'><label for='data-be3bc751-11b5-442b-8c94-b1ff1f61add3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13], dtype=int32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-decffddd-1048-4645-bc16-5b6dd808ee36' class='xr-section-summary-in' type='checkbox'  ><label for='section-decffddd-1048-4645-bc16-5b6dd808ee36' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-de38d619-6d42-4cc1-b0c8-e1ecc5e80989' class='xr-index-data-in' type='checkbox'/><label for='index-de38d619-6d42-4cc1-b0c8-e1ecc5e80989' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([237512.5, 237537.5, 237562.5, 237587.5, 237612.5, 237637.5, 237662.5,
       237687.5, 237712.5, 237737.5,
       ...
       249762.5, 249787.5, 249812.5, 249837.5, 249862.5, 249887.5, 249912.5,
       249937.5, 249962.5, 249987.5],
      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=500))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-7ee2949d-935b-4952-8874-2dce9e471af3' class='xr-index-data-in' type='checkbox'/><label for='index-7ee2949d-935b-4952-8874-2dce9e471af3' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
       563812.5, 563787.5, 563762.5,
       ...
       559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5, 559087.5,
       559062.5, 559037.5, 559012.5],
      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=200))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>layer</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-97813d78-0b4c-4ffb-aaa4-f809d0aaa3a6' class='xr-index-data-in' type='checkbox'/><label for='index-97813d78-0b4c-4ffb-aaa4-f809d0aaa3a6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], dtype=&#x27;int32&#x27;, name=&#x27;layer&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a6b2b310-e10c-49ef-8d94-53e544fd0e2f' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-a6b2b310-e10c-49ef-8d94-53e544fd0e2f' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
<br />
<br /></section>
<section id="adding-information-to-the-ic-package">
<h2>Adding information to the IC package<a class="headerlink" href="#adding-information-to-the-ic-package" title="Link to this heading">#</a></h2>
<p>The function for indicating the initial conditions is
<a class="reference internal" href="../../api/generated/mf6/imod.mf6.InitialConditions.html"><span class="doc">imod.mf6.InitialConditions</span></a>.
It is necessary to indicate the value(s) to be considered as the initial
(starting) head of the simulation.
In this case, this value is equal to the previously created starting_head array.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gwf_model</span><span class="p">[</span><span class="s2">&quot;ic&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">InitialConditions</span><span class="p">(</span><span class="n">starting_head</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="constant-head-package-chd">
<h1>Constant head package - CHD<a class="headerlink" href="#constant-head-package-chd" title="Link to this heading">#</a></h1>
<p>This package allows to indicate if the head varies with time,
if it is constant or if it is inactive.</p>
<section id="constant-head-edge">
<h2>Constant head edge<a class="headerlink" href="#constant-head-edge" title="Link to this heading">#</a></h2>
<p>The previously interpolated starting_head array will be used to define
the constant head value which will be used along the model boundaries.
A function is defined to indicate the location of the outer edge
(returning a boolean array).</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">outer_edge</span><span class="p">(</span><span class="n">da</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">from_edge</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_erosion</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">is_edge</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">from_edge</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">is_edge</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
</pre></div>
</div>
<p>For the next calculations, it is necessary to create a template array
which can be used for assigning the corresponding geometry to other arrays.
In this case, a 2d template is created based on the idomain layer information
and filled with ones.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">like_2d</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">idomain</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">layer</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">like_2d</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;idomain&#x27; (y: 200, x: 500)&gt; Size: 800kB
array([[1, 1, 1, ..., 1, 1, 1],
       [1, 1, 1, ..., 1, 1, 1],
       [1, 1, 1, ..., 1, 1, 1],
       ...,
       [1, 1, 1, ..., 1, 1, 1],
       [1, 1, 1, ..., 1, 1, 1],
       [1, 1, 1, ..., 1, 1, 1]])
Coordinates:
  * x        (x) float64 4kB 2.375e+05 2.375e+05 2.376e+05 ... 2.5e+05 2.5e+05
  * y        (y) float64 2kB 5.64e+05 5.64e+05 5.639e+05 ... 5.59e+05 5.59e+05
    dx       float64 8B 25.0
    dy       float64 8B -25.0
    layer    int32 4B 1</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'idomain'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>x</span>: 500</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-ab1a0f35-911b-4643-bb9b-b244d2905033' class='xr-array-in' type='checkbox' checked><label for='section-ab1a0f35-911b-4643-bb9b-b244d2905033' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 ... 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></div><div class='xr-array-data'><pre>array([[1, 1, 1, ..., 1, 1, 1],
       [1, 1, 1, ..., 1, 1, 1],
       [1, 1, 1, ..., 1, 1, 1],
       ...,
       [1, 1, 1, ..., 1, 1, 1],
       [1, 1, 1, ..., 1, 1, 1],
       [1, 1, 1, ..., 1, 1, 1]])</pre></div></div></li><li class='xr-section-item'><input id='section-398da2a3-673e-4161-b6c5-5a4704274a5b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-398da2a3-673e-4161-b6c5-5a4704274a5b' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-06db235c-fb27-4986-9f47-7199817ab8d3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-06db235c-fb27-4986-9f47-7199817ab8d3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-36908995-c2e5-4750-9cd7-6bfcf2a5d531' class='xr-var-data-in' type='checkbox'><label for='data-36908995-c2e5-4750-9cd7-6bfcf2a5d531' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-ac2f09b5-34ce-42cb-9115-9f72da3a6c33' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ac2f09b5-34ce-42cb-9115-9f72da3a6c33' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b1c24b33-0e89-4a46-ac83-cd74a8e5b10a' class='xr-var-data-in' type='checkbox'><label for='data-b1c24b33-0e89-4a46-ac83-cd74a8e5b10a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
       563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
       563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
       563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
       563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
       563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
       562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
       562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
       562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
       562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
       562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
       562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
       561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
       561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
       561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
       561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
       561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
       561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
       560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
       560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
       560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
       560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
       560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
       559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
       559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
       559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
       559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
       559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
       559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>25.0</div><input id='attrs-ef65ec7a-7406-47d5-97d0-0b8cde20d5d9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ef65ec7a-7406-47d5-97d0-0b8cde20d5d9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9de87a5c-98f9-49eb-93a3-8fe0e120f7b0' class='xr-var-data-in' type='checkbox'><label for='data-9de87a5c-98f9-49eb-93a3-8fe0e120f7b0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-25.0</div><input id='attrs-8ed0b35f-b805-43c7-8a06-29af835fdb22' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8ed0b35f-b805-43c7-8a06-29af835fdb22' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fea558fe-6263-4451-ad79-58d6ebb185b0' class='xr-var-data-in' type='checkbox'><label for='data-fea558fe-6263-4451-ad79-58d6ebb185b0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>layer</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1</div><input id='attrs-d46860f1-2767-41f1-802b-bae07854c84b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d46860f1-2767-41f1-802b-bae07854c84b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4f3b915d-6541-4610-b1fd-a6b7b19dca44' class='xr-var-data-in' type='checkbox'><label for='data-4f3b915d-6541-4610-b1fd-a6b7b19dca44' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1, dtype=int32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-682ec06f-2242-48ef-aebe-27c26e76fcef' class='xr-section-summary-in' type='checkbox'  ><label for='section-682ec06f-2242-48ef-aebe-27c26e76fcef' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-6df2647a-7e88-4c0f-9e33-97a4542fed2f' class='xr-index-data-in' type='checkbox'/><label for='index-6df2647a-7e88-4c0f-9e33-97a4542fed2f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([237512.5, 237537.5, 237562.5, 237587.5, 237612.5, 237637.5, 237662.5,
       237687.5, 237712.5, 237737.5,
       ...
       249762.5, 249787.5, 249812.5, 249837.5, 249862.5, 249887.5, 249912.5,
       249937.5, 249962.5, 249987.5],
      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=500))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-d04be4bd-9715-4427-86ee-1fea147fc6ed' class='xr-index-data-in' type='checkbox'/><label for='index-d04be4bd-9715-4427-86ee-1fea147fc6ed' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
       563812.5, 563787.5, 563762.5,
       ...
       559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5, 559087.5,
       559062.5, 559037.5, 559012.5],
      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=200))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f48a6e83-cf4e-43fd-977d-35141259e804' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-f48a6e83-cf4e-43fd-977d-35141259e804' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
<br />
<br /><p>Using the previously created function and the 2d template,
the outer edge is defined for this example.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">edge</span> <span class="o">=</span> <span class="n">outer_edge</span><span class="p">(</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">like_2d</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">(</span><span class="s2">&quot;layer&quot;</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="adding-information-to-the-chd-package">
<h2>Adding information to the CHD package<a class="headerlink" href="#adding-information-to-the-chd-package" title="Link to this heading">#</a></h2>
<p>To add the information to the CHD package within the gwf_model variable, the
<a class="reference internal" href="../../api/generated/mf6/imod.mf6.ConstantHead.html"><span class="doc">imod.mf6.ConstantHead</span></a>.
function is used.
The required information is the head array for this boundary condition.
In this example, the starting_head array is selected where the idomain is &gt; 0 (active)
and it is located in the edge array.</p>
<p>It is also possible (and optional) to indicate if the CHD information will be written
to the listing file after it is read (print_input), if the constant head flow rates will
be printed to the listing file for every stress period time step
in which “BUDGET PRINT” is specified in Output Control (print_flows)
and if the constant head flow terms will be written to the file
specified with “BUDGET FILEOUT” in Output Control (save_flows).
By default, these three options are set to False.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gwf_model</span><span class="p">[</span><span class="s2">&quot;chd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ConstantHead</span><span class="p">(</span>
    <span class="n">starting_head</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">idomain</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">edge</span><span class="p">),</span>
    <span class="n">print_input</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">print_flows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">save_flows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="recharge">
<h1>Recharge<a class="headerlink" href="#recharge" title="Link to this heading">#</a></h1>
<p>This package is used to represent areally distributed recharge to the groundwater system.
To calculate the recharge, the precipitation and evapotranspiration
information from the KNMI website has been downloaded for the study area.
This information is saved in netCDF files, which have been imported using the
xarray function
<a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.open_dataset.html#xarray.open_dataset">xr.open_dataset</a>,
slicing the area to the model’s miminum and maximum dimensions.</p>
<p>Note that the meteorological data has mm/d as unit and
this has to be converted to m/d for Modflow 6.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">xmin</span> <span class="o">=</span> <span class="mf">230_000.0</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mf">257_000.0</span>
<span class="n">ymin</span> <span class="o">=</span> <span class="mf">550_000.0</span>
<span class="n">ymax</span> <span class="o">=</span> <span class="mf">567_000.0</span>

<span class="n">meteorology</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">hondsrug_meteorology</span><span class="p">()</span>
<span class="n">pp</span> <span class="o">=</span> <span class="n">meteorology</span><span class="p">[</span><span class="s2">&quot;precipitation&quot;</span><span class="p">]</span>
<span class="n">evt</span> <span class="o">=</span> <span class="n">meteorology</span><span class="p">[</span><span class="s2">&quot;evapotranspiration&quot;</span><span class="p">]</span>

<span class="n">pp</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">ymax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">))</span> <span class="o">/</span> <span class="mf">1000.0</span>  <span class="c1"># from mm/d to m/d</span>
<span class="n">evt</span> <span class="o">=</span> <span class="n">evt</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">ymax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">))</span> <span class="o">/</span> <span class="mf">1000.0</span>  <span class="c1"># from mm/d to m/d</span>
</pre></div>
</div>
<section id="recharge-steady-state">
<h2>Recharge - Steady state<a class="headerlink" href="#recharge-steady-state" title="Link to this heading">#</a></h2>
<p>For the steady state conditions of the model,
the data from the period 2000 to 2009 was considered as reference.
The initial information was sliced to this time period and averaged
to obtain the a mean value grid. This process was done for both
precipitation and evapotranspiration datasets.</p>
<p><strong>Precipitation</strong></p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">pp_ss</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;2000-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2009-12-31&quot;</span><span class="p">))</span>
<span class="n">pp_ss_mean</span> <span class="o">=</span> <span class="n">pp_ss</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">pp_ss_mean</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_hondsrug_003.png" srcset="../../_images/sphx_glr_hondsrug_003.png" alt="dx = 1e+03, dy = -1e+03" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh object at 0x0000017F8A285D90&gt;
</pre></div>
</div>
<p><strong>Evapotranspiration</strong></p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">evt_ss</span> <span class="o">=</span> <span class="n">evt</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;2000-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2009-12-31&quot;</span><span class="p">))</span>
<span class="n">evt_ss_mean</span> <span class="o">=</span> <span class="n">evt_ss</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">evt_ss_mean</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_hondsrug_004.png" srcset="../../_images/sphx_glr_hondsrug_004.png" alt="dx = 1e+03, dy = -1e+03" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh object at 0x0000017F85774890&gt;
</pre></div>
</div>
<p>For the recharge calculation, a first estimate
is the difference between the precipitation and evapotranspiration values.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">rch_ss</span> <span class="o">=</span> <span class="n">pp_ss_mean</span> <span class="o">-</span> <span class="n">evt_ss_mean</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">rch_ss</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_hondsrug_005.png" srcset="../../_images/sphx_glr_hondsrug_005.png" alt="dx = 1e+03, dy = -1e+03" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage object at 0x0000017F92213050&gt;
</pre></div>
</div>
</section>
<section id="recharge-transient">
<h2>Recharge - Transient<a class="headerlink" href="#recharge-transient" title="Link to this heading">#</a></h2>
<p>The transient model will encompass the period from 2010 to 2015.
The initial pp and evt datasets have been sliced to this time frame.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">pp_trans</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;2010-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2015-12-31&quot;</span><span class="p">))</span>
<span class="n">evt_trans</span> <span class="o">=</span> <span class="n">evt</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;2010-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2015-12-31&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>As previously done, it is assumed that the recharge is equal
to the difference between precipitation and evapotranspiration as a first estimate.
Furthermore, the negative values found after doing this calculation have been
replaced by zeros, as the recharge should not have a negative value.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">rch_trans</span> <span class="o">=</span> <span class="n">pp_trans</span> <span class="o">-</span> <span class="n">evt_trans</span>
<span class="n">rch_trans</span> <span class="o">=</span> <span class="n">rch_trans</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">rch_trans</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># check negative values</span>
</pre></div>
</div>
<p>The original information is on a daily step, so it is going to be
resampled to a yearly step by using the xarray function
<a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.Dataset.resample.html#xarray.Dataset.resample">Dataset.resample</a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">rch_trans_yr</span> <span class="o">=</span> <span class="n">rch_trans</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">rch_trans_yr</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (time: 6, y: 17, x: 27)&gt; Size: 11kB
array([[[0.00191725, 0.00191589, 0.00191248, ..., 0.00158879,
         0.00160275, 0.00161772],
        [0.00193096, 0.00193016, 0.0019277 , ..., 0.00159777,
         0.00160856, 0.00162071],
        [0.00194592, 0.00194606, 0.00194384, ..., 0.00160863,
         0.00161658, 0.0016263 ],
        ...,
        [0.00205102, 0.0020491 , 0.00204451, ..., 0.00175834,
         0.00175477, 0.00175247],
        [0.0020481 , 0.00204493, 0.00203995, ..., 0.00177083,
         0.0017666 , 0.00176362],
        [0.00204444, 0.002041  , 0.00203658, ..., 0.00178251,
         0.00177807, 0.00177411]],

       [[0.00175232, 0.0017549 , 0.00175632, ..., 0.00160428,
         0.0016166 , 0.00163142],
        [0.00175832, 0.00176321, 0.00176716, ..., 0.00161909,
         0.00162744, 0.00163787],
        [0.00176593, 0.00177297, 0.00177865, ..., 0.00163613,
         0.00164029, 0.00164618],
...
        [0.00190413, 0.0019    , 0.00189647, ..., 0.00168478,
         0.00167463, 0.00166721],
        [0.00191761, 0.00191336, 0.00190866, ..., 0.00169624,
         0.00168655, 0.0016792 ],
        [0.0019308 , 0.00192603, 0.0019212 , ..., 0.00170712,
         0.00169771, 0.00169032]],

       [[0.00226806, 0.00225167, 0.00223808, ..., 0.00221006,
         0.00219559, 0.00218172],
        [0.0022924 , 0.00227892, 0.00226807, ..., 0.00220936,
         0.00219364, 0.00217812],
        [0.00231699, 0.00230603, 0.00229702, ..., 0.00221065,
         0.0021932 , 0.00217596],
        ...,
        [0.00249076, 0.00248442, 0.00247622, ..., 0.00224485,
         0.00222806, 0.00221361],
        [0.00249192, 0.00248449, 0.00247561, ..., 0.00224585,
         0.00223096, 0.00221743],
        [0.00249155, 0.00248376, 0.00247603, ..., 0.00224736,
         0.00223372, 0.00222133]]], dtype=float32)
Coordinates:
  * x        (x) float64 216B 2.305e+05 2.315e+05 ... 2.555e+05 2.565e+05
  * y        (y) float64 136B 5.665e+05 5.655e+05 ... 5.515e+05 5.505e+05
    dx       float64 8B 1e+03
    dy       float64 8B -1e+03
  * time     (time) datetime64[ns] 48B 2009-12-31 2010-12-31 ... 2014-12-31</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 6</li><li><span class='xr-has-index'>y</span>: 17</li><li><span class='xr-has-index'>x</span>: 27</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-8f5a9be4-97ae-4d79-b174-f6b680053c70' class='xr-array-in' type='checkbox' checked><label for='section-8f5a9be4-97ae-4d79-b174-f6b680053c70' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.001917 0.001916 0.001912 0.001907 ... 0.002247 0.002234 0.002221</span></div><div class='xr-array-data'><pre>array([[[0.00191725, 0.00191589, 0.00191248, ..., 0.00158879,
         0.00160275, 0.00161772],
        [0.00193096, 0.00193016, 0.0019277 , ..., 0.00159777,
         0.00160856, 0.00162071],
        [0.00194592, 0.00194606, 0.00194384, ..., 0.00160863,
         0.00161658, 0.0016263 ],
        ...,
        [0.00205102, 0.0020491 , 0.00204451, ..., 0.00175834,
         0.00175477, 0.00175247],
        [0.0020481 , 0.00204493, 0.00203995, ..., 0.00177083,
         0.0017666 , 0.00176362],
        [0.00204444, 0.002041  , 0.00203658, ..., 0.00178251,
         0.00177807, 0.00177411]],

       [[0.00175232, 0.0017549 , 0.00175632, ..., 0.00160428,
         0.0016166 , 0.00163142],
        [0.00175832, 0.00176321, 0.00176716, ..., 0.00161909,
         0.00162744, 0.00163787],
        [0.00176593, 0.00177297, 0.00177865, ..., 0.00163613,
         0.00164029, 0.00164618],
...
        [0.00190413, 0.0019    , 0.00189647, ..., 0.00168478,
         0.00167463, 0.00166721],
        [0.00191761, 0.00191336, 0.00190866, ..., 0.00169624,
         0.00168655, 0.0016792 ],
        [0.0019308 , 0.00192603, 0.0019212 , ..., 0.00170712,
         0.00169771, 0.00169032]],

       [[0.00226806, 0.00225167, 0.00223808, ..., 0.00221006,
         0.00219559, 0.00218172],
        [0.0022924 , 0.00227892, 0.00226807, ..., 0.00220936,
         0.00219364, 0.00217812],
        [0.00231699, 0.00230603, 0.00229702, ..., 0.00221065,
         0.0021932 , 0.00217596],
        ...,
        [0.00249076, 0.00248442, 0.00247622, ..., 0.00224485,
         0.00222806, 0.00221361],
        [0.00249192, 0.00248449, 0.00247561, ..., 0.00224585,
         0.00223096, 0.00221743],
        [0.00249155, 0.00248376, 0.00247603, ..., 0.00224736,
         0.00223372, 0.00222133]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-7e81f0d9-fe15-4f63-8cef-2a68df8d3ae6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7e81f0d9-fe15-4f63-8cef-2a68df8d3ae6' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.305e+05 2.315e+05 ... 2.565e+05</div><input id='attrs-eda34610-a1c4-41ed-9243-eaa30ae9b391' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-eda34610-a1c4-41ed-9243-eaa30ae9b391' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d0e542bc-166b-4323-ba83-3b9b126ad040' class='xr-var-data-in' type='checkbox'><label for='data-d0e542bc-166b-4323-ba83-3b9b126ad040' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([230500., 231500., 232500., 233500., 234500., 235500., 236500., 237500.,
       238500., 239500., 240500., 241500., 242500., 243500., 244500., 245500.,
       246500., 247500., 248500., 249500., 250500., 251500., 252500., 253500.,
       254500., 255500., 256500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.665e+05 5.655e+05 ... 5.505e+05</div><input id='attrs-0d8868cd-dc42-496d-a021-8fa63aecb22e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0d8868cd-dc42-496d-a021-8fa63aecb22e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a7e5166c-1f88-404f-8435-0ca5066488a1' class='xr-var-data-in' type='checkbox'><label for='data-a7e5166c-1f88-404f-8435-0ca5066488a1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([566500., 565500., 564500., 563500., 562500., 561500., 560500., 559500.,
       558500., 557500., 556500., 555500., 554500., 553500., 552500., 551500.,
       550500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1e+03</div><input id='attrs-fc4a5c6e-c4ca-4fe7-a96e-31054dd978f5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fc4a5c6e-c4ca-4fe7-a96e-31054dd978f5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-151344c3-6852-4da8-8b1e-968c8d095618' class='xr-var-data-in' type='checkbox'><label for='data-151344c3-6852-4da8-8b1e-968c8d095618' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1000.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1e+03</div><input id='attrs-de922cd7-97f7-4a28-b18c-8d5821975362' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-de922cd7-97f7-4a28-b18c-8d5821975362' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bf6875ec-6320-42bb-b045-d3fa8126a8c8' class='xr-var-data-in' type='checkbox'><label for='data-bf6875ec-6320-42bb-b045-d3fa8126a8c8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-1000.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2009-12-31 ... 2014-12-31</div><input id='attrs-3a6891cd-5502-4a52-9c28-b188ccc1f3d0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3a6891cd-5502-4a52-9c28-b188ccc1f3d0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-276d7f5e-5f13-4393-86af-3bb9126eb18d' class='xr-var-data-in' type='checkbox'><label for='data-276d7f5e-5f13-4393-86af-3bb9126eb18d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2009-12-31T00:00:00.000000000&#x27;, &#x27;2010-12-31T00:00:00.000000000&#x27;,
       &#x27;2011-12-31T00:00:00.000000000&#x27;, &#x27;2012-12-31T00:00:00.000000000&#x27;,
       &#x27;2013-12-31T00:00:00.000000000&#x27;, &#x27;2014-12-31T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e134a0e5-ac5f-4712-9fc7-0ac96c6ed26a' class='xr-section-summary-in' type='checkbox'  ><label for='section-e134a0e5-ac5f-4712-9fc7-0ac96c6ed26a' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-caaaa2f7-0707-46c2-a6ff-bdd0a5b6d15f' class='xr-index-data-in' type='checkbox'/><label for='index-caaaa2f7-0707-46c2-a6ff-bdd0a5b6d15f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([230500.0, 231500.0, 232500.0, 233500.0, 234500.0, 235500.0, 236500.0,
       237500.0, 238500.0, 239500.0, 240500.0, 241500.0, 242500.0, 243500.0,
       244500.0, 245500.0, 246500.0, 247500.0, 248500.0, 249500.0, 250500.0,
       251500.0, 252500.0, 253500.0, 254500.0, 255500.0, 256500.0],
      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-a83d8c67-1e01-4754-b359-8c2f116e17d5' class='xr-index-data-in' type='checkbox'/><label for='index-a83d8c67-1e01-4754-b359-8c2f116e17d5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([566500.0, 565500.0, 564500.0, 563500.0, 562500.0, 561500.0, 560500.0,
       559500.0, 558500.0, 557500.0, 556500.0, 555500.0, 554500.0, 553500.0,
       552500.0, 551500.0, 550500.0],
      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-847ba8d1-b386-4f84-8420-7e12e7bbfa31' class='xr-index-data-in' type='checkbox'/><label for='index-847ba8d1-b386-4f84-8420-7e12e7bbfa31' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2009-12-31&#x27;, &#x27;2010-12-31&#x27;, &#x27;2011-12-31&#x27;, &#x27;2012-12-31&#x27;,
               &#x27;2013-12-31&#x27;, &#x27;2014-12-31&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=&#x27;YE-DEC&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-14f734eb-f700-47bd-afc9-540acec1d63e' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-14f734eb-f700-47bd-afc9-540acec1d63e' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
<br />
<br /><p>To create the final recharge for the transient simulation,
the steady state information needs to be concatenated to the transient recharge data.
The steady state simulation will be run for one second.
This is achieved by using the numpy
<a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.datetime.html">Timedelta function</a>,
first creating a time delta of 1 second, which is assigned to the steady state recharge information.
This dataset is then concatenated using the xarray function
<a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.concat.html#xarray.concat">xarray.concat</a>
to the transient information and indicating that the dimension to join is “time”.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">starttime</span> <span class="o">=</span> <span class="s2">&quot;2009-12-31&quot;</span>

<span class="c1"># Add first steady-state</span>
<span class="n">timedelta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">)</span>  <span class="c1"># 1 second duration for initial steady-state</span>
<span class="n">starttime_steady</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="n">starttime</span><span class="p">)</span> <span class="o">-</span> <span class="n">timedelta</span>
<span class="n">rch_ss</span> <span class="o">=</span> <span class="n">rch_ss</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">starttime_steady</span><span class="p">)</span>

<span class="n">rch_ss_trans</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">rch_ss</span><span class="p">,</span> <span class="n">rch_trans_yr</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="n">rch_ss_trans</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>C:\buildagent\work\4b9080cbb3354582\imod-python\examples\mf6\hondsrug.py:358: UserWarning: Converting non-nanosecond precision datetime values to nanosecond precision. This behavior can eventually be relaxed in xarray, as it is an artifact from pandas which is now beginning to support non-nanosecond precision values. This warning is caused by passing non-nanosecond np.datetime64 or np.timedelta64 values to the DataArray or Variable constructor; it can be silenced by converting the values to nanosecond precision ahead of time.
  rch_ss = rch_ss.assign_coords(time=starttime_steady)
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (y: 17, x: 27, time: 7)&gt; Size: 13kB
array([[[0.00091255, 0.00191725, 0.00175232, ..., 0.00167949,
         0.00161827, 0.00226806],
        [0.0009093 , 0.00191589, 0.0017549 , ..., 0.001689  ,
         0.00161518, 0.00225167],
        [0.00090591, 0.00191248, 0.00175632, ..., 0.00169961,
         0.00161301, 0.00223808],
        ...,
        [0.00078183, 0.00158879, 0.00160428, ..., 0.00174276,
         0.00162122, 0.00221006],
        [0.00078091, 0.00160275, 0.0016166 , ..., 0.00174685,
         0.0016207 , 0.00219559],
        [0.00078071, 0.00161772, 0.00163142, ..., 0.00175276,
         0.00162407, 0.00218172]],

       [[0.000913  , 0.00193096, 0.00175832, ..., 0.00168658,
         0.00164151, 0.0022924 ],
        [0.0009098 , 0.00193016, 0.00176321, ..., 0.00169678,
         0.00163919, 0.00227892],
        [0.0009065 , 0.0019277 , 0.00176716, ..., 0.00170842,
         0.00163841, 0.00226807],
...
        [0.00085378, 0.00177083, 0.00186831, ..., 0.00174713,
         0.00169624, 0.00224585],
        [0.00084055, 0.0017666 , 0.00185661, ..., 0.00173329,
         0.00168655, 0.00223096],
        [0.00082746, 0.00176362, 0.00184691, ..., 0.00172136,
         0.0016792 , 0.00221743]],

       [[0.00098196, 0.00204444, 0.00188612, ..., 0.00182747,
         0.0019308 , 0.00249155],
        [0.00098031, 0.002041  , 0.00189853, ..., 0.00183236,
         0.00192603, 0.00248376],
        [0.00097932, 0.00203658, 0.00191231, ..., 0.00183771,
         0.0019212 , 0.00247603],
        ...,
        [0.00086102, 0.00178251, 0.00188156, ..., 0.00175411,
         0.00170712, 0.00224736],
        [0.00084771, 0.00177807, 0.00187044, ..., 0.0017413 ,
         0.00169771, 0.00223372],
        [0.0008352 , 0.00177411, 0.00186046, ..., 0.00173005,
         0.00169032, 0.00222133]]], dtype=float32)
Coordinates:
  * x        (x) float64 216B 2.305e+05 2.315e+05 ... 2.555e+05 2.565e+05
  * y        (y) float64 136B 5.665e+05 5.655e+05 ... 5.515e+05 5.505e+05
    dx       float64 8B 1e+03
    dy       float64 8B -1e+03
  * time     (time) datetime64[ns] 56B 2009-12-30T23:59:59 ... 2014-12-31</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 17</li><li><span class='xr-has-index'>x</span>: 27</li><li><span class='xr-has-index'>time</span>: 7</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-655b9dab-aaaf-4700-a4d7-fed4944b62e8' class='xr-array-in' type='checkbox' checked><label for='section-655b9dab-aaaf-4700-a4d7-fed4944b62e8' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0009125 0.001917 0.001752 0.001906 ... 0.00173 0.00169 0.002221</span></div><div class='xr-array-data'><pre>array([[[0.00091255, 0.00191725, 0.00175232, ..., 0.00167949,
         0.00161827, 0.00226806],
        [0.0009093 , 0.00191589, 0.0017549 , ..., 0.001689  ,
         0.00161518, 0.00225167],
        [0.00090591, 0.00191248, 0.00175632, ..., 0.00169961,
         0.00161301, 0.00223808],
        ...,
        [0.00078183, 0.00158879, 0.00160428, ..., 0.00174276,
         0.00162122, 0.00221006],
        [0.00078091, 0.00160275, 0.0016166 , ..., 0.00174685,
         0.0016207 , 0.00219559],
        [0.00078071, 0.00161772, 0.00163142, ..., 0.00175276,
         0.00162407, 0.00218172]],

       [[0.000913  , 0.00193096, 0.00175832, ..., 0.00168658,
         0.00164151, 0.0022924 ],
        [0.0009098 , 0.00193016, 0.00176321, ..., 0.00169678,
         0.00163919, 0.00227892],
        [0.0009065 , 0.0019277 , 0.00176716, ..., 0.00170842,
         0.00163841, 0.00226807],
...
        [0.00085378, 0.00177083, 0.00186831, ..., 0.00174713,
         0.00169624, 0.00224585],
        [0.00084055, 0.0017666 , 0.00185661, ..., 0.00173329,
         0.00168655, 0.00223096],
        [0.00082746, 0.00176362, 0.00184691, ..., 0.00172136,
         0.0016792 , 0.00221743]],

       [[0.00098196, 0.00204444, 0.00188612, ..., 0.00182747,
         0.0019308 , 0.00249155],
        [0.00098031, 0.002041  , 0.00189853, ..., 0.00183236,
         0.00192603, 0.00248376],
        [0.00097932, 0.00203658, 0.00191231, ..., 0.00183771,
         0.0019212 , 0.00247603],
        ...,
        [0.00086102, 0.00178251, 0.00188156, ..., 0.00175411,
         0.00170712, 0.00224736],
        [0.00084771, 0.00177807, 0.00187044, ..., 0.0017413 ,
         0.00169771, 0.00223372],
        [0.0008352 , 0.00177411, 0.00186046, ..., 0.00173005,
         0.00169032, 0.00222133]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-f681049f-b98c-4c48-a8b4-577bd56ea8b6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f681049f-b98c-4c48-a8b4-577bd56ea8b6' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.305e+05 2.315e+05 ... 2.565e+05</div><input id='attrs-89fd9bd1-4068-47f1-ab96-38870e6b64c3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-89fd9bd1-4068-47f1-ab96-38870e6b64c3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-784dd156-a3ad-4d1b-b9b7-73420cdfa859' class='xr-var-data-in' type='checkbox'><label for='data-784dd156-a3ad-4d1b-b9b7-73420cdfa859' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([230500., 231500., 232500., 233500., 234500., 235500., 236500., 237500.,
       238500., 239500., 240500., 241500., 242500., 243500., 244500., 245500.,
       246500., 247500., 248500., 249500., 250500., 251500., 252500., 253500.,
       254500., 255500., 256500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.665e+05 5.655e+05 ... 5.505e+05</div><input id='attrs-9d08b152-7493-4c00-8d02-604f1b0e5ba0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9d08b152-7493-4c00-8d02-604f1b0e5ba0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-77251592-cc47-4e61-b94e-b5da8d7423e5' class='xr-var-data-in' type='checkbox'><label for='data-77251592-cc47-4e61-b94e-b5da8d7423e5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([566500., 565500., 564500., 563500., 562500., 561500., 560500., 559500.,
       558500., 557500., 556500., 555500., 554500., 553500., 552500., 551500.,
       550500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1e+03</div><input id='attrs-a9e5f634-0a5d-4f66-8ec8-efc64057d900' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a9e5f634-0a5d-4f66-8ec8-efc64057d900' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9e8687ce-ba1c-4538-95a9-e322c9e28381' class='xr-var-data-in' type='checkbox'><label for='data-9e8687ce-ba1c-4538-95a9-e322c9e28381' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1000.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1e+03</div><input id='attrs-64929dc4-389c-4e9d-b6e5-70175c6c18e3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-64929dc4-389c-4e9d-b6e5-70175c6c18e3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b2032091-a3cb-4889-a647-8945bec75671' class='xr-var-data-in' type='checkbox'><label for='data-b2032091-a3cb-4889-a647-8945bec75671' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-1000.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2009-12-30T23:59:59 ... 2014-12-31</div><input id='attrs-7b1e9ff8-dd5a-4701-b471-d903116b45f3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7b1e9ff8-dd5a-4701-b471-d903116b45f3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9b553296-b74e-4dbb-8f7e-0c625f072800' class='xr-var-data-in' type='checkbox'><label for='data-9b553296-b74e-4dbb-8f7e-0c625f072800' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2009-12-30T23:59:59.000000000&#x27;, &#x27;2009-12-31T00:00:00.000000000&#x27;,
       &#x27;2010-12-31T00:00:00.000000000&#x27;, &#x27;2011-12-31T00:00:00.000000000&#x27;,
       &#x27;2012-12-31T00:00:00.000000000&#x27;, &#x27;2013-12-31T00:00:00.000000000&#x27;,
       &#x27;2014-12-31T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8eae2eb9-c390-4285-9b7a-e847f3c1b210' class='xr-section-summary-in' type='checkbox'  ><label for='section-8eae2eb9-c390-4285-9b7a-e847f3c1b210' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-4fe0e6a4-788b-47e4-9064-a81ec596df8a' class='xr-index-data-in' type='checkbox'/><label for='index-4fe0e6a4-788b-47e4-9064-a81ec596df8a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([230500.0, 231500.0, 232500.0, 233500.0, 234500.0, 235500.0, 236500.0,
       237500.0, 238500.0, 239500.0, 240500.0, 241500.0, 242500.0, 243500.0,
       244500.0, 245500.0, 246500.0, 247500.0, 248500.0, 249500.0, 250500.0,
       251500.0, 252500.0, 253500.0, 254500.0, 255500.0, 256500.0],
      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-a54d3e4a-f245-48a6-a759-33826a3850bc' class='xr-index-data-in' type='checkbox'/><label for='index-a54d3e4a-f245-48a6-a759-33826a3850bc' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([566500.0, 565500.0, 564500.0, 563500.0, 562500.0, 561500.0, 560500.0,
       559500.0, 558500.0, 557500.0, 556500.0, 555500.0, 554500.0, 553500.0,
       552500.0, 551500.0, 550500.0],
      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-3922d5d3-9227-4df3-8571-84053f46259d' class='xr-index-data-in' type='checkbox'/><label for='index-3922d5d3-9227-4df3-8571-84053f46259d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2009-12-30 23:59:59&#x27;, &#x27;2009-12-31 00:00:00&#x27;,
               &#x27;2010-12-31 00:00:00&#x27;, &#x27;2011-12-31 00:00:00&#x27;,
               &#x27;2012-12-31 00:00:00&#x27;, &#x27;2013-12-31 00:00:00&#x27;,
               &#x27;2014-12-31 00:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1ab988f3-596e-4216-8853-9ba461ea35fe' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-1ab988f3-596e-4216-8853-9ba461ea35fe' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
<br />
<br /><p>The data obtained from KNMI has different grid dimensions
than the one considered in this example. To fix this,
imod-python includes the option
<a class="reference internal" href="../../api/generated/prepare/imod.prepare.Regridder.html"><span class="doc">imod.prepare.Regridder</span></a>,
which modifies the original grid dimensions to a different one.
It is also possible to define the regridding method such as
<code class="docutils literal notranslate"><span class="pre">nearest</span></code>, <code class="docutils literal notranslate"><span class="pre">multilinear</span></code>, <code class="docutils literal notranslate"><span class="pre">mean</span></code>, among others.
In this case, <code class="docutils literal notranslate"><span class="pre">mean</span></code> was selected and the 2d template (like_2d)
was used as reference, as this is the geometry to be considered in the model.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">rch_ss_trans</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">prepare</span><span class="o">.</span><span class="n">Regridder</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">regrid</span><span class="p">(</span><span class="n">rch_ss_trans</span><span class="p">,</span> <span class="n">like_2d</span><span class="p">)</span>
<span class="n">rch_ss_trans</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (y: 200, x: 500, time: 7)&gt; Size: 6MB
array([[[0.00089943, 0.00190719, 0.00182535, ..., 0.00179266,
         0.00169166, 0.00232221],
        [0.00089943, 0.00190719, 0.00182535, ..., 0.00179266,
         0.00169166, 0.00232221],
        [0.00089943, 0.00190719, 0.00182535, ..., 0.00179266,
         0.00169166, 0.00232221],
        ...,
        [0.00083373, 0.00163785, 0.00171206, ..., 0.00176909,
         0.00164895, 0.00231468],
        [0.00083373, 0.00163785, 0.00171206, ..., 0.00176909,
         0.00164895, 0.00231468],
        [0.00083373, 0.00163785, 0.00171206, ..., 0.00176909,
         0.00164895, 0.00231468]],

       [[0.00089943, 0.00190719, 0.00182535, ..., 0.00179266,
         0.00169166, 0.00232221],
        [0.00089943, 0.00190719, 0.00182535, ..., 0.00179266,
         0.00169166, 0.00232221],
        [0.00089943, 0.00190719, 0.00182535, ..., 0.00179266,
         0.00169166, 0.00232221],
...
        [0.00088318, 0.00169605, 0.00183059, ..., 0.00180298,
         0.00171221, 0.0023817 ],
        [0.00088318, 0.00169605, 0.00183059, ..., 0.00180298,
         0.00171221, 0.0023817 ],
        [0.00088318, 0.00169605, 0.00183059, ..., 0.00180298,
         0.00171221, 0.0023817 ]],

       [[0.00091826, 0.00198224, 0.00191962, ..., 0.00183427,
         0.00179237, 0.00242177],
        [0.00091826, 0.00198224, 0.00191962, ..., 0.00183427,
         0.00179237, 0.00242177],
        [0.00091826, 0.00198224, 0.00191962, ..., 0.00183427,
         0.00179237, 0.00242177],
        ...,
        [0.00088318, 0.00169605, 0.00183059, ..., 0.00180298,
         0.00171221, 0.0023817 ],
        [0.00088318, 0.00169605, 0.00183059, ..., 0.00180298,
         0.00171221, 0.0023817 ],
        [0.00088318, 0.00169605, 0.00183059, ..., 0.00180298,
         0.00171221, 0.0023817 ]]])
Coordinates:
  * time     (time) datetime64[ns] 56B 2009-12-30T23:59:59 ... 2014-12-31
  * y        (y) float64 2kB 5.64e+05 5.64e+05 5.639e+05 ... 5.59e+05 5.59e+05
  * x        (x) float64 4kB 2.375e+05 2.375e+05 2.376e+05 ... 2.5e+05 2.5e+05
    dx       float64 8B 25.0
    dy       float64 8B -25.0
    layer    int32 4B 1</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>x</span>: 500</li><li><span class='xr-has-index'>time</span>: 7</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-fb39109a-e4a0-4599-a90c-7810f393cddc' class='xr-array-in' type='checkbox' checked><label for='section-fb39109a-e4a0-4599-a90c-7810f393cddc' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0008994 0.001907 0.001825 0.001961 ... 0.001803 0.001712 0.002382</span></div><div class='xr-array-data'><pre>array([[[0.00089943, 0.00190719, 0.00182535, ..., 0.00179266,
         0.00169166, 0.00232221],
        [0.00089943, 0.00190719, 0.00182535, ..., 0.00179266,
         0.00169166, 0.00232221],
        [0.00089943, 0.00190719, 0.00182535, ..., 0.00179266,
         0.00169166, 0.00232221],
        ...,
        [0.00083373, 0.00163785, 0.00171206, ..., 0.00176909,
         0.00164895, 0.00231468],
        [0.00083373, 0.00163785, 0.00171206, ..., 0.00176909,
         0.00164895, 0.00231468],
        [0.00083373, 0.00163785, 0.00171206, ..., 0.00176909,
         0.00164895, 0.00231468]],

       [[0.00089943, 0.00190719, 0.00182535, ..., 0.00179266,
         0.00169166, 0.00232221],
        [0.00089943, 0.00190719, 0.00182535, ..., 0.00179266,
         0.00169166, 0.00232221],
        [0.00089943, 0.00190719, 0.00182535, ..., 0.00179266,
         0.00169166, 0.00232221],
...
        [0.00088318, 0.00169605, 0.00183059, ..., 0.00180298,
         0.00171221, 0.0023817 ],
        [0.00088318, 0.00169605, 0.00183059, ..., 0.00180298,
         0.00171221, 0.0023817 ],
        [0.00088318, 0.00169605, 0.00183059, ..., 0.00180298,
         0.00171221, 0.0023817 ]],

       [[0.00091826, 0.00198224, 0.00191962, ..., 0.00183427,
         0.00179237, 0.00242177],
        [0.00091826, 0.00198224, 0.00191962, ..., 0.00183427,
         0.00179237, 0.00242177],
        [0.00091826, 0.00198224, 0.00191962, ..., 0.00183427,
         0.00179237, 0.00242177],
        ...,
        [0.00088318, 0.00169605, 0.00183059, ..., 0.00180298,
         0.00171221, 0.0023817 ],
        [0.00088318, 0.00169605, 0.00183059, ..., 0.00180298,
         0.00171221, 0.0023817 ],
        [0.00088318, 0.00169605, 0.00183059, ..., 0.00180298,
         0.00171221, 0.0023817 ]]])</pre></div></div></li><li class='xr-section-item'><input id='section-e97c8474-3da6-4f4e-b9a5-5234e07bfe19' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e97c8474-3da6-4f4e-b9a5-5234e07bfe19' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2009-12-30T23:59:59 ... 2014-12-31</div><input id='attrs-7e8e09bd-f39b-4f8a-9833-cb3eb18ad3d2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7e8e09bd-f39b-4f8a-9833-cb3eb18ad3d2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2014bffa-14e2-44c6-bb16-07df2ce4f513' class='xr-var-data-in' type='checkbox'><label for='data-2014bffa-14e2-44c6-bb16-07df2ce4f513' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2009-12-30T23:59:59.000000000&#x27;, &#x27;2009-12-31T00:00:00.000000000&#x27;,
       &#x27;2010-12-31T00:00:00.000000000&#x27;, &#x27;2011-12-31T00:00:00.000000000&#x27;,
       &#x27;2012-12-31T00:00:00.000000000&#x27;, &#x27;2013-12-31T00:00:00.000000000&#x27;,
       &#x27;2014-12-31T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-5f237891-0eb7-4b98-a9f9-5ac4dcb316b3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5f237891-0eb7-4b98-a9f9-5ac4dcb316b3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c4cb2aba-0b92-45ca-93cc-ca54a0518929' class='xr-var-data-in' type='checkbox'><label for='data-c4cb2aba-0b92-45ca-93cc-ca54a0518929' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
       563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
       563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
       563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
       563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
       563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
       562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
       562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
       562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
       562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
       562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
       562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
       561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
       561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
       561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
       561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
       561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
       561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
       560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
       560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
       560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
       560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
       560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
       559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
       559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
       559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
       559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
       559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
       559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-941a2d7f-1c1b-4b36-a89b-faf8b12f000a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-941a2d7f-1c1b-4b36-a89b-faf8b12f000a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-94b5569e-62cb-497d-897a-6022a0dc23dd' class='xr-var-data-in' type='checkbox'><label for='data-94b5569e-62cb-497d-897a-6022a0dc23dd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>25.0</div><input id='attrs-7f8de0a6-595d-487e-a5d8-f6b66e4bf12a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7f8de0a6-595d-487e-a5d8-f6b66e4bf12a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b3af3ba8-c593-4742-bba8-55f1991a544f' class='xr-var-data-in' type='checkbox'><label for='data-b3af3ba8-c593-4742-bba8-55f1991a544f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-25.0</div><input id='attrs-955952ab-519c-4f70-8a3f-4013feb85259' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-955952ab-519c-4f70-8a3f-4013feb85259' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-80048b96-ad58-421e-859c-b12b139e5f86' class='xr-var-data-in' type='checkbox'><label for='data-80048b96-ad58-421e-859c-b12b139e5f86' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>layer</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1</div><input id='attrs-4fbf8962-c47d-43dd-844d-7cadaa3a4570' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4fbf8962-c47d-43dd-844d-7cadaa3a4570' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-28fd5c38-918a-42d3-bf21-01e828c9206c' class='xr-var-data-in' type='checkbox'><label for='data-28fd5c38-918a-42d3-bf21-01e828c9206c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1, dtype=int32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8f24cc31-5679-4e5f-b257-9f5e96b8a01e' class='xr-section-summary-in' type='checkbox'  ><label for='section-8f24cc31-5679-4e5f-b257-9f5e96b8a01e' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-5bb71904-3c38-449f-b1a2-7919a251959a' class='xr-index-data-in' type='checkbox'/><label for='index-5bb71904-3c38-449f-b1a2-7919a251959a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2009-12-30 23:59:59&#x27;, &#x27;2009-12-31 00:00:00&#x27;,
               &#x27;2010-12-31 00:00:00&#x27;, &#x27;2011-12-31 00:00:00&#x27;,
               &#x27;2012-12-31 00:00:00&#x27;, &#x27;2013-12-31 00:00:00&#x27;,
               &#x27;2014-12-31 00:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-a0452cc5-8b4e-49eb-a7dc-8420799a2c75' class='xr-index-data-in' type='checkbox'/><label for='index-a0452cc5-8b4e-49eb-a7dc-8420799a2c75' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
       563812.5, 563787.5, 563762.5,
       ...
       559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5, 559087.5,
       559062.5, 559037.5, 559012.5],
      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=200))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-b5b51039-e30e-45bc-9433-84647206d436' class='xr-index-data-in' type='checkbox'/><label for='index-b5b51039-e30e-45bc-9433-84647206d436' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([237512.5, 237537.5, 237562.5, 237587.5, 237612.5, 237637.5, 237662.5,
       237687.5, 237712.5, 237737.5,
       ...
       249762.5, 249787.5, 249812.5, 249837.5, 249862.5, 249887.5, 249912.5,
       249937.5, 249962.5, 249987.5],
      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=500))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7c88786d-0af3-4d0d-8f3d-63fec0dfd1b9' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-7c88786d-0af3-4d0d-8f3d-63fec0dfd1b9' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
<br />
<br /><p>The previously created recharge array is a 2D array
that needs to be assigned to a 3D array. This is done using the xarray
<a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.where.html#xarray.DataArray.where">DataArray.where</a>
option, where the recharge values are applied to the cells where the
idomain value is larger than zero (that is, the active cells) and for the uppermost
active cell (indicated by the minimum layer number).</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">rch_total</span> <span class="o">=</span> <span class="n">rch_ss_trans</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="n">idomain</span><span class="p">[</span><span class="s2">&quot;layer&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">idomain</span><span class="p">[</span><span class="s2">&quot;layer&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">idomain</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="s2">&quot;layer&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">rch_total</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (y: 200, x: 500, time: 7, layer: 13)&gt; Size: 73MB
array([[[[       nan,        nan, 0.00089943, ...,        nan,
                 nan,        nan],
         [       nan,        nan, 0.00190719, ...,        nan,
                 nan,        nan],
         [       nan,        nan, 0.00182535, ...,        nan,
                 nan,        nan],
         ...,
         [       nan,        nan, 0.00179266, ...,        nan,
                 nan,        nan],
         [       nan,        nan, 0.00169166, ...,        nan,
                 nan,        nan],
         [       nan,        nan, 0.00232221, ...,        nan,
                 nan,        nan]],

        [[       nan,        nan, 0.00089943, ...,        nan,
                 nan,        nan],
         [       nan,        nan, 0.00190719, ...,        nan,
                 nan,        nan],
         [       nan,        nan, 0.00182535, ...,        nan,
                 nan,        nan],
...
         [       nan,        nan, 0.00180298, ...,        nan,
                 nan,        nan],
         [       nan,        nan, 0.00171221, ...,        nan,
                 nan,        nan],
         [       nan,        nan, 0.0023817 , ...,        nan,
                 nan,        nan]],

        [[       nan,        nan, 0.00088318, ...,        nan,
                 nan,        nan],
         [       nan,        nan, 0.00169605, ...,        nan,
                 nan,        nan],
         [       nan,        nan, 0.00183059, ...,        nan,
                 nan,        nan],
         ...,
         [       nan,        nan, 0.00180298, ...,        nan,
                 nan,        nan],
         [       nan,        nan, 0.00171221, ...,        nan,
                 nan,        nan],
         [       nan,        nan, 0.0023817 , ...,        nan,
                 nan,        nan]]]])
Coordinates:
  * time     (time) datetime64[ns] 56B 2009-12-30T23:59:59 ... 2014-12-31
  * y        (y) float64 2kB 5.64e+05 5.64e+05 5.639e+05 ... 5.59e+05 5.59e+05
  * x        (x) float64 4kB 2.375e+05 2.375e+05 2.376e+05 ... 2.5e+05 2.5e+05
    dx       float64 8B 25.0
    dy       float64 8B -25.0
  * layer    (layer) int32 52B 1 2 3 4 5 6 7 8 9 10 11 12 13</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>x</span>: 500</li><li><span class='xr-has-index'>time</span>: 7</li><li><span class='xr-has-index'>layer</span>: 13</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-172e75cc-9c51-4334-9980-e6d1e1bfbcc3' class='xr-array-in' type='checkbox' checked><label for='section-172e75cc-9c51-4334-9980-e6d1e1bfbcc3' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>nan nan 0.0008994 nan nan nan nan nan ... nan nan nan nan nan nan nan</span></div><div class='xr-array-data'><pre>array([[[[       nan,        nan, 0.00089943, ...,        nan,
                 nan,        nan],
         [       nan,        nan, 0.00190719, ...,        nan,
                 nan,        nan],
         [       nan,        nan, 0.00182535, ...,        nan,
                 nan,        nan],
         ...,
         [       nan,        nan, 0.00179266, ...,        nan,
                 nan,        nan],
         [       nan,        nan, 0.00169166, ...,        nan,
                 nan,        nan],
         [       nan,        nan, 0.00232221, ...,        nan,
                 nan,        nan]],

        [[       nan,        nan, 0.00089943, ...,        nan,
                 nan,        nan],
         [       nan,        nan, 0.00190719, ...,        nan,
                 nan,        nan],
         [       nan,        nan, 0.00182535, ...,        nan,
                 nan,        nan],
...
         [       nan,        nan, 0.00180298, ...,        nan,
                 nan,        nan],
         [       nan,        nan, 0.00171221, ...,        nan,
                 nan,        nan],
         [       nan,        nan, 0.0023817 , ...,        nan,
                 nan,        nan]],

        [[       nan,        nan, 0.00088318, ...,        nan,
                 nan,        nan],
         [       nan,        nan, 0.00169605, ...,        nan,
                 nan,        nan],
         [       nan,        nan, 0.00183059, ...,        nan,
                 nan,        nan],
         ...,
         [       nan,        nan, 0.00180298, ...,        nan,
                 nan,        nan],
         [       nan,        nan, 0.00171221, ...,        nan,
                 nan,        nan],
         [       nan,        nan, 0.0023817 , ...,        nan,
                 nan,        nan]]]])</pre></div></div></li><li class='xr-section-item'><input id='section-02121166-b22a-407d-b460-1e979016f120' class='xr-section-summary-in' type='checkbox'  checked><label for='section-02121166-b22a-407d-b460-1e979016f120' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2009-12-30T23:59:59 ... 2014-12-31</div><input id='attrs-40c343c6-eb17-42f9-bba2-b9babdf4d016' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-40c343c6-eb17-42f9-bba2-b9babdf4d016' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a8f731db-4f58-4fed-ba79-f1b4289cc3c1' class='xr-var-data-in' type='checkbox'><label for='data-a8f731db-4f58-4fed-ba79-f1b4289cc3c1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2009-12-30T23:59:59.000000000&#x27;, &#x27;2009-12-31T00:00:00.000000000&#x27;,
       &#x27;2010-12-31T00:00:00.000000000&#x27;, &#x27;2011-12-31T00:00:00.000000000&#x27;,
       &#x27;2012-12-31T00:00:00.000000000&#x27;, &#x27;2013-12-31T00:00:00.000000000&#x27;,
       &#x27;2014-12-31T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-3f98d231-de29-47d3-a2fd-5b309558235a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3f98d231-de29-47d3-a2fd-5b309558235a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c8a2d563-7c99-417e-8d99-0ec3cf23f895' class='xr-var-data-in' type='checkbox'><label for='data-c8a2d563-7c99-417e-8d99-0ec3cf23f895' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
       563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
       563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
       563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
       563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
       563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
       562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
       562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
       562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
       562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
       562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
       562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
       561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
       561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
       561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
       561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
       561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
       561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
       560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
       560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
       560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
       560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
       560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
       559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
       559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
       559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
       559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
       559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
       559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-6866019b-e294-4556-9e54-12c52afabfb4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6866019b-e294-4556-9e54-12c52afabfb4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ad79e830-7bda-44a3-8f9c-1edb262b1f3c' class='xr-var-data-in' type='checkbox'><label for='data-ad79e830-7bda-44a3-8f9c-1edb262b1f3c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>25.0</div><input id='attrs-fa89eee4-a825-4873-81c1-831d6422224f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fa89eee4-a825-4873-81c1-831d6422224f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-634ff640-622a-4042-bf43-a998658cedfb' class='xr-var-data-in' type='checkbox'><label for='data-634ff640-622a-4042-bf43-a998658cedfb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-25.0</div><input id='attrs-f640520b-1258-43ec-9f6d-0a0cd5ccbce0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f640520b-1258-43ec-9f6d-0a0cd5ccbce0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-36082bcb-72e8-4b45-aa8a-38a108bda241' class='xr-var-data-in' type='checkbox'><label for='data-36082bcb-72e8-4b45-aa8a-38a108bda241' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-25.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12 13</div><input id='attrs-e8ff2aac-4b24-48fa-ad71-d82efc9abe81' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e8ff2aac-4b24-48fa-ad71-d82efc9abe81' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d3562711-ac0d-4012-af74-68347abfcc71' class='xr-var-data-in' type='checkbox'><label for='data-d3562711-ac0d-4012-af74-68347abfcc71' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13], dtype=int32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c2f90f3b-b45f-4a00-abe5-41501dc7a3f5' class='xr-section-summary-in' type='checkbox'  ><label for='section-c2f90f3b-b45f-4a00-abe5-41501dc7a3f5' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-15efa612-f51c-4c0b-b89c-5d7b332ef566' class='xr-index-data-in' type='checkbox'/><label for='index-15efa612-f51c-4c0b-b89c-5d7b332ef566' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2009-12-30 23:59:59&#x27;, &#x27;2009-12-31 00:00:00&#x27;,
               &#x27;2010-12-31 00:00:00&#x27;, &#x27;2011-12-31 00:00:00&#x27;,
               &#x27;2012-12-31 00:00:00&#x27;, &#x27;2013-12-31 00:00:00&#x27;,
               &#x27;2014-12-31 00:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-e2d90bc1-528c-492b-94a0-0f52481bb27a' class='xr-index-data-in' type='checkbox'/><label for='index-e2d90bc1-528c-492b-94a0-0f52481bb27a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
       563812.5, 563787.5, 563762.5,
       ...
       559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5, 559087.5,
       559062.5, 559037.5, 559012.5],
      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=200))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-5ffcc7c7-019a-4634-9ccc-e31b80a19495' class='xr-index-data-in' type='checkbox'/><label for='index-5ffcc7c7-019a-4634-9ccc-e31b80a19495' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([237512.5, 237537.5, 237562.5, 237587.5, 237612.5, 237637.5, 237662.5,
       237687.5, 237712.5, 237737.5,
       ...
       249762.5, 249787.5, 249812.5, 249837.5, 249862.5, 249887.5, 249912.5,
       249937.5, 249962.5, 249987.5],
      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=500))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>layer</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-88ab4102-0026-4705-887f-76d9a0963453' class='xr-index-data-in' type='checkbox'/><label for='index-88ab4102-0026-4705-887f-76d9a0963453' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], dtype=&#x27;int32&#x27;, name=&#x27;layer&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1d70fddc-98ba-4dd8-80fd-802f3335c63b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-1d70fddc-98ba-4dd8-80fd-802f3335c63b' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
<br />
<br /><p>Finally, transposing the array dimensions using
<a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.transpose.html#xarray.DataArray.transpose">DataArray.transpose</a>
so they are in the correct order.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">rch_total</span> <span class="o">=</span> <span class="n">rch_total</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;layer&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">rch_total</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">rch_total</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">layer</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_hondsrug_006.png" srcset="../../_images/sphx_glr_hondsrug_006.png" alt="time = 2014-12-31, dx = 25.0, dy = -25.0, layer..." class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage object at 0x0000017F843026D0&gt;
</pre></div>
</div>
</section>
<section id="adding-information-to-the-rch-package">
<h2>Adding information to the RCH package<a class="headerlink" href="#adding-information-to-the-rch-package" title="Link to this heading">#</a></h2>
<p>The information for the RCH package is added with the function
<a class="reference internal" href="../../api/generated/mf6/imod.mf6.Recharge.html"><span class="doc">imod.mf6.Recharge</span></a>.
It is required to insert the recharge flux rate, and it is optional
to include the print_input, print_flows and save_flows information.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gwf_model</span><span class="p">[</span><span class="s2">&quot;rch&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">Recharge</span><span class="p">(</span><span class="n">rch_total</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="drainage-package-drn">
<h1>Drainage package - DRN<a class="headerlink" href="#drainage-package-drn" title="Link to this heading">#</a></h1>
<p>The drain package is used to simulate features that remove water from the aquifer,
such as agricultural drains or springs.
This occurs at a rate proportional to the head difference between the head in the
aquifer and the drain elevation
(the head in the aquifer has to be above that elevation).
The conductance is the proportionality constant.</p>
<section id="import-drainage-information">
<h2>Import drainage information<a class="headerlink" href="#import-drainage-information" title="Link to this heading">#</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">drainage</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">hondsrug_drainage</span><span class="p">()</span>

<span class="n">pipe_cond</span> <span class="o">=</span> <span class="n">drainage</span><span class="p">[</span><span class="s2">&quot;conductance&quot;</span><span class="p">]</span>
<span class="n">pipe_elev</span> <span class="o">=</span> <span class="n">drainage</span><span class="p">[</span><span class="s2">&quot;elevation&quot;</span><span class="p">]</span>

<span class="n">pipe_cond</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;conductance&#x27; (layer: 4, y: 200, x: 500)&gt; Size: 2MB
[400000 values with dtype=float32]
Coordinates:
  * x        (x) float64 4kB 2.375e+05 2.375e+05 2.376e+05 ... 2.5e+05 2.5e+05
  * y        (y) float64 2kB 5.64e+05 5.64e+05 5.639e+05 ... 5.59e+05 5.59e+05
    dx       float64 8B ...
    dy       float64 8B ...
  * layer    (layer) int32 16B 1 3 5 6</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'conductance'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>layer</span>: 4</li><li><span class='xr-has-index'>y</span>: 200</li><li><span class='xr-has-index'>x</span>: 500</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-438ddf53-eec4-472b-a606-db5933c6bb65' class='xr-array-in' type='checkbox' checked><label for='section-438ddf53-eec4-472b-a606-db5933c6bb65' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>...</span></div><div class='xr-array-data'><pre>[400000 values with dtype=float32]</pre></div></div></li><li class='xr-section-item'><input id='section-8944d369-e322-4e6f-9fd9-7d4b5e0c9f0a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8944d369-e322-4e6f-9fd9-7d4b5e0c9f0a' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.375e+05 2.375e+05 ... 2.5e+05</div><input id='attrs-c6d47f4f-347e-42a9-8924-f848f07a95c7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c6d47f4f-347e-42a9-8924-f848f07a95c7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a780f238-32ad-44b8-8abc-0d5b170864ac' class='xr-var-data-in' type='checkbox'><label for='data-a780f238-32ad-44b8-8abc-0d5b170864ac' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([237512.5, 237537.5, 237562.5, ..., 249937.5, 249962.5, 249987.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.64e+05 5.64e+05 ... 5.59e+05</div><input id='attrs-e3024baa-105f-4269-ad8c-7a3f0e2736e8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e3024baa-105f-4269-ad8c-7a3f0e2736e8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bd61634e-b669-47f8-a03b-401b69eef9be' class='xr-var-data-in' type='checkbox'><label for='data-bd61634e-b669-47f8-a03b-401b69eef9be' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
       563812.5, 563787.5, 563762.5, 563737.5, 563712.5, 563687.5, 563662.5,
       563637.5, 563612.5, 563587.5, 563562.5, 563537.5, 563512.5, 563487.5,
       563462.5, 563437.5, 563412.5, 563387.5, 563362.5, 563337.5, 563312.5,
       563287.5, 563262.5, 563237.5, 563212.5, 563187.5, 563162.5, 563137.5,
       563112.5, 563087.5, 563062.5, 563037.5, 563012.5, 562987.5, 562962.5,
       562937.5, 562912.5, 562887.5, 562862.5, 562837.5, 562812.5, 562787.5,
       562762.5, 562737.5, 562712.5, 562687.5, 562662.5, 562637.5, 562612.5,
       562587.5, 562562.5, 562537.5, 562512.5, 562487.5, 562462.5, 562437.5,
       562412.5, 562387.5, 562362.5, 562337.5, 562312.5, 562287.5, 562262.5,
       562237.5, 562212.5, 562187.5, 562162.5, 562137.5, 562112.5, 562087.5,
       562062.5, 562037.5, 562012.5, 561987.5, 561962.5, 561937.5, 561912.5,
       561887.5, 561862.5, 561837.5, 561812.5, 561787.5, 561762.5, 561737.5,
       561712.5, 561687.5, 561662.5, 561637.5, 561612.5, 561587.5, 561562.5,
       561537.5, 561512.5, 561487.5, 561462.5, 561437.5, 561412.5, 561387.5,
       561362.5, 561337.5, 561312.5, 561287.5, 561262.5, 561237.5, 561212.5,
       561187.5, 561162.5, 561137.5, 561112.5, 561087.5, 561062.5, 561037.5,
       561012.5, 560987.5, 560962.5, 560937.5, 560912.5, 560887.5, 560862.5,
       560837.5, 560812.5, 560787.5, 560762.5, 560737.5, 560712.5, 560687.5,
       560662.5, 560637.5, 560612.5, 560587.5, 560562.5, 560537.5, 560512.5,
       560487.5, 560462.5, 560437.5, 560412.5, 560387.5, 560362.5, 560337.5,
       560312.5, 560287.5, 560262.5, 560237.5, 560212.5, 560187.5, 560162.5,
       560137.5, 560112.5, 560087.5, 560062.5, 560037.5, 560012.5, 559987.5,
       559962.5, 559937.5, 559912.5, 559887.5, 559862.5, 559837.5, 559812.5,
       559787.5, 559762.5, 559737.5, 559712.5, 559687.5, 559662.5, 559637.5,
       559612.5, 559587.5, 559562.5, 559537.5, 559512.5, 559487.5, 559462.5,
       559437.5, 559412.5, 559387.5, 559362.5, 559337.5, 559312.5, 559287.5,
       559262.5, 559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5,
       559087.5, 559062.5, 559037.5, 559012.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dx</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-ca3a2906-b9fc-490c-a09c-5b9d3078504a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ca3a2906-b9fc-490c-a09c-5b9d3078504a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4c268fa0-7a5b-457d-9f94-7784250a28c1' class='xr-var-data-in' type='checkbox'><label for='data-4c268fa0-7a5b-457d-9f94-7784250a28c1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dy</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-153d5e63-2d35-4cab-9b1c-530533f24bcb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-153d5e63-2d35-4cab-9b1c-530533f24bcb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-910a395f-1840-4f62-9566-0853aa8524ed' class='xr-var-data-in' type='checkbox'><label for='data-910a395f-1840-4f62-9566-0853aa8524ed' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>layer</span></div><div class='xr-var-dims'>(layer)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 3 5 6</div><input id='attrs-d4bd9d9e-d711-4522-b741-e1dc3b42b4ed' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d4bd9d9e-d711-4522-b741-e1dc3b42b4ed' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ddd38df1-099b-4589-bed8-8df035c1e1d7' class='xr-var-data-in' type='checkbox'><label for='data-ddd38df1-099b-4589-bed8-8df035c1e1d7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1, 3, 5, 6], dtype=int32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-058ec9fd-ecd9-46c9-9001-66af6bb2e453' class='xr-section-summary-in' type='checkbox'  ><label for='section-058ec9fd-ecd9-46c9-9001-66af6bb2e453' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-5d3b87ae-e2fa-4321-8869-9329c3e10b11' class='xr-index-data-in' type='checkbox'/><label for='index-5d3b87ae-e2fa-4321-8869-9329c3e10b11' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([237512.5, 237537.5, 237562.5, 237587.5, 237612.5, 237637.5, 237662.5,
       237687.5, 237712.5, 237737.5,
       ...
       249762.5, 249787.5, 249812.5, 249837.5, 249862.5, 249887.5, 249912.5,
       249937.5, 249962.5, 249987.5],
      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=500))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-ca151bc3-3983-4163-addc-99f8c6069ee1' class='xr-index-data-in' type='checkbox'/><label for='index-ca151bc3-3983-4163-addc-99f8c6069ee1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([563987.5, 563962.5, 563937.5, 563912.5, 563887.5, 563862.5, 563837.5,
       563812.5, 563787.5, 563762.5,
       ...
       559237.5, 559212.5, 559187.5, 559162.5, 559137.5, 559112.5, 559087.5,
       559062.5, 559037.5, 559012.5],
      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=200))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>layer</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-f0656352-488d-4979-90d6-8f345c85b5e6' class='xr-index-data-in' type='checkbox'/><label for='index-f0656352-488d-4979-90d6-8f345c85b5e6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 3, 5, 6], dtype=&#x27;int32&#x27;, name=&#x27;layer&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-fbbd36e6-9051-4a38-92b2-82306e2b3928' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-fbbd36e6-9051-4a38-92b2-82306e2b3928' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
<br />
<br /></section>
<section id="adding-information-to-the-drn-package">
<h2>Adding information to the DRN package<a class="headerlink" href="#adding-information-to-the-drn-package" title="Link to this heading">#</a></h2>
<p>To add the information to the DRN package within the gwf_model variable, the
<a class="reference internal" href="../../api/generated/mf6/imod.mf6.Drainage.html"><span class="doc">imod.mf6.Drainage</span></a>.
function is used. It is required to add the previously created arrays for
the drain elevation and the drain conductance.
It is optional to insert the information for
<code class="docutils literal notranslate"><span class="pre">print_input</span></code>, <code class="docutils literal notranslate"><span class="pre">print_flows</span></code> and <code class="docutils literal notranslate"><span class="pre">save_flows</span></code>
which are set to False by default.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gwf_model</span><span class="p">[</span><span class="s2">&quot;drn-pipe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">Drainage</span><span class="p">(</span><span class="n">conductance</span><span class="o">=</span><span class="n">pipe_cond</span><span class="p">,</span> <span class="n">elevation</span><span class="o">=</span><span class="n">pipe_elev</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="river-package-riv">
<h1>River package - RIV<a class="headerlink" href="#river-package-riv" title="Link to this heading">#</a></h1>
<p>This package simulates the effects of flow between
surface-water features and groundwater systems.</p>
<section id="import-river-information">
<h2>Import river information<a class="headerlink" href="#import-river-information" title="Link to this heading">#</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">river</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">hondsrug_river</span><span class="p">()</span>
<span class="n">riv_cond</span> <span class="o">=</span> <span class="n">river</span><span class="p">[</span><span class="s2">&quot;conductance&quot;</span><span class="p">]</span>
<span class="n">riv_stage</span> <span class="o">=</span> <span class="n">river</span><span class="p">[</span><span class="s2">&quot;stage&quot;</span><span class="p">]</span>
<span class="n">riv_bot</span> <span class="o">=</span> <span class="n">river</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="adding-information-to-the-riv-package">
<h2>Adding information to the RIV package<a class="headerlink" href="#adding-information-to-the-riv-package" title="Link to this heading">#</a></h2>
<p>The data is assigned to the gwf_model variable by using
<a class="reference internal" href="../../api/generated/mf6/imod.mf6.River.html"><span class="doc">imod.mf6.River</span></a>,
based on the previously imported conductance, stage and bottom arrays.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gwf_model</span><span class="p">[</span><span class="s2">&quot;riv&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">River</span><span class="p">(</span>
    <span class="n">conductance</span><span class="o">=</span><span class="n">riv_cond</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">riv_stage</span><span class="p">,</span> <span class="n">bottom_elevation</span><span class="o">=</span><span class="n">riv_bot</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="storage-package-sto">
<h1>Storage package - STO<a class="headerlink" href="#storage-package-sto" title="Link to this heading">#</a></h1>
<p>When the STO Package is included in a model, storage changes
will be calculated, and thus, the model will be transient.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">ss</span> <span class="o">=</span> <span class="mf">0.0003</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">])</span>
<span class="n">sy</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
    <span class="p">[</span><span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.14</span><span class="p">,</span> <span class="mf">0.14</span><span class="p">,</span> <span class="mf">0.14</span><span class="p">,</span> <span class="mf">0.14</span><span class="p">,</span> <span class="mf">0.14</span><span class="p">],</span>
    <span class="p">{</span><span class="s2">&quot;layer&quot;</span><span class="p">:</span> <span class="n">layer</span><span class="p">},</span>
    <span class="p">(</span><span class="s2">&quot;layer&quot;</span><span class="p">,),</span>
<span class="p">)</span>
<span class="n">times_sto</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="s2">&quot;2009-12-30T23:59:59.00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2009-12-31T00:00:00.00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2010-12-31T00:00:00.00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2011-12-31T00:00:00.00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2012-12-31T00:00:00.00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2013-12-31T00:00:00.00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2014-12-31T00:00:00.00&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;datetime64[ns]&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">transient</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
    <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">times_sto</span><span class="p">},</span> <span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,)</span>
<span class="p">)</span>
</pre></div>
</div>
<section id="adding-information-to-the-sto-package">
<h2>Adding information to the STO package<a class="headerlink" href="#adding-information-to-the-sto-package" title="Link to this heading">#</a></h2>
<p>The data is assigned to the gwf_model variable by using
<a class="reference internal" href="../../api/generated/mf6/imod.mf6.SpecificStorage.html"><span class="doc">imod.mf6.SpecificStorage</span></a>.
It is necessary to indicate the values of specific storage,
specific yield and if the layers are convertible.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gwf_model</span><span class="p">[</span><span class="s2">&quot;sto&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">SpecificStorage</span><span class="p">(</span>
    <span class="n">specific_storage</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span>
    <span class="n">specific_yield</span><span class="o">=</span><span class="n">sy</span><span class="p">,</span>
    <span class="n">transient</span><span class="o">=</span><span class="n">transient</span><span class="p">,</span>
    <span class="n">convertible</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">save_flows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="output-control-package-oc">
<h1>Output Control package - OC<a class="headerlink" href="#output-control-package-oc" title="Link to this heading">#</a></h1>
<p>This package determines how and when heads are printed to the
listing file and/or written to a separate binary output file</p>
<section id="adding-information-to-the-oc-package">
<h2>Adding information to the OC package<a class="headerlink" href="#adding-information-to-the-oc-package" title="Link to this heading">#</a></h2>
<p>The function
<a class="reference internal" href="../../api/generated/mf6/imod.mf6.OutputControl.html"><span class="doc">imod.mf6.OutputControl</span></a>
is used to store the information for this package.
It is possible to indicate if the heads and budget information is saved
at the end of each stress period (<code class="docutils literal notranslate"><span class="pre">last</span></code>),
for all timesteps a stress period (<code class="docutils literal notranslate"><span class="pre">all</span></code>),
or at the start of a stress period (<code class="docutils literal notranslate"><span class="pre">first</span></code>)</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gwf_model</span><span class="p">[</span><span class="s2">&quot;oc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">OutputControl</span><span class="p">(</span><span class="n">save_head</span><span class="o">=</span><span class="s2">&quot;last&quot;</span><span class="p">,</span> <span class="n">save_budget</span><span class="o">=</span><span class="s2">&quot;last&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="model-simulation">
<h1>Model simulation<a class="headerlink" href="#model-simulation" title="Link to this heading">#</a></h1>
<p>In MODFLOW 6, the concept of “model” is that part of the program
that solves a hydrologic process. MODFLOW 6 documentation supports
one type of model: the GWF Model.
It is possible within the MODFLOW 6 framewotk to solve multiple,
tightly coupled, numerical models in a single system of equation,
which may be multiple models of the same type or of different types.</p>
<p>The previously created gwf_model variable now contains
the information from all the variables.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gwf_model</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>GroundwaterFlowModel(
    listing_file=None,
    print_input=False,
    print_flows=False,
    save_flows=False,
    newton=False,
    under_relaxation=False,
){
    &#39;dis&#39;: StructuredDiscretization,
    &#39;npf&#39;: NodePropertyFlow,
    &#39;ic&#39;: InitialConditions,
    &#39;chd&#39;: ConstantHead,
    &#39;rch&#39;: Recharge,
    &#39;drn-pipe&#39;: Drainage,
    &#39;riv&#39;: River,
    &#39;sto&#39;: SpecificStorage,
    &#39;oc&#39;: OutputControl,
}
</pre></div>
</div>
<section id="attach-the-model-information-to-a-simulation">
<h2>Attach the model information to a simulation<a class="headerlink" href="#attach-the-model-information-to-a-simulation" title="Link to this heading">#</a></h2>
<p>The function
<a class="reference internal" href="../../api/generated/mf6/imod.mf6.Modflow6Simulation.html"><span class="doc">imod.mf6.Modflow6Simulation</span></a>
allows to assign models to a simulation (in this case, the gwf_model).</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">simulation</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">Modflow6Simulation</span><span class="p">(</span><span class="s2">&quot;mf6-mipwa2-example&quot;</span><span class="p">)</span>
<span class="n">simulation</span><span class="p">[</span><span class="s2">&quot;GWF_1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gwf_model</span>
</pre></div>
</div>
</section>
<section id="solver-settings">
<h2>Solver settings<a class="headerlink" href="#solver-settings" title="Link to this heading">#</a></h2>
<p>The solver settings are indicated using
<a class="reference internal" href="../../api/generated/mf6/imod.mf6.Solution.html"><span class="doc">imod.mf6.Solution</span></a>.
If the values are not indicated manually, the defaults values will be considered.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">simulation</span><span class="p">[</span><span class="s2">&quot;solver&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span>
    <span class="n">modelnames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GWF_1&quot;</span><span class="p">],</span>
    <span class="n">print_option</span><span class="o">=</span><span class="s2">&quot;summary&quot;</span><span class="p">,</span>
    <span class="n">outer_dvclose</span><span class="o">=</span><span class="mf">1.0e-4</span><span class="p">,</span>
    <span class="n">outer_maximum</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">under_relaxation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">inner_dvclose</span><span class="o">=</span><span class="mf">1.0e-4</span><span class="p">,</span>
    <span class="n">inner_rclose</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
    <span class="n">inner_maximum</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">linear_acceleration</span><span class="o">=</span><span class="s2">&quot;cg&quot;</span><span class="p">,</span>
    <span class="n">scaling_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">reordering_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">relaxation_factor</span><span class="o">=</span><span class="mf">0.97</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="assign-time-discretization">
<h2>Assign time discretization<a class="headerlink" href="#assign-time-discretization" title="Link to this heading">#</a></h2>
<p>The time discretization of this model is 6 years.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">simulation</span><span class="o">.</span><span class="n">create_time_discretization</span><span class="p">(</span>
    <span class="n">additional_times</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;2009-12-30T23:59:59.000000000&quot;</span><span class="p">,</span> <span class="s2">&quot;2015-12-31T00:00:00.000000000&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="run-the-model">
<h2>Run the model<a class="headerlink" href="#run-the-model" title="Link to this heading">#</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following lines assume the <code class="docutils literal notranslate"><span class="pre">mf6</span></code> executable is available on your PATH.
<a class="reference internal" href="index.html#mf6-introduction"><span class="std std-ref">The Modflow 6 examples introduction</span></a> shortly
describes how to add it to yours.</p>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">modeldir</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">temporary_directory</span><span class="p">()</span>
<span class="n">simulation</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">modeldir</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">simulation</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="results-visualization">
<h1>Results visualization<a class="headerlink" href="#results-visualization" title="Link to this heading">#</a></h1>
<p>The next section indicated how to visualize the model results.</p>
<section id="import-heads-results">
<h2>Import heads results<a class="headerlink" href="#import-heads-results" title="Link to this heading">#</a></h2>
<p>The heads results are imported using
<a class="reference internal" href="../../api/generated/mf6/imod.mf6.open_hds.html"><span class="doc">imod.mf6.open_hds</span></a>.
on the background.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">hds</span> <span class="o">=</span> <span class="n">simulation</span><span class="o">.</span><span class="n">open_head</span><span class="p">()</span>
</pre></div>
</div>
<p>We can plot the data of an individual layer as follows</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">hds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">layer</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_hondsrug_007.png" srcset="../../_images/sphx_glr_hondsrug_007.png" alt="dx = 25.0, dy = -25.0, layer = 3, time = 1.096e+03" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh object at 0x0000017F8ACDA850&gt;
</pre></div>
</div>
<p>As you can see layer 3 has some missing cells in the west
Whereas layer 4 only contains active cells in the
eastern peatland area</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">hds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">layer</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_hondsrug_008.png" srcset="../../_images/sphx_glr_hondsrug_008.png" alt="dx = 25.0, dy = -25.0, layer = 4, time = 1.096e+03" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh object at 0x0000017F83598390&gt;
</pre></div>
</div>
<p>Layer 5 contains more data towards the west,
but has no active cells in the centre.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">hds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">layer</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_hondsrug_009.png" srcset="../../_images/sphx_glr_hondsrug_009.png" alt="dx = 25.0, dy = -25.0, layer = 5, time = 1.096e+03" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh object at 0x0000017F893000D0&gt;
</pre></div>
</div>
<p>As you can see the data is individual layers
have lots of inactive in different places.</p>
<p>It is difficult for this model to get a good idea
what is happening across the area based on 1 layer alone.
Luckily xarray allows us to compute the mean across a selection
of layers and plot this.</p>
<p>By first selecting 3 layers with <code class="docutils literal notranslate"><span class="pre">sel`</span></code>,
and then computing the mean across the layer dimension
with <code class="docutils literal notranslate"><span class="pre">mean(dim=&quot;layer&quot;)</span></code>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">hds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">layer</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;layer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_hondsrug_010.png" srcset="../../_images/sphx_glr_hondsrug_010.png" alt="dx = 25.0, dy = -25.0, time = 1.096e+03" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh object at 0x0000017F8A47E190&gt;
</pre></div>
</div>
</section>
<section id="assign-dates-to-head">
<h2>Assign dates to head<a class="headerlink" href="#assign-dates-to-head" title="Link to this heading">#</a></h2>
<p>MODFLOW6 has no concept of a calendar, so the output is not labelled only
in terms of “time since start” in floating point numbers. For this model
the time unit is days and we can assign a date coordinate as follows:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">starttime</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;2000-01-01&quot;</span><span class="p">)</span>
<span class="n">timedelta</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">hds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span> <span class="s2">&quot;D&quot;</span><span class="p">)</span>
<span class="n">hds</span> <span class="o">=</span> <span class="n">hds</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">starttime</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="extract-head-at-points">
<h2>Extract head at points<a class="headerlink" href="#extract-head-at-points" title="Link to this heading">#</a></h2>
<p>A typical operation is to extract simulated heads at point locations to
compare them with measurements. In this example, we select the heads at
two points:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">240_000.0</span><span class="p">,</span> <span class="mf">244_000.0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mf">560_000.0</span><span class="p">,</span> <span class="mf">562_000.0</span><span class="p">]</span>
<span class="n">selection</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">points_values</span><span class="p">(</span><span class="n">hds</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>The result can be converted into a pandas dataframe for timeseries analysis,
or written to a variety of tabular file formats.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">dataframe</span> <span class="o">=</span> <span class="n">selection</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">dataframe</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;id&quot;</span><span class="p">})</span>
<span class="n">dataframe</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>layer</th>
      <th>id</th>
      <th>x</th>
      <th>y</th>
      <th>dx</th>
      <th>dy</th>
      <th>head</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-01-01 00:00:01.000000002</td>
      <td>1</td>
      <td>0</td>
      <td>240012.5</td>
      <td>560012.5</td>
      <td>25.0</td>
      <td>-25.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-01-01 00:00:01.000000002</td>
      <td>1</td>
      <td>1</td>
      <td>244012.5</td>
      <td>562012.5</td>
      <td>25.0</td>
      <td>-25.0</td>
      <td>10.534013</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-01-01 00:00:01.000000002</td>
      <td>2</td>
      <td>0</td>
      <td>240012.5</td>
      <td>560012.5</td>
      <td>25.0</td>
      <td>-25.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-01-01 00:00:01.000000002</td>
      <td>2</td>
      <td>1</td>
      <td>244012.5</td>
      <td>562012.5</td>
      <td>25.0</td>
      <td>-25.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000-01-01 00:00:01.000000002</td>
      <td>3</td>
      <td>0</td>
      <td>240012.5</td>
      <td>560012.5</td>
      <td>25.0</td>
      <td>-25.0</td>
      <td>7.682111</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>177</th>
      <td>2005-12-31 00:00:01.000000002</td>
      <td>11</td>
      <td>1</td>
      <td>244012.5</td>
      <td>562012.5</td>
      <td>25.0</td>
      <td>-25.0</td>
      <td>4.787419</td>
    </tr>
    <tr>
      <th>178</th>
      <td>2005-12-31 00:00:01.000000002</td>
      <td>12</td>
      <td>0</td>
      <td>240012.5</td>
      <td>560012.5</td>
      <td>25.0</td>
      <td>-25.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>179</th>
      <td>2005-12-31 00:00:01.000000002</td>
      <td>12</td>
      <td>1</td>
      <td>244012.5</td>
      <td>562012.5</td>
      <td>25.0</td>
      <td>-25.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>180</th>
      <td>2005-12-31 00:00:01.000000002</td>
      <td>13</td>
      <td>0</td>
      <td>240012.5</td>
      <td>560012.5</td>
      <td>25.0</td>
      <td>-25.0</td>
      <td>7.498579</td>
    </tr>
    <tr>
      <th>181</th>
      <td>2005-12-31 00:00:01.000000002</td>
      <td>13</td>
      <td>1</td>
      <td>244012.5</td>
      <td>562012.5</td>
      <td>25.0</td>
      <td>-25.0</td>
      <td>4.787407</td>
    </tr>
  </tbody>
</table>
<p>182 rows × 8 columns</p>
</div>
</div>
<br />
<br /><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (2 minutes 30.319 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-mf6-hondsrug-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/f30714847fcf8c1c100982bffead0b02/hondsrug.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">hondsrug.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/c995abddfc68049a002f557d87972684/hondsrug.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">hondsrug.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/84d23090e46a2c15b82b906e7aeaa319/hondsrug.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">hondsrug.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="example_models.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Example models</p>
      </div>
    </a>
    <a class="right-next"
       href="hondsrug_partitioning.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Partitioning a regional model</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Regional model</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data">Load data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-information-to-the-dis-package">Adding information to the DIS package</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#node-property-flow-package-npf">Node property flow package - NPF</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hydraulic-conductivity">Hydraulic conductivity</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#icelltype">icelltype</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-information-to-the-npf-package">Adding information to the NPF package</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-conditions-package-ic">Initial conditions package - IC</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#starting-heads-interpolation">Starting heads interpolation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-information-to-the-ic-package">Adding information to the IC package</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#constant-head-package-chd">Constant head package - CHD</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constant-head-edge">Constant head edge</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-information-to-the-chd-package">Adding information to the CHD package</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#recharge">Recharge</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recharge-steady-state">Recharge - Steady state</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recharge-transient">Recharge - Transient</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-information-to-the-rch-package">Adding information to the RCH package</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#drainage-package-drn">Drainage package - DRN</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-drainage-information">Import drainage information</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-information-to-the-drn-package">Adding information to the DRN package</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#river-package-riv">River package - RIV</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-river-information">Import river information</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-information-to-the-riv-package">Adding information to the RIV package</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#storage-package-sto">Storage package - STO</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-information-to-the-sto-package">Adding information to the STO package</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#output-control-package-oc">Output Control package - OC</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-information-to-the-oc-package">Adding information to the OC package</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#model-simulation">Model simulation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#attach-the-model-information-to-a-simulation">Attach the model information to a simulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solver-settings">Solver settings</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assign-time-discretization">Assign time discretization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-model">Run the model</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#results-visualization">Results visualization</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-heads-results">Import heads results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assign-dates-to-head">Assign dates to head</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-head-at-points">Extract head at points</a></li>
</ul>
</li>
</ul>

  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/examples/mf6/hondsrug.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright Deltares.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>