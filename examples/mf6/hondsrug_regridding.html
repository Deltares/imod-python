

<!DOCTYPE html>


<html lang="en" data-content_root="" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Regridding a regional model &#8212; iMOD Python 0.16.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/theme-deltares.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/mf6/hondsrug_regridding';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Lake package example" href="lake.html" />
    <link rel="prev" title="Partitioning a regional model" href="hondsrug_partitioning.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
    
    <img src="../../_static/imod-python-logo.svg" class="logo__image only-light" alt="iMOD Python 0.16.0 documentation - Home"/>
    <script>document.write(`<img src="../../_static/imod-python-logo.svg" class="logo__image only-dark" alt="iMOD Python 0.16.0 documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../installation.html">
                        Installing
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../user-guide/index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api/index.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../faq/index.html">
                        FAQ
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../developing.html">
                        Developing
                      </a>
                    </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.deltares.nl/en/" title="Deltares" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../_static/deltares-white.svg" class="icon-link-image" alt="Deltares"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Deltares/imod-python" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../installation.html">
                        Installing
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../user-guide/index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api/index.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../faq/index.html">
                        FAQ
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links-2">
                    More
                </button>
                <ul id="pst-nav-more-links-2" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../developing.html">
                        Developing
                      </a>
                    </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.deltares.nl/en/" title="Deltares" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../_static/deltares-white.svg" class="icon-link-image" alt="Deltares"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Deltares/imod-python" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">MODFLOW6</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Henry.html">Henry</a></li>
<li class="toctree-l2"><a class="reference internal" href="circle.html">Circle</a></li>
<li class="toctree-l2"><a class="reference internal" href="circle_partitioned.html">Circle partitioned</a></li>
<li class="toctree-l2"><a class="reference internal" href="circle_transport.html">Freshwater lens (circle)</a></li>
<li class="toctree-l2"><a class="reference internal" href="different_ways_to_regrid_models.html">Different ways to regrid models</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex01_twri.html">TWRI</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_1d_transport.html">1D Solute Transport Benchmarks</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_models.html">Example models</a></li>
<li class="toctree-l2"><a class="reference internal" href="hondsrug.html">Regional model</a></li>










<li class="toctree-l2"><a class="reference internal" href="hondsrug_partitioning.html">Partitioning a regional model</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Regridding a regional model</a></li>



<li class="toctree-l2"><a class="reference internal" href="lake.html">Lake package example</a></li>
<li class="toctree-l2"><a class="reference internal" href="transport_2d.html">Transport 2d example</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../imodflow/index.html">iMODFLOW</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../imodflow/ImodflowProjectfile.html">Model Creation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../imod-wq/index.html">iMOD-WQ</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../imod-wq/Elder.html">Elder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imod-wq/FreshwaterLens.html">Freshwater Lens</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imod-wq/Henry-wq.html">Henry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imod-wq/Hydrocoin.html">Hydrocoin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imod-wq/SaltwaterPocket.html">Saltwater Pocket</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imod-wq/VerticalInterface.html">Vertical Interface</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../metaswap/index.html">MetaSWAP</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../metaswap/metaswap_example.html">Coupled MetaSWAP - Modflow6 model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metaswap/read_metaswap_file.html">Reading existing MetaSWAP input</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../prepare/index.html">Prepare</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../prepare/point_interpolation.html">Head point interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../prepare/polygonize_raster.html">Polygonize raster</a></li>
<li class="toctree-l2"><a class="reference internal" href="../prepare/rasterize_shp.html">Rasterize shapefiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../prepare/reproject.html">Reproject data</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualize/index.html">Visualization</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualize/flowvel_streamlines.html">Flow velocities and streamlines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualize/plot_map.html">Plot maps</a></li>
</ul>
</li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Examples</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">MODFLOW6</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Regridding...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-examples-mf6-hondsrug-regridding-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="regridding-a-regional-model">
<span id="sphx-glr-examples-mf6-hondsrug-regridding-py"></span><h1>Regridding a regional model<a class="headerlink" href="#regridding-a-regional-model" title="Permalink to this heading">#</a></h1>
<p>This example shows how a model can be regridded using default regridding
methods. The example used is the Hondsrug model. It is regridded to a coarser
grid. The simulated heads before and after the regridding are shown for
comparison, and some statistics are plotted for the head distributions at the
end of the simulation. Histograms of the input arrays before and after
regridding are shown next.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>

<span class="kn">import</span> <span class="nn">imod</span>
<span class="kn">from</span> <span class="nn">imod.typing</span> <span class="kn">import</span> <span class="n">GridDataArray</span>
</pre></div>
</div>
<p>Obtain the simulation, write it, run it, and plot some heads.
There is a separate example contained in <a class="reference internal" href="hondsrug.html"><span class="doc">Regional model</span></a>
that you should look at if you are interested in the model building</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">tmpdir</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">temporary_directory</span><span class="p">()</span>

<span class="n">gwf_simulation</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">hondsrug_simulation</span><span class="p">(</span><span class="n">tmpdir</span> <span class="o">/</span> <span class="s2">&quot;hondsrug_saved&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The model was written before the xt3d_option and rhs_option arguments were
added to iMOD Python. Set missing options to False.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gwf_simulation</span><span class="p">[</span><span class="s2">&quot;GWF&quot;</span><span class="p">][</span><span class="s2">&quot;npf&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_xt3d_option</span><span class="p">(</span><span class="n">is_xt3d_used</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_rhs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Write simulation</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">original_modeldir</span> <span class="o">=</span> <span class="n">tmpdir</span> <span class="o">/</span> <span class="s2">&quot;original&quot;</span>
<span class="n">gwf_simulation</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">original_modeldir</span><span class="p">)</span>
</pre></div>
</div>
<p>Run and open heads</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gwf_simulation</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">hds_original</span> <span class="o">=</span> <span class="n">gwf_simulation</span><span class="o">.</span><span class="n">open_head</span><span class="p">()</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">hds_original</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">layer</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_hondsrug_regridding_001.png" srcset="../../_images/sphx_glr_hondsrug_regridding_001.png" alt="dx = 25.0, dy = -25.0, layer = 3, time = 2.191e+03" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh object at 0x0000015AAC9CB210&gt;
</pre></div>
</div>
<p>Create the target grid we will regrid to.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">idomain</span> <span class="o">=</span> <span class="n">gwf_simulation</span><span class="p">[</span><span class="s2">&quot;GWF&quot;</span><span class="p">][</span><span class="s2">&quot;dis&quot;</span><span class="p">][</span><span class="s2">&quot;idomain&quot;</span><span class="p">]</span>

<span class="n">nlay</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">idomain</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;layer&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">nrow</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">ncol</span> <span class="o">=</span> <span class="mi">125</span>
<span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">nlay</span><span class="p">,</span> <span class="n">nrow</span><span class="p">,</span> <span class="n">ncol</span><span class="p">)</span>

<span class="n">xmin</span> <span class="o">=</span> <span class="n">idomain</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">[()]</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="n">idomain</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">[()]</span>
<span class="n">ymin</span> <span class="o">=</span> <span class="n">idomain</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">[()]</span>
<span class="n">ymax</span> <span class="o">=</span> <span class="n">idomain</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">[()]</span>

<span class="n">delta_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">)</span> <span class="o">/</span> <span class="n">ncol</span>
<span class="n">delta_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">ymax</span> <span class="o">-</span> <span class="n">ymin</span><span class="p">)</span> <span class="o">/</span> <span class="n">nrow</span>
<span class="n">dims</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;layer&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">new_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">delta_x</span><span class="p">)</span>
<span class="n">new_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ymax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="o">-</span><span class="n">delta_y</span><span class="p">)</span>
<span class="n">new_layer</span> <span class="o">=</span> <span class="n">idomain</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;layer&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">coords</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;layer&quot;</span><span class="p">:</span> <span class="n">new_layer</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">new_y</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">new_x</span><span class="p">,</span> <span class="s2">&quot;dx&quot;</span><span class="p">:</span> <span class="n">delta_x</span><span class="p">,</span> <span class="s2">&quot;dy&quot;</span><span class="p">:</span> <span class="n">delta_y</span><span class="p">}</span>
<span class="n">target_grid</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span> <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="regridding">
<h1>Regridding<a class="headerlink" href="#regridding" title="Permalink to this heading">#</a></h1>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Regrid the simulation with the ``regrid_like`` method. Write, run, and plot the results.</span>
<span class="n">regridded_simulation</span> <span class="o">=</span> <span class="n">gwf_simulation</span><span class="o">.</span><span class="n">regrid_like</span><span class="p">(</span>
    <span class="s2">&quot;hondsrug-regridded&quot;</span><span class="p">,</span> <span class="n">target_grid</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="n">regridded_modeldir</span> <span class="o">=</span> <span class="n">tmpdir</span> <span class="o">/</span> <span class="s2">&quot;regridded&quot;</span>
<span class="n">regridded_simulation</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">regridded_modeldir</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">regridded_simulation</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="n">hds_regridded</span> <span class="o">=</span> <span class="n">regridded_simulation</span><span class="o">.</span><span class="n">open_head</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="results-visualization">
<h1>Results visualization<a class="headerlink" href="#results-visualization" title="Permalink to this heading">#</a></h1>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">hds_regridded</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">layer</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">plot_histograms_side_by_side</span><span class="p">(</span>
    <span class="n">array_original</span><span class="p">:</span> <span class="n">GridDataArray</span><span class="p">,</span> <span class="n">array_regridded</span><span class="p">:</span> <span class="n">GridDataArray</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function creates a plot of normalized histograms of the 2 input</span>
<span class="sd">    DataArray. It plots a title above each histogram.&quot;&quot;&quot;</span>
    <span class="n">_</span><span class="p">,</span> <span class="p">(</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">array_original</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax0</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">array_regridded</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2"> (original)&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2"> (regridded)&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">write_summary_statistics</span><span class="p">(</span>
    <span class="n">array_original</span><span class="p">:</span> <span class="n">GridDataArray</span><span class="p">,</span> <span class="n">array_regridded</span><span class="p">:</span> <span class="n">GridDataArray</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">):</span>
    <span class="k">def</span> <span class="nf">convert_to_filtered_1d</span><span class="p">(</span><span class="n">grid</span><span class="p">:</span> <span class="n">GridDataArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This function receives an xarray DataArray and converts it to an 1d numpy</span>
<span class="sd">        array. All NaN&#39;s are filtered out.&quot;&quot;&quot;</span>
        <span class="n">grid_as_1d</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="nb">filter</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">grid_as_1d</span><span class="p">)</span>
        <span class="n">grid_as_1d</span> <span class="o">=</span> <span class="n">grid_as_1d</span><span class="p">[</span><span class="nb">filter</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">grid_as_1d</span>

    <span class="n">original</span> <span class="o">=</span> <span class="n">convert_to_filtered_1d</span><span class="p">(</span><span class="n">array_original</span><span class="p">)</span>
    <span class="n">regridded</span> <span class="o">=</span> <span class="n">convert_to_filtered_1d</span><span class="p">(</span><span class="n">array_regridded</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">summary statistics </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;~~~~~~~~~~~~~~~~~~~~~~~~~~&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;mean (original) </span><span class="si">{</span><span class="n">original</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">                    mean (regridded) </span><span class="si">{</span><span class="n">regridded</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;min (original) </span><span class="si">{</span><span class="n">original</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">}</span><span class="s2">                      min (regridded) </span><span class="si">{</span><span class="n">regridded</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;max (original) </span><span class="si">{</span><span class="n">original</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">}</span><span class="s2">                      max (regridded) </span><span class="si">{</span><span class="n">regridded</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;variance (original) </span><span class="si">{</span><span class="n">original</span><span class="o">.</span><span class="n">var</span><span class="p">()</span><span class="si">}</span><span class="s2">                 variance (regridded) </span><span class="si">{</span><span class="n">regridded</span><span class="o">.</span><span class="n">var</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>


<span class="n">write_summary_statistics</span><span class="p">(</span><span class="n">hds_original</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span> <span class="n">hds_regridded</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span> <span class="s2">&quot;head&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_hondsrug_regridding_002.png" srcset="../../_images/sphx_glr_hondsrug_regridding_002.png" alt="dx = 99.8, dy = -99.5, layer = 3, time = 2.191e+03" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>summary statistics head
~~~~~~~~~~~~~~~~~~~~~~~~~~
mean (original) 5.581319897749301                    mean (regridded) 4.404148626603712
min (original) 0.04073443694382525                      min (regridded) 0.17061075128112985
max (original) 17.30898058097886                      max (regridded) 12.600521120032152
variance (original) 8.857501814710492                 variance (regridded) 4.650317522208325
</pre></div>
</div>
</section>
<section id="comparison-with-histograms">
<h1>Comparison with histograms<a class="headerlink" href="#comparison-with-histograms" title="Permalink to this heading">#</a></h1>
<p>In the next segment we will compare the input and output of the models on different grids.
We advice to always check how your input is regridded. In this example we upscaled grid,
many input parameters are regridded with a <code class="docutils literal notranslate"><span class="pre">mean</span></code> method. This means that their input
range is reduced, which can be seen in tailings in the histograms becoming shorter.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">plot_histograms_side_by_side</span><span class="p">(</span>
    <span class="n">hds_original</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span> <span class="n">hds_regridded</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span> <span class="s2">&quot;head&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_hondsrug_regridding_003.png" srcset="../../_images/sphx_glr_hondsrug_regridding_003.png" alt="head (original), head (regridded)" class = "sphx-glr-single-img"/><p>Compare constant head arrays.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">plot_histograms_side_by_side</span><span class="p">(</span>
    <span class="n">gwf_simulation</span><span class="p">[</span><span class="s2">&quot;GWF&quot;</span><span class="p">][</span><span class="s2">&quot;chd&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;head&quot;</span><span class="p">],</span>
    <span class="n">regridded_simulation</span><span class="p">[</span><span class="s2">&quot;GWF&quot;</span><span class="p">][</span><span class="s2">&quot;chd&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;head&quot;</span><span class="p">],</span>
    <span class="s2">&quot;chd head&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_hondsrug_regridding_004.png" srcset="../../_images/sphx_glr_hondsrug_regridding_004.png" alt="chd head (original), chd head (regridded)" class = "sphx-glr-single-img"/><p>Compare horizontal hydraulic conductivities.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">plot_histograms_side_by_side</span><span class="p">(</span>
    <span class="n">gwf_simulation</span><span class="p">[</span><span class="s2">&quot;GWF&quot;</span><span class="p">][</span><span class="s2">&quot;npf&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">],</span>
    <span class="n">regridded_simulation</span><span class="p">[</span><span class="s2">&quot;GWF&quot;</span><span class="p">][</span><span class="s2">&quot;npf&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">],</span>
    <span class="s2">&quot;npf k&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_hondsrug_regridding_005.png" srcset="../../_images/sphx_glr_hondsrug_regridding_005.png" alt="npf k (original), npf k (regridded)" class = "sphx-glr-single-img"/><p>Compare vertical hydraulic conductivities.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">plot_histograms_side_by_side</span><span class="p">(</span>
    <span class="n">gwf_simulation</span><span class="p">[</span><span class="s2">&quot;GWF&quot;</span><span class="p">][</span><span class="s2">&quot;npf&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;k33&quot;</span><span class="p">],</span>
    <span class="n">regridded_simulation</span><span class="p">[</span><span class="s2">&quot;GWF&quot;</span><span class="p">][</span><span class="s2">&quot;npf&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;k33&quot;</span><span class="p">],</span>
    <span class="s2">&quot;npf k33&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_hondsrug_regridding_006.png" srcset="../../_images/sphx_glr_hondsrug_regridding_006.png" alt="npf k33 (original), npf k33 (regridded)" class = "sphx-glr-single-img"/><p>Compare starting heads.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">plot_histograms_side_by_side</span><span class="p">(</span>
    <span class="n">gwf_simulation</span><span class="p">[</span><span class="s2">&quot;GWF&quot;</span><span class="p">][</span><span class="s2">&quot;ic&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">],</span>
    <span class="n">regridded_simulation</span><span class="p">[</span><span class="s2">&quot;GWF&quot;</span><span class="p">][</span><span class="s2">&quot;ic&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">],</span>
    <span class="s2">&quot;ic start&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_hondsrug_regridding_007.png" srcset="../../_images/sphx_glr_hondsrug_regridding_007.png" alt="ic start (original), ic start (regridded)" class = "sphx-glr-single-img"/><p>Compare river stages.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">plot_histograms_side_by_side</span><span class="p">(</span>
    <span class="n">gwf_simulation</span><span class="p">[</span><span class="s2">&quot;GWF&quot;</span><span class="p">][</span><span class="s2">&quot;riv&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;stage&quot;</span><span class="p">],</span>
    <span class="n">regridded_simulation</span><span class="p">[</span><span class="s2">&quot;GWF&quot;</span><span class="p">][</span><span class="s2">&quot;riv&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;stage&quot;</span><span class="p">],</span>
    <span class="s2">&quot;riv stage&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_hondsrug_regridding_008.png" srcset="../../_images/sphx_glr_hondsrug_regridding_008.png" alt="riv stage (original), riv stage (regridded)" class = "sphx-glr-single-img"/><p>Compare river bottom elevations.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">plot_histograms_side_by_side</span><span class="p">(</span>
    <span class="n">gwf_simulation</span><span class="p">[</span><span class="s2">&quot;GWF&quot;</span><span class="p">][</span><span class="s2">&quot;riv&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;bottom_elevation&quot;</span><span class="p">],</span>
    <span class="n">regridded_simulation</span><span class="p">[</span><span class="s2">&quot;GWF&quot;</span><span class="p">][</span><span class="s2">&quot;riv&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;bottom_elevation&quot;</span><span class="p">],</span>
    <span class="s2">&quot;riv bottom elevation&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_hondsrug_regridding_009.png" srcset="../../_images/sphx_glr_hondsrug_regridding_009.png" alt="riv bottom elevation (original), riv bottom elevation (regridded)" class = "sphx-glr-single-img"/><p>Compare riverbed conductance.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">plot_histograms_side_by_side</span><span class="p">(</span>
    <span class="n">gwf_simulation</span><span class="p">[</span><span class="s2">&quot;GWF&quot;</span><span class="p">][</span><span class="s2">&quot;riv&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;conductance&quot;</span><span class="p">],</span>
    <span class="n">regridded_simulation</span><span class="p">[</span><span class="s2">&quot;GWF&quot;</span><span class="p">][</span><span class="s2">&quot;riv&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;conductance&quot;</span><span class="p">],</span>
    <span class="s2">&quot;riv conductance&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_hondsrug_regridding_010.png" srcset="../../_images/sphx_glr_hondsrug_regridding_010.png" alt="riv conductance (original), riv conductance (regridded)" class = "sphx-glr-single-img"/><p>Compare recharge rates.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">plot_histograms_side_by_side</span><span class="p">(</span>
    <span class="n">gwf_simulation</span><span class="p">[</span><span class="s2">&quot;GWF&quot;</span><span class="p">][</span><span class="s2">&quot;rch&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;rate&quot;</span><span class="p">],</span>
    <span class="n">regridded_simulation</span><span class="p">[</span><span class="s2">&quot;GWF&quot;</span><span class="p">][</span><span class="s2">&quot;rch&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;rate&quot;</span><span class="p">],</span>
    <span class="s2">&quot;rch rate&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_hondsrug_regridding_011.png" srcset="../../_images/sphx_glr_hondsrug_regridding_011.png" alt="rch rate (original), rch rate (regridded)" class = "sphx-glr-single-img"/><p>Compare drainage elevations.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">plot_histograms_side_by_side</span><span class="p">(</span>
    <span class="n">gwf_simulation</span><span class="p">[</span><span class="s2">&quot;GWF&quot;</span><span class="p">][</span><span class="s2">&quot;drn-pipe&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;elevation&quot;</span><span class="p">],</span>
    <span class="n">regridded_simulation</span><span class="p">[</span><span class="s2">&quot;GWF&quot;</span><span class="p">][</span><span class="s2">&quot;drn-pipe&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;elevation&quot;</span><span class="p">],</span>
    <span class="s2">&quot;drn-pipe elevation&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_hondsrug_regridding_012.png" srcset="../../_images/sphx_glr_hondsrug_regridding_012.png" alt="drn-pipe elevation (original), drn-pipe elevation (regridded)" class = "sphx-glr-single-img"/><p>Compare drain conductances.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">plot_histograms_side_by_side</span><span class="p">(</span>
    <span class="n">gwf_simulation</span><span class="p">[</span><span class="s2">&quot;GWF&quot;</span><span class="p">][</span><span class="s2">&quot;drn-pipe&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;conductance&quot;</span><span class="p">],</span>
    <span class="n">regridded_simulation</span><span class="p">[</span><span class="s2">&quot;GWF&quot;</span><span class="p">][</span><span class="s2">&quot;drn-pipe&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;conductance&quot;</span><span class="p">],</span>
    <span class="s2">&quot;drn-pipe conductance&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_hondsrug_regridding_013.png" srcset="../../_images/sphx_glr_hondsrug_regridding_013.png" alt="drn-pipe conductance (original), drn-pipe conductance (regridded)" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (1 minutes 56.881 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-mf6-hondsrug-regridding-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/c09851a21b1aee213ea29046f1845e3f/hondsrug_regridding.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">hondsrug_regridding.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/23979bd93c2fb13cd08ff0e081349e09/hondsrug_regridding.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">hondsrug_regridding.py</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="hondsrug_partitioning.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Partitioning a regional model</p>
      </div>
    </a>
    <a class="right-next"
       href="lake.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lake package example</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Regridding a regional model</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#regridding">Regridding</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#results-visualization">Results visualization</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-with-histograms">Comparison with histograms</a></li>
</ul>

  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/examples/mf6/hondsrug_regridding.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright Deltares.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.2.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>