

<!DOCTYPE html>


<html lang="en" data-content_root="" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Coupled MetaSWAP - Modflow6 model &#8212; iMOD Python 0.15.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/theme-deltares.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/metaswap/metaswap_example';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Reading existing MetaSWAP input" href="read_metaswap_file.html" />
    <link rel="prev" title="MetaSWAP" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
    
    <img src="../../_static/imod-python-logo.svg" class="logo__image only-light" alt="iMOD Python 0.15.0 documentation - Home"/>
    <script>document.write(`<img src="../../_static/imod-python-logo.svg" class="logo__image only-dark" alt="iMOD Python 0.15.0 documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../installation.html">
                        Installing
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../user-guide/index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api/index.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../faq/index.html">
                        FAQ
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../developing.html">
                        Developing
                      </a>
                    </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.deltares.nl/en/" title="Deltares" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../_static/deltares-white.svg" class="icon-link-image" alt="Deltares"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Deltares/imod-python" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../installation.html">
                        Installing
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../user-guide/index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api/index.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../faq/index.html">
                        FAQ
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links-2">
                    More
                </button>
                <ul id="pst-nav-more-links-2" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../developing.html">
                        Developing
                      </a>
                    </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.deltares.nl/en/" title="Deltares" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../_static/deltares-white.svg" class="icon-link-image" alt="Deltares"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Deltares/imod-python" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../mf6/index.html">MODFLOW6</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../mf6/Henry.html">Henry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mf6/circle.html">Circle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mf6/circle_transport.html">Freshwater lens (circle)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mf6/ex01_twri.html">TWRI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mf6/example_1d_transport.html">1D Solute Transport Benchmarks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mf6/example_models.html">Example models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mf6/hondsrug.html">Regional model</a></li>










<li class="toctree-l2"><a class="reference internal" href="../mf6/hondsrug_partitioning.html">Partitioning a regional model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mf6/hondsrug_regridding.html">Regridding a regional model</a></li>



<li class="toctree-l2"><a class="reference internal" href="../mf6/lake.html">Lake package example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mf6/twri_regridding.html">TWRI regridding</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../imodflow/index.html">iMODFLOW</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../imodflow/ImodflowProjectfile.html">Model Creation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../imod-wq/index.html">iMOD-WQ</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../imod-wq/Elder.html">Elder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imod-wq/FreshwaterLens.html">Freshwater Lens</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imod-wq/Henry.html">Henry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imod-wq/Hydrocoin.html">Hydrocoin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imod-wq/SaltwaterPocket.html">Saltwater Pocket</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imod-wq/VerticalInterface.html">Vertical Interface</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">MetaSWAP</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Coupled MetaSWAP - Modflow6 model</a></li>
<li class="toctree-l2"><a class="reference internal" href="read_metaswap_file.html">Reading existing MetaSWAP input</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../prepare/index.html">Prepare</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../prepare/point_interpolation.html">Head point interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../prepare/polygonize_raster.html">Polygonize raster</a></li>
<li class="toctree-l2"><a class="reference internal" href="../prepare/rasterize_shp.html">Rasterize shapefiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../prepare/reproject.html">Reproject data</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualize/index.html">Visualization</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualize/flowvel_streamlines.html">Flow velocities and streamlines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualize/plot_map.html">Plot maps</a></li>
</ul>
</li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Examples</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">MetaSWAP</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Coupled...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-examples-metaswap-metaswap-example-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="coupled-metaswap-modflow6-model">
<span id="sphx-glr-examples-metaswap-metaswap-example-py"></span><h1>Coupled MetaSWAP - Modflow6 model<a class="headerlink" href="#coupled-metaswap-modflow6-model" title="Permalink to this heading">#</a></h1>
<p>This example illustrates how to setup a simple MetaSWAP model coupled to a
Modflow 6 model model using the <code class="docutils literal notranslate"><span class="pre">imod</span></code> package and associated packages.</p>
<p>Overview of steps made:</p>
<blockquote>
<div><ul class="simple">
<li><p>Create Modflow 6 model</p></li>
<li><p>Create MetaSWAP model</p></li>
<li><p>Write coupled models</p></li>
</ul>
</div></blockquote>
<p>We’ll start with the following imports:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>

<span class="kn">import</span> <span class="nn">imod</span>
<span class="kn">from</span> <span class="nn">imod</span> <span class="kn">import</span> <span class="n">couplers</span><span class="p">,</span> <span class="n">mf6</span><span class="p">,</span> <span class="n">msw</span>
</pre></div>
</div>
<section id="modflow-6-model">
<h2>Modflow 6 model<a class="headerlink" href="#modflow-6-model" title="Permalink to this heading">#</a></h2>
<p>Next, we initiate the Modflow 6 groundwater model:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gwf_model</span> <span class="o">=</span> <span class="n">mf6</span><span class="o">.</span><span class="n">GroundwaterFlowModel</span><span class="p">()</span>
</pre></div>
</div>
<section id="create-grid">
<h3>Create grid<a class="headerlink" href="#create-grid" title="Permalink to this heading">#</a></h3>
<p>We’ll then define the Modflow 6 grid.
It consists of 3 layers of 9 by 9 cells rasters.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">shape</span> <span class="o">=</span> <span class="n">nlay</span><span class="p">,</span> <span class="n">nrow</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span>

<span class="n">dx</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10.0</span>
<span class="n">dz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">])</span>
<span class="n">xmin</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">ncol</span>
<span class="n">ymin</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">ymax</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span> <span class="o">*</span> <span class="n">nrow</span>
<span class="n">dims</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;layer&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>

<span class="n">layer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nlay</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ymax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dy</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dx</span>
<span class="n">coords</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;layer&quot;</span><span class="p">:</span> <span class="n">layer</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">}</span>

<span class="n">idomain</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span> <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">)</span>

<span class="n">top</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">bottom</span> <span class="o">=</span> <span class="n">top</span> <span class="o">-</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">layer</span> <span class="o">*</span> <span class="n">dz</span><span class="p">),</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;layer&quot;</span><span class="p">:</span> <span class="n">layer</span><span class="p">},</span> <span class="n">dims</span><span class="o">=</span><span class="s2">&quot;layer&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gwf_model</span><span class="p">[</span><span class="s2">&quot;dis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mf6</span><span class="o">.</span><span class="n">StructuredDiscretization</span><span class="p">(</span><span class="n">idomain</span><span class="o">=</span><span class="n">idomain</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">top</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">bottom</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="hydrogeology">
<h3>Hydrogeology<a class="headerlink" href="#hydrogeology" title="Permalink to this heading">#</a></h3>
<section id="hydraulic-conductivity">
<h4>Hydraulic conductivity<a class="headerlink" href="#hydraulic-conductivity" title="Permalink to this heading">#</a></h4>
<p>Assign the node property flow package, which specifies the hydraulic
conductivities. The middle layer is an aquitard.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">([</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;layer&quot;</span><span class="p">:</span> <span class="n">layer</span><span class="p">},</span> <span class="p">(</span><span class="s2">&quot;layer&quot;</span><span class="p">,))</span>
<span class="n">k33</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;layer&quot;</span><span class="p">:</span> <span class="n">layer</span><span class="p">},</span> <span class="p">(</span><span class="s2">&quot;layer&quot;</span><span class="p">,))</span>
<span class="n">gwf_model</span><span class="p">[</span><span class="s2">&quot;npf&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mf6</span><span class="o">.</span><span class="n">NodePropertyFlow</span><span class="p">(</span>
    <span class="n">icelltype</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
    <span class="n">k33</span><span class="o">=</span><span class="n">k33</span><span class="p">,</span>
    <span class="n">save_flows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="storage">
<h4>Storage<a class="headerlink" href="#storage" title="Permalink to this heading">#</a></h4>
<p>Cells are set to non-convertible (convertible = 0). This is a requirement for
MetaSWAP, because, once coupled, MetaSWAP is responsible for computing the
storage coefficient instead of Modflow.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gwf_model</span><span class="p">[</span><span class="s2">&quot;sto&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mf6</span><span class="o">.</span><span class="n">SpecificStorage</span><span class="p">(</span>
    <span class="n">specific_storage</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">specific_yield</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">transient</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">convertible</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="initial-conditions">
<h3>Initial conditions<a class="headerlink" href="#initial-conditions" title="Permalink to this heading">#</a></h3>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gwf_model</span><span class="p">[</span><span class="s2">&quot;ic&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mf6</span><span class="o">.</span><span class="n">InitialConditions</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="output-control">
<h3>Output Control<a class="headerlink" href="#output-control" title="Permalink to this heading">#</a></h3>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gwf_model</span><span class="p">[</span><span class="s2">&quot;oc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mf6</span><span class="o">.</span><span class="n">OutputControl</span><span class="p">(</span><span class="n">save_head</span><span class="o">=</span><span class="s2">&quot;last&quot;</span><span class="p">,</span> <span class="n">save_budget</span><span class="o">=</span><span class="s2">&quot;last&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="boundary-conditions">
<h3>Boundary conditions<a class="headerlink" href="#boundary-conditions" title="Permalink to this heading">#</a></h3>
<section id="constant-head">
<h4>Constant head<a class="headerlink" href="#constant-head" title="Permalink to this heading">#</a></h4>
<p>We’ll create constant head cells at the most left and right columns of the grid,
representing two ditches.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">head</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">idomain</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">head</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
<span class="n">head</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>

<span class="n">gwf_model</span><span class="p">[</span><span class="s2">&quot;chd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mf6</span><span class="o">.</span><span class="n">ConstantHead</span><span class="p">(</span>
    <span class="n">head</span><span class="p">,</span> <span class="n">print_input</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">print_flows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save_flows</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">head</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">layer</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_metaswap_example_001.png" srcset="../../_images/sphx_glr_metaswap_example_001.png" alt="layer = 1" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh object at 0x000002645B8D4490&gt;
</pre></div>
</div>
</section>
<section id="dummy-boundary-conditions">
<h4>Dummy boundary conditions<a class="headerlink" href="#dummy-boundary-conditions" title="Permalink to this heading">#</a></h4>
<p>The iMOD Coupler requires a dummy recharge package, and well package if
MetaSWAP’s sprinkling is enabled. This to let Modflow 6 allocate the
appropriate matrices needed in the exchange of states during model
computation.</p>
<section id="recharge">
<h5>Recharge<a class="headerlink" href="#recharge" title="Permalink to this heading">#</a></h5>
<p>We’ll start off with the recharge package, which has no recharge cells
at the location of our ditches.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">recharge</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">idomain</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">recharge</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">recharge</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="n">gwf_model</span><span class="p">[</span><span class="s2">&quot;rch_msw&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mf6</span><span class="o">.</span><span class="n">Recharge</span><span class="p">(</span><span class="n">recharge</span><span class="p">)</span>

<span class="n">recharge</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_metaswap_example_002.png" srcset="../../_images/sphx_glr_metaswap_example_002.png" alt="layer = 1" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh object at 0x0000026455C05F10&gt;
</pre></div>
</div>
</section>
<section id="wells">
<h5>Wells<a class="headerlink" href="#wells" title="Permalink to this heading">#</a></h5>
<p>We’ll create a dummy well package as well. imod.mf6.WellDisStructured needs
its input data provided as long tables instead of grids to so therefore we’ll
create 1d arrays by calling <code class="docutils literal notranslate"><span class="pre">np.tile</span></code> on the column indices,
and <code class="docutils literal notranslate"><span class="pre">np.repeat</span></code> on the row indices.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">wel_layer</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">ix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ncol</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nrow</span><span class="p">)</span>
<span class="n">iy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nrow</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ncol</span><span class="p">)</span>
<span class="n">rate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ix</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">wel_layer</span><span class="p">)</span>

<span class="n">gwf_model</span><span class="p">[</span><span class="s2">&quot;wells_msw&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mf6</span><span class="o">.</span><span class="n">WellDisStructured</span><span class="p">(</span>
    <span class="n">layer</span><span class="o">=</span><span class="n">layer</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">iy</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">ix</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="n">rate</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Initiate a Modflow 6 simulatation and attach the groundwater model to it.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">simulation</span> <span class="o">=</span> <span class="n">mf6</span><span class="o">.</span><span class="n">Modflow6Simulation</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
<span class="n">simulation</span><span class="p">[</span><span class="s2">&quot;GWF_1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gwf_model</span>

<span class="c1"># Define solver settings, we&#39;ll use a preset that is sufficient for this example.</span>

<span class="n">simulation</span><span class="p">[</span><span class="s2">&quot;solver&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mf6</span><span class="o">.</span><span class="n">SolutionPresetSimple</span><span class="p">(</span>
    <span class="n">modelnames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GWF_1&quot;</span><span class="p">],</span> <span class="n">print_option</span><span class="o">=</span><span class="s2">&quot;summary&quot;</span><span class="p">,</span> <span class="n">csv_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">no_ptc</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Create time discretization, we’ll model 2 days.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">freq</span> <span class="o">=</span> <span class="s2">&quot;D&quot;</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s2">&quot;1/1/1971&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;1/3/1971&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">freq</span><span class="p">)</span>

<span class="n">simulation</span><span class="o">.</span><span class="n">create_time_discretization</span><span class="p">(</span><span class="n">additional_times</span><span class="o">=</span><span class="n">times</span><span class="p">)</span>

<span class="n">times</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;1971-01-01&#39;, &#39;1971-01-02&#39;, &#39;1971-01-03&#39;], dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)
</pre></div>
</div>
</section>
</section>
</section>
</section>
<section id="metaswap-model">
<h2>MetaSWAP model<a class="headerlink" href="#metaswap-model" title="Permalink to this heading">#</a></h2>
<p>The next step is initating a <code class="docutils literal notranslate"><span class="pre">MetaSwapModel</span></code>. Critical is setting the right
path to MetaSWAP’s soil physical database, which contains the lookup table
with the soil physical relationships. Without access to this database MetaSWAP
cannot function. <a class="reference external" href="https://download.deltares.nl/metaswap">The full database can be downloaded here.</a></p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">msw_model</span> <span class="o">=</span> <span class="n">msw</span><span class="o">.</span><span class="n">MetaSwapModel</span><span class="p">(</span><span class="n">unsaturated_database</span><span class="o">=</span><span class="s2">&quot;./path/to/unsaturated/database&quot;</span><span class="p">)</span>

<span class="c1"># Create grid</span>
<span class="c1"># ```````````</span>
<span class="c1">#</span>
<span class="c1"># We&#39;ll start off specifying the grids required for MetaSWAP. The x,y values</span>
<span class="c1"># of this grid should be identical as the Modflow6 model, but it should</span>
<span class="c1"># not have a layer dimension.</span>

<span class="n">msw_grid</span> <span class="o">=</span> <span class="n">idomain</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
<p>We do not want MetaSWAP cells in the cells where the ditches are located in
Modflow 6. We can specify where MetaSWAP cells are active with the “active”
grid, which is a grid of booleans (i.e. True/False).</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">active</span> <span class="o">=</span> <span class="n">msw_grid</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
<span class="n">active</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">active</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">active</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (y: 9, x: 9)&gt;
array([[False,  True,  True,  True,  True,  True,  True,  True, False],
       [False,  True,  True,  True,  True,  True,  True,  True, False],
       [False,  True,  True,  True,  True,  True,  True,  True, False],
       [False,  True,  True,  True,  True,  True,  True,  True, False],
       [False,  True,  True,  True,  True,  True,  True,  True, False],
       [False,  True,  True,  True,  True,  True,  True,  True, False],
       [False,  True,  True,  True,  True,  True,  True,  True, False],
       [False,  True,  True,  True,  True,  True,  True,  True, False],
       [False,  True,  True,  True,  True,  True,  True,  True, False]])
Coordinates:
  * y        (y) float64 85.0 75.0 65.0 55.0 45.0 35.0 25.0 15.0 5.0
  * x        (x) float64 5.0 15.0 25.0 35.0 45.0 55.0 65.0 75.0 85.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 9</li><li><span class='xr-has-index'>x</span>: 9</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-7a873052-e947-4441-a0ee-41845e5bab6c' class='xr-array-in' type='checkbox' checked><label for='section-7a873052-e947-4441-a0ee-41845e5bab6c' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>False True True True True True True ... True True True True True False</span></div><div class='xr-array-data'><pre>array([[False,  True,  True,  True,  True,  True,  True,  True, False],
       [False,  True,  True,  True,  True,  True,  True,  True, False],
       [False,  True,  True,  True,  True,  True,  True,  True, False],
       [False,  True,  True,  True,  True,  True,  True,  True, False],
       [False,  True,  True,  True,  True,  True,  True,  True, False],
       [False,  True,  True,  True,  True,  True,  True,  True, False],
       [False,  True,  True,  True,  True,  True,  True,  True, False],
       [False,  True,  True,  True,  True,  True,  True,  True, False],
       [False,  True,  True,  True,  True,  True,  True,  True, False]])</pre></div></div></li><li class='xr-section-item'><input id='section-e610c540-541b-4735-8da9-6cea2c7fe1f0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e610c540-541b-4735-8da9-6cea2c7fe1f0' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>85.0 75.0 65.0 ... 25.0 15.0 5.0</div><input id='attrs-a80b1103-a60b-4fc5-b641-6b05cf9f9076' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a80b1103-a60b-4fc5-b641-6b05cf9f9076' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8790f0f0-17af-4240-9239-93c9c1f2b322' class='xr-var-data-in' type='checkbox'><label for='data-8790f0f0-17af-4240-9239-93c9c1f2b322' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([85., 75., 65., 55., 45., 35., 25., 15.,  5.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.0 15.0 25.0 ... 65.0 75.0 85.0</div><input id='attrs-7ab832a1-1d52-4a7e-abe6-b70fc052e826' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7ab832a1-1d52-4a7e-abe6-b70fc052e826' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-de4511f0-889a-4e34-99e8-d24933fd0aa5' class='xr-var-data-in' type='checkbox'><label for='data-de4511f0-889a-4e34-99e8-d24933fd0aa5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 5., 15., 25., 35., 45., 55., 65., 75., 85.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-80ae6f6d-b05c-4fcf-b5ca-81b3f09b6fc8' class='xr-section-summary-in' type='checkbox'  ><label for='section-80ae6f6d-b05c-4fcf-b5ca-81b3f09b6fc8' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-9d2acd53-afee-4907-a6d5-35dc39918dbb' class='xr-index-data-in' type='checkbox'/><label for='index-9d2acd53-afee-4907-a6d5-35dc39918dbb' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([85.0, 75.0, 65.0, 55.0, 45.0, 35.0, 25.0, 15.0, 5.0], dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-6c9071e8-cdc2-4247-8502-0d26bcd14be3' class='xr-index-data-in' type='checkbox'/><label for='index-6c9071e8-cdc2-4247-8502-0d26bcd14be3' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([5.0, 15.0, 25.0, 35.0, 45.0, 55.0, 65.0, 75.0, 85.0], dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-09d6eb46-10ba-4060-a2ca-b9fa12833655' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-09d6eb46-10ba-4060-a2ca-b9fa12833655' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
<br />
<br /><p>Another crucial grid is the “area” grid. The area grid denotes the area in
each cell, for each “subunit”. A subunit represent a separate landuse in the
grid. We’ll create a grid with two separate land uses.</p>
<p>Each grid which specifies parameters related to landuse (e.g. landuse,
rootzone_depth, ponding depth) requires a subunit dimension. In contrast,
grids specifying parameters not induced by landuse (e.g. soil type, elevation,
precipitation) cannot contain a subunit dimension.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">subunit</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">total_cell_area</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dx</span> <span class="o">*</span> <span class="n">dy</span><span class="p">)</span>
<span class="n">equal_area_per_subunit</span> <span class="o">=</span> <span class="n">total_cell_area</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">subunit</span><span class="p">)</span>

<span class="n">total_cell_area</span>

<span class="c1"># Create a full grid equal to the msw_grid. And expand_dims() to broadcast this</span>
<span class="c1"># grid along a new dimension, named &quot;subunit&quot;</span>
<span class="n">area</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">msw_grid</span><span class="p">,</span> <span class="n">equal_area_per_subunit</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">subunit</span><span class="o">=</span><span class="n">subunit</span><span class="p">)</span>
    <span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1"># expand_dims creates a view, so copy it to allow setting values.</span>
<span class="p">)</span>

<span class="c1"># To the left we only have subunit 0</span>
<span class="n">area</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">total_cell_area</span>
<span class="n">area</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="c1"># To the right we only have subunit 1</span>
<span class="n">area</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">area</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="o">=</span> <span class="n">total_cell_area</span>

<span class="n">area</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (subunit: 2, y: 9, x: 9)&gt;
array([[[100., 100., 100.,  50.,  50.,  50.,  nan,  nan,  nan],
        [100., 100., 100.,  50.,  50.,  50.,  nan,  nan,  nan],
        [100., 100., 100.,  50.,  50.,  50.,  nan,  nan,  nan],
        [100., 100., 100.,  50.,  50.,  50.,  nan,  nan,  nan],
        [100., 100., 100.,  50.,  50.,  50.,  nan,  nan,  nan],
        [100., 100., 100.,  50.,  50.,  50.,  nan,  nan,  nan],
        [100., 100., 100.,  50.,  50.,  50.,  nan,  nan,  nan],
        [100., 100., 100.,  50.,  50.,  50.,  nan,  nan,  nan],
        [100., 100., 100.,  50.,  50.,  50.,  nan,  nan,  nan]],

       [[ nan,  nan,  nan,  50.,  50.,  50., 100., 100., 100.],
        [ nan,  nan,  nan,  50.,  50.,  50., 100., 100., 100.],
        [ nan,  nan,  nan,  50.,  50.,  50., 100., 100., 100.],
        [ nan,  nan,  nan,  50.,  50.,  50., 100., 100., 100.],
        [ nan,  nan,  nan,  50.,  50.,  50., 100., 100., 100.],
        [ nan,  nan,  nan,  50.,  50.,  50., 100., 100., 100.],
        [ nan,  nan,  nan,  50.,  50.,  50., 100., 100., 100.],
        [ nan,  nan,  nan,  50.,  50.,  50., 100., 100., 100.],
        [ nan,  nan,  nan,  50.,  50.,  50., 100., 100., 100.]]])
Coordinates:
  * subunit  (subunit) int64 0 1
  * y        (y) float64 85.0 75.0 65.0 55.0 45.0 35.0 25.0 15.0 5.0
  * x        (x) float64 5.0 15.0 25.0 35.0 45.0 55.0 65.0 75.0 85.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>subunit</span>: 2</li><li><span class='xr-has-index'>y</span>: 9</li><li><span class='xr-has-index'>x</span>: 9</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-9f8eca62-c9df-4be5-a38b-bcccbea819cd' class='xr-array-in' type='checkbox' checked><label for='section-9f8eca62-c9df-4be5-a38b-bcccbea819cd' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>100.0 100.0 100.0 50.0 50.0 50.0 ... 50.0 50.0 50.0 100.0 100.0 100.0</span></div><div class='xr-array-data'><pre>array([[[100., 100., 100.,  50.,  50.,  50.,  nan,  nan,  nan],
        [100., 100., 100.,  50.,  50.,  50.,  nan,  nan,  nan],
        [100., 100., 100.,  50.,  50.,  50.,  nan,  nan,  nan],
        [100., 100., 100.,  50.,  50.,  50.,  nan,  nan,  nan],
        [100., 100., 100.,  50.,  50.,  50.,  nan,  nan,  nan],
        [100., 100., 100.,  50.,  50.,  50.,  nan,  nan,  nan],
        [100., 100., 100.,  50.,  50.,  50.,  nan,  nan,  nan],
        [100., 100., 100.,  50.,  50.,  50.,  nan,  nan,  nan],
        [100., 100., 100.,  50.,  50.,  50.,  nan,  nan,  nan]],

       [[ nan,  nan,  nan,  50.,  50.,  50., 100., 100., 100.],
        [ nan,  nan,  nan,  50.,  50.,  50., 100., 100., 100.],
        [ nan,  nan,  nan,  50.,  50.,  50., 100., 100., 100.],
        [ nan,  nan,  nan,  50.,  50.,  50., 100., 100., 100.],
        [ nan,  nan,  nan,  50.,  50.,  50., 100., 100., 100.],
        [ nan,  nan,  nan,  50.,  50.,  50., 100., 100., 100.],
        [ nan,  nan,  nan,  50.,  50.,  50., 100., 100., 100.],
        [ nan,  nan,  nan,  50.,  50.,  50., 100., 100., 100.],
        [ nan,  nan,  nan,  50.,  50.,  50., 100., 100., 100.]]])</pre></div></div></li><li class='xr-section-item'><input id='section-8a2c34e4-d852-4ad2-8f66-efacc81d0dc2' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8a2c34e4-d852-4ad2-8f66-efacc81d0dc2' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>subunit</span></div><div class='xr-var-dims'>(subunit)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1</div><input id='attrs-e3c24986-0a5a-4c3b-ba9c-d8fdd7596d93' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e3c24986-0a5a-4c3b-ba9c-d8fdd7596d93' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5c127378-50fb-48dc-a4ca-e83a31600556' class='xr-var-data-in' type='checkbox'><label for='data-5c127378-50fb-48dc-a4ca-e83a31600556' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1], dtype=int64)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>85.0 75.0 65.0 ... 25.0 15.0 5.0</div><input id='attrs-177195c9-b2fd-4830-999c-aea099d7eef6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-177195c9-b2fd-4830-999c-aea099d7eef6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f61fc73b-701c-41a9-b78e-1b4810688181' class='xr-var-data-in' type='checkbox'><label for='data-f61fc73b-701c-41a9-b78e-1b4810688181' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([85., 75., 65., 55., 45., 35., 25., 15.,  5.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.0 15.0 25.0 ... 65.0 75.0 85.0</div><input id='attrs-69361f0d-a99d-4ff9-a39c-e9e39c5d979e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-69361f0d-a99d-4ff9-a39c-e9e39c5d979e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2a426a37-6c52-45ed-bb95-6414da3208f2' class='xr-var-data-in' type='checkbox'><label for='data-2a426a37-6c52-45ed-bb95-6414da3208f2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 5., 15., 25., 35., 45., 55., 65., 75., 85.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7dbaffcb-6fe2-43b1-801d-edcd2164a56f' class='xr-section-summary-in' type='checkbox'  ><label for='section-7dbaffcb-6fe2-43b1-801d-edcd2164a56f' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-6529ca09-e103-4b61-b387-070ebc334076' class='xr-index-data-in' type='checkbox'/><label for='index-6529ca09-e103-4b61-b387-070ebc334076' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([85.0, 75.0, 65.0, 55.0, 45.0, 35.0, 25.0, 15.0, 5.0], dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-0468c3a7-1a7d-48f1-8fa0-e129add66614' class='xr-index-data-in' type='checkbox'/><label for='index-0468c3a7-1a7d-48f1-8fa0-e129add66614' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([5.0, 15.0, 25.0, 35.0, 45.0, 55.0, 65.0, 75.0, 85.0], dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>subunit</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-b281300f-6104-4925-8a88-72aeb613094f' class='xr-index-data-in' type='checkbox'/><label for='index-b281300f-6104-4925-8a88-72aeb613094f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Int64Index([0, 1], dtype=&#x27;int64&#x27;, name=&#x27;subunit&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-eb338b38-ad65-4749-a82d-e9b35bd8ff85' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-eb338b38-ad65-4749-a82d-e9b35bd8ff85' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
<br />
<br /><section id="landuse">
<h3>Landuse<a class="headerlink" href="#landuse" title="Permalink to this heading">#</a></h3>
<p>Define a grid with landuse classes.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">landuse</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">area</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
<span class="n">landuse</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">landuse</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (subunit: 2, y: 9, x: 9)&gt;
array([[[1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1]],

       [[2, 2, 2, 2, 2, 2, 2, 2, 2],
        [2, 2, 2, 2, 2, 2, 2, 2, 2],
        [2, 2, 2, 2, 2, 2, 2, 2, 2],
        [2, 2, 2, 2, 2, 2, 2, 2, 2],
        [2, 2, 2, 2, 2, 2, 2, 2, 2],
        [2, 2, 2, 2, 2, 2, 2, 2, 2],
        [2, 2, 2, 2, 2, 2, 2, 2, 2],
        [2, 2, 2, 2, 2, 2, 2, 2, 2],
        [2, 2, 2, 2, 2, 2, 2, 2, 2]]], dtype=int16)
Coordinates:
  * subunit  (subunit) int64 0 1
  * y        (y) float64 85.0 75.0 65.0 55.0 45.0 35.0 25.0 15.0 5.0
  * x        (x) float64 5.0 15.0 25.0 35.0 45.0 55.0 65.0 75.0 85.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>subunit</span>: 2</li><li><span class='xr-has-index'>y</span>: 9</li><li><span class='xr-has-index'>x</span>: 9</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-44e3bcc3-851d-43d1-abbf-c08b506d0e46' class='xr-array-in' type='checkbox' checked><label for='section-44e3bcc3-851d-43d1-abbf-c08b506d0e46' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 ... 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</span></div><div class='xr-array-data'><pre>array([[[1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1]],

       [[2, 2, 2, 2, 2, 2, 2, 2, 2],
        [2, 2, 2, 2, 2, 2, 2, 2, 2],
        [2, 2, 2, 2, 2, 2, 2, 2, 2],
        [2, 2, 2, 2, 2, 2, 2, 2, 2],
        [2, 2, 2, 2, 2, 2, 2, 2, 2],
        [2, 2, 2, 2, 2, 2, 2, 2, 2],
        [2, 2, 2, 2, 2, 2, 2, 2, 2],
        [2, 2, 2, 2, 2, 2, 2, 2, 2],
        [2, 2, 2, 2, 2, 2, 2, 2, 2]]], dtype=int16)</pre></div></div></li><li class='xr-section-item'><input id='section-f0a3e58e-f1de-419e-8404-eaa580f5a32a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f0a3e58e-f1de-419e-8404-eaa580f5a32a' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>subunit</span></div><div class='xr-var-dims'>(subunit)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1</div><input id='attrs-e69ea65c-8704-4571-8b0b-246c4dc4bea2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e69ea65c-8704-4571-8b0b-246c4dc4bea2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4acb97d2-b34e-4eb3-a85d-9ff3f27e9860' class='xr-var-data-in' type='checkbox'><label for='data-4acb97d2-b34e-4eb3-a85d-9ff3f27e9860' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1], dtype=int64)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>85.0 75.0 65.0 ... 25.0 15.0 5.0</div><input id='attrs-8bddae53-30d4-4a59-8993-28c3b909a063' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8bddae53-30d4-4a59-8993-28c3b909a063' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-74086dd7-b014-4f65-b6ea-c1510b788f80' class='xr-var-data-in' type='checkbox'><label for='data-74086dd7-b014-4f65-b6ea-c1510b788f80' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([85., 75., 65., 55., 45., 35., 25., 15.,  5.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.0 15.0 25.0 ... 65.0 75.0 85.0</div><input id='attrs-4bfa572b-a83f-4348-a8af-aed936861091' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4bfa572b-a83f-4348-a8af-aed936861091' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3ae9ae9a-d69a-4ad1-ada6-fef22069feba' class='xr-var-data-in' type='checkbox'><label for='data-3ae9ae9a-d69a-4ad1-ada6-fef22069feba' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 5., 15., 25., 35., 45., 55., 65., 75., 85.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4007bea1-f949-4d54-8440-fe2b8fb9b2a2' class='xr-section-summary-in' type='checkbox'  ><label for='section-4007bea1-f949-4d54-8440-fe2b8fb9b2a2' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d343f113-7950-4153-999d-02a804f8eb4c' class='xr-index-data-in' type='checkbox'/><label for='index-d343f113-7950-4153-999d-02a804f8eb4c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([85.0, 75.0, 65.0, 55.0, 45.0, 35.0, 25.0, 15.0, 5.0], dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-23a36a38-9a4d-4393-b7e5-ef5c6ac06658' class='xr-index-data-in' type='checkbox'/><label for='index-23a36a38-9a4d-4393-b7e5-ef5c6ac06658' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([5.0, 15.0, 25.0, 35.0, 45.0, 55.0, 65.0, 75.0, 85.0], dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>subunit</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-ad1851da-c484-4df7-9412-1f075f7b92cb' class='xr-index-data-in' type='checkbox'/><label for='index-ad1851da-c484-4df7-9412-1f075f7b92cb' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Int64Index([0, 1], dtype=&#x27;int64&#x27;, name=&#x27;subunit&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-241626da-a3fa-49ed-bb11-d109f0a2894b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-241626da-a3fa-49ed-bb11-d109f0a2894b' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
<br />
<br /></section>
<section id="soil-types">
<h3>Soil types<a class="headerlink" href="#soil-types" title="Permalink to this heading">#</a></h3>
<p>Define soil type classes. These will be looked up in MetaSWAP’s giant lookup
table for the national Staring series describing Dutch soils. <cite>The full
database can be downloaded here.
&lt;https://download.deltares.nl/metaswap&gt;</cite> In
previous examples we set values in our DataArray using numpy indexing. But we
can also use xarray’s <code class="docutils literal notranslate"><span class="pre">where()</span></code> method to set values.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">slt</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">msw_grid</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
<span class="c1"># Set all cells on the right half to 2.</span>
<span class="n">slt</span> <span class="o">=</span> <span class="n">slt</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">slt</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">xmax</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">slt</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (y: 9, x: 9)&gt;
array([[1, 1, 1, 1, 2, 2, 2, 2, 2],
       [1, 1, 1, 1, 2, 2, 2, 2, 2],
       [1, 1, 1, 1, 2, 2, 2, 2, 2],
       [1, 1, 1, 1, 2, 2, 2, 2, 2],
       [1, 1, 1, 1, 2, 2, 2, 2, 2],
       [1, 1, 1, 1, 2, 2, 2, 2, 2],
       [1, 1, 1, 1, 2, 2, 2, 2, 2],
       [1, 1, 1, 1, 2, 2, 2, 2, 2],
       [1, 1, 1, 1, 2, 2, 2, 2, 2]], dtype=int16)
Coordinates:
  * y        (y) float64 85.0 75.0 65.0 55.0 45.0 35.0 25.0 15.0 5.0
  * x        (x) float64 5.0 15.0 25.0 35.0 45.0 55.0 65.0 75.0 85.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 9</li><li><span class='xr-has-index'>x</span>: 9</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-8daebd80-60b4-4ff8-82cd-041fc7e9945b' class='xr-array-in' type='checkbox' checked><label for='section-8daebd80-60b4-4ff8-82cd-041fc7e9945b' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1 1 1 1 2 2 2 2 2 1 1 1 1 2 2 2 2 ... 1 1 2 2 2 2 2 1 1 1 1 2 2 2 2 2</span></div><div class='xr-array-data'><pre>array([[1, 1, 1, 1, 2, 2, 2, 2, 2],
       [1, 1, 1, 1, 2, 2, 2, 2, 2],
       [1, 1, 1, 1, 2, 2, 2, 2, 2],
       [1, 1, 1, 1, 2, 2, 2, 2, 2],
       [1, 1, 1, 1, 2, 2, 2, 2, 2],
       [1, 1, 1, 1, 2, 2, 2, 2, 2],
       [1, 1, 1, 1, 2, 2, 2, 2, 2],
       [1, 1, 1, 1, 2, 2, 2, 2, 2],
       [1, 1, 1, 1, 2, 2, 2, 2, 2]], dtype=int16)</pre></div></div></li><li class='xr-section-item'><input id='section-22917413-a8f5-44da-a943-a6910127a63a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-22917413-a8f5-44da-a943-a6910127a63a' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>85.0 75.0 65.0 ... 25.0 15.0 5.0</div><input id='attrs-e8d51612-a4ca-46bb-89e3-10748967a37e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e8d51612-a4ca-46bb-89e3-10748967a37e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9d49d4e4-6f59-448c-beab-b6517f29b333' class='xr-var-data-in' type='checkbox'><label for='data-9d49d4e4-6f59-448c-beab-b6517f29b333' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([85., 75., 65., 55., 45., 35., 25., 15.,  5.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.0 15.0 25.0 ... 65.0 75.0 85.0</div><input id='attrs-b0c6b50c-787f-496f-b1cd-105d97cc01c7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b0c6b50c-787f-496f-b1cd-105d97cc01c7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-40670467-3b67-497b-82a3-3a52a2132f9f' class='xr-var-data-in' type='checkbox'><label for='data-40670467-3b67-497b-82a3-3a52a2132f9f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 5., 15., 25., 35., 45., 55., 65., 75., 85.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0b5703ad-8d70-404e-8e32-c11ae52b691a' class='xr-section-summary-in' type='checkbox'  ><label for='section-0b5703ad-8d70-404e-8e32-c11ae52b691a' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-b3f73f76-7dd9-440f-a672-6fcf7df660b8' class='xr-index-data-in' type='checkbox'/><label for='index-b3f73f76-7dd9-440f-a672-6fcf7df660b8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([85.0, 75.0, 65.0, 55.0, 45.0, 35.0, 25.0, 15.0, 5.0], dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-9cc232d2-e8b3-4eff-a6c7-2c11f99cd312' class='xr-index-data-in' type='checkbox'/><label for='index-9cc232d2-e8b3-4eff-a6c7-2c11f99cd312' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([5.0, 15.0, 25.0, 35.0, 45.0, 55.0, 65.0, 75.0, 85.0], dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ad5a349c-4ec5-4b59-ba7e-c4566b24a98a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-ad5a349c-4ec5-4b59-ba7e-c4566b24a98a' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
<br />
<br /></section>
<section id="finishing-the-grid">
<h3>Finishing the grid<a class="headerlink" href="#finishing-the-grid" title="Permalink to this heading">#</a></h3>
<p>To finish specifying the landuse grid data, we’ll require a rootzone depth
for each subunit, and a grid with surface elevations</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">rootzone_depth</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">area</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">surface_elevation</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">msw_grid</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>

<span class="n">msw_model</span><span class="p">[</span><span class="s2">&quot;grid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">msw</span><span class="o">.</span><span class="n">GridData</span><span class="p">(</span>
    <span class="n">area</span><span class="o">=</span><span class="n">area</span><span class="p">,</span>
    <span class="n">landuse</span><span class="o">=</span><span class="n">landuse</span><span class="p">,</span>
    <span class="n">rootzone_depth</span><span class="o">=</span><span class="n">rootzone_depth</span><span class="p">,</span>
    <span class="n">surface_elevation</span><span class="o">=</span><span class="n">surface_elevation</span><span class="p">,</span>
    <span class="n">soil_physical_unit</span><span class="o">=</span><span class="n">slt</span><span class="p">,</span>
    <span class="n">active</span><span class="o">=</span><span class="n">active</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="initial-condition">
<h3>Initial Condition<a class="headerlink" href="#initial-condition" title="Permalink to this heading">#</a></h3>
<p>There are four options to specify initial conditions,
see this for page for an explanation —link-here—.
In this case we opt for an inital pF value of 2.2.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">msw_model</span><span class="p">[</span><span class="s2">&quot;ic&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">msw</span><span class="o">.</span><span class="n">InitialConditionsRootzonePressureHead</span><span class="p">(</span><span class="n">initial_pF</span><span class="o">=</span><span class="mf">2.2</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="meteorology">
<h3>Meteorology<a class="headerlink" href="#meteorology" title="Permalink to this heading">#</a></h3>
<p>Meteorological information should be provided as grids with a <code class="docutils literal notranslate"><span class="pre">time</span></code>
dimension.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">precipitation</span> <span class="o">=</span> <span class="n">msw_grid</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">times</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">evapotranspiration</span> <span class="o">=</span> <span class="n">precipitation</span> <span class="o">*</span> <span class="mf">1.5</span>

<span class="n">msw_model</span><span class="p">[</span><span class="s2">&quot;meteo_grid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">msw</span><span class="o">.</span><span class="n">MeteoGrid</span><span class="p">(</span><span class="n">precipitation</span><span class="p">,</span> <span class="n">evapotranspiration</span><span class="p">)</span>
<span class="n">msw_model</span><span class="p">[</span><span class="s2">&quot;mapping_prec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">msw</span><span class="o">.</span><span class="n">PrecipitationMapping</span><span class="p">(</span><span class="n">precipitation</span><span class="p">)</span>
<span class="n">msw_model</span><span class="p">[</span><span class="s2">&quot;mapping_evt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">msw</span><span class="o">.</span><span class="n">EvapotranspirationMapping</span><span class="p">(</span><span class="n">evapotranspiration</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="ponding">
<h3>Ponding<a class="headerlink" href="#ponding" title="Permalink to this heading">#</a></h3>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">msw_model</span><span class="p">[</span><span class="s2">&quot;ponding&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">msw</span><span class="o">.</span><span class="n">Ponding</span><span class="p">(</span>
    <span class="n">ponding_depth</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">area</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
    <span class="n">runon_resistance</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">area</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
    <span class="n">runoff_resistance</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">area</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="scaling-factors">
<h3>Scaling Factors<a class="headerlink" href="#scaling-factors" title="Permalink to this heading">#</a></h3>
<p>Scaling factors can be defined to adapt some parameters in the soil physical
database. With this you can investigate the sensitivity of parameters in soil
physical database. Furthermore, with this package you can specify the depth of
the perched water table.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">msw_model</span><span class="p">[</span><span class="s2">&quot;scaling&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">msw</span><span class="o">.</span><span class="n">ScalingFactors</span><span class="p">(</span>
    <span class="n">scale_soil_moisture</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">area</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
    <span class="n">scale_hydraulic_conductivity</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">area</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
    <span class="n">scale_pressure_head</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">area</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
    <span class="n">depth_perched_water_table</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">msw_grid</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="infiltration-factors">
<h3>Infiltration Factors<a class="headerlink" href="#infiltration-factors" title="Permalink to this heading">#</a></h3>
<p>Set the infiltration parameters. We set the resistances to -9999.0, which
makes MetaSWAP ignore them.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">msw_model</span><span class="p">[</span><span class="s2">&quot;infiltration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">msw</span><span class="o">.</span><span class="n">Infiltration</span><span class="p">(</span>
    <span class="n">infiltration_capacity</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">area</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
    <span class="n">downward_resistance</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">msw_grid</span><span class="p">,</span> <span class="o">-</span><span class="mf">9999.0</span><span class="p">),</span>
    <span class="n">upward_resistance</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">msw_grid</span><span class="p">,</span> <span class="o">-</span><span class="mf">9999.0</span><span class="p">),</span>
    <span class="n">bottom_resistance</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">msw_grid</span><span class="p">,</span> <span class="o">-</span><span class="mf">9999.0</span><span class="p">),</span>
    <span class="n">extra_storage_coefficient</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">msw_grid</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="landuse-options">
<h3>Landuse options<a class="headerlink" href="#landuse-options" title="Permalink to this heading">#</a></h3>
<p>The landuse option class constructs a lookup table which is used to map
landuse indices to a set of parameters. In this example, 3 stands for
potatoes. This means that for every cell in the <code class="docutils literal notranslate"><span class="pre">landuse</span></code> grid with a 3, the
parameters for a crop with <code class="docutils literal notranslate"><span class="pre">vegetation_index</span> <span class="pre">==</span> <span class="pre">3</span></code> are associate, which in this
case are potatoes.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">vegetation_index</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;grassland&quot;</span><span class="p">,</span> <span class="s2">&quot;maize&quot;</span><span class="p">,</span> <span class="s2">&quot;potatoes&quot;</span><span class="p">]</span>

<span class="n">landuse_index</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">coords</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;landuse_index&quot;</span><span class="p">:</span> <span class="n">landuse_index</span><span class="p">}</span>

<span class="n">landuse_names</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">names</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;landuse_index&quot;</span><span class="p">,))</span>
<span class="n">vegetation_index_da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">vegetation_index</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;landuse_index&quot;</span><span class="p">,)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Because there are a lot of parameters to define, we’ll create a DataArray of
ones (<code class="docutils literal notranslate"><span class="pre">lu</span></code>) to more easily broadcast all the different parameters.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">lu</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">vegetation_index_da</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

<span class="n">msw_model</span><span class="p">[</span><span class="s2">&quot;landuse_options&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">msw</span><span class="o">.</span><span class="n">LanduseOptions</span><span class="p">(</span>
    <span class="n">landuse_name</span><span class="o">=</span><span class="n">landuse_names</span><span class="p">,</span>
    <span class="n">vegetation_index</span><span class="o">=</span><span class="n">vegetation_index_da</span><span class="p">,</span>
    <span class="n">jarvis_o2_stress</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">lu</span><span class="p">),</span>
    <span class="n">jarvis_drought_stress</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">lu</span><span class="p">),</span>
    <span class="n">feddes_p1</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">lu</span><span class="p">,</span> <span class="mf">99.0</span><span class="p">),</span>
    <span class="n">feddes_p2</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">lu</span><span class="p">,</span> <span class="mf">99.0</span><span class="p">),</span>
    <span class="n">feddes_p3h</span><span class="o">=</span><span class="n">lu</span> <span class="o">*</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.0</span><span class="p">],</span>
    <span class="n">feddes_p3l</span><span class="o">=</span><span class="n">lu</span> <span class="o">*</span> <span class="p">[</span><span class="o">-</span><span class="mf">8.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">],</span>
    <span class="n">feddes_p4</span><span class="o">=</span><span class="n">lu</span> <span class="o">*</span> <span class="p">[</span><span class="o">-</span><span class="mf">80.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">100.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">100.0</span><span class="p">],</span>
    <span class="n">feddes_t3h</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">lu</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">),</span>
    <span class="n">feddes_t3l</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">lu</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
    <span class="n">threshold_sprinkling</span><span class="o">=</span><span class="n">lu</span> <span class="o">*</span> <span class="p">[</span><span class="o">-</span><span class="mf">8.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">],</span>
    <span class="n">fraction_evaporated_sprinkling</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">lu</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span>
    <span class="n">gift</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">lu</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">),</span>
    <span class="n">gift_duration</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">lu</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span>
    <span class="n">rotational_period</span><span class="o">=</span><span class="n">lu</span> <span class="o">*</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
    <span class="n">start_sprinkling_season</span><span class="o">=</span><span class="n">lu</span> <span class="o">*</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">150</span><span class="p">],</span>
    <span class="n">end_sprinkling_season</span><span class="o">=</span><span class="n">lu</span> <span class="o">*</span> <span class="p">[</span><span class="mi">230</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">240</span><span class="p">],</span>
    <span class="n">interception_option</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">lu</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span>
    <span class="n">interception_capacity_per_LAI</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">lu</span><span class="p">),</span>
    <span class="n">interception_intercept</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">lu</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="crop-growth">
<h3>Crop Growth<a class="headerlink" href="#crop-growth" title="Permalink to this heading">#</a></h3>
<p>Crop growth tables are specified as a two-dimensional array, with the day of
year as one dimension, and the vegetation index on the other. In the vegetation
factors, we’ll show how to bring some distinction between different crops.</p>
<p>We’ll start off specifiying the coordinates:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">day_of_year</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">367</span><span class="p">)</span>
<span class="n">vegetation_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">coords</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;day_of_year&quot;</span><span class="p">:</span> <span class="n">day_of_year</span><span class="p">,</span> <span class="s2">&quot;vegetation_index&quot;</span><span class="p">:</span> <span class="n">vegetation_index</span><span class="p">}</span>
</pre></div>
</div>
<p>We can use the coordinates to specify the soil cover of each plant.
We’ll start with a grid of zeros</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">soil_cover</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">day_of_year</span><span class="o">.</span><span class="n">shape</span> <span class="o">+</span> <span class="n">vegetation_index</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span>
    <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
    <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;day_of_year&quot;</span><span class="p">,</span> <span class="s2">&quot;vegetation_index&quot;</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The simplest soil cover specification is a step function. In this case soil
cover equals 1.0 for days 133 to 255 (mind Python’s 0-based index here), and
for the rest of the days it equals zero.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">soil_cover</span><span class="p">[</span><span class="mi">132</span><span class="p">:</span><span class="mi">254</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="n">soil_cover</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">vegetation_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_metaswap_example_003.png" srcset="../../_images/sphx_glr_metaswap_example_003.png" alt="vegetation_index = 1" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D object at 0x0000026457A09290&gt;]
</pre></div>
</div>
<p>We’ll simply triple the soil cover to get a leaf area index</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">leaf_area_index</span> <span class="o">=</span> <span class="n">soil_cover</span> <span class="o">*</span> <span class="mi">3</span>
</pre></div>
</div>
<p>Vegetation factors are used to convert the Makkink reference
evapotranspiration to a potential evapotranspiration for a certain vegetation
type. We’ll specify some simple crop schemes for the three crops as vegetation
factors. Mind that the vegetation factor array has two dimensions:
<code class="docutils literal notranslate"><span class="pre">day_of_year</span></code> and <code class="docutils literal notranslate"><span class="pre">vegetation_index</span></code></p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">vegetation_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;grass&quot;</span><span class="p">,</span> <span class="s2">&quot;maize&quot;</span><span class="p">,</span> <span class="s2">&quot;potatoes&quot;</span><span class="p">]</span>

<span class="n">vegetation_factor</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">soil_cover</span><span class="p">)</span>

<span class="n">vegetation_factor</span><span class="p">[</span><span class="mi">120</span><span class="p">:</span><span class="mi">132</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="n">vegetation_factor</span><span class="p">[</span><span class="mi">132</span><span class="p">:</span><span class="mi">142</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]</span>
<span class="n">vegetation_factor</span><span class="p">[</span><span class="mi">142</span><span class="p">:</span><span class="mi">152</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>
<span class="n">vegetation_factor</span><span class="p">[</span><span class="mi">152</span><span class="p">:</span><span class="mi">162</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="n">vegetation_factor</span><span class="p">[</span><span class="mi">162</span><span class="p">:</span><span class="mi">172</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">]</span>
<span class="n">vegetation_factor</span><span class="p">[</span><span class="mi">172</span><span class="p">:</span><span class="mi">182</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">]</span>
<span class="n">vegetation_factor</span><span class="p">[</span><span class="mi">182</span><span class="p">:</span><span class="mi">192</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">]</span>
<span class="n">vegetation_factor</span><span class="p">[</span><span class="mi">192</span><span class="p">:</span><span class="mi">244</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">]</span>
<span class="n">vegetation_factor</span><span class="p">[</span><span class="mi">244</span><span class="p">:</span><span class="mi">254</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]</span>
<span class="n">vegetation_factor</span><span class="p">[</span><span class="mi">254</span><span class="p">:</span><span class="mi">283</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>

<span class="c1"># Since grass is the reference crop, force all grass to 1.0</span>
<span class="n">vegetation_factor</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>


<span class="c1"># Assign vegetation names for the plot</span>
<span class="n">vegetation_factor</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span>
    <span class="n">vegetation_names</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;vegetation_index&quot;</span><span class="p">,</span> <span class="n">vegetation_names</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;day_of_year&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;vegetation_names&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_metaswap_example_004.png" srcset="../../_images/sphx_glr_metaswap_example_004.png" alt="metaswap example" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D object at 0x000002645B85A510&gt;, &lt;matplotlib.lines.Line2D object at 0x0000026455852950&gt;, &lt;matplotlib.lines.Line2D object at 0x000002645B8D93D0&gt;]
</pre></div>
</div>
<p>We’ll leave the interception capacity at zero, and the other factors at
one, and assign these to the AnnualCropFactors package.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">msw_model</span><span class="p">[</span><span class="s2">&quot;crop_factors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">msw</span><span class="o">.</span><span class="n">AnnualCropFactors</span><span class="p">(</span>
    <span class="n">soil_cover</span><span class="o">=</span><span class="n">soil_cover</span><span class="p">,</span>
    <span class="n">leaf_area_index</span><span class="o">=</span><span class="n">leaf_area_index</span><span class="p">,</span>
    <span class="n">interception_capacity</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">soil_cover</span><span class="p">),</span>
    <span class="n">vegetation_factor</span><span class="o">=</span><span class="n">vegetation_factor</span><span class="p">,</span>
    <span class="n">interception_factor</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">soil_cover</span><span class="p">),</span>
    <span class="n">bare_soil_factor</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">soil_cover</span><span class="p">),</span>
    <span class="n">ponding_factor</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">soil_cover</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id1">
<h3>Output Control<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">msw_model</span><span class="p">[</span><span class="s2">&quot;oc_idf&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">msw</span><span class="o">.</span><span class="n">IdfMapping</span><span class="p">(</span><span class="n">area</span><span class="p">,</span> <span class="o">-</span><span class="mf">9999.0</span><span class="p">)</span>
<span class="n">msw_model</span><span class="p">[</span><span class="s2">&quot;oc_var&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">msw</span><span class="o">.</span><span class="n">VariableOutputControl</span><span class="p">()</span>
<span class="n">msw_model</span><span class="p">[</span><span class="s2">&quot;oc_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">msw</span><span class="o">.</span><span class="n">TimeOutputControl</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">times</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="metaswap-mappings">
<h3>MetaSWAP Mappings<a class="headerlink" href="#metaswap-mappings" title="Permalink to this heading">#</a></h3>
<p>MetaSWAP requires its own mapping of SVAT to MODFLOW cells, for internal use.
We therefore provide the mf6.StructuredDiscretization and mf6.Well package to
mf6.CouplerMapping.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">msw_model</span><span class="p">[</span><span class="s2">&quot;mod2svat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">msw</span><span class="o">.</span><span class="n">CouplerMapping</span><span class="p">(</span>
    <span class="n">modflow_dis</span><span class="o">=</span><span class="n">gwf_model</span><span class="p">[</span><span class="s2">&quot;dis&quot;</span><span class="p">],</span> <span class="n">well</span><span class="o">=</span><span class="n">gwf_model</span><span class="p">[</span><span class="s2">&quot;wells_msw&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The sprinkling package also requires the Modflow6 wells.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">msw_model</span><span class="p">[</span><span class="s2">&quot;sprinkling&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">msw</span><span class="o">.</span><span class="n">Sprinkling</span><span class="p">(</span>
    <span class="n">max_abstraction_groundwater</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">msw_grid</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">),</span>
    <span class="n">max_abstraction_surfacewater</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">msw_grid</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">),</span>
    <span class="n">well</span><span class="o">=</span><span class="n">gwf_model</span><span class="p">[</span><span class="s2">&quot;wells_msw&quot;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="coupler-mapping">
<h2>Coupler mapping<a class="headerlink" href="#coupler-mapping" title="Permalink to this heading">#</a></h2>
<p>The MetaSWAP model and Modflow 6 simulation are provided to the MetaMod class,
which takes care of connecting (= “mapping”) the two models. Make sure to
provide the keys of the dummy Modflow 6 boundary conditions where MetaSWAP is
coupled to, so iMOD Python knows where to look: It is technically possible to
define multiple WEL and RCH packages in Modflow 6.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">metamod</span> <span class="o">=</span> <span class="n">couplers</span><span class="o">.</span><span class="n">MetaMod</span><span class="p">(</span>
    <span class="n">msw_model</span><span class="o">=</span><span class="n">msw_model</span><span class="p">,</span>
    <span class="n">mf6_simulation</span><span class="o">=</span><span class="n">simulation</span><span class="p">,</span>
    <span class="n">mf6_rch_pkgkey</span><span class="o">=</span><span class="s2">&quot;rch_msw&quot;</span><span class="p">,</span>
    <span class="n">mf6_wel_pkgkey</span><span class="o">=</span><span class="s2">&quot;wells_msw&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>By providing a few necessary paths to the modflow and metaswap libraries
for iMOD Coupler, we can write the coupled models. You can download the
modflow and metaswap libraries as part of the <a class="reference external" href="https://oss.deltares.nl/web/imod/download-imod5">the last iMOD5 release</a></p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">metamod_dir</span> <span class="o">=</span> <span class="n">imod</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">temporary_directory</span><span class="p">()</span>
<span class="n">mf6_dll</span> <span class="o">=</span> <span class="s2">&quot;./path/to/mf6.dll&quot;</span>
<span class="n">metaswap_dll</span> <span class="o">=</span> <span class="s2">&quot;./path/to/metaswap.dll&quot;</span>
<span class="n">metaswap_dll_dependency</span> <span class="o">=</span> <span class="s2">&quot;./path/to/metaswap/dll/dependency&quot;</span>

<span class="n">metamod</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">metamod_dir</span><span class="p">,</span> <span class="n">mf6_dll</span><span class="p">,</span> <span class="n">metaswap_dll</span><span class="p">,</span> <span class="n">metaswap_dll_dependency</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="running-the-models">
<h2>Running the models<a class="headerlink" href="#running-the-models" title="Permalink to this heading">#</a></h2>
<p>In order to run the models, make sure you install <code class="docutils literal notranslate"><span class="pre">imod_coupler</span></code>. <a class="reference external" href="https://github.com/Deltares/imod_coupler">You can
find the installation instructions here.</a></p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 0.792 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-metaswap-metaswap-example-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/6ca44f63cf025ff209dcc705a198c2d7/metaswap_example.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">metaswap_example.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/51be4ad1aba3f7d05234219a8ec77a7e/metaswap_example.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">metaswap_example.py</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">MetaSWAP</p>
      </div>
    </a>
    <a class="right-next"
       href="read_metaswap_file.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Reading existing MetaSWAP input</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">

  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modflow-6-model">Modflow 6 model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-grid">Create grid</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hydrogeology">Hydrogeology</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hydraulic-conductivity">Hydraulic conductivity</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#storage">Storage</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-conditions">Initial conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#output-control">Output Control</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boundary-conditions">Boundary conditions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#constant-head">Constant head</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dummy-boundary-conditions">Dummy boundary conditions</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#recharge">Recharge</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#wells">Wells</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metaswap-model">MetaSWAP model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#landuse">Landuse</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#soil-types">Soil types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finishing-the-grid">Finishing the grid</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-condition">Initial Condition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meteorology">Meteorology</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ponding">Ponding</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scaling-factors">Scaling Factors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#infiltration-factors">Infiltration Factors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#landuse-options">Landuse options</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#crop-growth">Crop Growth</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Output Control</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metaswap-mappings">MetaSWAP Mappings</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coupler-mapping">Coupler mapping</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-the-models">Running the models</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/examples/metaswap/metaswap_example.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright Deltares.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>